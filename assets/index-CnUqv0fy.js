var Nm=e=>{throw TypeError(e)};var QC=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var Sd=(e,t,n)=>t.has(e)||Nm("Cannot "+n);var G=(e,t,n)=>(Sd(e,t,"read from private field"),n?n.call(e):t.get(e)),Ie=(e,t,n)=>t.has(e)?Nm("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),ye=(e,t,n,r)=>(Sd(e,t,"write to private field"),r?r.call(e,n):t.set(e,n),n),Tt=(e,t,n)=>(Sd(e,t,"access private method"),n);var Iu=(e,t,n,r)=>({set _(o){ye(e,t,o,n)},get _(){return G(e,t,r)}});var wL=QC((NL,GC)=>{function JC(e,t){for(var n=0;n<t.length;n++){const r=t[n];if(typeof r!="string"&&!Array.isArray(r)){for(const o in r)if(o!=="default"&&!(o in e)){const i=Object.getOwnPropertyDescriptor(r,o);i&&Object.defineProperty(e,o,i.get?i:{enumerable:!0,get:()=>r[o]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerPolicy&&(i.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?i.credentials="include":o.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(o){if(o.ep)return;o.ep=!0;const i=n(o);fetch(o.href,i)}})();function P0(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var D0={exports:{}},Dc={},F0={exports:{}},Se={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var cu=Symbol.for("react.element"),ZC=Symbol.for("react.portal"),eE=Symbol.for("react.fragment"),tE=Symbol.for("react.strict_mode"),nE=Symbol.for("react.profiler"),rE=Symbol.for("react.provider"),oE=Symbol.for("react.context"),iE=Symbol.for("react.forward_ref"),aE=Symbol.for("react.suspense"),sE=Symbol.for("react.memo"),uE=Symbol.for("react.lazy"),Im=Symbol.iterator;function lE(e){return e===null||typeof e!="object"?null:(e=Im&&e[Im]||e["@@iterator"],typeof e=="function"?e:null)}var M0={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},O0=Object.assign,L0={};function Ka(e,t,n){this.props=e,this.context=t,this.refs=L0,this.updater=n||M0}Ka.prototype.isReactComponent={};Ka.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Ka.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function B0(){}B0.prototype=Ka.prototype;function cp(e,t,n){this.props=e,this.context=t,this.refs=L0,this.updater=n||M0}var dp=cp.prototype=new B0;dp.constructor=cp;O0(dp,Ka.prototype);dp.isPureReactComponent=!0;var Tm=Array.isArray,j0=Object.prototype.hasOwnProperty,fp={current:null},W0={key:!0,ref:!0,__self:!0,__source:!0};function z0(e,t,n){var r,o={},i=null,a=null;if(t!=null)for(r in t.ref!==void 0&&(a=t.ref),t.key!==void 0&&(i=""+t.key),t)j0.call(t,r)&&!W0.hasOwnProperty(r)&&(o[r]=t[r]);var s=arguments.length-2;if(s===1)o.children=n;else if(1<s){for(var u=Array(s),l=0;l<s;l++)u[l]=arguments[l+2];o.children=u}if(e&&e.defaultProps)for(r in s=e.defaultProps,s)o[r]===void 0&&(o[r]=s[r]);return{$$typeof:cu,type:e,key:i,ref:a,props:o,_owner:fp.current}}function cE(e,t){return{$$typeof:cu,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function hp(e){return typeof e=="object"&&e!==null&&e.$$typeof===cu}function dE(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var Am=/\/+/g;function kd(e,t){return typeof e=="object"&&e!==null&&e.key!=null?dE(""+e.key):t.toString(36)}function hl(e,t,n,r,o){var i=typeof e;(i==="undefined"||i==="boolean")&&(e=null);var a=!1;if(e===null)a=!0;else switch(i){case"string":case"number":a=!0;break;case"object":switch(e.$$typeof){case cu:case ZC:a=!0}}if(a)return a=e,o=o(a),e=r===""?"."+kd(a,0):r,Tm(o)?(n="",e!=null&&(n=e.replace(Am,"$&/")+"/"),hl(o,t,n,"",function(l){return l})):o!=null&&(hp(o)&&(o=cE(o,n+(!o.key||a&&a.key===o.key?"":(""+o.key).replace(Am,"$&/")+"/")+e)),t.push(o)),1;if(a=0,r=r===""?".":r+":",Tm(e))for(var s=0;s<e.length;s++){i=e[s];var u=r+kd(i,s);a+=hl(i,t,n,u,o)}else if(u=lE(e),typeof u=="function")for(e=u.call(e),s=0;!(i=e.next()).done;)i=i.value,u=r+kd(i,s++),a+=hl(i,t,n,u,o);else if(i==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return a}function Tu(e,t,n){if(e==null)return e;var r=[],o=0;return hl(e,r,"","",function(i){return t.call(n,i,o++)}),r}function fE(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Kt={current:null},pl={transition:null},hE={ReactCurrentDispatcher:Kt,ReactCurrentBatchConfig:pl,ReactCurrentOwner:fp};function U0(){throw Error("act(...) is not supported in production builds of React.")}Se.Children={map:Tu,forEach:function(e,t,n){Tu(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return Tu(e,function(){t++}),t},toArray:function(e){return Tu(e,function(t){return t})||[]},only:function(e){if(!hp(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Se.Component=Ka;Se.Fragment=eE;Se.Profiler=nE;Se.PureComponent=cp;Se.StrictMode=tE;Se.Suspense=aE;Se.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=hE;Se.act=U0;Se.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=O0({},e.props),o=e.key,i=e.ref,a=e._owner;if(t!=null){if(t.ref!==void 0&&(i=t.ref,a=fp.current),t.key!==void 0&&(o=""+t.key),e.type&&e.type.defaultProps)var s=e.type.defaultProps;for(u in t)j0.call(t,u)&&!W0.hasOwnProperty(u)&&(r[u]=t[u]===void 0&&s!==void 0?s[u]:t[u])}var u=arguments.length-2;if(u===1)r.children=n;else if(1<u){s=Array(u);for(var l=0;l<u;l++)s[l]=arguments[l+2];r.children=s}return{$$typeof:cu,type:e.type,key:o,ref:i,props:r,_owner:a}};Se.createContext=function(e){return e={$$typeof:oE,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:rE,_context:e},e.Consumer=e};Se.createElement=z0;Se.createFactory=function(e){var t=z0.bind(null,e);return t.type=e,t};Se.createRef=function(){return{current:null}};Se.forwardRef=function(e){return{$$typeof:iE,render:e}};Se.isValidElement=hp;Se.lazy=function(e){return{$$typeof:uE,_payload:{_status:-1,_result:e},_init:fE}};Se.memo=function(e,t){return{$$typeof:sE,type:e,compare:t===void 0?null:t}};Se.startTransition=function(e){var t=pl.transition;pl.transition={};try{e()}finally{pl.transition=t}};Se.unstable_act=U0;Se.useCallback=function(e,t){return Kt.current.useCallback(e,t)};Se.useContext=function(e){return Kt.current.useContext(e)};Se.useDebugValue=function(){};Se.useDeferredValue=function(e){return Kt.current.useDeferredValue(e)};Se.useEffect=function(e,t){return Kt.current.useEffect(e,t)};Se.useId=function(){return Kt.current.useId()};Se.useImperativeHandle=function(e,t,n){return Kt.current.useImperativeHandle(e,t,n)};Se.useInsertionEffect=function(e,t){return Kt.current.useInsertionEffect(e,t)};Se.useLayoutEffect=function(e,t){return Kt.current.useLayoutEffect(e,t)};Se.useMemo=function(e,t){return Kt.current.useMemo(e,t)};Se.useReducer=function(e,t,n){return Kt.current.useReducer(e,t,n)};Se.useRef=function(e){return Kt.current.useRef(e)};Se.useState=function(e){return Kt.current.useState(e)};Se.useSyncExternalStore=function(e,t,n){return Kt.current.useSyncExternalStore(e,t,n)};Se.useTransition=function(){return Kt.current.useTransition()};Se.version="18.3.1";F0.exports=Se;var A=F0.exports;const J=P0(A),$0=JC({__proto__:null,default:J},[A]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var pE=A,vE=Symbol.for("react.element"),mE=Symbol.for("react.fragment"),gE=Object.prototype.hasOwnProperty,yE=pE.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,xE={key:!0,ref:!0,__self:!0,__source:!0};function V0(e,t,n){var r,o={},i=null,a=null;n!==void 0&&(i=""+n),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(a=t.ref);for(r in t)gE.call(t,r)&&!xE.hasOwnProperty(r)&&(o[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps,t)o[r]===void 0&&(o[r]=t[r]);return{$$typeof:vE,type:e,key:i,ref:a,props:o,_owner:yE.current}}Dc.Fragment=mE;Dc.jsx=V0;Dc.jsxs=V0;D0.exports=Dc;var _=D0.exports,H0={exports:{}},_n={},G0={exports:{}},q0={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(D,M){var B=D.length;D.push(M);e:for(;0<B;){var q=B-1>>>1,K=D[q];if(0<o(K,M))D[q]=M,D[B]=K,B=q;else break e}}function n(D){return D.length===0?null:D[0]}function r(D){if(D.length===0)return null;var M=D[0],B=D.pop();if(B!==M){D[0]=B;e:for(var q=0,K=D.length,Q=K>>>1;q<Q;){var Z=2*(q+1)-1,se=D[Z],de=Z+1,re=D[de];if(0>o(se,B))de<K&&0>o(re,se)?(D[q]=re,D[de]=B,q=de):(D[q]=se,D[Z]=B,q=Z);else if(de<K&&0>o(re,B))D[q]=re,D[de]=B,q=de;else break e}}return M}function o(D,M){var B=D.sortIndex-M.sortIndex;return B!==0?B:D.id-M.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var a=Date,s=a.now();e.unstable_now=function(){return a.now()-s}}var u=[],l=[],c=1,d=null,f=3,h=!1,v=!1,m=!1,g=typeof setTimeout=="function"?setTimeout:null,p=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function x(D){for(var M=n(l);M!==null;){if(M.callback===null)r(l);else if(M.startTime<=D)r(l),M.sortIndex=M.expirationTime,t(u,M);else break;M=n(l)}}function w(D){if(m=!1,x(D),!v)if(n(u)!==null)v=!0,U(b);else{var M=n(l);M!==null&&z(w,M.startTime-D)}}function b(D,M){v=!1,m&&(m=!1,p(S),S=-1),h=!0;var B=f;try{for(x(M),d=n(u);d!==null&&(!(d.expirationTime>M)||D&&!P());){var q=d.callback;if(typeof q=="function"){d.callback=null,f=d.priorityLevel;var K=q(d.expirationTime<=M);M=e.unstable_now(),typeof K=="function"?d.callback=K:d===n(u)&&r(u),x(M)}else r(u);d=n(u)}if(d!==null)var Q=!0;else{var Z=n(l);Z!==null&&z(w,Z.startTime-M),Q=!1}return Q}finally{d=null,f=B,h=!1}}var C=!1,E=null,S=-1,R=5,k=-1;function P(){return!(e.unstable_now()-k<R)}function T(){if(E!==null){var D=e.unstable_now();k=D;var M=!0;try{M=E(!0,D)}finally{M?j():(C=!1,E=null)}}else C=!1}var j;if(typeof y=="function")j=function(){y(T)};else if(typeof MessageChannel<"u"){var O=new MessageChannel,W=O.port2;O.port1.onmessage=T,j=function(){W.postMessage(null)}}else j=function(){g(T,0)};function U(D){E=D,C||(C=!0,j())}function z(D,M){S=g(function(){D(e.unstable_now())},M)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(D){D.callback=null},e.unstable_continueExecution=function(){v||h||(v=!0,U(b))},e.unstable_forceFrameRate=function(D){0>D||125<D?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):R=0<D?Math.floor(1e3/D):5},e.unstable_getCurrentPriorityLevel=function(){return f},e.unstable_getFirstCallbackNode=function(){return n(u)},e.unstable_next=function(D){switch(f){case 1:case 2:case 3:var M=3;break;default:M=f}var B=f;f=M;try{return D()}finally{f=B}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(D,M){switch(D){case 1:case 2:case 3:case 4:case 5:break;default:D=3}var B=f;f=D;try{return M()}finally{f=B}},e.unstable_scheduleCallback=function(D,M,B){var q=e.unstable_now();switch(typeof B=="object"&&B!==null?(B=B.delay,B=typeof B=="number"&&0<B?q+B:q):B=q,D){case 1:var K=-1;break;case 2:K=250;break;case 5:K=1073741823;break;case 4:K=1e4;break;default:K=5e3}return K=B+K,D={id:c++,callback:M,priorityLevel:D,startTime:B,expirationTime:K,sortIndex:-1},B>q?(D.sortIndex=B,t(l,D),n(u)===null&&D===n(l)&&(m?(p(S),S=-1):m=!0,z(w,B-q))):(D.sortIndex=K,t(u,D),v||h||(v=!0,U(b))),D},e.unstable_shouldYield=P,e.unstable_wrapCallback=function(D){var M=f;return function(){var B=f;f=M;try{return D.apply(this,arguments)}finally{f=B}}}})(q0);G0.exports=q0;var wE=G0.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var bE=A,En=wE;function Y(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var K0=new Set,Fs={};function Di(e,t){Ma(e,t),Ma(e+"Capture",t)}function Ma(e,t){for(Fs[e]=t,e=0;e<t.length;e++)K0.add(t[e])}var Kr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Df=Object.prototype.hasOwnProperty,CE=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Pm={},Dm={};function EE(e){return Df.call(Dm,e)?!0:Df.call(Pm,e)?!1:CE.test(e)?Dm[e]=!0:(Pm[e]=!0,!1)}function _E(e,t,n,r){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function SE(e,t,n,r){if(t===null||typeof t>"u"||_E(e,t,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Xt(e,t,n,r,o,i,a){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=r,this.attributeNamespace=o,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=a}var Rt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Rt[e]=new Xt(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Rt[t]=new Xt(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Rt[e]=new Xt(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Rt[e]=new Xt(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Rt[e]=new Xt(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Rt[e]=new Xt(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Rt[e]=new Xt(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Rt[e]=new Xt(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Rt[e]=new Xt(e,5,!1,e.toLowerCase(),null,!1,!1)});var pp=/[\-:]([a-z])/g;function vp(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(pp,vp);Rt[t]=new Xt(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(pp,vp);Rt[t]=new Xt(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(pp,vp);Rt[t]=new Xt(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Rt[e]=new Xt(e,1,!1,e.toLowerCase(),null,!1,!1)});Rt.xlinkHref=new Xt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Rt[e]=new Xt(e,1,!1,e.toLowerCase(),null,!0,!0)});function mp(e,t,n,r){var o=Rt.hasOwnProperty(t)?Rt[t]:null;(o!==null?o.type!==0:r||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(SE(t,n,o,r)&&(n=null),r||o===null?EE(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):o.mustUseProperty?e[o.propertyName]=n===null?o.type===3?!1:"":n:(t=o.attributeName,r=o.attributeNamespace,n===null?e.removeAttribute(t):(o=o.type,n=o===3||o===4&&n===!0?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}var eo=bE.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Au=Symbol.for("react.element"),Ji=Symbol.for("react.portal"),Zi=Symbol.for("react.fragment"),gp=Symbol.for("react.strict_mode"),Ff=Symbol.for("react.profiler"),X0=Symbol.for("react.provider"),Y0=Symbol.for("react.context"),yp=Symbol.for("react.forward_ref"),Mf=Symbol.for("react.suspense"),Of=Symbol.for("react.suspense_list"),xp=Symbol.for("react.memo"),yo=Symbol.for("react.lazy"),Q0=Symbol.for("react.offscreen"),Fm=Symbol.iterator;function rs(e){return e===null||typeof e!="object"?null:(e=Fm&&e[Fm]||e["@@iterator"],typeof e=="function"?e:null)}var Ye=Object.assign,Rd;function gs(e){if(Rd===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);Rd=t&&t[1]||""}return`
`+Rd+e}var Nd=!1;function Id(e,t){if(!e||Nd)return"";Nd=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(l){var r=l}Reflect.construct(e,[],t)}else{try{t.call()}catch(l){r=l}e.call(t.prototype)}else{try{throw Error()}catch(l){r=l}e()}}catch(l){if(l&&r&&typeof l.stack=="string"){for(var o=l.stack.split(`
`),i=r.stack.split(`
`),a=o.length-1,s=i.length-1;1<=a&&0<=s&&o[a]!==i[s];)s--;for(;1<=a&&0<=s;a--,s--)if(o[a]!==i[s]){if(a!==1||s!==1)do if(a--,s--,0>s||o[a]!==i[s]){var u=`
`+o[a].replace(" at new "," at ");return e.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",e.displayName)),u}while(1<=a&&0<=s);break}}}finally{Nd=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?gs(e):""}function kE(e){switch(e.tag){case 5:return gs(e.type);case 16:return gs("Lazy");case 13:return gs("Suspense");case 19:return gs("SuspenseList");case 0:case 2:case 15:return e=Id(e.type,!1),e;case 11:return e=Id(e.type.render,!1),e;case 1:return e=Id(e.type,!0),e;default:return""}}function Lf(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Zi:return"Fragment";case Ji:return"Portal";case Ff:return"Profiler";case gp:return"StrictMode";case Mf:return"Suspense";case Of:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Y0:return(e.displayName||"Context")+".Consumer";case X0:return(e._context.displayName||"Context")+".Provider";case yp:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case xp:return t=e.displayName||null,t!==null?t:Lf(e.type)||"Memo";case yo:t=e._payload,e=e._init;try{return Lf(e(t))}catch{}}return null}function RE(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Lf(t);case 8:return t===gp?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function $o(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function J0(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function NE(e){var t=J0(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var o=n.get,i=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return o.call(this)},set:function(a){r=""+a,i.call(this,a)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(a){r=""+a},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Pu(e){e._valueTracker||(e._valueTracker=NE(e))}function Z0(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=J0(e)?e.checked?"true":"false":e.value),e=r,e!==n?(t.setValue(e),!0):!1}function Pl(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Bf(e,t){var n=t.checked;return Ye({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function Mm(e,t){var n=t.defaultValue==null?"":t.defaultValue,r=t.checked!=null?t.checked:t.defaultChecked;n=$o(t.value!=null?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function ex(e,t){t=t.checked,t!=null&&mp(e,"checked",t,!1)}function jf(e,t){ex(e,t);var n=$o(t.value),r=t.type;if(n!=null)r==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(r==="submit"||r==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Wf(e,t.type,n):t.hasOwnProperty("defaultValue")&&Wf(e,t.type,$o(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function Om(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!(r!=="submit"&&r!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function Wf(e,t,n){(t!=="number"||Pl(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var ys=Array.isArray;function ca(e,t,n,r){if(e=e.options,t){t={};for(var o=0;o<n.length;o++)t["$"+n[o]]=!0;for(n=0;n<e.length;n++)o=t.hasOwnProperty("$"+e[n].value),e[n].selected!==o&&(e[n].selected=o),o&&r&&(e[n].defaultSelected=!0)}else{for(n=""+$o(n),t=null,o=0;o<e.length;o++){if(e[o].value===n){e[o].selected=!0,r&&(e[o].defaultSelected=!0);return}t!==null||e[o].disabled||(t=e[o])}t!==null&&(t.selected=!0)}}function zf(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(Y(91));return Ye({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Lm(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(Y(92));if(ys(n)){if(1<n.length)throw Error(Y(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:$o(n)}}function tx(e,t){var n=$o(t.value),r=$o(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),r!=null&&(e.defaultValue=""+r)}function Bm(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function nx(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Uf(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?nx(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Du,rx=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,r,o){MSApp.execUnsafeLocalFunction(function(){return e(t,n,r,o)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Du=Du||document.createElement("div"),Du.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Du.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Ms(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var bs={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},IE=["Webkit","ms","Moz","O"];Object.keys(bs).forEach(function(e){IE.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),bs[t]=bs[e]})});function ox(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||bs.hasOwnProperty(e)&&bs[e]?(""+t).trim():t+"px"}function ix(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var r=n.indexOf("--")===0,o=ox(n,t[n],r);n==="float"&&(n="cssFloat"),r?e.setProperty(n,o):e[n]=o}}var TE=Ye({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function $f(e,t){if(t){if(TE[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(Y(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(Y(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(Y(61))}if(t.style!=null&&typeof t.style!="object")throw Error(Y(62))}}function Vf(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Hf=null;function wp(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Gf=null,da=null,fa=null;function jm(e){if(e=hu(e)){if(typeof Gf!="function")throw Error(Y(280));var t=e.stateNode;t&&(t=Bc(t),Gf(e.stateNode,e.type,t))}}function ax(e){da?fa?fa.push(e):fa=[e]:da=e}function sx(){if(da){var e=da,t=fa;if(fa=da=null,jm(e),t)for(e=0;e<t.length;e++)jm(t[e])}}function ux(e,t){return e(t)}function lx(){}var Td=!1;function cx(e,t,n){if(Td)return e(t,n);Td=!0;try{return ux(e,t,n)}finally{Td=!1,(da!==null||fa!==null)&&(lx(),sx())}}function Os(e,t){var n=e.stateNode;if(n===null)return null;var r=Bc(n);if(r===null)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(e=e.type,r=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!r;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(Y(231,t,typeof n));return n}var qf=!1;if(Kr)try{var os={};Object.defineProperty(os,"passive",{get:function(){qf=!0}}),window.addEventListener("test",os,os),window.removeEventListener("test",os,os)}catch{qf=!1}function AE(e,t,n,r,o,i,a,s,u){var l=Array.prototype.slice.call(arguments,3);try{t.apply(n,l)}catch(c){this.onError(c)}}var Cs=!1,Dl=null,Fl=!1,Kf=null,PE={onError:function(e){Cs=!0,Dl=e}};function DE(e,t,n,r,o,i,a,s,u){Cs=!1,Dl=null,AE.apply(PE,arguments)}function FE(e,t,n,r,o,i,a,s,u){if(DE.apply(this,arguments),Cs){if(Cs){var l=Dl;Cs=!1,Dl=null}else throw Error(Y(198));Fl||(Fl=!0,Kf=l)}}function Fi(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function dx(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Wm(e){if(Fi(e)!==e)throw Error(Y(188))}function ME(e){var t=e.alternate;if(!t){if(t=Fi(e),t===null)throw Error(Y(188));return t!==e?null:e}for(var n=e,r=t;;){var o=n.return;if(o===null)break;var i=o.alternate;if(i===null){if(r=o.return,r!==null){n=r;continue}break}if(o.child===i.child){for(i=o.child;i;){if(i===n)return Wm(o),e;if(i===r)return Wm(o),t;i=i.sibling}throw Error(Y(188))}if(n.return!==r.return)n=o,r=i;else{for(var a=!1,s=o.child;s;){if(s===n){a=!0,n=o,r=i;break}if(s===r){a=!0,r=o,n=i;break}s=s.sibling}if(!a){for(s=i.child;s;){if(s===n){a=!0,n=i,r=o;break}if(s===r){a=!0,r=i,n=o;break}s=s.sibling}if(!a)throw Error(Y(189))}}if(n.alternate!==r)throw Error(Y(190))}if(n.tag!==3)throw Error(Y(188));return n.stateNode.current===n?e:t}function fx(e){return e=ME(e),e!==null?hx(e):null}function hx(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=hx(e);if(t!==null)return t;e=e.sibling}return null}var px=En.unstable_scheduleCallback,zm=En.unstable_cancelCallback,OE=En.unstable_shouldYield,LE=En.unstable_requestPaint,nt=En.unstable_now,BE=En.unstable_getCurrentPriorityLevel,bp=En.unstable_ImmediatePriority,vx=En.unstable_UserBlockingPriority,Ml=En.unstable_NormalPriority,jE=En.unstable_LowPriority,mx=En.unstable_IdlePriority,Fc=null,Er=null;function WE(e){if(Er&&typeof Er.onCommitFiberRoot=="function")try{Er.onCommitFiberRoot(Fc,e,void 0,(e.current.flags&128)===128)}catch{}}var er=Math.clz32?Math.clz32:$E,zE=Math.log,UE=Math.LN2;function $E(e){return e>>>=0,e===0?32:31-(zE(e)/UE|0)|0}var Fu=64,Mu=4194304;function xs(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Ol(e,t){var n=e.pendingLanes;if(n===0)return 0;var r=0,o=e.suspendedLanes,i=e.pingedLanes,a=n&268435455;if(a!==0){var s=a&~o;s!==0?r=xs(s):(i&=a,i!==0&&(r=xs(i)))}else a=n&~o,a!==0?r=xs(a):i!==0&&(r=xs(i));if(r===0)return 0;if(t!==0&&t!==r&&!(t&o)&&(o=r&-r,i=t&-t,o>=i||o===16&&(i&4194240)!==0))return t;if(r&4&&(r|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=r;0<t;)n=31-er(t),o=1<<n,r|=e[n],t&=~o;return r}function VE(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function HE(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,o=e.expirationTimes,i=e.pendingLanes;0<i;){var a=31-er(i),s=1<<a,u=o[a];u===-1?(!(s&n)||s&r)&&(o[a]=VE(s,t)):u<=t&&(e.expiredLanes|=s),i&=~s}}function Xf(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function gx(){var e=Fu;return Fu<<=1,!(Fu&4194240)&&(Fu=64),e}function Ad(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function du(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-er(t),e[t]=n}function GE(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var o=31-er(n),i=1<<o;t[o]=0,r[o]=-1,e[o]=-1,n&=~i}}function Cp(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-er(n),o=1<<r;o&t|e[r]&t&&(e[r]|=t),n&=~o}}var De=0;function yx(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var xx,Ep,wx,bx,Cx,Yf=!1,Ou=[],Po=null,Do=null,Fo=null,Ls=new Map,Bs=new Map,wo=[],qE="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Um(e,t){switch(e){case"focusin":case"focusout":Po=null;break;case"dragenter":case"dragleave":Do=null;break;case"mouseover":case"mouseout":Fo=null;break;case"pointerover":case"pointerout":Ls.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Bs.delete(t.pointerId)}}function is(e,t,n,r,o,i){return e===null||e.nativeEvent!==i?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[o]},t!==null&&(t=hu(t),t!==null&&Ep(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,o!==null&&t.indexOf(o)===-1&&t.push(o),e)}function KE(e,t,n,r,o){switch(t){case"focusin":return Po=is(Po,e,t,n,r,o),!0;case"dragenter":return Do=is(Do,e,t,n,r,o),!0;case"mouseover":return Fo=is(Fo,e,t,n,r,o),!0;case"pointerover":var i=o.pointerId;return Ls.set(i,is(Ls.get(i)||null,e,t,n,r,o)),!0;case"gotpointercapture":return i=o.pointerId,Bs.set(i,is(Bs.get(i)||null,e,t,n,r,o)),!0}return!1}function Ex(e){var t=di(e.target);if(t!==null){var n=Fi(t);if(n!==null){if(t=n.tag,t===13){if(t=dx(n),t!==null){e.blockedOn=t,Cx(e.priority,function(){wx(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function vl(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=Qf(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var r=new n.constructor(n.type,n);Hf=r,n.target.dispatchEvent(r),Hf=null}else return t=hu(n),t!==null&&Ep(t),e.blockedOn=n,!1;t.shift()}return!0}function $m(e,t,n){vl(e)&&n.delete(t)}function XE(){Yf=!1,Po!==null&&vl(Po)&&(Po=null),Do!==null&&vl(Do)&&(Do=null),Fo!==null&&vl(Fo)&&(Fo=null),Ls.forEach($m),Bs.forEach($m)}function as(e,t){e.blockedOn===t&&(e.blockedOn=null,Yf||(Yf=!0,En.unstable_scheduleCallback(En.unstable_NormalPriority,XE)))}function js(e){function t(o){return as(o,e)}if(0<Ou.length){as(Ou[0],e);for(var n=1;n<Ou.length;n++){var r=Ou[n];r.blockedOn===e&&(r.blockedOn=null)}}for(Po!==null&&as(Po,e),Do!==null&&as(Do,e),Fo!==null&&as(Fo,e),Ls.forEach(t),Bs.forEach(t),n=0;n<wo.length;n++)r=wo[n],r.blockedOn===e&&(r.blockedOn=null);for(;0<wo.length&&(n=wo[0],n.blockedOn===null);)Ex(n),n.blockedOn===null&&wo.shift()}var ha=eo.ReactCurrentBatchConfig,Ll=!0;function YE(e,t,n,r){var o=De,i=ha.transition;ha.transition=null;try{De=1,_p(e,t,n,r)}finally{De=o,ha.transition=i}}function QE(e,t,n,r){var o=De,i=ha.transition;ha.transition=null;try{De=4,_p(e,t,n,r)}finally{De=o,ha.transition=i}}function _p(e,t,n,r){if(Ll){var o=Qf(e,t,n,r);if(o===null)zd(e,t,r,Bl,n),Um(e,r);else if(KE(o,e,t,n,r))r.stopPropagation();else if(Um(e,r),t&4&&-1<qE.indexOf(e)){for(;o!==null;){var i=hu(o);if(i!==null&&xx(i),i=Qf(e,t,n,r),i===null&&zd(e,t,r,Bl,n),i===o)break;o=i}o!==null&&r.stopPropagation()}else zd(e,t,r,null,n)}}var Bl=null;function Qf(e,t,n,r){if(Bl=null,e=wp(r),e=di(e),e!==null)if(t=Fi(e),t===null)e=null;else if(n=t.tag,n===13){if(e=dx(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Bl=e,null}function _x(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(BE()){case bp:return 1;case vx:return 4;case Ml:case jE:return 16;case mx:return 536870912;default:return 16}default:return 16}}var Ro=null,Sp=null,ml=null;function Sx(){if(ml)return ml;var e,t=Sp,n=t.length,r,o="value"in Ro?Ro.value:Ro.textContent,i=o.length;for(e=0;e<n&&t[e]===o[e];e++);var a=n-e;for(r=1;r<=a&&t[n-r]===o[i-r];r++);return ml=o.slice(e,1<r?1-r:void 0)}function gl(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Lu(){return!0}function Vm(){return!1}function Sn(e){function t(n,r,o,i,a){this._reactName=n,this._targetInst=o,this.type=r,this.nativeEvent=i,this.target=a,this.currentTarget=null;for(var s in e)e.hasOwnProperty(s)&&(n=e[s],this[s]=n?n(i):i[s]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Lu:Vm,this.isPropagationStopped=Vm,this}return Ye(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Lu)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Lu)},persist:function(){},isPersistent:Lu}),t}var Xa={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},kp=Sn(Xa),fu=Ye({},Xa,{view:0,detail:0}),JE=Sn(fu),Pd,Dd,ss,Mc=Ye({},fu,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Rp,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ss&&(ss&&e.type==="mousemove"?(Pd=e.screenX-ss.screenX,Dd=e.screenY-ss.screenY):Dd=Pd=0,ss=e),Pd)},movementY:function(e){return"movementY"in e?e.movementY:Dd}}),Hm=Sn(Mc),ZE=Ye({},Mc,{dataTransfer:0}),e_=Sn(ZE),t_=Ye({},fu,{relatedTarget:0}),Fd=Sn(t_),n_=Ye({},Xa,{animationName:0,elapsedTime:0,pseudoElement:0}),r_=Sn(n_),o_=Ye({},Xa,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),i_=Sn(o_),a_=Ye({},Xa,{data:0}),Gm=Sn(a_),s_={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},u_={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},l_={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function c_(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=l_[e])?!!t[e]:!1}function Rp(){return c_}var d_=Ye({},fu,{key:function(e){if(e.key){var t=s_[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=gl(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?u_[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Rp,charCode:function(e){return e.type==="keypress"?gl(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?gl(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),f_=Sn(d_),h_=Ye({},Mc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),qm=Sn(h_),p_=Ye({},fu,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Rp}),v_=Sn(p_),m_=Ye({},Xa,{propertyName:0,elapsedTime:0,pseudoElement:0}),g_=Sn(m_),y_=Ye({},Mc,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),x_=Sn(y_),w_=[9,13,27,32],Np=Kr&&"CompositionEvent"in window,Es=null;Kr&&"documentMode"in document&&(Es=document.documentMode);var b_=Kr&&"TextEvent"in window&&!Es,kx=Kr&&(!Np||Es&&8<Es&&11>=Es),Km=" ",Xm=!1;function Rx(e,t){switch(e){case"keyup":return w_.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Nx(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var ea=!1;function C_(e,t){switch(e){case"compositionend":return Nx(t);case"keypress":return t.which!==32?null:(Xm=!0,Km);case"textInput":return e=t.data,e===Km&&Xm?null:e;default:return null}}function E_(e,t){if(ea)return e==="compositionend"||!Np&&Rx(e,t)?(e=Sx(),ml=Sp=Ro=null,ea=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return kx&&t.locale!=="ko"?null:t.data;default:return null}}var __={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Ym(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!__[e.type]:t==="textarea"}function Ix(e,t,n,r){ax(r),t=jl(t,"onChange"),0<t.length&&(n=new kp("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var _s=null,Ws=null;function S_(e){Wx(e,0)}function Oc(e){var t=ra(e);if(Z0(t))return e}function k_(e,t){if(e==="change")return t}var Tx=!1;if(Kr){var Md;if(Kr){var Od="oninput"in document;if(!Od){var Qm=document.createElement("div");Qm.setAttribute("oninput","return;"),Od=typeof Qm.oninput=="function"}Md=Od}else Md=!1;Tx=Md&&(!document.documentMode||9<document.documentMode)}function Jm(){_s&&(_s.detachEvent("onpropertychange",Ax),Ws=_s=null)}function Ax(e){if(e.propertyName==="value"&&Oc(Ws)){var t=[];Ix(t,Ws,e,wp(e)),cx(S_,t)}}function R_(e,t,n){e==="focusin"?(Jm(),_s=t,Ws=n,_s.attachEvent("onpropertychange",Ax)):e==="focusout"&&Jm()}function N_(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Oc(Ws)}function I_(e,t){if(e==="click")return Oc(t)}function T_(e,t){if(e==="input"||e==="change")return Oc(t)}function A_(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var rr=typeof Object.is=="function"?Object.is:A_;function zs(e,t){if(rr(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var o=n[r];if(!Df.call(t,o)||!rr(e[o],t[o]))return!1}return!0}function Zm(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function eg(e,t){var n=Zm(e);e=0;for(var r;n;){if(n.nodeType===3){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Zm(n)}}function Px(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Px(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function Dx(){for(var e=window,t=Pl();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=Pl(e.document)}return t}function Ip(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function P_(e){var t=Dx(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&Px(n.ownerDocument.documentElement,n)){if(r!==null&&Ip(n)){if(t=r.start,e=r.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var o=n.textContent.length,i=Math.min(r.start,o);r=r.end===void 0?i:Math.min(r.end,o),!e.extend&&i>r&&(o=r,r=i,i=o),o=eg(n,i);var a=eg(n,r);o&&a&&(e.rangeCount!==1||e.anchorNode!==o.node||e.anchorOffset!==o.offset||e.focusNode!==a.node||e.focusOffset!==a.offset)&&(t=t.createRange(),t.setStart(o.node,o.offset),e.removeAllRanges(),i>r?(e.addRange(t),e.extend(a.node,a.offset)):(t.setEnd(a.node,a.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var D_=Kr&&"documentMode"in document&&11>=document.documentMode,ta=null,Jf=null,Ss=null,Zf=!1;function tg(e,t,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Zf||ta==null||ta!==Pl(r)||(r=ta,"selectionStart"in r&&Ip(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Ss&&zs(Ss,r)||(Ss=r,r=jl(Jf,"onSelect"),0<r.length&&(t=new kp("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=ta)))}function Bu(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var na={animationend:Bu("Animation","AnimationEnd"),animationiteration:Bu("Animation","AnimationIteration"),animationstart:Bu("Animation","AnimationStart"),transitionend:Bu("Transition","TransitionEnd")},Ld={},Fx={};Kr&&(Fx=document.createElement("div").style,"AnimationEvent"in window||(delete na.animationend.animation,delete na.animationiteration.animation,delete na.animationstart.animation),"TransitionEvent"in window||delete na.transitionend.transition);function Lc(e){if(Ld[e])return Ld[e];if(!na[e])return e;var t=na[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in Fx)return Ld[e]=t[n];return e}var Mx=Lc("animationend"),Ox=Lc("animationiteration"),Lx=Lc("animationstart"),Bx=Lc("transitionend"),jx=new Map,ng="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Qo(e,t){jx.set(e,t),Di(t,[e])}for(var Bd=0;Bd<ng.length;Bd++){var jd=ng[Bd],F_=jd.toLowerCase(),M_=jd[0].toUpperCase()+jd.slice(1);Qo(F_,"on"+M_)}Qo(Mx,"onAnimationEnd");Qo(Ox,"onAnimationIteration");Qo(Lx,"onAnimationStart");Qo("dblclick","onDoubleClick");Qo("focusin","onFocus");Qo("focusout","onBlur");Qo(Bx,"onTransitionEnd");Ma("onMouseEnter",["mouseout","mouseover"]);Ma("onMouseLeave",["mouseout","mouseover"]);Ma("onPointerEnter",["pointerout","pointerover"]);Ma("onPointerLeave",["pointerout","pointerover"]);Di("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Di("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Di("onBeforeInput",["compositionend","keypress","textInput","paste"]);Di("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Di("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Di("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ws="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),O_=new Set("cancel close invalid load scroll toggle".split(" ").concat(ws));function rg(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,FE(r,t,void 0,e),e.currentTarget=null}function Wx(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var r=e[n],o=r.event;r=r.listeners;e:{var i=void 0;if(t)for(var a=r.length-1;0<=a;a--){var s=r[a],u=s.instance,l=s.currentTarget;if(s=s.listener,u!==i&&o.isPropagationStopped())break e;rg(o,s,l),i=u}else for(a=0;a<r.length;a++){if(s=r[a],u=s.instance,l=s.currentTarget,s=s.listener,u!==i&&o.isPropagationStopped())break e;rg(o,s,l),i=u}}}if(Fl)throw e=Kf,Fl=!1,Kf=null,e}function ze(e,t){var n=t[oh];n===void 0&&(n=t[oh]=new Set);var r=e+"__bubble";n.has(r)||(zx(t,e,2,!1),n.add(r))}function Wd(e,t,n){var r=0;t&&(r|=4),zx(n,e,r,t)}var ju="_reactListening"+Math.random().toString(36).slice(2);function Us(e){if(!e[ju]){e[ju]=!0,K0.forEach(function(n){n!=="selectionchange"&&(O_.has(n)||Wd(n,!1,e),Wd(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[ju]||(t[ju]=!0,Wd("selectionchange",!1,t))}}function zx(e,t,n,r){switch(_x(t)){case 1:var o=YE;break;case 4:o=QE;break;default:o=_p}n=o.bind(null,t,n,e),o=void 0,!qf||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(o=!0),r?o!==void 0?e.addEventListener(t,n,{capture:!0,passive:o}):e.addEventListener(t,n,!0):o!==void 0?e.addEventListener(t,n,{passive:o}):e.addEventListener(t,n,!1)}function zd(e,t,n,r,o){var i=r;if(!(t&1)&&!(t&2)&&r!==null)e:for(;;){if(r===null)return;var a=r.tag;if(a===3||a===4){var s=r.stateNode.containerInfo;if(s===o||s.nodeType===8&&s.parentNode===o)break;if(a===4)for(a=r.return;a!==null;){var u=a.tag;if((u===3||u===4)&&(u=a.stateNode.containerInfo,u===o||u.nodeType===8&&u.parentNode===o))return;a=a.return}for(;s!==null;){if(a=di(s),a===null)return;if(u=a.tag,u===5||u===6){r=i=a;continue e}s=s.parentNode}}r=r.return}cx(function(){var l=i,c=wp(n),d=[];e:{var f=jx.get(e);if(f!==void 0){var h=kp,v=e;switch(e){case"keypress":if(gl(n)===0)break e;case"keydown":case"keyup":h=f_;break;case"focusin":v="focus",h=Fd;break;case"focusout":v="blur",h=Fd;break;case"beforeblur":case"afterblur":h=Fd;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":h=Hm;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":h=e_;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":h=v_;break;case Mx:case Ox:case Lx:h=r_;break;case Bx:h=g_;break;case"scroll":h=JE;break;case"wheel":h=x_;break;case"copy":case"cut":case"paste":h=i_;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":h=qm}var m=(t&4)!==0,g=!m&&e==="scroll",p=m?f!==null?f+"Capture":null:f;m=[];for(var y=l,x;y!==null;){x=y;var w=x.stateNode;if(x.tag===5&&w!==null&&(x=w,p!==null&&(w=Os(y,p),w!=null&&m.push($s(y,w,x)))),g)break;y=y.return}0<m.length&&(f=new h(f,v,null,n,c),d.push({event:f,listeners:m}))}}if(!(t&7)){e:{if(f=e==="mouseover"||e==="pointerover",h=e==="mouseout"||e==="pointerout",f&&n!==Hf&&(v=n.relatedTarget||n.fromElement)&&(di(v)||v[Xr]))break e;if((h||f)&&(f=c.window===c?c:(f=c.ownerDocument)?f.defaultView||f.parentWindow:window,h?(v=n.relatedTarget||n.toElement,h=l,v=v?di(v):null,v!==null&&(g=Fi(v),v!==g||v.tag!==5&&v.tag!==6)&&(v=null)):(h=null,v=l),h!==v)){if(m=Hm,w="onMouseLeave",p="onMouseEnter",y="mouse",(e==="pointerout"||e==="pointerover")&&(m=qm,w="onPointerLeave",p="onPointerEnter",y="pointer"),g=h==null?f:ra(h),x=v==null?f:ra(v),f=new m(w,y+"leave",h,n,c),f.target=g,f.relatedTarget=x,w=null,di(c)===l&&(m=new m(p,y+"enter",v,n,c),m.target=x,m.relatedTarget=g,w=m),g=w,h&&v)t:{for(m=h,p=v,y=0,x=m;x;x=$i(x))y++;for(x=0,w=p;w;w=$i(w))x++;for(;0<y-x;)m=$i(m),y--;for(;0<x-y;)p=$i(p),x--;for(;y--;){if(m===p||p!==null&&m===p.alternate)break t;m=$i(m),p=$i(p)}m=null}else m=null;h!==null&&og(d,f,h,m,!1),v!==null&&g!==null&&og(d,g,v,m,!0)}}e:{if(f=l?ra(l):window,h=f.nodeName&&f.nodeName.toLowerCase(),h==="select"||h==="input"&&f.type==="file")var b=k_;else if(Ym(f))if(Tx)b=T_;else{b=N_;var C=R_}else(h=f.nodeName)&&h.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(b=I_);if(b&&(b=b(e,l))){Ix(d,b,n,c);break e}C&&C(e,f,l),e==="focusout"&&(C=f._wrapperState)&&C.controlled&&f.type==="number"&&Wf(f,"number",f.value)}switch(C=l?ra(l):window,e){case"focusin":(Ym(C)||C.contentEditable==="true")&&(ta=C,Jf=l,Ss=null);break;case"focusout":Ss=Jf=ta=null;break;case"mousedown":Zf=!0;break;case"contextmenu":case"mouseup":case"dragend":Zf=!1,tg(d,n,c);break;case"selectionchange":if(D_)break;case"keydown":case"keyup":tg(d,n,c)}var E;if(Np)e:{switch(e){case"compositionstart":var S="onCompositionStart";break e;case"compositionend":S="onCompositionEnd";break e;case"compositionupdate":S="onCompositionUpdate";break e}S=void 0}else ea?Rx(e,n)&&(S="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(S="onCompositionStart");S&&(kx&&n.locale!=="ko"&&(ea||S!=="onCompositionStart"?S==="onCompositionEnd"&&ea&&(E=Sx()):(Ro=c,Sp="value"in Ro?Ro.value:Ro.textContent,ea=!0)),C=jl(l,S),0<C.length&&(S=new Gm(S,e,null,n,c),d.push({event:S,listeners:C}),E?S.data=E:(E=Nx(n),E!==null&&(S.data=E)))),(E=b_?C_(e,n):E_(e,n))&&(l=jl(l,"onBeforeInput"),0<l.length&&(c=new Gm("onBeforeInput","beforeinput",null,n,c),d.push({event:c,listeners:l}),c.data=E))}Wx(d,t)})}function $s(e,t,n){return{instance:e,listener:t,currentTarget:n}}function jl(e,t){for(var n=t+"Capture",r=[];e!==null;){var o=e,i=o.stateNode;o.tag===5&&i!==null&&(o=i,i=Os(e,n),i!=null&&r.unshift($s(e,i,o)),i=Os(e,t),i!=null&&r.push($s(e,i,o))),e=e.return}return r}function $i(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function og(e,t,n,r,o){for(var i=t._reactName,a=[];n!==null&&n!==r;){var s=n,u=s.alternate,l=s.stateNode;if(u!==null&&u===r)break;s.tag===5&&l!==null&&(s=l,o?(u=Os(n,i),u!=null&&a.unshift($s(n,u,s))):o||(u=Os(n,i),u!=null&&a.push($s(n,u,s)))),n=n.return}a.length!==0&&e.push({event:t,listeners:a})}var L_=/\r\n?/g,B_=/\u0000|\uFFFD/g;function ig(e){return(typeof e=="string"?e:""+e).replace(L_,`
`).replace(B_,"")}function Wu(e,t,n){if(t=ig(t),ig(e)!==t&&n)throw Error(Y(425))}function Wl(){}var eh=null,th=null;function nh(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var rh=typeof setTimeout=="function"?setTimeout:void 0,j_=typeof clearTimeout=="function"?clearTimeout:void 0,ag=typeof Promise=="function"?Promise:void 0,W_=typeof queueMicrotask=="function"?queueMicrotask:typeof ag<"u"?function(e){return ag.resolve(null).then(e).catch(z_)}:rh;function z_(e){setTimeout(function(){throw e})}function Ud(e,t){var n=t,r=0;do{var o=n.nextSibling;if(e.removeChild(n),o&&o.nodeType===8)if(n=o.data,n==="/$"){if(r===0){e.removeChild(o),js(t);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=o}while(n);js(t)}function Mo(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function sg(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var Ya=Math.random().toString(36).slice(2),yr="__reactFiber$"+Ya,Vs="__reactProps$"+Ya,Xr="__reactContainer$"+Ya,oh="__reactEvents$"+Ya,U_="__reactListeners$"+Ya,$_="__reactHandles$"+Ya;function di(e){var t=e[yr];if(t)return t;for(var n=e.parentNode;n;){if(t=n[Xr]||n[yr]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=sg(e);e!==null;){if(n=e[yr])return n;e=sg(e)}return t}e=n,n=e.parentNode}return null}function hu(e){return e=e[yr]||e[Xr],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function ra(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(Y(33))}function Bc(e){return e[Vs]||null}var ih=[],oa=-1;function Jo(e){return{current:e}}function $e(e){0>oa||(e.current=ih[oa],ih[oa]=null,oa--)}function Be(e,t){oa++,ih[oa]=e.current,e.current=t}var Vo={},Wt=Jo(Vo),nn=Jo(!1),Si=Vo;function Oa(e,t){var n=e.type.contextTypes;if(!n)return Vo;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var o={},i;for(i in n)o[i]=t[i];return r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=o),o}function rn(e){return e=e.childContextTypes,e!=null}function zl(){$e(nn),$e(Wt)}function ug(e,t,n){if(Wt.current!==Vo)throw Error(Y(168));Be(Wt,t),Be(nn,n)}function Ux(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var o in r)if(!(o in t))throw Error(Y(108,RE(e)||"Unknown",o));return Ye({},n,r)}function Ul(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Vo,Si=Wt.current,Be(Wt,e),Be(nn,nn.current),!0}function lg(e,t,n){var r=e.stateNode;if(!r)throw Error(Y(169));n?(e=Ux(e,t,Si),r.__reactInternalMemoizedMergedChildContext=e,$e(nn),$e(Wt),Be(Wt,e)):$e(nn),Be(nn,n)}var Ur=null,jc=!1,$d=!1;function $x(e){Ur===null?Ur=[e]:Ur.push(e)}function V_(e){jc=!0,$x(e)}function Zo(){if(!$d&&Ur!==null){$d=!0;var e=0,t=De;try{var n=Ur;for(De=1;e<n.length;e++){var r=n[e];do r=r(!0);while(r!==null)}Ur=null,jc=!1}catch(o){throw Ur!==null&&(Ur=Ur.slice(e+1)),px(bp,Zo),o}finally{De=t,$d=!1}}return null}var ia=[],aa=0,$l=null,Vl=0,Nn=[],In=0,ki=null,Hr=1,Gr="";function ai(e,t){ia[aa++]=Vl,ia[aa++]=$l,$l=e,Vl=t}function Vx(e,t,n){Nn[In++]=Hr,Nn[In++]=Gr,Nn[In++]=ki,ki=e;var r=Hr;e=Gr;var o=32-er(r)-1;r&=~(1<<o),n+=1;var i=32-er(t)+o;if(30<i){var a=o-o%5;i=(r&(1<<a)-1).toString(32),r>>=a,o-=a,Hr=1<<32-er(t)+o|n<<o|r,Gr=i+e}else Hr=1<<i|n<<o|r,Gr=e}function Tp(e){e.return!==null&&(ai(e,1),Vx(e,1,0))}function Ap(e){for(;e===$l;)$l=ia[--aa],ia[aa]=null,Vl=ia[--aa],ia[aa]=null;for(;e===ki;)ki=Nn[--In],Nn[In]=null,Gr=Nn[--In],Nn[In]=null,Hr=Nn[--In],Nn[In]=null}var wn=null,mn=null,He=!1,Qn=null;function Hx(e,t){var n=Pn(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function cg(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,wn=e,mn=Mo(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,wn=e,mn=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=ki!==null?{id:Hr,overflow:Gr}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=Pn(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,wn=e,mn=null,!0):!1;default:return!1}}function ah(e){return(e.mode&1)!==0&&(e.flags&128)===0}function sh(e){if(He){var t=mn;if(t){var n=t;if(!cg(e,t)){if(ah(e))throw Error(Y(418));t=Mo(n.nextSibling);var r=wn;t&&cg(e,t)?Hx(r,n):(e.flags=e.flags&-4097|2,He=!1,wn=e)}}else{if(ah(e))throw Error(Y(418));e.flags=e.flags&-4097|2,He=!1,wn=e}}}function dg(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;wn=e}function zu(e){if(e!==wn)return!1;if(!He)return dg(e),He=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!nh(e.type,e.memoizedProps)),t&&(t=mn)){if(ah(e))throw Gx(),Error(Y(418));for(;t;)Hx(e,t),t=Mo(t.nextSibling)}if(dg(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(Y(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){mn=Mo(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}mn=null}}else mn=wn?Mo(e.stateNode.nextSibling):null;return!0}function Gx(){for(var e=mn;e;)e=Mo(e.nextSibling)}function La(){mn=wn=null,He=!1}function Pp(e){Qn===null?Qn=[e]:Qn.push(e)}var H_=eo.ReactCurrentBatchConfig;function us(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(Y(309));var r=n.stateNode}if(!r)throw Error(Y(147,e));var o=r,i=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===i?t.ref:(t=function(a){var s=o.refs;a===null?delete s[i]:s[i]=a},t._stringRef=i,t)}if(typeof e!="string")throw Error(Y(284));if(!n._owner)throw Error(Y(290,e))}return e}function Uu(e,t){throw e=Object.prototype.toString.call(t),Error(Y(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function fg(e){var t=e._init;return t(e._payload)}function qx(e){function t(p,y){if(e){var x=p.deletions;x===null?(p.deletions=[y],p.flags|=16):x.push(y)}}function n(p,y){if(!e)return null;for(;y!==null;)t(p,y),y=y.sibling;return null}function r(p,y){for(p=new Map;y!==null;)y.key!==null?p.set(y.key,y):p.set(y.index,y),y=y.sibling;return p}function o(p,y){return p=jo(p,y),p.index=0,p.sibling=null,p}function i(p,y,x){return p.index=x,e?(x=p.alternate,x!==null?(x=x.index,x<y?(p.flags|=2,y):x):(p.flags|=2,y)):(p.flags|=1048576,y)}function a(p){return e&&p.alternate===null&&(p.flags|=2),p}function s(p,y,x,w){return y===null||y.tag!==6?(y=Yd(x,p.mode,w),y.return=p,y):(y=o(y,x),y.return=p,y)}function u(p,y,x,w){var b=x.type;return b===Zi?c(p,y,x.props.children,w,x.key):y!==null&&(y.elementType===b||typeof b=="object"&&b!==null&&b.$$typeof===yo&&fg(b)===y.type)?(w=o(y,x.props),w.ref=us(p,y,x),w.return=p,w):(w=_l(x.type,x.key,x.props,null,p.mode,w),w.ref=us(p,y,x),w.return=p,w)}function l(p,y,x,w){return y===null||y.tag!==4||y.stateNode.containerInfo!==x.containerInfo||y.stateNode.implementation!==x.implementation?(y=Qd(x,p.mode,w),y.return=p,y):(y=o(y,x.children||[]),y.return=p,y)}function c(p,y,x,w,b){return y===null||y.tag!==7?(y=Ei(x,p.mode,w,b),y.return=p,y):(y=o(y,x),y.return=p,y)}function d(p,y,x){if(typeof y=="string"&&y!==""||typeof y=="number")return y=Yd(""+y,p.mode,x),y.return=p,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case Au:return x=_l(y.type,y.key,y.props,null,p.mode,x),x.ref=us(p,null,y),x.return=p,x;case Ji:return y=Qd(y,p.mode,x),y.return=p,y;case yo:var w=y._init;return d(p,w(y._payload),x)}if(ys(y)||rs(y))return y=Ei(y,p.mode,x,null),y.return=p,y;Uu(p,y)}return null}function f(p,y,x,w){var b=y!==null?y.key:null;if(typeof x=="string"&&x!==""||typeof x=="number")return b!==null?null:s(p,y,""+x,w);if(typeof x=="object"&&x!==null){switch(x.$$typeof){case Au:return x.key===b?u(p,y,x,w):null;case Ji:return x.key===b?l(p,y,x,w):null;case yo:return b=x._init,f(p,y,b(x._payload),w)}if(ys(x)||rs(x))return b!==null?null:c(p,y,x,w,null);Uu(p,x)}return null}function h(p,y,x,w,b){if(typeof w=="string"&&w!==""||typeof w=="number")return p=p.get(x)||null,s(y,p,""+w,b);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Au:return p=p.get(w.key===null?x:w.key)||null,u(y,p,w,b);case Ji:return p=p.get(w.key===null?x:w.key)||null,l(y,p,w,b);case yo:var C=w._init;return h(p,y,x,C(w._payload),b)}if(ys(w)||rs(w))return p=p.get(x)||null,c(y,p,w,b,null);Uu(y,w)}return null}function v(p,y,x,w){for(var b=null,C=null,E=y,S=y=0,R=null;E!==null&&S<x.length;S++){E.index>S?(R=E,E=null):R=E.sibling;var k=f(p,E,x[S],w);if(k===null){E===null&&(E=R);break}e&&E&&k.alternate===null&&t(p,E),y=i(k,y,S),C===null?b=k:C.sibling=k,C=k,E=R}if(S===x.length)return n(p,E),He&&ai(p,S),b;if(E===null){for(;S<x.length;S++)E=d(p,x[S],w),E!==null&&(y=i(E,y,S),C===null?b=E:C.sibling=E,C=E);return He&&ai(p,S),b}for(E=r(p,E);S<x.length;S++)R=h(E,p,S,x[S],w),R!==null&&(e&&R.alternate!==null&&E.delete(R.key===null?S:R.key),y=i(R,y,S),C===null?b=R:C.sibling=R,C=R);return e&&E.forEach(function(P){return t(p,P)}),He&&ai(p,S),b}function m(p,y,x,w){var b=rs(x);if(typeof b!="function")throw Error(Y(150));if(x=b.call(x),x==null)throw Error(Y(151));for(var C=b=null,E=y,S=y=0,R=null,k=x.next();E!==null&&!k.done;S++,k=x.next()){E.index>S?(R=E,E=null):R=E.sibling;var P=f(p,E,k.value,w);if(P===null){E===null&&(E=R);break}e&&E&&P.alternate===null&&t(p,E),y=i(P,y,S),C===null?b=P:C.sibling=P,C=P,E=R}if(k.done)return n(p,E),He&&ai(p,S),b;if(E===null){for(;!k.done;S++,k=x.next())k=d(p,k.value,w),k!==null&&(y=i(k,y,S),C===null?b=k:C.sibling=k,C=k);return He&&ai(p,S),b}for(E=r(p,E);!k.done;S++,k=x.next())k=h(E,p,S,k.value,w),k!==null&&(e&&k.alternate!==null&&E.delete(k.key===null?S:k.key),y=i(k,y,S),C===null?b=k:C.sibling=k,C=k);return e&&E.forEach(function(T){return t(p,T)}),He&&ai(p,S),b}function g(p,y,x,w){if(typeof x=="object"&&x!==null&&x.type===Zi&&x.key===null&&(x=x.props.children),typeof x=="object"&&x!==null){switch(x.$$typeof){case Au:e:{for(var b=x.key,C=y;C!==null;){if(C.key===b){if(b=x.type,b===Zi){if(C.tag===7){n(p,C.sibling),y=o(C,x.props.children),y.return=p,p=y;break e}}else if(C.elementType===b||typeof b=="object"&&b!==null&&b.$$typeof===yo&&fg(b)===C.type){n(p,C.sibling),y=o(C,x.props),y.ref=us(p,C,x),y.return=p,p=y;break e}n(p,C);break}else t(p,C);C=C.sibling}x.type===Zi?(y=Ei(x.props.children,p.mode,w,x.key),y.return=p,p=y):(w=_l(x.type,x.key,x.props,null,p.mode,w),w.ref=us(p,y,x),w.return=p,p=w)}return a(p);case Ji:e:{for(C=x.key;y!==null;){if(y.key===C)if(y.tag===4&&y.stateNode.containerInfo===x.containerInfo&&y.stateNode.implementation===x.implementation){n(p,y.sibling),y=o(y,x.children||[]),y.return=p,p=y;break e}else{n(p,y);break}else t(p,y);y=y.sibling}y=Qd(x,p.mode,w),y.return=p,p=y}return a(p);case yo:return C=x._init,g(p,y,C(x._payload),w)}if(ys(x))return v(p,y,x,w);if(rs(x))return m(p,y,x,w);Uu(p,x)}return typeof x=="string"&&x!==""||typeof x=="number"?(x=""+x,y!==null&&y.tag===6?(n(p,y.sibling),y=o(y,x),y.return=p,p=y):(n(p,y),y=Yd(x,p.mode,w),y.return=p,p=y),a(p)):n(p,y)}return g}var Ba=qx(!0),Kx=qx(!1),Hl=Jo(null),Gl=null,sa=null,Dp=null;function Fp(){Dp=sa=Gl=null}function Mp(e){var t=Hl.current;$e(Hl),e._currentValue=t}function uh(e,t,n){for(;e!==null;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,r!==null&&(r.childLanes|=t)):r!==null&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function pa(e,t){Gl=e,Dp=sa=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(tn=!0),e.firstContext=null)}function On(e){var t=e._currentValue;if(Dp!==e)if(e={context:e,memoizedValue:t,next:null},sa===null){if(Gl===null)throw Error(Y(308));sa=e,Gl.dependencies={lanes:0,firstContext:e}}else sa=sa.next=e;return t}var fi=null;function Op(e){fi===null?fi=[e]:fi.push(e)}function Xx(e,t,n,r){var o=t.interleaved;return o===null?(n.next=n,Op(t)):(n.next=o.next,o.next=n),t.interleaved=n,Yr(e,r)}function Yr(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var xo=!1;function Lp(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Yx(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function qr(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Oo(e,t,n){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,Ne&2){var o=r.pending;return o===null?t.next=t:(t.next=o.next,o.next=t),r.pending=t,Yr(e,n)}return o=r.interleaved,o===null?(t.next=t,Op(r)):(t.next=o.next,o.next=t),r.interleaved=t,Yr(e,n)}function yl(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,Cp(e,n)}}function hg(e,t){var n=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var o=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?o=i=a:i=i.next=a,n=n.next}while(n!==null);i===null?o=i=t:i=i.next=t}else o=i=t;n={baseState:r.baseState,firstBaseUpdate:o,lastBaseUpdate:i,shared:r.shared,effects:r.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function ql(e,t,n,r){var o=e.updateQueue;xo=!1;var i=o.firstBaseUpdate,a=o.lastBaseUpdate,s=o.shared.pending;if(s!==null){o.shared.pending=null;var u=s,l=u.next;u.next=null,a===null?i=l:a.next=l,a=u;var c=e.alternate;c!==null&&(c=c.updateQueue,s=c.lastBaseUpdate,s!==a&&(s===null?c.firstBaseUpdate=l:s.next=l,c.lastBaseUpdate=u))}if(i!==null){var d=o.baseState;a=0,c=l=u=null,s=i;do{var f=s.lane,h=s.eventTime;if((r&f)===f){c!==null&&(c=c.next={eventTime:h,lane:0,tag:s.tag,payload:s.payload,callback:s.callback,next:null});e:{var v=e,m=s;switch(f=t,h=n,m.tag){case 1:if(v=m.payload,typeof v=="function"){d=v.call(h,d,f);break e}d=v;break e;case 3:v.flags=v.flags&-65537|128;case 0:if(v=m.payload,f=typeof v=="function"?v.call(h,d,f):v,f==null)break e;d=Ye({},d,f);break e;case 2:xo=!0}}s.callback!==null&&s.lane!==0&&(e.flags|=64,f=o.effects,f===null?o.effects=[s]:f.push(s))}else h={eventTime:h,lane:f,tag:s.tag,payload:s.payload,callback:s.callback,next:null},c===null?(l=c=h,u=d):c=c.next=h,a|=f;if(s=s.next,s===null){if(s=o.shared.pending,s===null)break;f=s,s=f.next,f.next=null,o.lastBaseUpdate=f,o.shared.pending=null}}while(!0);if(c===null&&(u=d),o.baseState=u,o.firstBaseUpdate=l,o.lastBaseUpdate=c,t=o.shared.interleaved,t!==null){o=t;do a|=o.lane,o=o.next;while(o!==t)}else i===null&&(o.shared.lanes=0);Ni|=a,e.lanes=a,e.memoizedState=d}}function pg(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var r=e[t],o=r.callback;if(o!==null){if(r.callback=null,r=n,typeof o!="function")throw Error(Y(191,o));o.call(r)}}}var pu={},_r=Jo(pu),Hs=Jo(pu),Gs=Jo(pu);function hi(e){if(e===pu)throw Error(Y(174));return e}function Bp(e,t){switch(Be(Gs,t),Be(Hs,e),Be(_r,pu),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Uf(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Uf(t,e)}$e(_r),Be(_r,t)}function ja(){$e(_r),$e(Hs),$e(Gs)}function Qx(e){hi(Gs.current);var t=hi(_r.current),n=Uf(t,e.type);t!==n&&(Be(Hs,e),Be(_r,n))}function jp(e){Hs.current===e&&($e(_r),$e(Hs))}var Ge=Jo(0);function Kl(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Vd=[];function Wp(){for(var e=0;e<Vd.length;e++)Vd[e]._workInProgressVersionPrimary=null;Vd.length=0}var xl=eo.ReactCurrentDispatcher,Hd=eo.ReactCurrentBatchConfig,Ri=0,Xe=null,ut=null,gt=null,Xl=!1,ks=!1,qs=0,G_=0;function At(){throw Error(Y(321))}function zp(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!rr(e[n],t[n]))return!1;return!0}function Up(e,t,n,r,o,i){if(Ri=i,Xe=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,xl.current=e===null||e.memoizedState===null?Y_:Q_,e=n(r,o),ks){i=0;do{if(ks=!1,qs=0,25<=i)throw Error(Y(301));i+=1,gt=ut=null,t.updateQueue=null,xl.current=J_,e=n(r,o)}while(ks)}if(xl.current=Yl,t=ut!==null&&ut.next!==null,Ri=0,gt=ut=Xe=null,Xl=!1,t)throw Error(Y(300));return e}function $p(){var e=qs!==0;return qs=0,e}function fr(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return gt===null?Xe.memoizedState=gt=e:gt=gt.next=e,gt}function Ln(){if(ut===null){var e=Xe.alternate;e=e!==null?e.memoizedState:null}else e=ut.next;var t=gt===null?Xe.memoizedState:gt.next;if(t!==null)gt=t,ut=e;else{if(e===null)throw Error(Y(310));ut=e,e={memoizedState:ut.memoizedState,baseState:ut.baseState,baseQueue:ut.baseQueue,queue:ut.queue,next:null},gt===null?Xe.memoizedState=gt=e:gt=gt.next=e}return gt}function Ks(e,t){return typeof t=="function"?t(e):t}function Gd(e){var t=Ln(),n=t.queue;if(n===null)throw Error(Y(311));n.lastRenderedReducer=e;var r=ut,o=r.baseQueue,i=n.pending;if(i!==null){if(o!==null){var a=o.next;o.next=i.next,i.next=a}r.baseQueue=o=i,n.pending=null}if(o!==null){i=o.next,r=r.baseState;var s=a=null,u=null,l=i;do{var c=l.lane;if((Ri&c)===c)u!==null&&(u=u.next={lane:0,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null}),r=l.hasEagerState?l.eagerState:e(r,l.action);else{var d={lane:c,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null};u===null?(s=u=d,a=r):u=u.next=d,Xe.lanes|=c,Ni|=c}l=l.next}while(l!==null&&l!==i);u===null?a=r:u.next=s,rr(r,t.memoizedState)||(tn=!0),t.memoizedState=r,t.baseState=a,t.baseQueue=u,n.lastRenderedState=r}if(e=n.interleaved,e!==null){o=e;do i=o.lane,Xe.lanes|=i,Ni|=i,o=o.next;while(o!==e)}else o===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function qd(e){var t=Ln(),n=t.queue;if(n===null)throw Error(Y(311));n.lastRenderedReducer=e;var r=n.dispatch,o=n.pending,i=t.memoizedState;if(o!==null){n.pending=null;var a=o=o.next;do i=e(i,a.action),a=a.next;while(a!==o);rr(i,t.memoizedState)||(tn=!0),t.memoizedState=i,t.baseQueue===null&&(t.baseState=i),n.lastRenderedState=i}return[i,r]}function Jx(){}function Zx(e,t){var n=Xe,r=Ln(),o=t(),i=!rr(r.memoizedState,o);if(i&&(r.memoizedState=o,tn=!0),r=r.queue,Vp(n1.bind(null,n,r,e),[e]),r.getSnapshot!==t||i||gt!==null&&gt.memoizedState.tag&1){if(n.flags|=2048,Xs(9,t1.bind(null,n,r,o,t),void 0,null),yt===null)throw Error(Y(349));Ri&30||e1(n,t,o)}return o}function e1(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=Xe.updateQueue,t===null?(t={lastEffect:null,stores:null},Xe.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function t1(e,t,n,r){t.value=n,t.getSnapshot=r,r1(t)&&o1(e)}function n1(e,t,n){return n(function(){r1(t)&&o1(e)})}function r1(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!rr(e,n)}catch{return!0}}function o1(e){var t=Yr(e,1);t!==null&&tr(t,e,1,-1)}function vg(e){var t=fr();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ks,lastRenderedState:e},t.queue=e,e=e.dispatch=X_.bind(null,Xe,e),[t.memoizedState,e]}function Xs(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},t=Xe.updateQueue,t===null?(t={lastEffect:null,stores:null},Xe.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e)),e}function i1(){return Ln().memoizedState}function wl(e,t,n,r){var o=fr();Xe.flags|=e,o.memoizedState=Xs(1|t,n,void 0,r===void 0?null:r)}function Wc(e,t,n,r){var o=Ln();r=r===void 0?null:r;var i=void 0;if(ut!==null){var a=ut.memoizedState;if(i=a.destroy,r!==null&&zp(r,a.deps)){o.memoizedState=Xs(t,n,i,r);return}}Xe.flags|=e,o.memoizedState=Xs(1|t,n,i,r)}function mg(e,t){return wl(8390656,8,e,t)}function Vp(e,t){return Wc(2048,8,e,t)}function a1(e,t){return Wc(4,2,e,t)}function s1(e,t){return Wc(4,4,e,t)}function u1(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function l1(e,t,n){return n=n!=null?n.concat([e]):null,Wc(4,4,u1.bind(null,t,e),n)}function Hp(){}function c1(e,t){var n=Ln();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&zp(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function d1(e,t){var n=Ln();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&zp(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function f1(e,t,n){return Ri&21?(rr(n,t)||(n=gx(),Xe.lanes|=n,Ni|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,tn=!0),e.memoizedState=n)}function q_(e,t){var n=De;De=n!==0&&4>n?n:4,e(!0);var r=Hd.transition;Hd.transition={};try{e(!1),t()}finally{De=n,Hd.transition=r}}function h1(){return Ln().memoizedState}function K_(e,t,n){var r=Bo(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},p1(e))v1(t,n);else if(n=Xx(e,t,n,r),n!==null){var o=Gt();tr(n,e,r,o),m1(n,t,r)}}function X_(e,t,n){var r=Bo(e),o={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(p1(e))v1(t,o);else{var i=e.alternate;if(e.lanes===0&&(i===null||i.lanes===0)&&(i=t.lastRenderedReducer,i!==null))try{var a=t.lastRenderedState,s=i(a,n);if(o.hasEagerState=!0,o.eagerState=s,rr(s,a)){var u=t.interleaved;u===null?(o.next=o,Op(t)):(o.next=u.next,u.next=o),t.interleaved=o;return}}catch{}finally{}n=Xx(e,t,o,r),n!==null&&(o=Gt(),tr(n,e,r,o),m1(n,t,r))}}function p1(e){var t=e.alternate;return e===Xe||t!==null&&t===Xe}function v1(e,t){ks=Xl=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function m1(e,t,n){if(n&4194240){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,Cp(e,n)}}var Yl={readContext:On,useCallback:At,useContext:At,useEffect:At,useImperativeHandle:At,useInsertionEffect:At,useLayoutEffect:At,useMemo:At,useReducer:At,useRef:At,useState:At,useDebugValue:At,useDeferredValue:At,useTransition:At,useMutableSource:At,useSyncExternalStore:At,useId:At,unstable_isNewReconciler:!1},Y_={readContext:On,useCallback:function(e,t){return fr().memoizedState=[e,t===void 0?null:t],e},useContext:On,useEffect:mg,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,wl(4194308,4,u1.bind(null,t,e),n)},useLayoutEffect:function(e,t){return wl(4194308,4,e,t)},useInsertionEffect:function(e,t){return wl(4,2,e,t)},useMemo:function(e,t){var n=fr();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=fr();return t=n!==void 0?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=K_.bind(null,Xe,e),[r.memoizedState,e]},useRef:function(e){var t=fr();return e={current:e},t.memoizedState=e},useState:vg,useDebugValue:Hp,useDeferredValue:function(e){return fr().memoizedState=e},useTransition:function(){var e=vg(!1),t=e[0];return e=q_.bind(null,e[1]),fr().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=Xe,o=fr();if(He){if(n===void 0)throw Error(Y(407));n=n()}else{if(n=t(),yt===null)throw Error(Y(349));Ri&30||e1(r,t,n)}o.memoizedState=n;var i={value:n,getSnapshot:t};return o.queue=i,mg(n1.bind(null,r,i,e),[e]),r.flags|=2048,Xs(9,t1.bind(null,r,i,n,t),void 0,null),n},useId:function(){var e=fr(),t=yt.identifierPrefix;if(He){var n=Gr,r=Hr;n=(r&~(1<<32-er(r)-1)).toString(32)+n,t=":"+t+"R"+n,n=qs++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=G_++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},Q_={readContext:On,useCallback:c1,useContext:On,useEffect:Vp,useImperativeHandle:l1,useInsertionEffect:a1,useLayoutEffect:s1,useMemo:d1,useReducer:Gd,useRef:i1,useState:function(){return Gd(Ks)},useDebugValue:Hp,useDeferredValue:function(e){var t=Ln();return f1(t,ut.memoizedState,e)},useTransition:function(){var e=Gd(Ks)[0],t=Ln().memoizedState;return[e,t]},useMutableSource:Jx,useSyncExternalStore:Zx,useId:h1,unstable_isNewReconciler:!1},J_={readContext:On,useCallback:c1,useContext:On,useEffect:Vp,useImperativeHandle:l1,useInsertionEffect:a1,useLayoutEffect:s1,useMemo:d1,useReducer:qd,useRef:i1,useState:function(){return qd(Ks)},useDebugValue:Hp,useDeferredValue:function(e){var t=Ln();return ut===null?t.memoizedState=e:f1(t,ut.memoizedState,e)},useTransition:function(){var e=qd(Ks)[0],t=Ln().memoizedState;return[e,t]},useMutableSource:Jx,useSyncExternalStore:Zx,useId:h1,unstable_isNewReconciler:!1};function Gn(e,t){if(e&&e.defaultProps){t=Ye({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function lh(e,t,n,r){t=e.memoizedState,n=n(r,t),n=n==null?t:Ye({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var zc={isMounted:function(e){return(e=e._reactInternals)?Fi(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=Gt(),o=Bo(e),i=qr(r,o);i.payload=t,n!=null&&(i.callback=n),t=Oo(e,i,o),t!==null&&(tr(t,e,o,r),yl(t,e,o))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=Gt(),o=Bo(e),i=qr(r,o);i.tag=1,i.payload=t,n!=null&&(i.callback=n),t=Oo(e,i,o),t!==null&&(tr(t,e,o,r),yl(t,e,o))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Gt(),r=Bo(e),o=qr(n,r);o.tag=2,t!=null&&(o.callback=t),t=Oo(e,o,r),t!==null&&(tr(t,e,r,n),yl(t,e,r))}};function gg(e,t,n,r,o,i,a){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(r,i,a):t.prototype&&t.prototype.isPureReactComponent?!zs(n,r)||!zs(o,i):!0}function g1(e,t,n){var r=!1,o=Vo,i=t.contextType;return typeof i=="object"&&i!==null?i=On(i):(o=rn(t)?Si:Wt.current,r=t.contextTypes,i=(r=r!=null)?Oa(e,o):Vo),t=new t(n,i),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=zc,e.stateNode=t,t._reactInternals=e,r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=o,e.__reactInternalMemoizedMaskedChildContext=i),t}function yg(e,t,n,r){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,r),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&zc.enqueueReplaceState(t,t.state,null)}function ch(e,t,n,r){var o=e.stateNode;o.props=n,o.state=e.memoizedState,o.refs={},Lp(e);var i=t.contextType;typeof i=="object"&&i!==null?o.context=On(i):(i=rn(t)?Si:Wt.current,o.context=Oa(e,i)),o.state=e.memoizedState,i=t.getDerivedStateFromProps,typeof i=="function"&&(lh(e,t,i,n),o.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof o.getSnapshotBeforeUpdate=="function"||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(t=o.state,typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount(),t!==o.state&&zc.enqueueReplaceState(o,o.state,null),ql(e,n,o,r),o.state=e.memoizedState),typeof o.componentDidMount=="function"&&(e.flags|=4194308)}function Wa(e,t){try{var n="",r=t;do n+=kE(r),r=r.return;while(r);var o=n}catch(i){o=`
Error generating stack: `+i.message+`
`+i.stack}return{value:e,source:t,stack:o,digest:null}}function Kd(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function dh(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var Z_=typeof WeakMap=="function"?WeakMap:Map;function y1(e,t,n){n=qr(-1,n),n.tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Jl||(Jl=!0,bh=r),dh(e,t)},n}function x1(e,t,n){n=qr(-1,n),n.tag=3;var r=e.type.getDerivedStateFromError;if(typeof r=="function"){var o=t.value;n.payload=function(){return r(o)},n.callback=function(){dh(e,t)}}var i=e.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){dh(e,t),typeof r!="function"&&(Lo===null?Lo=new Set([this]):Lo.add(this));var a=t.stack;this.componentDidCatch(t.value,{componentStack:a!==null?a:""})}),n}function xg(e,t,n){var r=e.pingCache;if(r===null){r=e.pingCache=new Z_;var o=new Set;r.set(t,o)}else o=r.get(t),o===void 0&&(o=new Set,r.set(t,o));o.has(n)||(o.add(n),e=hS.bind(null,e,t,n),t.then(e,e))}function wg(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function bg(e,t,n,r,o){return e.mode&1?(e.flags|=65536,e.lanes=o,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=qr(-1,1),t.tag=2,Oo(n,t,1))),n.lanes|=1),e)}var eS=eo.ReactCurrentOwner,tn=!1;function Vt(e,t,n,r){t.child=e===null?Kx(t,null,n,r):Ba(t,e.child,n,r)}function Cg(e,t,n,r,o){n=n.render;var i=t.ref;return pa(t,o),r=Up(e,t,n,r,i,o),n=$p(),e!==null&&!tn?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~o,Qr(e,t,o)):(He&&n&&Tp(t),t.flags|=1,Vt(e,t,r,o),t.child)}function Eg(e,t,n,r,o){if(e===null){var i=n.type;return typeof i=="function"&&!Zp(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=i,w1(e,t,i,r,o)):(e=_l(n.type,null,r,t,t.mode,o),e.ref=t.ref,e.return=t,t.child=e)}if(i=e.child,!(e.lanes&o)){var a=i.memoizedProps;if(n=n.compare,n=n!==null?n:zs,n(a,r)&&e.ref===t.ref)return Qr(e,t,o)}return t.flags|=1,e=jo(i,r),e.ref=t.ref,e.return=t,t.child=e}function w1(e,t,n,r,o){if(e!==null){var i=e.memoizedProps;if(zs(i,r)&&e.ref===t.ref)if(tn=!1,t.pendingProps=r=i,(e.lanes&o)!==0)e.flags&131072&&(tn=!0);else return t.lanes=e.lanes,Qr(e,t,o)}return fh(e,t,n,r,o)}function b1(e,t,n){var r=t.pendingProps,o=r.children,i=e!==null?e.memoizedState:null;if(r.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Be(la,fn),fn|=n;else{if(!(n&1073741824))return e=i!==null?i.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Be(la,fn),fn|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,Be(la,fn),fn|=r}else i!==null?(r=i.baseLanes|n,t.memoizedState=null):r=n,Be(la,fn),fn|=r;return Vt(e,t,o,n),t.child}function C1(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function fh(e,t,n,r,o){var i=rn(n)?Si:Wt.current;return i=Oa(t,i),pa(t,o),n=Up(e,t,n,r,i,o),r=$p(),e!==null&&!tn?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~o,Qr(e,t,o)):(He&&r&&Tp(t),t.flags|=1,Vt(e,t,n,o),t.child)}function _g(e,t,n,r,o){if(rn(n)){var i=!0;Ul(t)}else i=!1;if(pa(t,o),t.stateNode===null)bl(e,t),g1(t,n,r),ch(t,n,r,o),r=!0;else if(e===null){var a=t.stateNode,s=t.memoizedProps;a.props=s;var u=a.context,l=n.contextType;typeof l=="object"&&l!==null?l=On(l):(l=rn(n)?Si:Wt.current,l=Oa(t,l));var c=n.getDerivedStateFromProps,d=typeof c=="function"||typeof a.getSnapshotBeforeUpdate=="function";d||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(s!==r||u!==l)&&yg(t,a,r,l),xo=!1;var f=t.memoizedState;a.state=f,ql(t,r,a,o),u=t.memoizedState,s!==r||f!==u||nn.current||xo?(typeof c=="function"&&(lh(t,n,c,r),u=t.memoizedState),(s=xo||gg(t,n,s,r,f,u,l))?(d||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(t.flags|=4194308)):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=u),a.props=r,a.state=u,a.context=l,r=s):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),r=!1)}else{a=t.stateNode,Yx(e,t),s=t.memoizedProps,l=t.type===t.elementType?s:Gn(t.type,s),a.props=l,d=t.pendingProps,f=a.context,u=n.contextType,typeof u=="object"&&u!==null?u=On(u):(u=rn(n)?Si:Wt.current,u=Oa(t,u));var h=n.getDerivedStateFromProps;(c=typeof h=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(s!==d||f!==u)&&yg(t,a,r,u),xo=!1,f=t.memoizedState,a.state=f,ql(t,r,a,o);var v=t.memoizedState;s!==d||f!==v||nn.current||xo?(typeof h=="function"&&(lh(t,n,h,r),v=t.memoizedState),(l=xo||gg(t,n,l,r,f,v,u)||!1)?(c||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(r,v,u),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(r,v,u)),typeof a.componentDidUpdate=="function"&&(t.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof a.componentDidUpdate!="function"||s===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||s===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=v),a.props=r,a.state=v,a.context=u,r=l):(typeof a.componentDidUpdate!="function"||s===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||s===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),r=!1)}return hh(e,t,n,r,i,o)}function hh(e,t,n,r,o,i){C1(e,t);var a=(t.flags&128)!==0;if(!r&&!a)return o&&lg(t,n,!1),Qr(e,t,i);r=t.stateNode,eS.current=t;var s=a&&typeof n.getDerivedStateFromError!="function"?null:r.render();return t.flags|=1,e!==null&&a?(t.child=Ba(t,e.child,null,i),t.child=Ba(t,null,s,i)):Vt(e,t,s,i),t.memoizedState=r.state,o&&lg(t,n,!0),t.child}function E1(e){var t=e.stateNode;t.pendingContext?ug(e,t.pendingContext,t.pendingContext!==t.context):t.context&&ug(e,t.context,!1),Bp(e,t.containerInfo)}function Sg(e,t,n,r,o){return La(),Pp(o),t.flags|=256,Vt(e,t,n,r),t.child}var ph={dehydrated:null,treeContext:null,retryLane:0};function vh(e){return{baseLanes:e,cachePool:null,transitions:null}}function _1(e,t,n){var r=t.pendingProps,o=Ge.current,i=!1,a=(t.flags&128)!==0,s;if((s=a)||(s=e!==null&&e.memoizedState===null?!1:(o&2)!==0),s?(i=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(o|=1),Be(Ge,o&1),e===null)return sh(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(a=r.children,e=r.fallback,i?(r=t.mode,i=t.child,a={mode:"hidden",children:a},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=a):i=Vc(a,r,0,null),e=Ei(e,r,n,null),i.return=t,e.return=t,i.sibling=e,t.child=i,t.child.memoizedState=vh(n),t.memoizedState=ph,e):Gp(t,a));if(o=e.memoizedState,o!==null&&(s=o.dehydrated,s!==null))return tS(e,t,a,r,s,o,n);if(i){i=r.fallback,a=t.mode,o=e.child,s=o.sibling;var u={mode:"hidden",children:r.children};return!(a&1)&&t.child!==o?(r=t.child,r.childLanes=0,r.pendingProps=u,t.deletions=null):(r=jo(o,u),r.subtreeFlags=o.subtreeFlags&14680064),s!==null?i=jo(s,i):(i=Ei(i,a,n,null),i.flags|=2),i.return=t,r.return=t,r.sibling=i,t.child=r,r=i,i=t.child,a=e.child.memoizedState,a=a===null?vh(n):{baseLanes:a.baseLanes|n,cachePool:null,transitions:a.transitions},i.memoizedState=a,i.childLanes=e.childLanes&~n,t.memoizedState=ph,r}return i=e.child,e=i.sibling,r=jo(i,{mode:"visible",children:r.children}),!(t.mode&1)&&(r.lanes=n),r.return=t,r.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function Gp(e,t){return t=Vc({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function $u(e,t,n,r){return r!==null&&Pp(r),Ba(t,e.child,null,n),e=Gp(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function tS(e,t,n,r,o,i,a){if(n)return t.flags&256?(t.flags&=-257,r=Kd(Error(Y(422))),$u(e,t,a,r)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(i=r.fallback,o=t.mode,r=Vc({mode:"visible",children:r.children},o,0,null),i=Ei(i,o,a,null),i.flags|=2,r.return=t,i.return=t,r.sibling=i,t.child=r,t.mode&1&&Ba(t,e.child,null,a),t.child.memoizedState=vh(a),t.memoizedState=ph,i);if(!(t.mode&1))return $u(e,t,a,null);if(o.data==="$!"){if(r=o.nextSibling&&o.nextSibling.dataset,r)var s=r.dgst;return r=s,i=Error(Y(419)),r=Kd(i,r,void 0),$u(e,t,a,r)}if(s=(a&e.childLanes)!==0,tn||s){if(r=yt,r!==null){switch(a&-a){case 4:o=2;break;case 16:o=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:o=32;break;case 536870912:o=268435456;break;default:o=0}o=o&(r.suspendedLanes|a)?0:o,o!==0&&o!==i.retryLane&&(i.retryLane=o,Yr(e,o),tr(r,e,o,-1))}return Jp(),r=Kd(Error(Y(421))),$u(e,t,a,r)}return o.data==="$?"?(t.flags|=128,t.child=e.child,t=pS.bind(null,e),o._reactRetry=t,null):(e=i.treeContext,mn=Mo(o.nextSibling),wn=t,He=!0,Qn=null,e!==null&&(Nn[In++]=Hr,Nn[In++]=Gr,Nn[In++]=ki,Hr=e.id,Gr=e.overflow,ki=t),t=Gp(t,r.children),t.flags|=4096,t)}function kg(e,t,n){e.lanes|=t;var r=e.alternate;r!==null&&(r.lanes|=t),uh(e.return,t,n)}function Xd(e,t,n,r,o){var i=e.memoizedState;i===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:o}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=o)}function S1(e,t,n){var r=t.pendingProps,o=r.revealOrder,i=r.tail;if(Vt(e,t,r.children,n),r=Ge.current,r&2)r=r&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&kg(e,n,t);else if(e.tag===19)kg(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Be(Ge,r),!(t.mode&1))t.memoizedState=null;else switch(o){case"forwards":for(n=t.child,o=null;n!==null;)e=n.alternate,e!==null&&Kl(e)===null&&(o=n),n=n.sibling;n=o,n===null?(o=t.child,t.child=null):(o=n.sibling,n.sibling=null),Xd(t,!1,o,n,i);break;case"backwards":for(n=null,o=t.child,t.child=null;o!==null;){if(e=o.alternate,e!==null&&Kl(e)===null){t.child=o;break}e=o.sibling,o.sibling=n,n=o,o=e}Xd(t,!0,n,null,i);break;case"together":Xd(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function bl(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Qr(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),Ni|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(Y(153));if(t.child!==null){for(e=t.child,n=jo(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=jo(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function nS(e,t,n){switch(t.tag){case 3:E1(t),La();break;case 5:Qx(t);break;case 1:rn(t.type)&&Ul(t);break;case 4:Bp(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,o=t.memoizedProps.value;Be(Hl,r._currentValue),r._currentValue=o;break;case 13:if(r=t.memoizedState,r!==null)return r.dehydrated!==null?(Be(Ge,Ge.current&1),t.flags|=128,null):n&t.child.childLanes?_1(e,t,n):(Be(Ge,Ge.current&1),e=Qr(e,t,n),e!==null?e.sibling:null);Be(Ge,Ge.current&1);break;case 19:if(r=(n&t.childLanes)!==0,e.flags&128){if(r)return S1(e,t,n);t.flags|=128}if(o=t.memoizedState,o!==null&&(o.rendering=null,o.tail=null,o.lastEffect=null),Be(Ge,Ge.current),r)break;return null;case 22:case 23:return t.lanes=0,b1(e,t,n)}return Qr(e,t,n)}var k1,mh,R1,N1;k1=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};mh=function(){};R1=function(e,t,n,r){var o=e.memoizedProps;if(o!==r){e=t.stateNode,hi(_r.current);var i=null;switch(n){case"input":o=Bf(e,o),r=Bf(e,r),i=[];break;case"select":o=Ye({},o,{value:void 0}),r=Ye({},r,{value:void 0}),i=[];break;case"textarea":o=zf(e,o),r=zf(e,r),i=[];break;default:typeof o.onClick!="function"&&typeof r.onClick=="function"&&(e.onclick=Wl)}$f(n,r);var a;n=null;for(l in o)if(!r.hasOwnProperty(l)&&o.hasOwnProperty(l)&&o[l]!=null)if(l==="style"){var s=o[l];for(a in s)s.hasOwnProperty(a)&&(n||(n={}),n[a]="")}else l!=="dangerouslySetInnerHTML"&&l!=="children"&&l!=="suppressContentEditableWarning"&&l!=="suppressHydrationWarning"&&l!=="autoFocus"&&(Fs.hasOwnProperty(l)?i||(i=[]):(i=i||[]).push(l,null));for(l in r){var u=r[l];if(s=o!=null?o[l]:void 0,r.hasOwnProperty(l)&&u!==s&&(u!=null||s!=null))if(l==="style")if(s){for(a in s)!s.hasOwnProperty(a)||u&&u.hasOwnProperty(a)||(n||(n={}),n[a]="");for(a in u)u.hasOwnProperty(a)&&s[a]!==u[a]&&(n||(n={}),n[a]=u[a])}else n||(i||(i=[]),i.push(l,n)),n=u;else l==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,s=s?s.__html:void 0,u!=null&&s!==u&&(i=i||[]).push(l,u)):l==="children"?typeof u!="string"&&typeof u!="number"||(i=i||[]).push(l,""+u):l!=="suppressContentEditableWarning"&&l!=="suppressHydrationWarning"&&(Fs.hasOwnProperty(l)?(u!=null&&l==="onScroll"&&ze("scroll",e),i||s===u||(i=[])):(i=i||[]).push(l,u))}n&&(i=i||[]).push("style",n);var l=i;(t.updateQueue=l)&&(t.flags|=4)}};N1=function(e,t,n,r){n!==r&&(t.flags|=4)};function ls(e,t){if(!He)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Pt(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,r=0;if(t)for(var o=e.child;o!==null;)n|=o.lanes|o.childLanes,r|=o.subtreeFlags&14680064,r|=o.flags&14680064,o.return=e,o=o.sibling;else for(o=e.child;o!==null;)n|=o.lanes|o.childLanes,r|=o.subtreeFlags,r|=o.flags,o.return=e,o=o.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function rS(e,t,n){var r=t.pendingProps;switch(Ap(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Pt(t),null;case 1:return rn(t.type)&&zl(),Pt(t),null;case 3:return r=t.stateNode,ja(),$e(nn),$e(Wt),Wp(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&(zu(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Qn!==null&&(_h(Qn),Qn=null))),mh(e,t),Pt(t),null;case 5:jp(t);var o=hi(Gs.current);if(n=t.type,e!==null&&t.stateNode!=null)R1(e,t,n,r,o),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(t.stateNode===null)throw Error(Y(166));return Pt(t),null}if(e=hi(_r.current),zu(t)){r=t.stateNode,n=t.type;var i=t.memoizedProps;switch(r[yr]=t,r[Vs]=i,e=(t.mode&1)!==0,n){case"dialog":ze("cancel",r),ze("close",r);break;case"iframe":case"object":case"embed":ze("load",r);break;case"video":case"audio":for(o=0;o<ws.length;o++)ze(ws[o],r);break;case"source":ze("error",r);break;case"img":case"image":case"link":ze("error",r),ze("load",r);break;case"details":ze("toggle",r);break;case"input":Mm(r,i),ze("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},ze("invalid",r);break;case"textarea":Lm(r,i),ze("invalid",r)}$f(n,i),o=null;for(var a in i)if(i.hasOwnProperty(a)){var s=i[a];a==="children"?typeof s=="string"?r.textContent!==s&&(i.suppressHydrationWarning!==!0&&Wu(r.textContent,s,e),o=["children",s]):typeof s=="number"&&r.textContent!==""+s&&(i.suppressHydrationWarning!==!0&&Wu(r.textContent,s,e),o=["children",""+s]):Fs.hasOwnProperty(a)&&s!=null&&a==="onScroll"&&ze("scroll",r)}switch(n){case"input":Pu(r),Om(r,i,!0);break;case"textarea":Pu(r),Bm(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=Wl)}r=o,t.updateQueue=r,r!==null&&(t.flags|=4)}else{a=o.nodeType===9?o:o.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=nx(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=a.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof r.is=="string"?e=a.createElement(n,{is:r.is}):(e=a.createElement(n),n==="select"&&(a=e,r.multiple?a.multiple=!0:r.size&&(a.size=r.size))):e=a.createElementNS(e,n),e[yr]=t,e[Vs]=r,k1(e,t,!1,!1),t.stateNode=e;e:{switch(a=Vf(n,r),n){case"dialog":ze("cancel",e),ze("close",e),o=r;break;case"iframe":case"object":case"embed":ze("load",e),o=r;break;case"video":case"audio":for(o=0;o<ws.length;o++)ze(ws[o],e);o=r;break;case"source":ze("error",e),o=r;break;case"img":case"image":case"link":ze("error",e),ze("load",e),o=r;break;case"details":ze("toggle",e),o=r;break;case"input":Mm(e,r),o=Bf(e,r),ze("invalid",e);break;case"option":o=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},o=Ye({},r,{value:void 0}),ze("invalid",e);break;case"textarea":Lm(e,r),o=zf(e,r),ze("invalid",e);break;default:o=r}$f(n,o),s=o;for(i in s)if(s.hasOwnProperty(i)){var u=s[i];i==="style"?ix(e,u):i==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&rx(e,u)):i==="children"?typeof u=="string"?(n!=="textarea"||u!=="")&&Ms(e,u):typeof u=="number"&&Ms(e,""+u):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(Fs.hasOwnProperty(i)?u!=null&&i==="onScroll"&&ze("scroll",e):u!=null&&mp(e,i,u,a))}switch(n){case"input":Pu(e),Om(e,r,!1);break;case"textarea":Pu(e),Bm(e);break;case"option":r.value!=null&&e.setAttribute("value",""+$o(r.value));break;case"select":e.multiple=!!r.multiple,i=r.value,i!=null?ca(e,!!r.multiple,i,!1):r.defaultValue!=null&&ca(e,!!r.multiple,r.defaultValue,!0);break;default:typeof o.onClick=="function"&&(e.onclick=Wl)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Pt(t),null;case 6:if(e&&t.stateNode!=null)N1(e,t,e.memoizedProps,r);else{if(typeof r!="string"&&t.stateNode===null)throw Error(Y(166));if(n=hi(Gs.current),hi(_r.current),zu(t)){if(r=t.stateNode,n=t.memoizedProps,r[yr]=t,(i=r.nodeValue!==n)&&(e=wn,e!==null))switch(e.tag){case 3:Wu(r.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Wu(r.nodeValue,n,(e.mode&1)!==0)}i&&(t.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[yr]=t,t.stateNode=r}return Pt(t),null;case 13:if($e(Ge),r=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(He&&mn!==null&&t.mode&1&&!(t.flags&128))Gx(),La(),t.flags|=98560,i=!1;else if(i=zu(t),r!==null&&r.dehydrated!==null){if(e===null){if(!i)throw Error(Y(318));if(i=t.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(Y(317));i[yr]=t}else La(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Pt(t),i=!1}else Qn!==null&&(_h(Qn),Qn=null),i=!0;if(!i)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(r=r!==null,r!==(e!==null&&e.memoizedState!==null)&&r&&(t.child.flags|=8192,t.mode&1&&(e===null||Ge.current&1?ct===0&&(ct=3):Jp())),t.updateQueue!==null&&(t.flags|=4),Pt(t),null);case 4:return ja(),mh(e,t),e===null&&Us(t.stateNode.containerInfo),Pt(t),null;case 10:return Mp(t.type._context),Pt(t),null;case 17:return rn(t.type)&&zl(),Pt(t),null;case 19:if($e(Ge),i=t.memoizedState,i===null)return Pt(t),null;if(r=(t.flags&128)!==0,a=i.rendering,a===null)if(r)ls(i,!1);else{if(ct!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(a=Kl(e),a!==null){for(t.flags|=128,ls(i,!1),r=a.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;n!==null;)i=n,e=r,i.flags&=14680066,a=i.alternate,a===null?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=a.childLanes,i.lanes=a.lanes,i.child=a.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=a.memoizedProps,i.memoizedState=a.memoizedState,i.updateQueue=a.updateQueue,i.type=a.type,e=a.dependencies,i.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Be(Ge,Ge.current&1|2),t.child}e=e.sibling}i.tail!==null&&nt()>za&&(t.flags|=128,r=!0,ls(i,!1),t.lanes=4194304)}else{if(!r)if(e=Kl(a),e!==null){if(t.flags|=128,r=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),ls(i,!0),i.tail===null&&i.tailMode==="hidden"&&!a.alternate&&!He)return Pt(t),null}else 2*nt()-i.renderingStartTime>za&&n!==1073741824&&(t.flags|=128,r=!0,ls(i,!1),t.lanes=4194304);i.isBackwards?(a.sibling=t.child,t.child=a):(n=i.last,n!==null?n.sibling=a:t.child=a,i.last=a)}return i.tail!==null?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=nt(),t.sibling=null,n=Ge.current,Be(Ge,r?n&1|2:n&1),t):(Pt(t),null);case 22:case 23:return Qp(),r=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==r&&(t.flags|=8192),r&&t.mode&1?fn&1073741824&&(Pt(t),t.subtreeFlags&6&&(t.flags|=8192)):Pt(t),null;case 24:return null;case 25:return null}throw Error(Y(156,t.tag))}function oS(e,t){switch(Ap(t),t.tag){case 1:return rn(t.type)&&zl(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return ja(),$e(nn),$e(Wt),Wp(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return jp(t),null;case 13:if($e(Ge),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(Y(340));La()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return $e(Ge),null;case 4:return ja(),null;case 10:return Mp(t.type._context),null;case 22:case 23:return Qp(),null;case 24:return null;default:return null}}var Vu=!1,Mt=!1,iS=typeof WeakSet=="function"?WeakSet:Set,ne=null;function ua(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){tt(e,t,r)}else n.current=null}function gh(e,t,n){try{n()}catch(r){tt(e,t,r)}}var Rg=!1;function aS(e,t){if(eh=Ll,e=Dx(),Ip(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var o=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var a=0,s=-1,u=-1,l=0,c=0,d=e,f=null;t:for(;;){for(var h;d!==n||o!==0&&d.nodeType!==3||(s=a+o),d!==i||r!==0&&d.nodeType!==3||(u=a+r),d.nodeType===3&&(a+=d.nodeValue.length),(h=d.firstChild)!==null;)f=d,d=h;for(;;){if(d===e)break t;if(f===n&&++l===o&&(s=a),f===i&&++c===r&&(u=a),(h=d.nextSibling)!==null)break;d=f,f=d.parentNode}d=h}n=s===-1||u===-1?null:{start:s,end:u}}else n=null}n=n||{start:0,end:0}}else n=null;for(th={focusedElem:e,selectionRange:n},Ll=!1,ne=t;ne!==null;)if(t=ne,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,ne=e;else for(;ne!==null;){t=ne;try{var v=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(v!==null){var m=v.memoizedProps,g=v.memoizedState,p=t.stateNode,y=p.getSnapshotBeforeUpdate(t.elementType===t.type?m:Gn(t.type,m),g);p.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var x=t.stateNode.containerInfo;x.nodeType===1?x.textContent="":x.nodeType===9&&x.documentElement&&x.removeChild(x.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Y(163))}}catch(w){tt(t,t.return,w)}if(e=t.sibling,e!==null){e.return=t.return,ne=e;break}ne=t.return}return v=Rg,Rg=!1,v}function Rs(e,t,n){var r=t.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var o=r=r.next;do{if((o.tag&e)===e){var i=o.destroy;o.destroy=void 0,i!==void 0&&gh(t,n,i)}o=o.next}while(o!==r)}}function Uc(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function yh(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function I1(e){var t=e.alternate;t!==null&&(e.alternate=null,I1(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[yr],delete t[Vs],delete t[oh],delete t[U_],delete t[$_])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function T1(e){return e.tag===5||e.tag===3||e.tag===4}function Ng(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||T1(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function xh(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=Wl));else if(r!==4&&(e=e.child,e!==null))for(xh(e,t,n),e=e.sibling;e!==null;)xh(e,t,n),e=e.sibling}function wh(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(r!==4&&(e=e.child,e!==null))for(wh(e,t,n),e=e.sibling;e!==null;)wh(e,t,n),e=e.sibling}var Ct=null,Yn=!1;function fo(e,t,n){for(n=n.child;n!==null;)A1(e,t,n),n=n.sibling}function A1(e,t,n){if(Er&&typeof Er.onCommitFiberUnmount=="function")try{Er.onCommitFiberUnmount(Fc,n)}catch{}switch(n.tag){case 5:Mt||ua(n,t);case 6:var r=Ct,o=Yn;Ct=null,fo(e,t,n),Ct=r,Yn=o,Ct!==null&&(Yn?(e=Ct,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):Ct.removeChild(n.stateNode));break;case 18:Ct!==null&&(Yn?(e=Ct,n=n.stateNode,e.nodeType===8?Ud(e.parentNode,n):e.nodeType===1&&Ud(e,n),js(e)):Ud(Ct,n.stateNode));break;case 4:r=Ct,o=Yn,Ct=n.stateNode.containerInfo,Yn=!0,fo(e,t,n),Ct=r,Yn=o;break;case 0:case 11:case 14:case 15:if(!Mt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){o=r=r.next;do{var i=o,a=i.destroy;i=i.tag,a!==void 0&&(i&2||i&4)&&gh(n,t,a),o=o.next}while(o!==r)}fo(e,t,n);break;case 1:if(!Mt&&(ua(n,t),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(s){tt(n,t,s)}fo(e,t,n);break;case 21:fo(e,t,n);break;case 22:n.mode&1?(Mt=(r=Mt)||n.memoizedState!==null,fo(e,t,n),Mt=r):fo(e,t,n);break;default:fo(e,t,n)}}function Ig(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new iS),t.forEach(function(r){var o=vS.bind(null,e,r);n.has(r)||(n.add(r),r.then(o,o))})}}function Vn(e,t){var n=t.deletions;if(n!==null)for(var r=0;r<n.length;r++){var o=n[r];try{var i=e,a=t,s=a;e:for(;s!==null;){switch(s.tag){case 5:Ct=s.stateNode,Yn=!1;break e;case 3:Ct=s.stateNode.containerInfo,Yn=!0;break e;case 4:Ct=s.stateNode.containerInfo,Yn=!0;break e}s=s.return}if(Ct===null)throw Error(Y(160));A1(i,a,o),Ct=null,Yn=!1;var u=o.alternate;u!==null&&(u.return=null),o.return=null}catch(l){tt(o,t,l)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)P1(t,e),t=t.sibling}function P1(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Vn(t,e),cr(e),r&4){try{Rs(3,e,e.return),Uc(3,e)}catch(m){tt(e,e.return,m)}try{Rs(5,e,e.return)}catch(m){tt(e,e.return,m)}}break;case 1:Vn(t,e),cr(e),r&512&&n!==null&&ua(n,n.return);break;case 5:if(Vn(t,e),cr(e),r&512&&n!==null&&ua(n,n.return),e.flags&32){var o=e.stateNode;try{Ms(o,"")}catch(m){tt(e,e.return,m)}}if(r&4&&(o=e.stateNode,o!=null)){var i=e.memoizedProps,a=n!==null?n.memoizedProps:i,s=e.type,u=e.updateQueue;if(e.updateQueue=null,u!==null)try{s==="input"&&i.type==="radio"&&i.name!=null&&ex(o,i),Vf(s,a);var l=Vf(s,i);for(a=0;a<u.length;a+=2){var c=u[a],d=u[a+1];c==="style"?ix(o,d):c==="dangerouslySetInnerHTML"?rx(o,d):c==="children"?Ms(o,d):mp(o,c,d,l)}switch(s){case"input":jf(o,i);break;case"textarea":tx(o,i);break;case"select":var f=o._wrapperState.wasMultiple;o._wrapperState.wasMultiple=!!i.multiple;var h=i.value;h!=null?ca(o,!!i.multiple,h,!1):f!==!!i.multiple&&(i.defaultValue!=null?ca(o,!!i.multiple,i.defaultValue,!0):ca(o,!!i.multiple,i.multiple?[]:"",!1))}o[Vs]=i}catch(m){tt(e,e.return,m)}}break;case 6:if(Vn(t,e),cr(e),r&4){if(e.stateNode===null)throw Error(Y(162));o=e.stateNode,i=e.memoizedProps;try{o.nodeValue=i}catch(m){tt(e,e.return,m)}}break;case 3:if(Vn(t,e),cr(e),r&4&&n!==null&&n.memoizedState.isDehydrated)try{js(t.containerInfo)}catch(m){tt(e,e.return,m)}break;case 4:Vn(t,e),cr(e);break;case 13:Vn(t,e),cr(e),o=e.child,o.flags&8192&&(i=o.memoizedState!==null,o.stateNode.isHidden=i,!i||o.alternate!==null&&o.alternate.memoizedState!==null||(Xp=nt())),r&4&&Ig(e);break;case 22:if(c=n!==null&&n.memoizedState!==null,e.mode&1?(Mt=(l=Mt)||c,Vn(t,e),Mt=l):Vn(t,e),cr(e),r&8192){if(l=e.memoizedState!==null,(e.stateNode.isHidden=l)&&!c&&e.mode&1)for(ne=e,c=e.child;c!==null;){for(d=ne=c;ne!==null;){switch(f=ne,h=f.child,f.tag){case 0:case 11:case 14:case 15:Rs(4,f,f.return);break;case 1:ua(f,f.return);var v=f.stateNode;if(typeof v.componentWillUnmount=="function"){r=f,n=f.return;try{t=r,v.props=t.memoizedProps,v.state=t.memoizedState,v.componentWillUnmount()}catch(m){tt(r,n,m)}}break;case 5:ua(f,f.return);break;case 22:if(f.memoizedState!==null){Ag(d);continue}}h!==null?(h.return=f,ne=h):Ag(d)}c=c.sibling}e:for(c=null,d=e;;){if(d.tag===5){if(c===null){c=d;try{o=d.stateNode,l?(i=o.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(s=d.stateNode,u=d.memoizedProps.style,a=u!=null&&u.hasOwnProperty("display")?u.display:null,s.style.display=ox("display",a))}catch(m){tt(e,e.return,m)}}}else if(d.tag===6){if(c===null)try{d.stateNode.nodeValue=l?"":d.memoizedProps}catch(m){tt(e,e.return,m)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===e)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===e)break e;for(;d.sibling===null;){if(d.return===null||d.return===e)break e;c===d&&(c=null),d=d.return}c===d&&(c=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:Vn(t,e),cr(e),r&4&&Ig(e);break;case 21:break;default:Vn(t,e),cr(e)}}function cr(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(T1(n)){var r=n;break e}n=n.return}throw Error(Y(160))}switch(r.tag){case 5:var o=r.stateNode;r.flags&32&&(Ms(o,""),r.flags&=-33);var i=Ng(e);wh(e,i,o);break;case 3:case 4:var a=r.stateNode.containerInfo,s=Ng(e);xh(e,s,a);break;default:throw Error(Y(161))}}catch(u){tt(e,e.return,u)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function sS(e,t,n){ne=e,D1(e)}function D1(e,t,n){for(var r=(e.mode&1)!==0;ne!==null;){var o=ne,i=o.child;if(o.tag===22&&r){var a=o.memoizedState!==null||Vu;if(!a){var s=o.alternate,u=s!==null&&s.memoizedState!==null||Mt;s=Vu;var l=Mt;if(Vu=a,(Mt=u)&&!l)for(ne=o;ne!==null;)a=ne,u=a.child,a.tag===22&&a.memoizedState!==null?Pg(o):u!==null?(u.return=a,ne=u):Pg(o);for(;i!==null;)ne=i,D1(i),i=i.sibling;ne=o,Vu=s,Mt=l}Tg(e)}else o.subtreeFlags&8772&&i!==null?(i.return=o,ne=i):Tg(e)}}function Tg(e){for(;ne!==null;){var t=ne;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Mt||Uc(5,t);break;case 1:var r=t.stateNode;if(t.flags&4&&!Mt)if(n===null)r.componentDidMount();else{var o=t.elementType===t.type?n.memoizedProps:Gn(t.type,n.memoizedProps);r.componentDidUpdate(o,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;i!==null&&pg(t,i,r);break;case 3:var a=t.updateQueue;if(a!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}pg(t,a,n)}break;case 5:var s=t.stateNode;if(n===null&&t.flags&4){n=s;var u=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&n.focus();break;case"img":u.src&&(n.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var l=t.alternate;if(l!==null){var c=l.memoizedState;if(c!==null){var d=c.dehydrated;d!==null&&js(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Y(163))}Mt||t.flags&512&&yh(t)}catch(f){tt(t,t.return,f)}}if(t===e){ne=null;break}if(n=t.sibling,n!==null){n.return=t.return,ne=n;break}ne=t.return}}function Ag(e){for(;ne!==null;){var t=ne;if(t===e){ne=null;break}var n=t.sibling;if(n!==null){n.return=t.return,ne=n;break}ne=t.return}}function Pg(e){for(;ne!==null;){var t=ne;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{Uc(4,t)}catch(u){tt(t,n,u)}break;case 1:var r=t.stateNode;if(typeof r.componentDidMount=="function"){var o=t.return;try{r.componentDidMount()}catch(u){tt(t,o,u)}}var i=t.return;try{yh(t)}catch(u){tt(t,i,u)}break;case 5:var a=t.return;try{yh(t)}catch(u){tt(t,a,u)}}}catch(u){tt(t,t.return,u)}if(t===e){ne=null;break}var s=t.sibling;if(s!==null){s.return=t.return,ne=s;break}ne=t.return}}var uS=Math.ceil,Ql=eo.ReactCurrentDispatcher,qp=eo.ReactCurrentOwner,Mn=eo.ReactCurrentBatchConfig,Ne=0,yt=null,it=null,kt=0,fn=0,la=Jo(0),ct=0,Ys=null,Ni=0,$c=0,Kp=0,Ns=null,Jt=null,Xp=0,za=1/0,zr=null,Jl=!1,bh=null,Lo=null,Hu=!1,No=null,Zl=0,Is=0,Ch=null,Cl=-1,El=0;function Gt(){return Ne&6?nt():Cl!==-1?Cl:Cl=nt()}function Bo(e){return e.mode&1?Ne&2&&kt!==0?kt&-kt:H_.transition!==null?(El===0&&(El=gx()),El):(e=De,e!==0||(e=window.event,e=e===void 0?16:_x(e.type)),e):1}function tr(e,t,n,r){if(50<Is)throw Is=0,Ch=null,Error(Y(185));du(e,n,r),(!(Ne&2)||e!==yt)&&(e===yt&&(!(Ne&2)&&($c|=n),ct===4&&bo(e,kt)),on(e,r),n===1&&Ne===0&&!(t.mode&1)&&(za=nt()+500,jc&&Zo()))}function on(e,t){var n=e.callbackNode;HE(e,t);var r=Ol(e,e===yt?kt:0);if(r===0)n!==null&&zm(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(n!=null&&zm(n),t===1)e.tag===0?V_(Dg.bind(null,e)):$x(Dg.bind(null,e)),W_(function(){!(Ne&6)&&Zo()}),n=null;else{switch(yx(r)){case 1:n=bp;break;case 4:n=vx;break;case 16:n=Ml;break;case 536870912:n=mx;break;default:n=Ml}n=z1(n,F1.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function F1(e,t){if(Cl=-1,El=0,Ne&6)throw Error(Y(327));var n=e.callbackNode;if(va()&&e.callbackNode!==n)return null;var r=Ol(e,e===yt?kt:0);if(r===0)return null;if(r&30||r&e.expiredLanes||t)t=ec(e,r);else{t=r;var o=Ne;Ne|=2;var i=O1();(yt!==e||kt!==t)&&(zr=null,za=nt()+500,Ci(e,t));do try{dS();break}catch(s){M1(e,s)}while(!0);Fp(),Ql.current=i,Ne=o,it!==null?t=0:(yt=null,kt=0,t=ct)}if(t!==0){if(t===2&&(o=Xf(e),o!==0&&(r=o,t=Eh(e,o))),t===1)throw n=Ys,Ci(e,0),bo(e,r),on(e,nt()),n;if(t===6)bo(e,r);else{if(o=e.current.alternate,!(r&30)&&!lS(o)&&(t=ec(e,r),t===2&&(i=Xf(e),i!==0&&(r=i,t=Eh(e,i))),t===1))throw n=Ys,Ci(e,0),bo(e,r),on(e,nt()),n;switch(e.finishedWork=o,e.finishedLanes=r,t){case 0:case 1:throw Error(Y(345));case 2:si(e,Jt,zr);break;case 3:if(bo(e,r),(r&130023424)===r&&(t=Xp+500-nt(),10<t)){if(Ol(e,0)!==0)break;if(o=e.suspendedLanes,(o&r)!==r){Gt(),e.pingedLanes|=e.suspendedLanes&o;break}e.timeoutHandle=rh(si.bind(null,e,Jt,zr),t);break}si(e,Jt,zr);break;case 4:if(bo(e,r),(r&4194240)===r)break;for(t=e.eventTimes,o=-1;0<r;){var a=31-er(r);i=1<<a,a=t[a],a>o&&(o=a),r&=~i}if(r=o,r=nt()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*uS(r/1960))-r,10<r){e.timeoutHandle=rh(si.bind(null,e,Jt,zr),r);break}si(e,Jt,zr);break;case 5:si(e,Jt,zr);break;default:throw Error(Y(329))}}}return on(e,nt()),e.callbackNode===n?F1.bind(null,e):null}function Eh(e,t){var n=Ns;return e.current.memoizedState.isDehydrated&&(Ci(e,t).flags|=256),e=ec(e,t),e!==2&&(t=Jt,Jt=n,t!==null&&_h(t)),e}function _h(e){Jt===null?Jt=e:Jt.push.apply(Jt,e)}function lS(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var o=n[r],i=o.getSnapshot;o=o.value;try{if(!rr(i(),o))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function bo(e,t){for(t&=~Kp,t&=~$c,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-er(t),r=1<<n;e[n]=-1,t&=~r}}function Dg(e){if(Ne&6)throw Error(Y(327));va();var t=Ol(e,0);if(!(t&1))return on(e,nt()),null;var n=ec(e,t);if(e.tag!==0&&n===2){var r=Xf(e);r!==0&&(t=r,n=Eh(e,r))}if(n===1)throw n=Ys,Ci(e,0),bo(e,t),on(e,nt()),n;if(n===6)throw Error(Y(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,si(e,Jt,zr),on(e,nt()),null}function Yp(e,t){var n=Ne;Ne|=1;try{return e(t)}finally{Ne=n,Ne===0&&(za=nt()+500,jc&&Zo())}}function Ii(e){No!==null&&No.tag===0&&!(Ne&6)&&va();var t=Ne;Ne|=1;var n=Mn.transition,r=De;try{if(Mn.transition=null,De=1,e)return e()}finally{De=r,Mn.transition=n,Ne=t,!(Ne&6)&&Zo()}}function Qp(){fn=la.current,$e(la)}function Ci(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,j_(n)),it!==null)for(n=it.return;n!==null;){var r=n;switch(Ap(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&zl();break;case 3:ja(),$e(nn),$e(Wt),Wp();break;case 5:jp(r);break;case 4:ja();break;case 13:$e(Ge);break;case 19:$e(Ge);break;case 10:Mp(r.type._context);break;case 22:case 23:Qp()}n=n.return}if(yt=e,it=e=jo(e.current,null),kt=fn=t,ct=0,Ys=null,Kp=$c=Ni=0,Jt=Ns=null,fi!==null){for(t=0;t<fi.length;t++)if(n=fi[t],r=n.interleaved,r!==null){n.interleaved=null;var o=r.next,i=n.pending;if(i!==null){var a=i.next;i.next=o,r.next=a}n.pending=r}fi=null}return e}function M1(e,t){do{var n=it;try{if(Fp(),xl.current=Yl,Xl){for(var r=Xe.memoizedState;r!==null;){var o=r.queue;o!==null&&(o.pending=null),r=r.next}Xl=!1}if(Ri=0,gt=ut=Xe=null,ks=!1,qs=0,qp.current=null,n===null||n.return===null){ct=1,Ys=t,it=null;break}e:{var i=e,a=n.return,s=n,u=t;if(t=kt,s.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var l=u,c=s,d=c.tag;if(!(c.mode&1)&&(d===0||d===11||d===15)){var f=c.alternate;f?(c.updateQueue=f.updateQueue,c.memoizedState=f.memoizedState,c.lanes=f.lanes):(c.updateQueue=null,c.memoizedState=null)}var h=wg(a);if(h!==null){h.flags&=-257,bg(h,a,s,i,t),h.mode&1&&xg(i,l,t),t=h,u=l;var v=t.updateQueue;if(v===null){var m=new Set;m.add(u),t.updateQueue=m}else v.add(u);break e}else{if(!(t&1)){xg(i,l,t),Jp();break e}u=Error(Y(426))}}else if(He&&s.mode&1){var g=wg(a);if(g!==null){!(g.flags&65536)&&(g.flags|=256),bg(g,a,s,i,t),Pp(Wa(u,s));break e}}i=u=Wa(u,s),ct!==4&&(ct=2),Ns===null?Ns=[i]:Ns.push(i),i=a;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t;var p=y1(i,u,t);hg(i,p);break e;case 1:s=u;var y=i.type,x=i.stateNode;if(!(i.flags&128)&&(typeof y.getDerivedStateFromError=="function"||x!==null&&typeof x.componentDidCatch=="function"&&(Lo===null||!Lo.has(x)))){i.flags|=65536,t&=-t,i.lanes|=t;var w=x1(i,s,t);hg(i,w);break e}}i=i.return}while(i!==null)}B1(n)}catch(b){t=b,it===n&&n!==null&&(it=n=n.return);continue}break}while(!0)}function O1(){var e=Ql.current;return Ql.current=Yl,e===null?Yl:e}function Jp(){(ct===0||ct===3||ct===2)&&(ct=4),yt===null||!(Ni&268435455)&&!($c&268435455)||bo(yt,kt)}function ec(e,t){var n=Ne;Ne|=2;var r=O1();(yt!==e||kt!==t)&&(zr=null,Ci(e,t));do try{cS();break}catch(o){M1(e,o)}while(!0);if(Fp(),Ne=n,Ql.current=r,it!==null)throw Error(Y(261));return yt=null,kt=0,ct}function cS(){for(;it!==null;)L1(it)}function dS(){for(;it!==null&&!OE();)L1(it)}function L1(e){var t=W1(e.alternate,e,fn);e.memoizedProps=e.pendingProps,t===null?B1(e):it=t,qp.current=null}function B1(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=oS(n,t),n!==null){n.flags&=32767,it=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{ct=6,it=null;return}}else if(n=rS(n,t,fn),n!==null){it=n;return}if(t=t.sibling,t!==null){it=t;return}it=t=e}while(t!==null);ct===0&&(ct=5)}function si(e,t,n){var r=De,o=Mn.transition;try{Mn.transition=null,De=1,fS(e,t,n,r)}finally{Mn.transition=o,De=r}return null}function fS(e,t,n,r){do va();while(No!==null);if(Ne&6)throw Error(Y(327));n=e.finishedWork;var o=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(Y(177));e.callbackNode=null,e.callbackPriority=0;var i=n.lanes|n.childLanes;if(GE(e,i),e===yt&&(it=yt=null,kt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Hu||(Hu=!0,z1(Ml,function(){return va(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=Mn.transition,Mn.transition=null;var a=De;De=1;var s=Ne;Ne|=4,qp.current=null,aS(e,n),P1(n,e),P_(th),Ll=!!eh,th=eh=null,e.current=n,sS(n),LE(),Ne=s,De=a,Mn.transition=i}else e.current=n;if(Hu&&(Hu=!1,No=e,Zl=o),i=e.pendingLanes,i===0&&(Lo=null),WE(n.stateNode),on(e,nt()),t!==null)for(r=e.onRecoverableError,n=0;n<t.length;n++)o=t[n],r(o.value,{componentStack:o.stack,digest:o.digest});if(Jl)throw Jl=!1,e=bh,bh=null,e;return Zl&1&&e.tag!==0&&va(),i=e.pendingLanes,i&1?e===Ch?Is++:(Is=0,Ch=e):Is=0,Zo(),null}function va(){if(No!==null){var e=yx(Zl),t=Mn.transition,n=De;try{if(Mn.transition=null,De=16>e?16:e,No===null)var r=!1;else{if(e=No,No=null,Zl=0,Ne&6)throw Error(Y(331));var o=Ne;for(Ne|=4,ne=e.current;ne!==null;){var i=ne,a=i.child;if(ne.flags&16){var s=i.deletions;if(s!==null){for(var u=0;u<s.length;u++){var l=s[u];for(ne=l;ne!==null;){var c=ne;switch(c.tag){case 0:case 11:case 15:Rs(8,c,i)}var d=c.child;if(d!==null)d.return=c,ne=d;else for(;ne!==null;){c=ne;var f=c.sibling,h=c.return;if(I1(c),c===l){ne=null;break}if(f!==null){f.return=h,ne=f;break}ne=h}}}var v=i.alternate;if(v!==null){var m=v.child;if(m!==null){v.child=null;do{var g=m.sibling;m.sibling=null,m=g}while(m!==null)}}ne=i}}if(i.subtreeFlags&2064&&a!==null)a.return=i,ne=a;else e:for(;ne!==null;){if(i=ne,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Rs(9,i,i.return)}var p=i.sibling;if(p!==null){p.return=i.return,ne=p;break e}ne=i.return}}var y=e.current;for(ne=y;ne!==null;){a=ne;var x=a.child;if(a.subtreeFlags&2064&&x!==null)x.return=a,ne=x;else e:for(a=y;ne!==null;){if(s=ne,s.flags&2048)try{switch(s.tag){case 0:case 11:case 15:Uc(9,s)}}catch(b){tt(s,s.return,b)}if(s===a){ne=null;break e}var w=s.sibling;if(w!==null){w.return=s.return,ne=w;break e}ne=s.return}}if(Ne=o,Zo(),Er&&typeof Er.onPostCommitFiberRoot=="function")try{Er.onPostCommitFiberRoot(Fc,e)}catch{}r=!0}return r}finally{De=n,Mn.transition=t}}return!1}function Fg(e,t,n){t=Wa(n,t),t=y1(e,t,1),e=Oo(e,t,1),t=Gt(),e!==null&&(du(e,1,t),on(e,t))}function tt(e,t,n){if(e.tag===3)Fg(e,e,n);else for(;t!==null;){if(t.tag===3){Fg(t,e,n);break}else if(t.tag===1){var r=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Lo===null||!Lo.has(r))){e=Wa(n,e),e=x1(t,e,1),t=Oo(t,e,1),e=Gt(),t!==null&&(du(t,1,e),on(t,e));break}}t=t.return}}function hS(e,t,n){var r=e.pingCache;r!==null&&r.delete(t),t=Gt(),e.pingedLanes|=e.suspendedLanes&n,yt===e&&(kt&n)===n&&(ct===4||ct===3&&(kt&130023424)===kt&&500>nt()-Xp?Ci(e,0):Kp|=n),on(e,t)}function j1(e,t){t===0&&(e.mode&1?(t=Mu,Mu<<=1,!(Mu&130023424)&&(Mu=4194304)):t=1);var n=Gt();e=Yr(e,t),e!==null&&(du(e,t,n),on(e,n))}function pS(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),j1(e,n)}function vS(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,o=e.memoizedState;o!==null&&(n=o.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(Y(314))}r!==null&&r.delete(t),j1(e,n)}var W1;W1=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||nn.current)tn=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return tn=!1,nS(e,t,n);tn=!!(e.flags&131072)}else tn=!1,He&&t.flags&1048576&&Vx(t,Vl,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;bl(e,t),e=t.pendingProps;var o=Oa(t,Wt.current);pa(t,n),o=Up(null,t,r,e,o,n);var i=$p();return t.flags|=1,typeof o=="object"&&o!==null&&typeof o.render=="function"&&o.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,rn(r)?(i=!0,Ul(t)):i=!1,t.memoizedState=o.state!==null&&o.state!==void 0?o.state:null,Lp(t),o.updater=zc,t.stateNode=o,o._reactInternals=t,ch(t,r,e,n),t=hh(null,t,r,!0,i,n)):(t.tag=0,He&&i&&Tp(t),Vt(null,t,o,n),t=t.child),t;case 16:r=t.elementType;e:{switch(bl(e,t),e=t.pendingProps,o=r._init,r=o(r._payload),t.type=r,o=t.tag=gS(r),e=Gn(r,e),o){case 0:t=fh(null,t,r,e,n);break e;case 1:t=_g(null,t,r,e,n);break e;case 11:t=Cg(null,t,r,e,n);break e;case 14:t=Eg(null,t,r,Gn(r.type,e),n);break e}throw Error(Y(306,r,""))}return t;case 0:return r=t.type,o=t.pendingProps,o=t.elementType===r?o:Gn(r,o),fh(e,t,r,o,n);case 1:return r=t.type,o=t.pendingProps,o=t.elementType===r?o:Gn(r,o),_g(e,t,r,o,n);case 3:e:{if(E1(t),e===null)throw Error(Y(387));r=t.pendingProps,i=t.memoizedState,o=i.element,Yx(e,t),ql(t,r,null,n);var a=t.memoizedState;if(r=a.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},t.updateQueue.baseState=i,t.memoizedState=i,t.flags&256){o=Wa(Error(Y(423)),t),t=Sg(e,t,r,n,o);break e}else if(r!==o){o=Wa(Error(Y(424)),t),t=Sg(e,t,r,n,o);break e}else for(mn=Mo(t.stateNode.containerInfo.firstChild),wn=t,He=!0,Qn=null,n=Kx(t,null,r,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(La(),r===o){t=Qr(e,t,n);break e}Vt(e,t,r,n)}t=t.child}return t;case 5:return Qx(t),e===null&&sh(t),r=t.type,o=t.pendingProps,i=e!==null?e.memoizedProps:null,a=o.children,nh(r,o)?a=null:i!==null&&nh(r,i)&&(t.flags|=32),C1(e,t),Vt(e,t,a,n),t.child;case 6:return e===null&&sh(t),null;case 13:return _1(e,t,n);case 4:return Bp(t,t.stateNode.containerInfo),r=t.pendingProps,e===null?t.child=Ba(t,null,r,n):Vt(e,t,r,n),t.child;case 11:return r=t.type,o=t.pendingProps,o=t.elementType===r?o:Gn(r,o),Cg(e,t,r,o,n);case 7:return Vt(e,t,t.pendingProps,n),t.child;case 8:return Vt(e,t,t.pendingProps.children,n),t.child;case 12:return Vt(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,o=t.pendingProps,i=t.memoizedProps,a=o.value,Be(Hl,r._currentValue),r._currentValue=a,i!==null)if(rr(i.value,a)){if(i.children===o.children&&!nn.current){t=Qr(e,t,n);break e}}else for(i=t.child,i!==null&&(i.return=t);i!==null;){var s=i.dependencies;if(s!==null){a=i.child;for(var u=s.firstContext;u!==null;){if(u.context===r){if(i.tag===1){u=qr(-1,n&-n),u.tag=2;var l=i.updateQueue;if(l!==null){l=l.shared;var c=l.pending;c===null?u.next=u:(u.next=c.next,c.next=u),l.pending=u}}i.lanes|=n,u=i.alternate,u!==null&&(u.lanes|=n),uh(i.return,n,t),s.lanes|=n;break}u=u.next}}else if(i.tag===10)a=i.type===t.type?null:i.child;else if(i.tag===18){if(a=i.return,a===null)throw Error(Y(341));a.lanes|=n,s=a.alternate,s!==null&&(s.lanes|=n),uh(a,n,t),a=i.sibling}else a=i.child;if(a!==null)a.return=i;else for(a=i;a!==null;){if(a===t){a=null;break}if(i=a.sibling,i!==null){i.return=a.return,a=i;break}a=a.return}i=a}Vt(e,t,o.children,n),t=t.child}return t;case 9:return o=t.type,r=t.pendingProps.children,pa(t,n),o=On(o),r=r(o),t.flags|=1,Vt(e,t,r,n),t.child;case 14:return r=t.type,o=Gn(r,t.pendingProps),o=Gn(r.type,o),Eg(e,t,r,o,n);case 15:return w1(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,o=t.pendingProps,o=t.elementType===r?o:Gn(r,o),bl(e,t),t.tag=1,rn(r)?(e=!0,Ul(t)):e=!1,pa(t,n),g1(t,r,o),ch(t,r,o,n),hh(null,t,r,!0,e,n);case 19:return S1(e,t,n);case 22:return b1(e,t,n)}throw Error(Y(156,t.tag))};function z1(e,t){return px(e,t)}function mS(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Pn(e,t,n,r){return new mS(e,t,n,r)}function Zp(e){return e=e.prototype,!(!e||!e.isReactComponent)}function gS(e){if(typeof e=="function")return Zp(e)?1:0;if(e!=null){if(e=e.$$typeof,e===yp)return 11;if(e===xp)return 14}return 2}function jo(e,t){var n=e.alternate;return n===null?(n=Pn(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function _l(e,t,n,r,o,i){var a=2;if(r=e,typeof e=="function")Zp(e)&&(a=1);else if(typeof e=="string")a=5;else e:switch(e){case Zi:return Ei(n.children,o,i,t);case gp:a=8,o|=8;break;case Ff:return e=Pn(12,n,t,o|2),e.elementType=Ff,e.lanes=i,e;case Mf:return e=Pn(13,n,t,o),e.elementType=Mf,e.lanes=i,e;case Of:return e=Pn(19,n,t,o),e.elementType=Of,e.lanes=i,e;case Q0:return Vc(n,o,i,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case X0:a=10;break e;case Y0:a=9;break e;case yp:a=11;break e;case xp:a=14;break e;case yo:a=16,r=null;break e}throw Error(Y(130,e==null?e:typeof e,""))}return t=Pn(a,n,t,o),t.elementType=e,t.type=r,t.lanes=i,t}function Ei(e,t,n,r){return e=Pn(7,e,r,t),e.lanes=n,e}function Vc(e,t,n,r){return e=Pn(22,e,r,t),e.elementType=Q0,e.lanes=n,e.stateNode={isHidden:!1},e}function Yd(e,t,n){return e=Pn(6,e,null,t),e.lanes=n,e}function Qd(e,t,n){return t=Pn(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function yS(e,t,n,r,o){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Ad(0),this.expirationTimes=Ad(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ad(0),this.identifierPrefix=r,this.onRecoverableError=o,this.mutableSourceEagerHydrationData=null}function ev(e,t,n,r,o,i,a,s,u){return e=new yS(e,t,n,s,u),t===1?(t=1,i===!0&&(t|=8)):t=0,i=Pn(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Lp(i),e}function xS(e,t,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Ji,key:r==null?null:""+r,children:e,containerInfo:t,implementation:n}}function U1(e){if(!e)return Vo;e=e._reactInternals;e:{if(Fi(e)!==e||e.tag!==1)throw Error(Y(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(rn(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(Y(171))}if(e.tag===1){var n=e.type;if(rn(n))return Ux(e,n,t)}return t}function $1(e,t,n,r,o,i,a,s,u){return e=ev(n,r,!0,e,o,i,a,s,u),e.context=U1(null),n=e.current,r=Gt(),o=Bo(n),i=qr(r,o),i.callback=t??null,Oo(n,i,o),e.current.lanes=o,du(e,o,r),on(e,r),e}function Hc(e,t,n,r){var o=t.current,i=Gt(),a=Bo(o);return n=U1(n),t.context===null?t.context=n:t.pendingContext=n,t=qr(i,a),t.payload={element:e},r=r===void 0?null:r,r!==null&&(t.callback=r),e=Oo(o,t,a),e!==null&&(tr(e,o,a,i),yl(e,o,a)),a}function tc(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Mg(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function tv(e,t){Mg(e,t),(e=e.alternate)&&Mg(e,t)}function wS(){return null}var V1=typeof reportError=="function"?reportError:function(e){console.error(e)};function nv(e){this._internalRoot=e}Gc.prototype.render=nv.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(Y(409));Hc(e,t,null,null)};Gc.prototype.unmount=nv.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Ii(function(){Hc(null,e,null,null)}),t[Xr]=null}};function Gc(e){this._internalRoot=e}Gc.prototype.unstable_scheduleHydration=function(e){if(e){var t=bx();e={blockedOn:null,target:e,priority:t};for(var n=0;n<wo.length&&t!==0&&t<wo[n].priority;n++);wo.splice(n,0,e),n===0&&Ex(e)}};function rv(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function qc(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Og(){}function bS(e,t,n,r,o){if(o){if(typeof r=="function"){var i=r;r=function(){var l=tc(a);i.call(l)}}var a=$1(t,r,e,0,null,!1,!1,"",Og);return e._reactRootContainer=a,e[Xr]=a.current,Us(e.nodeType===8?e.parentNode:e),Ii(),a}for(;o=e.lastChild;)e.removeChild(o);if(typeof r=="function"){var s=r;r=function(){var l=tc(u);s.call(l)}}var u=ev(e,0,!1,null,null,!1,!1,"",Og);return e._reactRootContainer=u,e[Xr]=u.current,Us(e.nodeType===8?e.parentNode:e),Ii(function(){Hc(t,u,n,r)}),u}function Kc(e,t,n,r,o){var i=n._reactRootContainer;if(i){var a=i;if(typeof o=="function"){var s=o;o=function(){var u=tc(a);s.call(u)}}Hc(t,a,e,o)}else a=bS(n,t,e,o,r);return tc(a)}xx=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=xs(t.pendingLanes);n!==0&&(Cp(t,n|1),on(t,nt()),!(Ne&6)&&(za=nt()+500,Zo()))}break;case 13:Ii(function(){var r=Yr(e,1);if(r!==null){var o=Gt();tr(r,e,1,o)}}),tv(e,1)}};Ep=function(e){if(e.tag===13){var t=Yr(e,134217728);if(t!==null){var n=Gt();tr(t,e,134217728,n)}tv(e,134217728)}};wx=function(e){if(e.tag===13){var t=Bo(e),n=Yr(e,t);if(n!==null){var r=Gt();tr(n,e,t,r)}tv(e,t)}};bx=function(){return De};Cx=function(e,t){var n=De;try{return De=e,t()}finally{De=n}};Gf=function(e,t,n){switch(t){case"input":if(jf(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var o=Bc(r);if(!o)throw Error(Y(90));Z0(r),jf(r,o)}}}break;case"textarea":tx(e,n);break;case"select":t=n.value,t!=null&&ca(e,!!n.multiple,t,!1)}};ux=Yp;lx=Ii;var CS={usingClientEntryPoint:!1,Events:[hu,ra,Bc,ax,sx,Yp]},cs={findFiberByHostInstance:di,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},ES={bundleType:cs.bundleType,version:cs.version,rendererPackageName:cs.rendererPackageName,rendererConfig:cs.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:eo.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=fx(e),e===null?null:e.stateNode},findFiberByHostInstance:cs.findFiberByHostInstance||wS,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Gu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Gu.isDisabled&&Gu.supportsFiber)try{Fc=Gu.inject(ES),Er=Gu}catch{}}_n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=CS;_n.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!rv(t))throw Error(Y(200));return xS(e,t,null,n)};_n.createRoot=function(e,t){if(!rv(e))throw Error(Y(299));var n=!1,r="",o=V1;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(o=t.onRecoverableError)),t=ev(e,1,!1,null,null,n,!1,r,o),e[Xr]=t.current,Us(e.nodeType===8?e.parentNode:e),new nv(t)};_n.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(Y(188)):(e=Object.keys(e).join(","),Error(Y(268,e)));return e=fx(t),e=e===null?null:e.stateNode,e};_n.flushSync=function(e){return Ii(e)};_n.hydrate=function(e,t,n){if(!qc(t))throw Error(Y(200));return Kc(null,e,t,!0,n)};_n.hydrateRoot=function(e,t,n){if(!rv(e))throw Error(Y(405));var r=n!=null&&n.hydratedSources||null,o=!1,i="",a=V1;if(n!=null&&(n.unstable_strictMode===!0&&(o=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(a=n.onRecoverableError)),t=$1(t,null,e,1,n??null,o,!1,i,a),e[Xr]=t.current,Us(e),r)for(e=0;e<r.length;e++)n=r[e],o=n._getVersion,o=o(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,o]:t.mutableSourceEagerHydrationData.push(n,o);return new Gc(t)};_n.render=function(e,t,n){if(!qc(t))throw Error(Y(200));return Kc(null,e,t,!1,n)};_n.unmountComponentAtNode=function(e){if(!qc(e))throw Error(Y(40));return e._reactRootContainer?(Ii(function(){Kc(null,null,e,!1,function(){e._reactRootContainer=null,e[Xr]=null})}),!0):!1};_n.unstable_batchedUpdates=Yp;_n.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!qc(n))throw Error(Y(200));if(e==null||e._reactInternals===void 0)throw Error(Y(38));return Kc(e,t,n,!1,r)};_n.version="18.3.1-next-f1338f8080-20240426";function H1(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(H1)}catch(e){console.error(e)}}H1(),H0.exports=_n;var vu=H0.exports;const G1=P0(vu);var q1,Lg=vu;q1=Lg.createRoot,Lg.hydrateRoot;const _S=1,SS=1e6;let Jd=0;function kS(){return Jd=(Jd+1)%Number.MAX_SAFE_INTEGER,Jd.toString()}const Zd=new Map,Bg=e=>{if(Zd.has(e))return;const t=setTimeout(()=>{Zd.delete(e),Ts({type:"REMOVE_TOAST",toastId:e})},SS);Zd.set(e,t)},RS=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,_S)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(n=>n.id===t.toast.id?{...n,...t.toast}:n)};case"DISMISS_TOAST":{const{toastId:n}=t;return n?Bg(n):e.toasts.forEach(r=>{Bg(r.id)}),{...e,toasts:e.toasts.map(r=>r.id===n||n===void 0?{...r,open:!1}:r)}}case"REMOVE_TOAST":return t.toastId===void 0?{...e,toasts:[]}:{...e,toasts:e.toasts.filter(n=>n.id!==t.toastId)}}},Sl=[];let kl={toasts:[]};function Ts(e){kl=RS(kl,e),Sl.forEach(t=>{t(kl)})}function NS({...e}){const t=kS(),n=o=>Ts({type:"UPDATE_TOAST",toast:{...o,id:t}}),r=()=>Ts({type:"DISMISS_TOAST",toastId:t});return Ts({type:"ADD_TOAST",toast:{...e,id:t,open:!0,onOpenChange:o=>{o||r()}}}),{id:t,dismiss:r,update:n}}function IS(){const[e,t]=A.useState(kl);return A.useEffect(()=>(Sl.push(t),()=>{const n=Sl.indexOf(t);n>-1&&Sl.splice(n,1)}),[e]),{...e,toast:NS,dismiss:n=>Ts({type:"DISMISS_TOAST",toastId:n})}}function lt(e,t,{checkForDefaultPrevented:n=!0}={}){return function(o){if(e==null||e(o),n===!1||!o.defaultPrevented)return t==null?void 0:t(o)}}function jg(e,t){if(typeof e=="function")return e(t);e!=null&&(e.current=t)}function K1(...e){return t=>{let n=!1;const r=e.map(o=>{const i=jg(o,t);return!n&&typeof i=="function"&&(n=!0),i});if(n)return()=>{for(let o=0;o<r.length;o++){const i=r[o];typeof i=="function"?i():jg(e[o],null)}}}}function or(...e){return A.useCallback(K1(...e),e)}function Xc(e,t=[]){let n=[];function r(i,a){const s=A.createContext(a),u=n.length;n=[...n,a];const l=d=>{var p;const{scope:f,children:h,...v}=d,m=((p=f==null?void 0:f[e])==null?void 0:p[u])||s,g=A.useMemo(()=>v,Object.values(v));return _.jsx(m.Provider,{value:g,children:h})};l.displayName=i+"Provider";function c(d,f){var m;const h=((m=f==null?void 0:f[e])==null?void 0:m[u])||s,v=A.useContext(h);if(v)return v;if(a!==void 0)return a;throw new Error(`\`${d}\` must be used within \`${i}\``)}return[l,c]}const o=()=>{const i=n.map(a=>A.createContext(a));return function(s){const u=(s==null?void 0:s[e])||i;return A.useMemo(()=>({[`__scope${e}`]:{...s,[e]:u}}),[s,u])}};return o.scopeName=e,[r,TS(o,...t)]}function TS(...e){const t=e[0];if(e.length===1)return t;const n=()=>{const r=e.map(o=>({useScope:o(),scopeName:o.scopeName}));return function(i){const a=r.reduce((s,{useScope:u,scopeName:l})=>{const d=u(i)[`__scope${l}`];return{...s,...d}},{});return A.useMemo(()=>({[`__scope${t.scopeName}`]:a}),[a])}};return n.scopeName=t.scopeName,n}function nc(e){const t=PS(e),n=A.forwardRef((r,o)=>{const{children:i,...a}=r,s=A.Children.toArray(i),u=s.find(FS);if(u){const l=u.props.children,c=s.map(d=>d===u?A.Children.count(l)>1?A.Children.only(null):A.isValidElement(l)?l.props.children:null:d);return _.jsx(t,{...a,ref:o,children:A.isValidElement(l)?A.cloneElement(l,void 0,c):null})}return _.jsx(t,{...a,ref:o,children:i})});return n.displayName=`${e}.Slot`,n}var AS=nc("Slot");function PS(e){const t=A.forwardRef((n,r)=>{const{children:o,...i}=n;if(A.isValidElement(o)){const a=OS(o),s=MS(i,o.props);return o.type!==A.Fragment&&(s.ref=r?K1(r,a):a),A.cloneElement(o,s)}return A.Children.count(o)>1?A.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var X1=Symbol("radix.slottable");function DS(e){const t=({children:n})=>_.jsx(_.Fragment,{children:n});return t.displayName=`${e}.Slottable`,t.__radixId=X1,t}function FS(e){return A.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===X1}function MS(e,t){const n={...t};for(const r in t){const o=e[r],i=t[r];/^on[A-Z]/.test(r)?o&&i?n[r]=(...s)=>{const u=i(...s);return o(...s),u}:o&&(n[r]=o):r==="style"?n[r]={...o,...i}:r==="className"&&(n[r]=[o,i].filter(Boolean).join(" "))}return{...e,...n}}function OS(e){var r,o;let t=(r=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:r.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=(o=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:o.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}function LS(e){const t=e+"CollectionProvider",[n,r]=Xc(t),[o,i]=n(t,{collectionRef:{current:null},itemMap:new Map}),a=m=>{const{scope:g,children:p}=m,y=J.useRef(null),x=J.useRef(new Map).current;return _.jsx(o,{scope:g,itemMap:x,collectionRef:y,children:p})};a.displayName=t;const s=e+"CollectionSlot",u=nc(s),l=J.forwardRef((m,g)=>{const{scope:p,children:y}=m,x=i(s,p),w=or(g,x.collectionRef);return _.jsx(u,{ref:w,children:y})});l.displayName=s;const c=e+"CollectionItemSlot",d="data-radix-collection-item",f=nc(c),h=J.forwardRef((m,g)=>{const{scope:p,children:y,...x}=m,w=J.useRef(null),b=or(g,w),C=i(c,p);return J.useEffect(()=>(C.itemMap.set(w,{ref:w,...x}),()=>void C.itemMap.delete(w))),_.jsx(f,{[d]:"",ref:b,children:y})});h.displayName=c;function v(m){const g=i(e+"CollectionConsumer",m);return J.useCallback(()=>{const y=g.collectionRef.current;if(!y)return[];const x=Array.from(y.querySelectorAll(`[${d}]`));return Array.from(g.itemMap.values()).sort((C,E)=>x.indexOf(C.ref.current)-x.indexOf(E.ref.current))},[g.collectionRef,g.itemMap])}return[{Provider:a,Slot:l,ItemSlot:h},v,r]}var BS=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],cn=BS.reduce((e,t)=>{const n=nc(`Primitive.${t}`),r=A.forwardRef((o,i)=>{const{asChild:a,...s}=o,u=a?n:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),_.jsx(u,{...s,ref:i})});return r.displayName=`Primitive.${t}`,{...e,[t]:r}},{});function Y1(e,t){e&&vu.flushSync(()=>e.dispatchEvent(t))}function Ho(e){const t=A.useRef(e);return A.useEffect(()=>{t.current=e}),A.useMemo(()=>(...n)=>{var r;return(r=t.current)==null?void 0:r.call(t,...n)},[])}function jS(e,t=globalThis==null?void 0:globalThis.document){const n=Ho(e);A.useEffect(()=>{const r=o=>{o.key==="Escape"&&n(o)};return t.addEventListener("keydown",r,{capture:!0}),()=>t.removeEventListener("keydown",r,{capture:!0})},[n,t])}var WS="DismissableLayer",Sh="dismissableLayer.update",zS="dismissableLayer.pointerDownOutside",US="dismissableLayer.focusOutside",Wg,Q1=A.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),ov=A.forwardRef((e,t)=>{const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:r,onPointerDownOutside:o,onFocusOutside:i,onInteractOutside:a,onDismiss:s,...u}=e,l=A.useContext(Q1),[c,d]=A.useState(null),f=(c==null?void 0:c.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,h]=A.useState({}),v=or(t,E=>d(E)),m=Array.from(l.layers),[g]=[...l.layersWithOutsidePointerEventsDisabled].slice(-1),p=m.indexOf(g),y=c?m.indexOf(c):-1,x=l.layersWithOutsidePointerEventsDisabled.size>0,w=y>=p,b=VS(E=>{const S=E.target,R=[...l.branches].some(k=>k.contains(S));!w||R||(o==null||o(E),a==null||a(E),E.defaultPrevented||s==null||s())},f),C=HS(E=>{const S=E.target;[...l.branches].some(k=>k.contains(S))||(i==null||i(E),a==null||a(E),E.defaultPrevented||s==null||s())},f);return jS(E=>{y===l.layers.size-1&&(r==null||r(E),!E.defaultPrevented&&s&&(E.preventDefault(),s()))},f),A.useEffect(()=>{if(c)return n&&(l.layersWithOutsidePointerEventsDisabled.size===0&&(Wg=f.body.style.pointerEvents,f.body.style.pointerEvents="none"),l.layersWithOutsidePointerEventsDisabled.add(c)),l.layers.add(c),zg(),()=>{n&&l.layersWithOutsidePointerEventsDisabled.size===1&&(f.body.style.pointerEvents=Wg)}},[c,f,n,l]),A.useEffect(()=>()=>{c&&(l.layers.delete(c),l.layersWithOutsidePointerEventsDisabled.delete(c),zg())},[c,l]),A.useEffect(()=>{const E=()=>h({});return document.addEventListener(Sh,E),()=>document.removeEventListener(Sh,E)},[]),_.jsx(cn.div,{...u,ref:v,style:{pointerEvents:x?w?"auto":"none":void 0,...e.style},onFocusCapture:lt(e.onFocusCapture,C.onFocusCapture),onBlurCapture:lt(e.onBlurCapture,C.onBlurCapture),onPointerDownCapture:lt(e.onPointerDownCapture,b.onPointerDownCapture)})});ov.displayName=WS;var $S="DismissableLayerBranch",J1=A.forwardRef((e,t)=>{const n=A.useContext(Q1),r=A.useRef(null),o=or(t,r);return A.useEffect(()=>{const i=r.current;if(i)return n.branches.add(i),()=>{n.branches.delete(i)}},[n.branches]),_.jsx(cn.div,{...e,ref:o})});J1.displayName=$S;function VS(e,t=globalThis==null?void 0:globalThis.document){const n=Ho(e),r=A.useRef(!1),o=A.useRef(()=>{});return A.useEffect(()=>{const i=s=>{if(s.target&&!r.current){let u=function(){Z1(zS,n,l,{discrete:!0})};const l={originalEvent:s};s.pointerType==="touch"?(t.removeEventListener("click",o.current),o.current=u,t.addEventListener("click",o.current,{once:!0})):u()}else t.removeEventListener("click",o.current);r.current=!1},a=window.setTimeout(()=>{t.addEventListener("pointerdown",i)},0);return()=>{window.clearTimeout(a),t.removeEventListener("pointerdown",i),t.removeEventListener("click",o.current)}},[t,n]),{onPointerDownCapture:()=>r.current=!0}}function HS(e,t=globalThis==null?void 0:globalThis.document){const n=Ho(e),r=A.useRef(!1);return A.useEffect(()=>{const o=i=>{i.target&&!r.current&&Z1(US,n,{originalEvent:i},{discrete:!1})};return t.addEventListener("focusin",o),()=>t.removeEventListener("focusin",o)},[t,n]),{onFocusCapture:()=>r.current=!0,onBlurCapture:()=>r.current=!1}}function zg(){const e=new CustomEvent(Sh);document.dispatchEvent(e)}function Z1(e,t,n,{discrete:r}){const o=n.originalEvent.target,i=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:n});t&&o.addEventListener(e,t,{once:!0}),r?Y1(o,i):o.dispatchEvent(i)}var GS=ov,qS=J1,Go=globalThis!=null&&globalThis.document?A.useLayoutEffect:()=>{},KS="Portal",ew=A.forwardRef((e,t)=>{var s;const{container:n,...r}=e,[o,i]=A.useState(!1);Go(()=>i(!0),[]);const a=n||o&&((s=globalThis==null?void 0:globalThis.document)==null?void 0:s.body);return a?G1.createPortal(_.jsx(cn.div,{...r,ref:t}),a):null});ew.displayName=KS;function XS(e,t){return A.useReducer((n,r)=>t[n][r]??n,e)}var iv=e=>{const{present:t,children:n}=e,r=YS(t),o=typeof n=="function"?n({present:r.isPresent}):A.Children.only(n),i=or(r.ref,QS(o));return typeof n=="function"||r.isPresent?A.cloneElement(o,{ref:i}):null};iv.displayName="Presence";function YS(e){const[t,n]=A.useState(),r=A.useRef(null),o=A.useRef(e),i=A.useRef("none"),a=e?"mounted":"unmounted",[s,u]=XS(a,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return A.useEffect(()=>{const l=qu(r.current);i.current=s==="mounted"?l:"none"},[s]),Go(()=>{const l=r.current,c=o.current;if(c!==e){const f=i.current,h=qu(l);e?u("MOUNT"):h==="none"||(l==null?void 0:l.display)==="none"?u("UNMOUNT"):u(c&&f!==h?"ANIMATION_OUT":"UNMOUNT"),o.current=e}},[e,u]),Go(()=>{if(t){let l;const c=t.ownerDocument.defaultView??window,d=h=>{const m=qu(r.current).includes(h.animationName);if(h.target===t&&m&&(u("ANIMATION_END"),!o.current)){const g=t.style.animationFillMode;t.style.animationFillMode="forwards",l=c.setTimeout(()=>{t.style.animationFillMode==="forwards"&&(t.style.animationFillMode=g)})}},f=h=>{h.target===t&&(i.current=qu(r.current))};return t.addEventListener("animationstart",f),t.addEventListener("animationcancel",d),t.addEventListener("animationend",d),()=>{c.clearTimeout(l),t.removeEventListener("animationstart",f),t.removeEventListener("animationcancel",d),t.removeEventListener("animationend",d)}}else u("ANIMATION_END")},[t,u]),{isPresent:["mounted","unmountSuspended"].includes(s),ref:A.useCallback(l=>{r.current=l?getComputedStyle(l):null,n(l)},[])}}function qu(e){return(e==null?void 0:e.animationName)||"none"}function QS(e){var r,o;let t=(r=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:r.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=(o=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:o.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}var JS=$0[" useInsertionEffect ".trim().toString()]||Go;function ZS({prop:e,defaultProp:t,onChange:n=()=>{},caller:r}){const[o,i,a]=ek({defaultProp:t,onChange:n}),s=e!==void 0,u=s?e:o;{const c=A.useRef(e!==void 0);A.useEffect(()=>{const d=c.current;d!==s&&console.warn(`${r} is changing from ${d?"controlled":"uncontrolled"} to ${s?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),c.current=s},[s,r])}const l=A.useCallback(c=>{var d;if(s){const f=tk(c)?c(e):c;f!==e&&((d=a.current)==null||d.call(a,f))}else i(c)},[s,e,i,a]);return[u,l]}function ek({defaultProp:e,onChange:t}){const[n,r]=A.useState(e),o=A.useRef(n),i=A.useRef(t);return JS(()=>{i.current=t},[t]),A.useEffect(()=>{var a;o.current!==n&&((a=i.current)==null||a.call(i,n),o.current=n)},[n,o]),[n,r,i]}function tk(e){return typeof e=="function"}var nk=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),rk="VisuallyHidden",Yc=A.forwardRef((e,t)=>_.jsx(cn.span,{...e,ref:t,style:{...nk,...e.style}}));Yc.displayName=rk;var ok=Yc,av="ToastProvider",[sv,ik,ak]=LS("Toast"),[tw,CL]=Xc("Toast",[ak]),[sk,Qc]=tw(av),nw=e=>{const{__scopeToast:t,label:n="Notification",duration:r=5e3,swipeDirection:o="right",swipeThreshold:i=50,children:a}=e,[s,u]=A.useState(null),[l,c]=A.useState(0),d=A.useRef(!1),f=A.useRef(!1);return n.trim()||console.error(`Invalid prop \`label\` supplied to \`${av}\`. Expected non-empty \`string\`.`),_.jsx(sv.Provider,{scope:t,children:_.jsx(sk,{scope:t,label:n,duration:r,swipeDirection:o,swipeThreshold:i,toastCount:l,viewport:s,onViewportChange:u,onToastAdd:A.useCallback(()=>c(h=>h+1),[]),onToastRemove:A.useCallback(()=>c(h=>h-1),[]),isFocusedToastEscapeKeyDownRef:d,isClosePausedRef:f,children:a})})};nw.displayName=av;var rw="ToastViewport",uk=["F8"],kh="toast.viewportPause",Rh="toast.viewportResume",ow=A.forwardRef((e,t)=>{const{__scopeToast:n,hotkey:r=uk,label:o="Notifications ({hotkey})",...i}=e,a=Qc(rw,n),s=ik(n),u=A.useRef(null),l=A.useRef(null),c=A.useRef(null),d=A.useRef(null),f=or(t,d,a.onViewportChange),h=r.join("+").replace(/Key/g,"").replace(/Digit/g,""),v=a.toastCount>0;A.useEffect(()=>{const g=p=>{var x;r.length!==0&&r.every(w=>p[w]||p.code===w)&&((x=d.current)==null||x.focus())};return document.addEventListener("keydown",g),()=>document.removeEventListener("keydown",g)},[r]),A.useEffect(()=>{const g=u.current,p=d.current;if(v&&g&&p){const y=()=>{if(!a.isClosePausedRef.current){const C=new CustomEvent(kh);p.dispatchEvent(C),a.isClosePausedRef.current=!0}},x=()=>{if(a.isClosePausedRef.current){const C=new CustomEvent(Rh);p.dispatchEvent(C),a.isClosePausedRef.current=!1}},w=C=>{!g.contains(C.relatedTarget)&&x()},b=()=>{g.contains(document.activeElement)||x()};return g.addEventListener("focusin",y),g.addEventListener("focusout",w),g.addEventListener("pointermove",y),g.addEventListener("pointerleave",b),window.addEventListener("blur",y),window.addEventListener("focus",x),()=>{g.removeEventListener("focusin",y),g.removeEventListener("focusout",w),g.removeEventListener("pointermove",y),g.removeEventListener("pointerleave",b),window.removeEventListener("blur",y),window.removeEventListener("focus",x)}}},[v,a.isClosePausedRef]);const m=A.useCallback(({tabbingDirection:g})=>{const y=s().map(x=>{const w=x.ref.current,b=[w,...bk(w)];return g==="forwards"?b:b.reverse()});return(g==="forwards"?y.reverse():y).flat()},[s]);return A.useEffect(()=>{const g=d.current;if(g){const p=y=>{var b,C,E;const x=y.altKey||y.ctrlKey||y.metaKey;if(y.key==="Tab"&&!x){const S=document.activeElement,R=y.shiftKey;if(y.target===g&&R){(b=l.current)==null||b.focus();return}const T=m({tabbingDirection:R?"backwards":"forwards"}),j=T.findIndex(O=>O===S);ef(T.slice(j+1))?y.preventDefault():R?(C=l.current)==null||C.focus():(E=c.current)==null||E.focus()}};return g.addEventListener("keydown",p),()=>g.removeEventListener("keydown",p)}},[s,m]),_.jsxs(qS,{ref:u,role:"region","aria-label":o.replace("{hotkey}",h),tabIndex:-1,style:{pointerEvents:v?void 0:"none"},children:[v&&_.jsx(Nh,{ref:l,onFocusFromOutsideViewport:()=>{const g=m({tabbingDirection:"forwards"});ef(g)}}),_.jsx(sv.Slot,{scope:n,children:_.jsx(cn.ol,{tabIndex:-1,...i,ref:f})}),v&&_.jsx(Nh,{ref:c,onFocusFromOutsideViewport:()=>{const g=m({tabbingDirection:"backwards"});ef(g)}})]})});ow.displayName=rw;var iw="ToastFocusProxy",Nh=A.forwardRef((e,t)=>{const{__scopeToast:n,onFocusFromOutsideViewport:r,...o}=e,i=Qc(iw,n);return _.jsx(Yc,{"aria-hidden":!0,tabIndex:0,...o,ref:t,style:{position:"fixed"},onFocus:a=>{var l;const s=a.relatedTarget;!((l=i.viewport)!=null&&l.contains(s))&&r()}})});Nh.displayName=iw;var mu="Toast",lk="toast.swipeStart",ck="toast.swipeMove",dk="toast.swipeCancel",fk="toast.swipeEnd",aw=A.forwardRef((e,t)=>{const{forceMount:n,open:r,defaultOpen:o,onOpenChange:i,...a}=e,[s,u]=ZS({prop:r,defaultProp:o??!0,onChange:i,caller:mu});return _.jsx(iv,{present:n||s,children:_.jsx(vk,{open:s,...a,ref:t,onClose:()=>u(!1),onPause:Ho(e.onPause),onResume:Ho(e.onResume),onSwipeStart:lt(e.onSwipeStart,l=>{l.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:lt(e.onSwipeMove,l=>{const{x:c,y:d}=l.detail.delta;l.currentTarget.setAttribute("data-swipe","move"),l.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${c}px`),l.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${d}px`)}),onSwipeCancel:lt(e.onSwipeCancel,l=>{l.currentTarget.setAttribute("data-swipe","cancel"),l.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),l.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),l.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),l.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:lt(e.onSwipeEnd,l=>{const{x:c,y:d}=l.detail.delta;l.currentTarget.setAttribute("data-swipe","end"),l.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),l.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),l.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${c}px`),l.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${d}px`),u(!1)})})})});aw.displayName=mu;var[hk,pk]=tw(mu,{onClose(){}}),vk=A.forwardRef((e,t)=>{const{__scopeToast:n,type:r="foreground",duration:o,open:i,onClose:a,onEscapeKeyDown:s,onPause:u,onResume:l,onSwipeStart:c,onSwipeMove:d,onSwipeCancel:f,onSwipeEnd:h,...v}=e,m=Qc(mu,n),[g,p]=A.useState(null),y=or(t,O=>p(O)),x=A.useRef(null),w=A.useRef(null),b=o||m.duration,C=A.useRef(0),E=A.useRef(b),S=A.useRef(0),{onToastAdd:R,onToastRemove:k}=m,P=Ho(()=>{var W;(g==null?void 0:g.contains(document.activeElement))&&((W=m.viewport)==null||W.focus()),a()}),T=A.useCallback(O=>{!O||O===1/0||(window.clearTimeout(S.current),C.current=new Date().getTime(),S.current=window.setTimeout(P,O))},[P]);A.useEffect(()=>{const O=m.viewport;if(O){const W=()=>{T(E.current),l==null||l()},U=()=>{const z=new Date().getTime()-C.current;E.current=E.current-z,window.clearTimeout(S.current),u==null||u()};return O.addEventListener(kh,U),O.addEventListener(Rh,W),()=>{O.removeEventListener(kh,U),O.removeEventListener(Rh,W)}}},[m.viewport,b,u,l,T]),A.useEffect(()=>{i&&!m.isClosePausedRef.current&&T(b)},[i,b,m.isClosePausedRef,T]),A.useEffect(()=>(R(),()=>k()),[R,k]);const j=A.useMemo(()=>g?hw(g):null,[g]);return m.viewport?_.jsxs(_.Fragment,{children:[j&&_.jsx(mk,{__scopeToast:n,role:"status","aria-live":r==="foreground"?"assertive":"polite","aria-atomic":!0,children:j}),_.jsx(hk,{scope:n,onClose:P,children:vu.createPortal(_.jsx(sv.ItemSlot,{scope:n,children:_.jsx(GS,{asChild:!0,onEscapeKeyDown:lt(s,()=>{m.isFocusedToastEscapeKeyDownRef.current||P(),m.isFocusedToastEscapeKeyDownRef.current=!1}),children:_.jsx(cn.li,{role:"status","aria-live":"off","aria-atomic":!0,tabIndex:0,"data-state":i?"open":"closed","data-swipe-direction":m.swipeDirection,...v,ref:y,style:{userSelect:"none",touchAction:"none",...e.style},onKeyDown:lt(e.onKeyDown,O=>{O.key==="Escape"&&(s==null||s(O.nativeEvent),O.nativeEvent.defaultPrevented||(m.isFocusedToastEscapeKeyDownRef.current=!0,P()))}),onPointerDown:lt(e.onPointerDown,O=>{O.button===0&&(x.current={x:O.clientX,y:O.clientY})}),onPointerMove:lt(e.onPointerMove,O=>{if(!x.current)return;const W=O.clientX-x.current.x,U=O.clientY-x.current.y,z=!!w.current,D=["left","right"].includes(m.swipeDirection),M=["left","up"].includes(m.swipeDirection)?Math.min:Math.max,B=D?M(0,W):0,q=D?0:M(0,U),K=O.pointerType==="touch"?10:2,Q={x:B,y:q},Z={originalEvent:O,delta:Q};z?(w.current=Q,Ku(ck,d,Z,{discrete:!1})):Ug(Q,m.swipeDirection,K)?(w.current=Q,Ku(lk,c,Z,{discrete:!1}),O.target.setPointerCapture(O.pointerId)):(Math.abs(W)>K||Math.abs(U)>K)&&(x.current=null)}),onPointerUp:lt(e.onPointerUp,O=>{const W=w.current,U=O.target;if(U.hasPointerCapture(O.pointerId)&&U.releasePointerCapture(O.pointerId),w.current=null,x.current=null,W){const z=O.currentTarget,D={originalEvent:O,delta:W};Ug(W,m.swipeDirection,m.swipeThreshold)?Ku(fk,h,D,{discrete:!0}):Ku(dk,f,D,{discrete:!0}),z.addEventListener("click",M=>M.preventDefault(),{once:!0})}})})})}),m.viewport)})]}):null}),mk=e=>{const{__scopeToast:t,children:n,...r}=e,o=Qc(mu,t),[i,a]=A.useState(!1),[s,u]=A.useState(!1);return xk(()=>a(!0)),A.useEffect(()=>{const l=window.setTimeout(()=>u(!0),1e3);return()=>window.clearTimeout(l)},[]),s?null:_.jsx(ew,{asChild:!0,children:_.jsx(Yc,{...r,children:i&&_.jsxs(_.Fragment,{children:[o.label," ",n]})})})},gk="ToastTitle",sw=A.forwardRef((e,t)=>{const{__scopeToast:n,...r}=e;return _.jsx(cn.div,{...r,ref:t})});sw.displayName=gk;var yk="ToastDescription",uw=A.forwardRef((e,t)=>{const{__scopeToast:n,...r}=e;return _.jsx(cn.div,{...r,ref:t})});uw.displayName=yk;var lw="ToastAction",cw=A.forwardRef((e,t)=>{const{altText:n,...r}=e;return n.trim()?_.jsx(fw,{altText:n,asChild:!0,children:_.jsx(uv,{...r,ref:t})}):(console.error(`Invalid prop \`altText\` supplied to \`${lw}\`. Expected non-empty \`string\`.`),null)});cw.displayName=lw;var dw="ToastClose",uv=A.forwardRef((e,t)=>{const{__scopeToast:n,...r}=e,o=pk(dw,n);return _.jsx(fw,{asChild:!0,children:_.jsx(cn.button,{type:"button",...r,ref:t,onClick:lt(e.onClick,o.onClose)})})});uv.displayName=dw;var fw=A.forwardRef((e,t)=>{const{__scopeToast:n,altText:r,...o}=e;return _.jsx(cn.div,{"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":r||void 0,...o,ref:t})});function hw(e){const t=[];return Array.from(e.childNodes).forEach(r=>{if(r.nodeType===r.TEXT_NODE&&r.textContent&&t.push(r.textContent),wk(r)){const o=r.ariaHidden||r.hidden||r.style.display==="none",i=r.dataset.radixToastAnnounceExclude==="";if(!o)if(i){const a=r.dataset.radixToastAnnounceAlt;a&&t.push(a)}else t.push(...hw(r))}}),t}function Ku(e,t,n,{discrete:r}){const o=n.originalEvent.currentTarget,i=new CustomEvent(e,{bubbles:!0,cancelable:!0,detail:n});t&&o.addEventListener(e,t,{once:!0}),r?Y1(o,i):o.dispatchEvent(i)}var Ug=(e,t,n=0)=>{const r=Math.abs(e.x),o=Math.abs(e.y),i=r>o;return t==="left"||t==="right"?i&&r>n:!i&&o>n};function xk(e=()=>{}){const t=Ho(e);Go(()=>{let n=0,r=0;return n=window.requestAnimationFrame(()=>r=window.requestAnimationFrame(t)),()=>{window.cancelAnimationFrame(n),window.cancelAnimationFrame(r)}},[t])}function wk(e){return e.nodeType===e.ELEMENT_NODE}function bk(e){const t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const o=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||o?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)t.push(n.currentNode);return t}function ef(e){const t=document.activeElement;return e.some(n=>n===t?!0:(n.focus(),document.activeElement!==t))}var Ck=nw,pw=ow,vw=aw,mw=sw,gw=uw,yw=cw,xw=uv;function ww(e){var t,n,r="";if(typeof e=="string"||typeof e=="number")r+=e;else if(typeof e=="object")if(Array.isArray(e)){var o=e.length;for(t=0;t<o;t++)e[t]&&(n=ww(e[t]))&&(r&&(r+=" "),r+=n)}else for(n in e)e[n]&&(r&&(r+=" "),r+=n);return r}function bw(){for(var e,t,n=0,r="",o=arguments.length;n<o;n++)(e=arguments[n])&&(t=ww(e))&&(r&&(r+=" "),r+=t);return r}const $g=e=>typeof e=="boolean"?`${e}`:e===0?"0":e,Vg=bw,Cw=(e,t)=>n=>{var r;if((t==null?void 0:t.variants)==null)return Vg(e,n==null?void 0:n.class,n==null?void 0:n.className);const{variants:o,defaultVariants:i}=t,a=Object.keys(o).map(l=>{const c=n==null?void 0:n[l],d=i==null?void 0:i[l];if(c===null)return null;const f=$g(c)||$g(d);return o[l][f]}),s=n&&Object.entries(n).reduce((l,c)=>{let[d,f]=c;return f===void 0||(l[d]=f),l},{}),u=t==null||(r=t.compoundVariants)===null||r===void 0?void 0:r.reduce((l,c)=>{let{class:d,className:f,...h}=c;return Object.entries(h).every(v=>{let[m,g]=v;return Array.isArray(g)?g.includes({...i,...s}[m]):{...i,...s}[m]===g})?[...l,d,f]:l},[]);return Vg(e,a,u,n==null?void 0:n.class,n==null?void 0:n.className)};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ek=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Ew=(...e)=>e.filter((t,n,r)=>!!t&&t.trim()!==""&&r.indexOf(t)===n).join(" ").trim();/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var _k={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sk=A.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:n=2,absoluteStrokeWidth:r,className:o="",children:i,iconNode:a,...s},u)=>A.createElement("svg",{ref:u,..._k,width:t,height:t,stroke:e,strokeWidth:r?Number(n)*24/Number(t):n,className:Ew("lucide",o),...s},[...a.map(([l,c])=>A.createElement(l,c)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Je=(e,t)=>{const n=A.forwardRef(({className:r,...o},i)=>A.createElement(Sk,{ref:i,iconNode:t,className:Ew(`lucide-${Ek(e)}`,r),...o}));return n.displayName=`${e}`,n};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kk=Je("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hg=Je("Award",[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rk=Je("Brain",[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M12 5a3 3 0 1 1 5.997.125 4 4 0 0 1 2.526 5.77 4 4 0 0 1-.556 6.588A4 4 0 1 1 12 18Z",key:"ep3f8r"}],["path",{d:"M15 13a4.5 4.5 0 0 1-3-4 4.5 4.5 0 0 1-3 4",key:"1p4c4q"}],["path",{d:"M17.599 6.5a3 3 0 0 0 .399-1.375",key:"tmeiqw"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M19.938 10.5a4 4 0 0 1 .585.396",key:"1qfode"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M19.967 17.484A4 4 0 0 1 18 18",key:"159ez6"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gg=Je("ChartColumn",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nk=Je("ChartPie",[["path",{d:"M21 12c.552 0 1.005-.449.95-.998a10 10 0 0 0-8.953-8.951c-.55-.055-.998.398-.998.95v8a1 1 0 0 0 1 1z",key:"pzmjnu"}],["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ik=Je("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tk=Je("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ak=Je("CloudRain",[["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"M16 14v6",key:"1j4efv"}],["path",{d:"M8 14v6",key:"17c4r9"}],["path",{d:"M12 16v6",key:"c8a4gj"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pk=Je("Cloud",[["path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z",key:"p7xjir"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dk=Je("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ih=Je("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fk=Je("Lightbulb",[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mk=Je("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ok=Je("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lk=Je("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bk=Je("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xu=Je("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qg=Je("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jk=Je("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wk=Je("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _w=Je("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zk=Je("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sw=Je("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]),lv="-",Uk=e=>{const t=Vk(e),{conflictingClassGroups:n,conflictingClassGroupModifiers:r}=e;return{getClassGroupId:a=>{const s=a.split(lv);return s[0]===""&&s.length!==1&&s.shift(),kw(s,t)||$k(a)},getConflictingClassGroupIds:(a,s)=>{const u=n[a]||[];return s&&r[a]?[...u,...r[a]]:u}}},kw=(e,t)=>{var a;if(e.length===0)return t.classGroupId;const n=e[0],r=t.nextPart.get(n),o=r?kw(e.slice(1),r):void 0;if(o)return o;if(t.validators.length===0)return;const i=e.join(lv);return(a=t.validators.find(({validator:s})=>s(i)))==null?void 0:a.classGroupId},Kg=/^\[(.+)\]$/,$k=e=>{if(Kg.test(e)){const t=Kg.exec(e)[1],n=t==null?void 0:t.substring(0,t.indexOf(":"));if(n)return"arbitrary.."+n}},Vk=e=>{const{theme:t,prefix:n}=e,r={nextPart:new Map,validators:[]};return Gk(Object.entries(e.classGroups),n).forEach(([i,a])=>{Th(a,r,i,t)}),r},Th=(e,t,n,r)=>{e.forEach(o=>{if(typeof o=="string"){const i=o===""?t:Xg(t,o);i.classGroupId=n;return}if(typeof o=="function"){if(Hk(o)){Th(o(r),t,n,r);return}t.validators.push({validator:o,classGroupId:n});return}Object.entries(o).forEach(([i,a])=>{Th(a,Xg(t,i),n,r)})})},Xg=(e,t)=>{let n=e;return t.split(lv).forEach(r=>{n.nextPart.has(r)||n.nextPart.set(r,{nextPart:new Map,validators:[]}),n=n.nextPart.get(r)}),n},Hk=e=>e.isThemeGetter,Gk=(e,t)=>t?e.map(([n,r])=>{const o=r.map(i=>typeof i=="string"?t+i:typeof i=="object"?Object.fromEntries(Object.entries(i).map(([a,s])=>[t+a,s])):i);return[n,o]}):e,qk=e=>{if(e<1)return{get:()=>{},set:()=>{}};let t=0,n=new Map,r=new Map;const o=(i,a)=>{n.set(i,a),t++,t>e&&(t=0,r=n,n=new Map)};return{get(i){let a=n.get(i);if(a!==void 0)return a;if((a=r.get(i))!==void 0)return o(i,a),a},set(i,a){n.has(i)?n.set(i,a):o(i,a)}}},Rw="!",Kk=e=>{const{separator:t,experimentalParseClassName:n}=e,r=t.length===1,o=t[0],i=t.length,a=s=>{const u=[];let l=0,c=0,d;for(let g=0;g<s.length;g++){let p=s[g];if(l===0){if(p===o&&(r||s.slice(g,g+i)===t)){u.push(s.slice(c,g)),c=g+i;continue}if(p==="/"){d=g;continue}}p==="["?l++:p==="]"&&l--}const f=u.length===0?s:s.substring(c),h=f.startsWith(Rw),v=h?f.substring(1):f,m=d&&d>c?d-c:void 0;return{modifiers:u,hasImportantModifier:h,baseClassName:v,maybePostfixModifierPosition:m}};return n?s=>n({className:s,parseClassName:a}):a},Xk=e=>{if(e.length<=1)return e;const t=[];let n=[];return e.forEach(r=>{r[0]==="["?(t.push(...n.sort(),r),n=[]):n.push(r)}),t.push(...n.sort()),t},Yk=e=>({cache:qk(e.cacheSize),parseClassName:Kk(e),...Uk(e)}),Qk=/\s+/,Jk=(e,t)=>{const{parseClassName:n,getClassGroupId:r,getConflictingClassGroupIds:o}=t,i=[],a=e.trim().split(Qk);let s="";for(let u=a.length-1;u>=0;u-=1){const l=a[u],{modifiers:c,hasImportantModifier:d,baseClassName:f,maybePostfixModifierPosition:h}=n(l);let v=!!h,m=r(v?f.substring(0,h):f);if(!m){if(!v){s=l+(s.length>0?" "+s:s);continue}if(m=r(f),!m){s=l+(s.length>0?" "+s:s);continue}v=!1}const g=Xk(c).join(":"),p=d?g+Rw:g,y=p+m;if(i.includes(y))continue;i.push(y);const x=o(m,v);for(let w=0;w<x.length;++w){const b=x[w];i.push(p+b)}s=l+(s.length>0?" "+s:s)}return s};function Zk(){let e=0,t,n,r="";for(;e<arguments.length;)(t=arguments[e++])&&(n=Nw(t))&&(r&&(r+=" "),r+=n);return r}const Nw=e=>{if(typeof e=="string")return e;let t,n="";for(let r=0;r<e.length;r++)e[r]&&(t=Nw(e[r]))&&(n&&(n+=" "),n+=t);return n};function eR(e,...t){let n,r,o,i=a;function a(u){const l=t.reduce((c,d)=>d(c),e());return n=Yk(l),r=n.cache.get,o=n.cache.set,i=s,s(u)}function s(u){const l=r(u);if(l)return l;const c=Jk(u,n);return o(u,c),c}return function(){return i(Zk.apply(null,arguments))}}const We=e=>{const t=n=>n[e]||[];return t.isThemeGetter=!0,t},Iw=/^\[(?:([a-z-]+):)?(.+)\]$/i,tR=/^\d+\/\d+$/,nR=new Set(["px","full","screen"]),rR=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,oR=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,iR=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,aR=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,sR=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Lr=e=>ma(e)||nR.has(e)||tR.test(e),ho=e=>Qa(e,"length",vR),ma=e=>!!e&&!Number.isNaN(Number(e)),tf=e=>Qa(e,"number",ma),ds=e=>!!e&&Number.isInteger(Number(e)),uR=e=>e.endsWith("%")&&ma(e.slice(0,-1)),we=e=>Iw.test(e),po=e=>rR.test(e),lR=new Set(["length","size","percentage"]),cR=e=>Qa(e,lR,Tw),dR=e=>Qa(e,"position",Tw),fR=new Set(["image","url"]),hR=e=>Qa(e,fR,gR),pR=e=>Qa(e,"",mR),fs=()=>!0,Qa=(e,t,n)=>{const r=Iw.exec(e);return r?r[1]?typeof t=="string"?r[1]===t:t.has(r[1]):n(r[2]):!1},vR=e=>oR.test(e)&&!iR.test(e),Tw=()=>!1,mR=e=>aR.test(e),gR=e=>sR.test(e),yR=()=>{const e=We("colors"),t=We("spacing"),n=We("blur"),r=We("brightness"),o=We("borderColor"),i=We("borderRadius"),a=We("borderSpacing"),s=We("borderWidth"),u=We("contrast"),l=We("grayscale"),c=We("hueRotate"),d=We("invert"),f=We("gap"),h=We("gradientColorStops"),v=We("gradientColorStopPositions"),m=We("inset"),g=We("margin"),p=We("opacity"),y=We("padding"),x=We("saturate"),w=We("scale"),b=We("sepia"),C=We("skew"),E=We("space"),S=We("translate"),R=()=>["auto","contain","none"],k=()=>["auto","hidden","clip","visible","scroll"],P=()=>["auto",we,t],T=()=>[we,t],j=()=>["",Lr,ho],O=()=>["auto",ma,we],W=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],U=()=>["solid","dashed","dotted","double","none"],z=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],D=()=>["start","end","center","between","around","evenly","stretch"],M=()=>["","0",we],B=()=>["auto","avoid","all","avoid-page","page","left","right","column"],q=()=>[ma,we];return{cacheSize:500,separator:":",theme:{colors:[fs],spacing:[Lr,ho],blur:["none","",po,we],brightness:q(),borderColor:[e],borderRadius:["none","","full",po,we],borderSpacing:T(),borderWidth:j(),contrast:q(),grayscale:M(),hueRotate:q(),invert:M(),gap:T(),gradientColorStops:[e],gradientColorStopPositions:[uR,ho],inset:P(),margin:P(),opacity:q(),padding:T(),saturate:q(),scale:q(),sepia:M(),skew:q(),space:T(),translate:T()},classGroups:{aspect:[{aspect:["auto","square","video",we]}],container:["container"],columns:[{columns:[po]}],"break-after":[{"break-after":B()}],"break-before":[{"break-before":B()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...W(),we]}],overflow:[{overflow:k()}],"overflow-x":[{"overflow-x":k()}],"overflow-y":[{"overflow-y":k()}],overscroll:[{overscroll:R()}],"overscroll-x":[{"overscroll-x":R()}],"overscroll-y":[{"overscroll-y":R()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[m]}],"inset-x":[{"inset-x":[m]}],"inset-y":[{"inset-y":[m]}],start:[{start:[m]}],end:[{end:[m]}],top:[{top:[m]}],right:[{right:[m]}],bottom:[{bottom:[m]}],left:[{left:[m]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",ds,we]}],basis:[{basis:P()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",we]}],grow:[{grow:M()}],shrink:[{shrink:M()}],order:[{order:["first","last","none",ds,we]}],"grid-cols":[{"grid-cols":[fs]}],"col-start-end":[{col:["auto",{span:["full",ds,we]},we]}],"col-start":[{"col-start":O()}],"col-end":[{"col-end":O()}],"grid-rows":[{"grid-rows":[fs]}],"row-start-end":[{row:["auto",{span:[ds,we]},we]}],"row-start":[{"row-start":O()}],"row-end":[{"row-end":O()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",we]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",we]}],gap:[{gap:[f]}],"gap-x":[{"gap-x":[f]}],"gap-y":[{"gap-y":[f]}],"justify-content":[{justify:["normal",...D()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...D(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...D(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[y]}],px:[{px:[y]}],py:[{py:[y]}],ps:[{ps:[y]}],pe:[{pe:[y]}],pt:[{pt:[y]}],pr:[{pr:[y]}],pb:[{pb:[y]}],pl:[{pl:[y]}],m:[{m:[g]}],mx:[{mx:[g]}],my:[{my:[g]}],ms:[{ms:[g]}],me:[{me:[g]}],mt:[{mt:[g]}],mr:[{mr:[g]}],mb:[{mb:[g]}],ml:[{ml:[g]}],"space-x":[{"space-x":[E]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[E]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",we,t]}],"min-w":[{"min-w":[we,t,"min","max","fit"]}],"max-w":[{"max-w":[we,t,"none","full","min","max","fit","prose",{screen:[po]},po]}],h:[{h:[we,t,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[we,t,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[we,t,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[we,t,"auto","min","max","fit"]}],"font-size":[{text:["base",po,ho]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",tf]}],"font-family":[{font:[fs]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",we]}],"line-clamp":[{"line-clamp":["none",ma,tf]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",Lr,we]}],"list-image":[{"list-image":["none",we]}],"list-style-type":[{list:["none","disc","decimal",we]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[e]}],"placeholder-opacity":[{"placeholder-opacity":[p]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[e]}],"text-opacity":[{"text-opacity":[p]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...U(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",Lr,ho]}],"underline-offset":[{"underline-offset":["auto",Lr,we]}],"text-decoration-color":[{decoration:[e]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:T()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",we]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",we]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[p]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...W(),dR]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",cR]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},hR]}],"bg-color":[{bg:[e]}],"gradient-from-pos":[{from:[v]}],"gradient-via-pos":[{via:[v]}],"gradient-to-pos":[{to:[v]}],"gradient-from":[{from:[h]}],"gradient-via":[{via:[h]}],"gradient-to":[{to:[h]}],rounded:[{rounded:[i]}],"rounded-s":[{"rounded-s":[i]}],"rounded-e":[{"rounded-e":[i]}],"rounded-t":[{"rounded-t":[i]}],"rounded-r":[{"rounded-r":[i]}],"rounded-b":[{"rounded-b":[i]}],"rounded-l":[{"rounded-l":[i]}],"rounded-ss":[{"rounded-ss":[i]}],"rounded-se":[{"rounded-se":[i]}],"rounded-ee":[{"rounded-ee":[i]}],"rounded-es":[{"rounded-es":[i]}],"rounded-tl":[{"rounded-tl":[i]}],"rounded-tr":[{"rounded-tr":[i]}],"rounded-br":[{"rounded-br":[i]}],"rounded-bl":[{"rounded-bl":[i]}],"border-w":[{border:[s]}],"border-w-x":[{"border-x":[s]}],"border-w-y":[{"border-y":[s]}],"border-w-s":[{"border-s":[s]}],"border-w-e":[{"border-e":[s]}],"border-w-t":[{"border-t":[s]}],"border-w-r":[{"border-r":[s]}],"border-w-b":[{"border-b":[s]}],"border-w-l":[{"border-l":[s]}],"border-opacity":[{"border-opacity":[p]}],"border-style":[{border:[...U(),"hidden"]}],"divide-x":[{"divide-x":[s]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[s]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[p]}],"divide-style":[{divide:U()}],"border-color":[{border:[o]}],"border-color-x":[{"border-x":[o]}],"border-color-y":[{"border-y":[o]}],"border-color-s":[{"border-s":[o]}],"border-color-e":[{"border-e":[o]}],"border-color-t":[{"border-t":[o]}],"border-color-r":[{"border-r":[o]}],"border-color-b":[{"border-b":[o]}],"border-color-l":[{"border-l":[o]}],"divide-color":[{divide:[o]}],"outline-style":[{outline:["",...U()]}],"outline-offset":[{"outline-offset":[Lr,we]}],"outline-w":[{outline:[Lr,ho]}],"outline-color":[{outline:[e]}],"ring-w":[{ring:j()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[e]}],"ring-opacity":[{"ring-opacity":[p]}],"ring-offset-w":[{"ring-offset":[Lr,ho]}],"ring-offset-color":[{"ring-offset":[e]}],shadow:[{shadow:["","inner","none",po,pR]}],"shadow-color":[{shadow:[fs]}],opacity:[{opacity:[p]}],"mix-blend":[{"mix-blend":[...z(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":z()}],filter:[{filter:["","none"]}],blur:[{blur:[n]}],brightness:[{brightness:[r]}],contrast:[{contrast:[u]}],"drop-shadow":[{"drop-shadow":["","none",po,we]}],grayscale:[{grayscale:[l]}],"hue-rotate":[{"hue-rotate":[c]}],invert:[{invert:[d]}],saturate:[{saturate:[x]}],sepia:[{sepia:[b]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[n]}],"backdrop-brightness":[{"backdrop-brightness":[r]}],"backdrop-contrast":[{"backdrop-contrast":[u]}],"backdrop-grayscale":[{"backdrop-grayscale":[l]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[c]}],"backdrop-invert":[{"backdrop-invert":[d]}],"backdrop-opacity":[{"backdrop-opacity":[p]}],"backdrop-saturate":[{"backdrop-saturate":[x]}],"backdrop-sepia":[{"backdrop-sepia":[b]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[a]}],"border-spacing-x":[{"border-spacing-x":[a]}],"border-spacing-y":[{"border-spacing-y":[a]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",we]}],duration:[{duration:q()}],ease:[{ease:["linear","in","out","in-out",we]}],delay:[{delay:q()}],animate:[{animate:["none","spin","ping","pulse","bounce",we]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[w]}],"scale-x":[{"scale-x":[w]}],"scale-y":[{"scale-y":[w]}],rotate:[{rotate:[ds,we]}],"translate-x":[{"translate-x":[S]}],"translate-y":[{"translate-y":[S]}],"skew-x":[{"skew-x":[C]}],"skew-y":[{"skew-y":[C]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",we]}],accent:[{accent:["auto",e]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",we]}],"caret-color":[{caret:[e]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":T()}],"scroll-mx":[{"scroll-mx":T()}],"scroll-my":[{"scroll-my":T()}],"scroll-ms":[{"scroll-ms":T()}],"scroll-me":[{"scroll-me":T()}],"scroll-mt":[{"scroll-mt":T()}],"scroll-mr":[{"scroll-mr":T()}],"scroll-mb":[{"scroll-mb":T()}],"scroll-ml":[{"scroll-ml":T()}],"scroll-p":[{"scroll-p":T()}],"scroll-px":[{"scroll-px":T()}],"scroll-py":[{"scroll-py":T()}],"scroll-ps":[{"scroll-ps":T()}],"scroll-pe":[{"scroll-pe":T()}],"scroll-pt":[{"scroll-pt":T()}],"scroll-pr":[{"scroll-pr":T()}],"scroll-pb":[{"scroll-pb":T()}],"scroll-pl":[{"scroll-pl":T()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",we]}],fill:[{fill:[e,"none"]}],"stroke-w":[{stroke:[Lr,ho,tf]}],stroke:[{stroke:[e,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},xR=eR(yR);function qt(...e){return xR(bw(e))}const wR=Ck,Aw=A.forwardRef(({className:e,...t},n)=>_.jsx(pw,{ref:n,className:qt("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",e),...t}));Aw.displayName=pw.displayName;const bR=Cw("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),Pw=A.forwardRef(({className:e,variant:t,...n},r)=>_.jsx(vw,{ref:r,className:qt(bR({variant:t}),e),...n}));Pw.displayName=vw.displayName;const CR=A.forwardRef(({className:e,...t},n)=>_.jsx(yw,{ref:n,className:qt("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",e),...t}));CR.displayName=yw.displayName;const Dw=A.forwardRef(({className:e,...t},n)=>_.jsx(xw,{ref:n,className:qt("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",e),"toast-close":"",...t,children:_.jsx(zk,{className:"h-4 w-4"})}));Dw.displayName=xw.displayName;const Fw=A.forwardRef(({className:e,...t},n)=>_.jsx(mw,{ref:n,className:qt("text-sm font-semibold",e),...t}));Fw.displayName=mw.displayName;const Mw=A.forwardRef(({className:e,...t},n)=>_.jsx(gw,{ref:n,className:qt("text-sm opacity-90",e),...t}));Mw.displayName=gw.displayName;function ER(){const{toasts:e}=IS();return _.jsxs(wR,{children:[e.map(function({id:t,title:n,description:r,action:o,...i}){return _.jsxs(Pw,{...i,children:[_.jsxs("div",{className:"grid gap-1",children:[n&&_.jsx(Fw,{children:n}),r&&_.jsx(Mw,{children:r})]}),o,_.jsx(Dw,{})]},t)}),_.jsx(Aw,{})]})}var _R=e=>{switch(e){case"success":return RR;case"info":return IR;case"warning":return NR;case"error":return TR;default:return null}},SR=Array(12).fill(0),kR=({visible:e,className:t})=>J.createElement("div",{className:["sonner-loading-wrapper",t].filter(Boolean).join(" "),"data-visible":e},J.createElement("div",{className:"sonner-spinner"},SR.map((n,r)=>J.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${r}`})))),RR=J.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},J.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),NR=J.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},J.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),IR=J.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},J.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),TR=J.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},J.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),AR=J.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},J.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),J.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"})),PR=()=>{let[e,t]=J.useState(document.hidden);return J.useEffect(()=>{let n=()=>{t(document.hidden)};return document.addEventListener("visibilitychange",n),()=>window.removeEventListener("visibilitychange",n)},[]),e},Ah=1,DR=class{constructor(){this.subscribe=t=>(this.subscribers.push(t),()=>{let n=this.subscribers.indexOf(t);this.subscribers.splice(n,1)}),this.publish=t=>{this.subscribers.forEach(n=>n(t))},this.addToast=t=>{this.publish(t),this.toasts=[...this.toasts,t]},this.create=t=>{var n;let{message:r,...o}=t,i=typeof(t==null?void 0:t.id)=="number"||((n=t.id)==null?void 0:n.length)>0?t.id:Ah++,a=this.toasts.find(u=>u.id===i),s=t.dismissible===void 0?!0:t.dismissible;return this.dismissedToasts.has(i)&&this.dismissedToasts.delete(i),a?this.toasts=this.toasts.map(u=>u.id===i?(this.publish({...u,...t,id:i,title:r}),{...u,...t,id:i,dismissible:s,title:r}):u):this.addToast({title:r,...o,dismissible:s,id:i}),i},this.dismiss=t=>(this.dismissedToasts.add(t),t||this.toasts.forEach(n=>{this.subscribers.forEach(r=>r({id:n.id,dismiss:!0}))}),this.subscribers.forEach(n=>n({id:t,dismiss:!0})),t),this.message=(t,n)=>this.create({...n,message:t}),this.error=(t,n)=>this.create({...n,message:t,type:"error"}),this.success=(t,n)=>this.create({...n,type:"success",message:t}),this.info=(t,n)=>this.create({...n,type:"info",message:t}),this.warning=(t,n)=>this.create({...n,type:"warning",message:t}),this.loading=(t,n)=>this.create({...n,type:"loading",message:t}),this.promise=(t,n)=>{if(!n)return;let r;n.loading!==void 0&&(r=this.create({...n,promise:t,type:"loading",message:n.loading,description:typeof n.description!="function"?n.description:void 0}));let o=t instanceof Promise?t:t(),i=r!==void 0,a,s=o.then(async l=>{if(a=["resolve",l],J.isValidElement(l))i=!1,this.create({id:r,type:"default",message:l});else if(MR(l)&&!l.ok){i=!1;let c=typeof n.error=="function"?await n.error(`HTTP error! status: ${l.status}`):n.error,d=typeof n.description=="function"?await n.description(`HTTP error! status: ${l.status}`):n.description;this.create({id:r,type:"error",message:c,description:d})}else if(n.success!==void 0){i=!1;let c=typeof n.success=="function"?await n.success(l):n.success,d=typeof n.description=="function"?await n.description(l):n.description;this.create({id:r,type:"success",message:c,description:d})}}).catch(async l=>{if(a=["reject",l],n.error!==void 0){i=!1;let c=typeof n.error=="function"?await n.error(l):n.error,d=typeof n.description=="function"?await n.description(l):n.description;this.create({id:r,type:"error",message:c,description:d})}}).finally(()=>{var l;i&&(this.dismiss(r),r=void 0),(l=n.finally)==null||l.call(n)}),u=()=>new Promise((l,c)=>s.then(()=>a[0]==="reject"?c(a[1]):l(a[1])).catch(c));return typeof r!="string"&&typeof r!="number"?{unwrap:u}:Object.assign(r,{unwrap:u})},this.custom=(t,n)=>{let r=(n==null?void 0:n.id)||Ah++;return this.create({jsx:t(r),id:r,...n}),r},this.getActiveToasts=()=>this.toasts.filter(t=>!this.dismissedToasts.has(t.id)),this.subscribers=[],this.toasts=[],this.dismissedToasts=new Set}},Qt=new DR,FR=(e,t)=>{let n=(t==null?void 0:t.id)||Ah++;return Qt.addToast({title:e,...t,id:n}),n},MR=e=>e&&typeof e=="object"&&"ok"in e&&typeof e.ok=="boolean"&&"status"in e&&typeof e.status=="number",OR=FR,LR=()=>Qt.toasts,BR=()=>Qt.getActiveToasts();Object.assign(OR,{success:Qt.success,info:Qt.info,warning:Qt.warning,error:Qt.error,custom:Qt.custom,message:Qt.message,promise:Qt.promise,dismiss:Qt.dismiss,loading:Qt.loading},{getHistory:LR,getToasts:BR});function jR(e,{insertAt:t}={}){if(typeof document>"u")return;let n=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css",t==="top"&&n.firstChild?n.insertBefore(r,n.firstChild):n.appendChild(r),r.styleSheet?r.styleSheet.cssText=e:r.appendChild(document.createTextNode(e))}jR(`:where(html[dir="ltr"]),:where([data-sonner-toaster][dir="ltr"]){--toast-icon-margin-start: -3px;--toast-icon-margin-end: 4px;--toast-svg-margin-start: -1px;--toast-svg-margin-end: 0px;--toast-button-margin-start: auto;--toast-button-margin-end: 0;--toast-close-button-start: 0;--toast-close-button-end: unset;--toast-close-button-transform: translate(-35%, -35%)}:where(html[dir="rtl"]),:where([data-sonner-toaster][dir="rtl"]){--toast-icon-margin-start: 4px;--toast-icon-margin-end: -3px;--toast-svg-margin-start: 0px;--toast-svg-margin-end: -1px;--toast-button-margin-start: 0;--toast-button-margin-end: auto;--toast-close-button-start: unset;--toast-close-button-end: 0;--toast-close-button-transform: translate(35%, -35%)}:where([data-sonner-toaster]){position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1: hsl(0, 0%, 99%);--gray2: hsl(0, 0%, 97.3%);--gray3: hsl(0, 0%, 95.1%);--gray4: hsl(0, 0%, 93%);--gray5: hsl(0, 0%, 90.9%);--gray6: hsl(0, 0%, 88.7%);--gray7: hsl(0, 0%, 85.8%);--gray8: hsl(0, 0%, 78%);--gray9: hsl(0, 0%, 56.1%);--gray10: hsl(0, 0%, 52.3%);--gray11: hsl(0, 0%, 43.5%);--gray12: hsl(0, 0%, 9%);--border-radius: 8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:none;z-index:999999999;transition:transform .4s ease}:where([data-sonner-toaster][data-lifted="true"]){transform:translateY(-10px)}@media (hover: none) and (pointer: coarse){:where([data-sonner-toaster][data-lifted="true"]){transform:none}}:where([data-sonner-toaster][data-x-position="right"]){right:var(--offset-right)}:where([data-sonner-toaster][data-x-position="left"]){left:var(--offset-left)}:where([data-sonner-toaster][data-x-position="center"]){left:50%;transform:translate(-50%)}:where([data-sonner-toaster][data-y-position="top"]){top:var(--offset-top)}:where([data-sonner-toaster][data-y-position="bottom"]){bottom:var(--offset-bottom)}:where([data-sonner-toast]){--y: translateY(100%);--lift-amount: calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);filter:blur(0);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:none;overflow-wrap:anywhere}:where([data-sonner-toast][data-styled="true"]){padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px #0000001a;width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}:where([data-sonner-toast]:focus-visible){box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast][data-y-position="top"]){top:0;--y: translateY(-100%);--lift: 1;--lift-amount: calc(1 * var(--gap))}:where([data-sonner-toast][data-y-position="bottom"]){bottom:0;--y: translateY(100%);--lift: -1;--lift-amount: calc(var(--lift) * var(--gap))}:where([data-sonner-toast]) :where([data-description]){font-weight:400;line-height:1.4;color:inherit}:where([data-sonner-toast]) :where([data-title]){font-weight:500;line-height:1.5;color:inherit}:where([data-sonner-toast]) :where([data-icon]){display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}:where([data-sonner-toast][data-promise="true"]) :where([data-icon])>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}:where([data-sonner-toast]) :where([data-icon])>*{flex-shrink:0}:where([data-sonner-toast]) :where([data-icon]) svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}:where([data-sonner-toast]) :where([data-content]){display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;cursor:pointer;outline:none;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}:where([data-sonner-toast]) :where([data-button]):focus-visible{box-shadow:0 0 0 2px #0006}:where([data-sonner-toast]) :where([data-button]):first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}:where([data-sonner-toast]) :where([data-cancel]){color:var(--normal-text);background:rgba(0,0,0,.08)}:where([data-sonner-toast][data-theme="dark"]) :where([data-cancel]){background:rgba(255,255,255,.3)}:where([data-sonner-toast]) :where([data-close-button]){position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast] [data-close-button]{background:var(--gray1)}:where([data-sonner-toast]) :where([data-close-button]):focus-visible{box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast]) :where([data-disabled="true"]){cursor:not-allowed}:where([data-sonner-toast]):hover :where([data-close-button]):hover{background:var(--gray2);border-color:var(--gray5)}:where([data-sonner-toast][data-swiping="true"]):before{content:"";position:absolute;left:-50%;right:-50%;height:100%;z-index:-1}:where([data-sonner-toast][data-y-position="top"][data-swiping="true"]):before{bottom:50%;transform:scaleY(3) translateY(50%)}:where([data-sonner-toast][data-y-position="bottom"][data-swiping="true"]):before{top:50%;transform:scaleY(3) translateY(-50%)}:where([data-sonner-toast][data-swiping="false"][data-removed="true"]):before{content:"";position:absolute;inset:0;transform:scaleY(2)}:where([data-sonner-toast]):after{content:"";position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}:where([data-sonner-toast][data-mounted="true"]){--y: translateY(0);opacity:1}:where([data-sonner-toast][data-expanded="false"][data-front="false"]){--scale: var(--toasts-before) * .05 + 1;--y: translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}:where([data-sonner-toast])>*{transition:opacity .4s}:where([data-sonner-toast][data-expanded="false"][data-front="false"][data-styled="true"])>*{opacity:0}:where([data-sonner-toast][data-visible="false"]){opacity:0;pointer-events:none}:where([data-sonner-toast][data-mounted="true"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}:where([data-sonner-toast][data-removed="true"][data-front="true"][data-swipe-out="false"]){--y: translateY(calc(var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="false"]){--y: translateY(40%);opacity:0;transition:transform .5s,opacity .2s}:where([data-sonner-toast][data-removed="true"][data-front="false"]):before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount-y, 0px)) translate(var(--swipe-amount-x, 0px));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation-duration:.2s;animation-timing-function:ease-out;animation-fill-mode:forwards}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=left]{animation-name:swipe-out-left}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=right]{animation-name:swipe-out-right}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=up]{animation-name:swipe-out-up}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=down]{animation-name:swipe-out-down}@keyframes swipe-out-left{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) - 100%));opacity:0}}@keyframes swipe-out-right{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) + 100%));opacity:0}}@keyframes swipe-out-up{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) - 100%));opacity:0}}@keyframes swipe-out-down{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) + 100%));opacity:0}}@media (max-width: 600px){[data-sonner-toaster]{position:fixed;right:var(--mobile-offset-right);left:var(--mobile-offset-left);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset-left) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset-left) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset-left)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--mobile-offset-bottom)}[data-sonner-toaster][data-y-position=top]{top:var(--mobile-offset-top)}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset-left);right:var(--mobile-offset-right);transform:none}}[data-sonner-toaster][data-theme=light]{--normal-bg: #fff;--normal-border: var(--gray4);--normal-text: var(--gray12);--success-bg: hsl(143, 85%, 96%);--success-border: hsl(145, 92%, 91%);--success-text: hsl(140, 100%, 27%);--info-bg: hsl(208, 100%, 97%);--info-border: hsl(221, 91%, 91%);--info-text: hsl(210, 92%, 45%);--warning-bg: hsl(49, 100%, 97%);--warning-border: hsl(49, 91%, 91%);--warning-text: hsl(31, 92%, 45%);--error-bg: hsl(359, 100%, 97%);--error-border: hsl(359, 100%, 94%);--error-text: hsl(360, 100%, 45%)}[data-sonner-toaster][data-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg: #fff;--normal-border: var(--gray3);--normal-text: var(--gray12)}[data-sonner-toaster][data-theme=dark]{--normal-bg: #000;--normal-bg-hover: hsl(0, 0%, 12%);--normal-border: hsl(0, 0%, 20%);--normal-border-hover: hsl(0, 0%, 25%);--normal-text: var(--gray1);--success-bg: hsl(150, 100%, 6%);--success-border: hsl(147, 100%, 12%);--success-text: hsl(150, 86%, 65%);--info-bg: hsl(215, 100%, 6%);--info-border: hsl(223, 100%, 12%);--info-text: hsl(216, 87%, 65%);--warning-bg: hsl(64, 100%, 6%);--warning-border: hsl(60, 100%, 12%);--warning-text: hsl(46, 87%, 65%);--error-bg: hsl(358, 76%, 10%);--error-border: hsl(357, 89%, 16%);--error-text: hsl(358, 100%, 81%)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]{background:var(--normal-bg);border-color:var(--normal-border);color:var(--normal-text)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]:hover{background:var(--normal-bg-hover);border-color:var(--normal-border-hover)}[data-rich-colors=true][data-sonner-toast][data-type=success],[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info],[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning],[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error],[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size: 16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:nth-child(1){animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}to{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}to{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}to{opacity:.15}}@media (prefers-reduced-motion){[data-sonner-toast],[data-sonner-toast]>*,.sonner-loading-bar{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}
`);function Yu(e){return e.label!==void 0}var WR=3,zR="32px",UR="16px",Yg=4e3,$R=356,VR=14,HR=20,GR=200;function Hn(...e){return e.filter(Boolean).join(" ")}function qR(e){let[t,n]=e.split("-"),r=[];return t&&r.push(t),n&&r.push(n),r}var KR=e=>{var t,n,r,o,i,a,s,u,l,c,d;let{invert:f,toast:h,unstyled:v,interacting:m,setHeights:g,visibleToasts:p,heights:y,index:x,toasts:w,expanded:b,removeToast:C,defaultRichColors:E,closeButton:S,style:R,cancelButtonStyle:k,actionButtonStyle:P,className:T="",descriptionClassName:j="",duration:O,position:W,gap:U,loadingIcon:z,expandByDefault:D,classNames:M,icons:B,closeButtonAriaLabel:q="Close toast",pauseWhenPageIsHidden:K}=e,[Q,Z]=J.useState(null),[se,de]=J.useState(null),[re,xe]=J.useState(!1),[me,Pe]=J.useState(!1),[pe,ke]=J.useState(!1),[Ce,Oe]=J.useState(!1),[Le,Fe]=J.useState(!1),[Yt,Nt]=J.useState(0),[ot,Or]=J.useState(0),Ut=J.useRef(h.duration||O||Yg),jn=J.useRef(null),bt=J.useRef(null),so=x===0,Wn=x+1<=p,It=h.type,dn=h.dismissible!==!1,kn=h.className||"",ns=h.descriptionClassName||"",Wi=J.useMemo(()=>y.findIndex(ge=>ge.toastId===h.id)||0,[y,h.id]),Ed=J.useMemo(()=>{var ge;return(ge=h.closeButton)!=null?ge:S},[h.closeButton,S]),Nu=J.useMemo(()=>h.duration||O||Yg,[h.duration,O]),ri=J.useRef(0),lr=J.useRef(0),zi=J.useRef(0),Ui=J.useRef(null),[qC,KC]=W.split("-"),km=J.useMemo(()=>y.reduce((ge,Me,Ve)=>Ve>=Wi?ge:ge+Me.height,0),[y,Wi]),Rm=PR(),XC=h.invert||f,_d=It==="loading";lr.current=J.useMemo(()=>Wi*U+km,[Wi,km]),J.useEffect(()=>{Ut.current=Nu},[Nu]),J.useEffect(()=>{xe(!0)},[]),J.useEffect(()=>{let ge=bt.current;if(ge){let Me=ge.getBoundingClientRect().height;return Or(Me),g(Ve=>[{toastId:h.id,height:Me,position:h.position},...Ve]),()=>g(Ve=>Ve.filter(zn=>zn.toastId!==h.id))}},[g,h.id]),J.useLayoutEffect(()=>{if(!re)return;let ge=bt.current,Me=ge.style.height;ge.style.height="auto";let Ve=ge.getBoundingClientRect().height;ge.style.height=Me,Or(Ve),g(zn=>zn.find(Un=>Un.toastId===h.id)?zn.map(Un=>Un.toastId===h.id?{...Un,height:Ve}:Un):[{toastId:h.id,height:Ve,position:h.position},...zn])},[re,h.title,h.description,g,h.id]);let uo=J.useCallback(()=>{Pe(!0),Nt(lr.current),g(ge=>ge.filter(Me=>Me.toastId!==h.id)),setTimeout(()=>{C(h)},GR)},[h,C,g,lr]);J.useEffect(()=>{if(h.promise&&It==="loading"||h.duration===1/0||h.type==="loading")return;let ge;return b||m||K&&Rm?(()=>{if(zi.current<ri.current){let Me=new Date().getTime()-ri.current;Ut.current=Ut.current-Me}zi.current=new Date().getTime()})():Ut.current!==1/0&&(ri.current=new Date().getTime(),ge=setTimeout(()=>{var Me;(Me=h.onAutoClose)==null||Me.call(h,h),uo()},Ut.current)),()=>clearTimeout(ge)},[b,m,h,It,K,Rm,uo]),J.useEffect(()=>{h.delete&&uo()},[uo,h.delete]);function YC(){var ge,Me,Ve;return B!=null&&B.loading?J.createElement("div",{className:Hn(M==null?void 0:M.loader,(ge=h==null?void 0:h.classNames)==null?void 0:ge.loader,"sonner-loader"),"data-visible":It==="loading"},B.loading):z?J.createElement("div",{className:Hn(M==null?void 0:M.loader,(Me=h==null?void 0:h.classNames)==null?void 0:Me.loader,"sonner-loader"),"data-visible":It==="loading"},z):J.createElement(kR,{className:Hn(M==null?void 0:M.loader,(Ve=h==null?void 0:h.classNames)==null?void 0:Ve.loader),visible:It==="loading"})}return J.createElement("li",{tabIndex:0,ref:bt,className:Hn(T,kn,M==null?void 0:M.toast,(t=h==null?void 0:h.classNames)==null?void 0:t.toast,M==null?void 0:M.default,M==null?void 0:M[It],(n=h==null?void 0:h.classNames)==null?void 0:n[It]),"data-sonner-toast":"","data-rich-colors":(r=h.richColors)!=null?r:E,"data-styled":!(h.jsx||h.unstyled||v),"data-mounted":re,"data-promise":!!h.promise,"data-swiped":Le,"data-removed":me,"data-visible":Wn,"data-y-position":qC,"data-x-position":KC,"data-index":x,"data-front":so,"data-swiping":pe,"data-dismissible":dn,"data-type":It,"data-invert":XC,"data-swipe-out":Ce,"data-swipe-direction":se,"data-expanded":!!(b||D&&re),style:{"--index":x,"--toasts-before":x,"--z-index":w.length-x,"--offset":`${me?Yt:lr.current}px`,"--initial-height":D?"auto":`${ot}px`,...R,...h.style},onDragEnd:()=>{ke(!1),Z(null),Ui.current=null},onPointerDown:ge=>{_d||!dn||(jn.current=new Date,Nt(lr.current),ge.target.setPointerCapture(ge.pointerId),ge.target.tagName!=="BUTTON"&&(ke(!0),Ui.current={x:ge.clientX,y:ge.clientY}))},onPointerUp:()=>{var ge,Me,Ve,zn;if(Ce||!dn)return;Ui.current=null;let Un=Number(((ge=bt.current)==null?void 0:ge.style.getPropertyValue("--swipe-amount-x").replace("px",""))||0),lo=Number(((Me=bt.current)==null?void 0:Me.style.getPropertyValue("--swipe-amount-y").replace("px",""))||0),oi=new Date().getTime()-((Ve=jn.current)==null?void 0:Ve.getTime()),$n=Q==="x"?Un:lo,co=Math.abs($n)/oi;if(Math.abs($n)>=HR||co>.11){Nt(lr.current),(zn=h.onDismiss)==null||zn.call(h,h),de(Q==="x"?Un>0?"right":"left":lo>0?"down":"up"),uo(),Oe(!0),Fe(!1);return}ke(!1),Z(null)},onPointerMove:ge=>{var Me,Ve,zn,Un;if(!Ui.current||!dn||((Me=window.getSelection())==null?void 0:Me.toString().length)>0)return;let lo=ge.clientY-Ui.current.y,oi=ge.clientX-Ui.current.x,$n=(Ve=e.swipeDirections)!=null?Ve:qR(W);!Q&&(Math.abs(oi)>1||Math.abs(lo)>1)&&Z(Math.abs(oi)>Math.abs(lo)?"x":"y");let co={x:0,y:0};Q==="y"?($n.includes("top")||$n.includes("bottom"))&&($n.includes("top")&&lo<0||$n.includes("bottom")&&lo>0)&&(co.y=lo):Q==="x"&&($n.includes("left")||$n.includes("right"))&&($n.includes("left")&&oi<0||$n.includes("right")&&oi>0)&&(co.x=oi),(Math.abs(co.x)>0||Math.abs(co.y)>0)&&Fe(!0),(zn=bt.current)==null||zn.style.setProperty("--swipe-amount-x",`${co.x}px`),(Un=bt.current)==null||Un.style.setProperty("--swipe-amount-y",`${co.y}px`)}},Ed&&!h.jsx?J.createElement("button",{"aria-label":q,"data-disabled":_d,"data-close-button":!0,onClick:_d||!dn?()=>{}:()=>{var ge;uo(),(ge=h.onDismiss)==null||ge.call(h,h)},className:Hn(M==null?void 0:M.closeButton,(o=h==null?void 0:h.classNames)==null?void 0:o.closeButton)},(i=B==null?void 0:B.close)!=null?i:AR):null,h.jsx||A.isValidElement(h.title)?h.jsx?h.jsx:typeof h.title=="function"?h.title():h.title:J.createElement(J.Fragment,null,It||h.icon||h.promise?J.createElement("div",{"data-icon":"",className:Hn(M==null?void 0:M.icon,(a=h==null?void 0:h.classNames)==null?void 0:a.icon)},h.promise||h.type==="loading"&&!h.icon?h.icon||YC():null,h.type!=="loading"?h.icon||(B==null?void 0:B[It])||_R(It):null):null,J.createElement("div",{"data-content":"",className:Hn(M==null?void 0:M.content,(s=h==null?void 0:h.classNames)==null?void 0:s.content)},J.createElement("div",{"data-title":"",className:Hn(M==null?void 0:M.title,(u=h==null?void 0:h.classNames)==null?void 0:u.title)},typeof h.title=="function"?h.title():h.title),h.description?J.createElement("div",{"data-description":"",className:Hn(j,ns,M==null?void 0:M.description,(l=h==null?void 0:h.classNames)==null?void 0:l.description)},typeof h.description=="function"?h.description():h.description):null),A.isValidElement(h.cancel)?h.cancel:h.cancel&&Yu(h.cancel)?J.createElement("button",{"data-button":!0,"data-cancel":!0,style:h.cancelButtonStyle||k,onClick:ge=>{var Me,Ve;Yu(h.cancel)&&dn&&((Ve=(Me=h.cancel).onClick)==null||Ve.call(Me,ge),uo())},className:Hn(M==null?void 0:M.cancelButton,(c=h==null?void 0:h.classNames)==null?void 0:c.cancelButton)},h.cancel.label):null,A.isValidElement(h.action)?h.action:h.action&&Yu(h.action)?J.createElement("button",{"data-button":!0,"data-action":!0,style:h.actionButtonStyle||P,onClick:ge=>{var Me,Ve;Yu(h.action)&&((Ve=(Me=h.action).onClick)==null||Ve.call(Me,ge),!ge.defaultPrevented&&uo())},className:Hn(M==null?void 0:M.actionButton,(d=h==null?void 0:h.classNames)==null?void 0:d.actionButton)},h.action.label):null))};function Qg(){if(typeof window>"u"||typeof document>"u")return"ltr";let e=document.documentElement.getAttribute("dir");return e==="auto"||!e?window.getComputedStyle(document.documentElement).direction:e}function XR(e,t){let n={};return[e,t].forEach((r,o)=>{let i=o===1,a=i?"--mobile-offset":"--offset",s=i?UR:zR;function u(l){["top","right","bottom","left"].forEach(c=>{n[`${a}-${c}`]=typeof l=="number"?`${l}px`:l})}typeof r=="number"||typeof r=="string"?u(r):typeof r=="object"?["top","right","bottom","left"].forEach(l=>{r[l]===void 0?n[`${a}-${l}`]=s:n[`${a}-${l}`]=typeof r[l]=="number"?`${r[l]}px`:r[l]}):u(s)}),n}var YR=A.forwardRef(function(e,t){let{invert:n,position:r="bottom-right",hotkey:o=["altKey","KeyT"],expand:i,closeButton:a,className:s,offset:u,mobileOffset:l,theme:c="light",richColors:d,duration:f,style:h,visibleToasts:v=WR,toastOptions:m,dir:g=Qg(),gap:p=VR,loadingIcon:y,icons:x,containerAriaLabel:w="Notifications",pauseWhenPageIsHidden:b}=e,[C,E]=J.useState([]),S=J.useMemo(()=>Array.from(new Set([r].concat(C.filter(K=>K.position).map(K=>K.position)))),[C,r]),[R,k]=J.useState([]),[P,T]=J.useState(!1),[j,O]=J.useState(!1),[W,U]=J.useState(c!=="system"?c:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),z=J.useRef(null),D=o.join("+").replace(/Key/g,"").replace(/Digit/g,""),M=J.useRef(null),B=J.useRef(!1),q=J.useCallback(K=>{E(Q=>{var Z;return(Z=Q.find(se=>se.id===K.id))!=null&&Z.delete||Qt.dismiss(K.id),Q.filter(({id:se})=>se!==K.id)})},[]);return J.useEffect(()=>Qt.subscribe(K=>{if(K.dismiss){E(Q=>Q.map(Z=>Z.id===K.id?{...Z,delete:!0}:Z));return}setTimeout(()=>{G1.flushSync(()=>{E(Q=>{let Z=Q.findIndex(se=>se.id===K.id);return Z!==-1?[...Q.slice(0,Z),{...Q[Z],...K},...Q.slice(Z+1)]:[K,...Q]})})})}),[]),J.useEffect(()=>{if(c!=="system"){U(c);return}if(c==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?U("dark"):U("light")),typeof window>"u")return;let K=window.matchMedia("(prefers-color-scheme: dark)");try{K.addEventListener("change",({matches:Q})=>{U(Q?"dark":"light")})}catch{K.addListener(({matches:Z})=>{try{U(Z?"dark":"light")}catch(se){console.error(se)}})}},[c]),J.useEffect(()=>{C.length<=1&&T(!1)},[C]),J.useEffect(()=>{let K=Q=>{var Z,se;o.every(de=>Q[de]||Q.code===de)&&(T(!0),(Z=z.current)==null||Z.focus()),Q.code==="Escape"&&(document.activeElement===z.current||(se=z.current)!=null&&se.contains(document.activeElement))&&T(!1)};return document.addEventListener("keydown",K),()=>document.removeEventListener("keydown",K)},[o]),J.useEffect(()=>{if(z.current)return()=>{M.current&&(M.current.focus({preventScroll:!0}),M.current=null,B.current=!1)}},[z.current]),J.createElement("section",{ref:t,"aria-label":`${w} ${D}`,tabIndex:-1,"aria-live":"polite","aria-relevant":"additions text","aria-atomic":"false",suppressHydrationWarning:!0},S.map((K,Q)=>{var Z;let[se,de]=K.split("-");return C.length?J.createElement("ol",{key:K,dir:g==="auto"?Qg():g,tabIndex:-1,ref:z,className:s,"data-sonner-toaster":!0,"data-theme":W,"data-y-position":se,"data-lifted":P&&C.length>1&&!i,"data-x-position":de,style:{"--front-toast-height":`${((Z=R[0])==null?void 0:Z.height)||0}px`,"--width":`${$R}px`,"--gap":`${p}px`,...h,...XR(u,l)},onBlur:re=>{B.current&&!re.currentTarget.contains(re.relatedTarget)&&(B.current=!1,M.current&&(M.current.focus({preventScroll:!0}),M.current=null))},onFocus:re=>{re.target instanceof HTMLElement&&re.target.dataset.dismissible==="false"||B.current||(B.current=!0,M.current=re.relatedTarget)},onMouseEnter:()=>T(!0),onMouseMove:()=>T(!0),onMouseLeave:()=>{j||T(!1)},onDragEnd:()=>T(!1),onPointerDown:re=>{re.target instanceof HTMLElement&&re.target.dataset.dismissible==="false"||O(!0)},onPointerUp:()=>O(!1)},C.filter(re=>!re.position&&Q===0||re.position===K).map((re,xe)=>{var me,Pe;return J.createElement(KR,{key:re.id,icons:x,index:xe,toast:re,defaultRichColors:d,duration:(me=m==null?void 0:m.duration)!=null?me:f,className:m==null?void 0:m.className,descriptionClassName:m==null?void 0:m.descriptionClassName,invert:n,visibleToasts:v,closeButton:(Pe=m==null?void 0:m.closeButton)!=null?Pe:a,interacting:j,position:K,style:m==null?void 0:m.style,unstyled:m==null?void 0:m.unstyled,classNames:m==null?void 0:m.classNames,cancelButtonStyle:m==null?void 0:m.cancelButtonStyle,actionButtonStyle:m==null?void 0:m.actionButtonStyle,removeToast:q,toasts:C.filter(pe=>pe.position==re.position),heights:R.filter(pe=>pe.position==re.position),setHeights:k,expandByDefault:i,gap:p,loadingIcon:y,expanded:P,pauseWhenPageIsHidden:b,swipeDirections:e.swipeDirections})})):null}))});const QR=e=>_.jsx(YR,{theme:"light",className:"toaster group",toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",description:"group-[.toast]:text-muted-foreground",actionButton:"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",cancelButton:"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground"}},...e}),JR=["top","right","bottom","left"],qo=Math.min,pn=Math.max,rc=Math.round,Qu=Math.floor,Sr=e=>({x:e,y:e}),ZR={left:"right",right:"left",bottom:"top",top:"bottom"},eN={start:"end",end:"start"};function Ph(e,t,n){return pn(e,qo(t,n))}function Jr(e,t){return typeof e=="function"?e(t):e}function Zr(e){return e.split("-")[0]}function Ja(e){return e.split("-")[1]}function cv(e){return e==="x"?"y":"x"}function dv(e){return e==="y"?"height":"width"}function br(e){return["top","bottom"].includes(Zr(e))?"y":"x"}function fv(e){return cv(br(e))}function tN(e,t,n){n===void 0&&(n=!1);const r=Ja(e),o=fv(e),i=dv(o);let a=o==="x"?r===(n?"end":"start")?"right":"left":r==="start"?"bottom":"top";return t.reference[i]>t.floating[i]&&(a=oc(a)),[a,oc(a)]}function nN(e){const t=oc(e);return[Dh(e),t,Dh(t)]}function Dh(e){return e.replace(/start|end/g,t=>eN[t])}function rN(e,t,n){const r=["left","right"],o=["right","left"],i=["top","bottom"],a=["bottom","top"];switch(e){case"top":case"bottom":return n?t?o:r:t?r:o;case"left":case"right":return t?i:a;default:return[]}}function oN(e,t,n,r){const o=Ja(e);let i=rN(Zr(e),n==="start",r);return o&&(i=i.map(a=>a+"-"+o),t&&(i=i.concat(i.map(Dh)))),i}function oc(e){return e.replace(/left|right|bottom|top/g,t=>ZR[t])}function iN(e){return{top:0,right:0,bottom:0,left:0,...e}}function Ow(e){return typeof e!="number"?iN(e):{top:e,right:e,bottom:e,left:e}}function ic(e){const{x:t,y:n,width:r,height:o}=e;return{width:r,height:o,top:n,left:t,right:t+r,bottom:n+o,x:t,y:n}}function Jg(e,t,n){let{reference:r,floating:o}=e;const i=br(t),a=fv(t),s=dv(a),u=Zr(t),l=i==="y",c=r.x+r.width/2-o.width/2,d=r.y+r.height/2-o.height/2,f=r[s]/2-o[s]/2;let h;switch(u){case"top":h={x:c,y:r.y-o.height};break;case"bottom":h={x:c,y:r.y+r.height};break;case"right":h={x:r.x+r.width,y:d};break;case"left":h={x:r.x-o.width,y:d};break;default:h={x:r.x,y:r.y}}switch(Ja(t)){case"start":h[a]-=f*(n&&l?-1:1);break;case"end":h[a]+=f*(n&&l?-1:1);break}return h}const aN=async(e,t,n)=>{const{placement:r="bottom",strategy:o="absolute",middleware:i=[],platform:a}=n,s=i.filter(Boolean),u=await(a.isRTL==null?void 0:a.isRTL(t));let l=await a.getElementRects({reference:e,floating:t,strategy:o}),{x:c,y:d}=Jg(l,r,u),f=r,h={},v=0;for(let m=0;m<s.length;m++){const{name:g,fn:p}=s[m],{x:y,y:x,data:w,reset:b}=await p({x:c,y:d,initialPlacement:r,placement:f,strategy:o,middlewareData:h,rects:l,platform:a,elements:{reference:e,floating:t}});c=y??c,d=x??d,h={...h,[g]:{...h[g],...w}},b&&v<=50&&(v++,typeof b=="object"&&(b.placement&&(f=b.placement),b.rects&&(l=b.rects===!0?await a.getElementRects({reference:e,floating:t,strategy:o}):b.rects),{x:c,y:d}=Jg(l,f,u)),m=-1)}return{x:c,y:d,placement:f,strategy:o,middlewareData:h}};async function Qs(e,t){var n;t===void 0&&(t={});const{x:r,y:o,platform:i,rects:a,elements:s,strategy:u}=e,{boundary:l="clippingAncestors",rootBoundary:c="viewport",elementContext:d="floating",altBoundary:f=!1,padding:h=0}=Jr(t,e),v=Ow(h),g=s[f?d==="floating"?"reference":"floating":d],p=ic(await i.getClippingRect({element:(n=await(i.isElement==null?void 0:i.isElement(g)))==null||n?g:g.contextElement||await(i.getDocumentElement==null?void 0:i.getDocumentElement(s.floating)),boundary:l,rootBoundary:c,strategy:u})),y=d==="floating"?{x:r,y:o,width:a.floating.width,height:a.floating.height}:a.reference,x=await(i.getOffsetParent==null?void 0:i.getOffsetParent(s.floating)),w=await(i.isElement==null?void 0:i.isElement(x))?await(i.getScale==null?void 0:i.getScale(x))||{x:1,y:1}:{x:1,y:1},b=ic(i.convertOffsetParentRelativeRectToViewportRelativeRect?await i.convertOffsetParentRelativeRectToViewportRelativeRect({elements:s,rect:y,offsetParent:x,strategy:u}):y);return{top:(p.top-b.top+v.top)/w.y,bottom:(b.bottom-p.bottom+v.bottom)/w.y,left:(p.left-b.left+v.left)/w.x,right:(b.right-p.right+v.right)/w.x}}const sN=e=>({name:"arrow",options:e,async fn(t){const{x:n,y:r,placement:o,rects:i,platform:a,elements:s,middlewareData:u}=t,{element:l,padding:c=0}=Jr(e,t)||{};if(l==null)return{};const d=Ow(c),f={x:n,y:r},h=fv(o),v=dv(h),m=await a.getDimensions(l),g=h==="y",p=g?"top":"left",y=g?"bottom":"right",x=g?"clientHeight":"clientWidth",w=i.reference[v]+i.reference[h]-f[h]-i.floating[v],b=f[h]-i.reference[h],C=await(a.getOffsetParent==null?void 0:a.getOffsetParent(l));let E=C?C[x]:0;(!E||!await(a.isElement==null?void 0:a.isElement(C)))&&(E=s.floating[x]||i.floating[v]);const S=w/2-b/2,R=E/2-m[v]/2-1,k=qo(d[p],R),P=qo(d[y],R),T=k,j=E-m[v]-P,O=E/2-m[v]/2+S,W=Ph(T,O,j),U=!u.arrow&&Ja(o)!=null&&O!==W&&i.reference[v]/2-(O<T?k:P)-m[v]/2<0,z=U?O<T?O-T:O-j:0;return{[h]:f[h]+z,data:{[h]:W,centerOffset:O-W-z,...U&&{alignmentOffset:z}},reset:U}}}),uN=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(t){var n,r;const{placement:o,middlewareData:i,rects:a,initialPlacement:s,platform:u,elements:l}=t,{mainAxis:c=!0,crossAxis:d=!0,fallbackPlacements:f,fallbackStrategy:h="bestFit",fallbackAxisSideDirection:v="none",flipAlignment:m=!0,...g}=Jr(e,t);if((n=i.arrow)!=null&&n.alignmentOffset)return{};const p=Zr(o),y=br(s),x=Zr(s)===s,w=await(u.isRTL==null?void 0:u.isRTL(l.floating)),b=f||(x||!m?[oc(s)]:nN(s)),C=v!=="none";!f&&C&&b.push(...oN(s,m,v,w));const E=[s,...b],S=await Qs(t,g),R=[];let k=((r=i.flip)==null?void 0:r.overflows)||[];if(c&&R.push(S[p]),d){const O=tN(o,a,w);R.push(S[O[0]],S[O[1]])}if(k=[...k,{placement:o,overflows:R}],!R.every(O=>O<=0)){var P,T;const O=(((P=i.flip)==null?void 0:P.index)||0)+1,W=E[O];if(W&&(!(d==="alignment"?y!==br(W):!1)||k.every(D=>D.overflows[0]>0&&br(D.placement)===y)))return{data:{index:O,overflows:k},reset:{placement:W}};let U=(T=k.filter(z=>z.overflows[0]<=0).sort((z,D)=>z.overflows[1]-D.overflows[1])[0])==null?void 0:T.placement;if(!U)switch(h){case"bestFit":{var j;const z=(j=k.filter(D=>{if(C){const M=br(D.placement);return M===y||M==="y"}return!0}).map(D=>[D.placement,D.overflows.filter(M=>M>0).reduce((M,B)=>M+B,0)]).sort((D,M)=>D[1]-M[1])[0])==null?void 0:j[0];z&&(U=z);break}case"initialPlacement":U=s;break}if(o!==U)return{reset:{placement:U}}}return{}}}};function Zg(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function ey(e){return JR.some(t=>e[t]>=0)}const lN=function(e){return e===void 0&&(e={}),{name:"hide",options:e,async fn(t){const{rects:n}=t,{strategy:r="referenceHidden",...o}=Jr(e,t);switch(r){case"referenceHidden":{const i=await Qs(t,{...o,elementContext:"reference"}),a=Zg(i,n.reference);return{data:{referenceHiddenOffsets:a,referenceHidden:ey(a)}}}case"escaped":{const i=await Qs(t,{...o,altBoundary:!0}),a=Zg(i,n.floating);return{data:{escapedOffsets:a,escaped:ey(a)}}}default:return{}}}}};async function cN(e,t){const{placement:n,platform:r,elements:o}=e,i=await(r.isRTL==null?void 0:r.isRTL(o.floating)),a=Zr(n),s=Ja(n),u=br(n)==="y",l=["left","top"].includes(a)?-1:1,c=i&&u?-1:1,d=Jr(t,e);let{mainAxis:f,crossAxis:h,alignmentAxis:v}=typeof d=="number"?{mainAxis:d,crossAxis:0,alignmentAxis:null}:{mainAxis:d.mainAxis||0,crossAxis:d.crossAxis||0,alignmentAxis:d.alignmentAxis};return s&&typeof v=="number"&&(h=s==="end"?v*-1:v),u?{x:h*c,y:f*l}:{x:f*l,y:h*c}}const dN=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(t){var n,r;const{x:o,y:i,placement:a,middlewareData:s}=t,u=await cN(t,e);return a===((n=s.offset)==null?void 0:n.placement)&&(r=s.arrow)!=null&&r.alignmentOffset?{}:{x:o+u.x,y:i+u.y,data:{...u,placement:a}}}}},fN=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(t){const{x:n,y:r,placement:o}=t,{mainAxis:i=!0,crossAxis:a=!1,limiter:s={fn:g=>{let{x:p,y}=g;return{x:p,y}}},...u}=Jr(e,t),l={x:n,y:r},c=await Qs(t,u),d=br(Zr(o)),f=cv(d);let h=l[f],v=l[d];if(i){const g=f==="y"?"top":"left",p=f==="y"?"bottom":"right",y=h+c[g],x=h-c[p];h=Ph(y,h,x)}if(a){const g=d==="y"?"top":"left",p=d==="y"?"bottom":"right",y=v+c[g],x=v-c[p];v=Ph(y,v,x)}const m=s.fn({...t,[f]:h,[d]:v});return{...m,data:{x:m.x-n,y:m.y-r,enabled:{[f]:i,[d]:a}}}}}},hN=function(e){return e===void 0&&(e={}),{options:e,fn(t){const{x:n,y:r,placement:o,rects:i,middlewareData:a}=t,{offset:s=0,mainAxis:u=!0,crossAxis:l=!0}=Jr(e,t),c={x:n,y:r},d=br(o),f=cv(d);let h=c[f],v=c[d];const m=Jr(s,t),g=typeof m=="number"?{mainAxis:m,crossAxis:0}:{mainAxis:0,crossAxis:0,...m};if(u){const x=f==="y"?"height":"width",w=i.reference[f]-i.floating[x]+g.mainAxis,b=i.reference[f]+i.reference[x]-g.mainAxis;h<w?h=w:h>b&&(h=b)}if(l){var p,y;const x=f==="y"?"width":"height",w=["top","left"].includes(Zr(o)),b=i.reference[d]-i.floating[x]+(w&&((p=a.offset)==null?void 0:p[d])||0)+(w?0:g.crossAxis),C=i.reference[d]+i.reference[x]+(w?0:((y=a.offset)==null?void 0:y[d])||0)-(w?g.crossAxis:0);v<b?v=b:v>C&&(v=C)}return{[f]:h,[d]:v}}}},pN=function(e){return e===void 0&&(e={}),{name:"size",options:e,async fn(t){var n,r;const{placement:o,rects:i,platform:a,elements:s}=t,{apply:u=()=>{},...l}=Jr(e,t),c=await Qs(t,l),d=Zr(o),f=Ja(o),h=br(o)==="y",{width:v,height:m}=i.floating;let g,p;d==="top"||d==="bottom"?(g=d,p=f===(await(a.isRTL==null?void 0:a.isRTL(s.floating))?"start":"end")?"left":"right"):(p=d,g=f==="end"?"top":"bottom");const y=m-c.top-c.bottom,x=v-c.left-c.right,w=qo(m-c[g],y),b=qo(v-c[p],x),C=!t.middlewareData.shift;let E=w,S=b;if((n=t.middlewareData.shift)!=null&&n.enabled.x&&(S=x),(r=t.middlewareData.shift)!=null&&r.enabled.y&&(E=y),C&&!f){const k=pn(c.left,0),P=pn(c.right,0),T=pn(c.top,0),j=pn(c.bottom,0);h?S=v-2*(k!==0||P!==0?k+P:pn(c.left,c.right)):E=m-2*(T!==0||j!==0?T+j:pn(c.top,c.bottom))}await u({...t,availableWidth:S,availableHeight:E});const R=await a.getDimensions(s.floating);return v!==R.width||m!==R.height?{reset:{rects:!0}}:{}}}};function Jc(){return typeof window<"u"}function Za(e){return Lw(e)?(e.nodeName||"").toLowerCase():"#document"}function bn(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function Ar(e){var t;return(t=(Lw(e)?e.ownerDocument:e.document)||window.document)==null?void 0:t.documentElement}function Lw(e){return Jc()?e instanceof Node||e instanceof bn(e).Node:!1}function ir(e){return Jc()?e instanceof Element||e instanceof bn(e).Element:!1}function Ir(e){return Jc()?e instanceof HTMLElement||e instanceof bn(e).HTMLElement:!1}function ty(e){return!Jc()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof bn(e).ShadowRoot}function gu(e){const{overflow:t,overflowX:n,overflowY:r,display:o}=ar(e);return/auto|scroll|overlay|hidden|clip/.test(t+r+n)&&!["inline","contents"].includes(o)}function vN(e){return["table","td","th"].includes(Za(e))}function Zc(e){return[":popover-open",":modal"].some(t=>{try{return e.matches(t)}catch{return!1}})}function hv(e){const t=pv(),n=ir(e)?ar(e):e;return["transform","translate","scale","rotate","perspective"].some(r=>n[r]?n[r]!=="none":!1)||(n.containerType?n.containerType!=="normal":!1)||!t&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!t&&(n.filter?n.filter!=="none":!1)||["transform","translate","scale","rotate","perspective","filter"].some(r=>(n.willChange||"").includes(r))||["paint","layout","strict","content"].some(r=>(n.contain||"").includes(r))}function mN(e){let t=Ko(e);for(;Ir(t)&&!Ua(t);){if(hv(t))return t;if(Zc(t))return null;t=Ko(t)}return null}function pv(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function Ua(e){return["html","body","#document"].includes(Za(e))}function ar(e){return bn(e).getComputedStyle(e)}function ed(e){return ir(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function Ko(e){if(Za(e)==="html")return e;const t=e.assignedSlot||e.parentNode||ty(e)&&e.host||Ar(e);return ty(t)?t.host:t}function Bw(e){const t=Ko(e);return Ua(t)?e.ownerDocument?e.ownerDocument.body:e.body:Ir(t)&&gu(t)?t:Bw(t)}function Js(e,t,n){var r;t===void 0&&(t=[]),n===void 0&&(n=!0);const o=Bw(e),i=o===((r=e.ownerDocument)==null?void 0:r.body),a=bn(o);if(i){const s=Fh(a);return t.concat(a,a.visualViewport||[],gu(o)?o:[],s&&n?Js(s):[])}return t.concat(o,Js(o,[],n))}function Fh(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function jw(e){const t=ar(e);let n=parseFloat(t.width)||0,r=parseFloat(t.height)||0;const o=Ir(e),i=o?e.offsetWidth:n,a=o?e.offsetHeight:r,s=rc(n)!==i||rc(r)!==a;return s&&(n=i,r=a),{width:n,height:r,$:s}}function vv(e){return ir(e)?e:e.contextElement}function ga(e){const t=vv(e);if(!Ir(t))return Sr(1);const n=t.getBoundingClientRect(),{width:r,height:o,$:i}=jw(t);let a=(i?rc(n.width):n.width)/r,s=(i?rc(n.height):n.height)/o;return(!a||!Number.isFinite(a))&&(a=1),(!s||!Number.isFinite(s))&&(s=1),{x:a,y:s}}const gN=Sr(0);function Ww(e){const t=bn(e);return!pv()||!t.visualViewport?gN:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function yN(e,t,n){return t===void 0&&(t=!1),!n||t&&n!==bn(e)?!1:t}function Ti(e,t,n,r){t===void 0&&(t=!1),n===void 0&&(n=!1);const o=e.getBoundingClientRect(),i=vv(e);let a=Sr(1);t&&(r?ir(r)&&(a=ga(r)):a=ga(e));const s=yN(i,n,r)?Ww(i):Sr(0);let u=(o.left+s.x)/a.x,l=(o.top+s.y)/a.y,c=o.width/a.x,d=o.height/a.y;if(i){const f=bn(i),h=r&&ir(r)?bn(r):r;let v=f,m=Fh(v);for(;m&&r&&h!==v;){const g=ga(m),p=m.getBoundingClientRect(),y=ar(m),x=p.left+(m.clientLeft+parseFloat(y.paddingLeft))*g.x,w=p.top+(m.clientTop+parseFloat(y.paddingTop))*g.y;u*=g.x,l*=g.y,c*=g.x,d*=g.y,u+=x,l+=w,v=bn(m),m=Fh(v)}}return ic({width:c,height:d,x:u,y:l})}function mv(e,t){const n=ed(e).scrollLeft;return t?t.left+n:Ti(Ar(e)).left+n}function zw(e,t,n){n===void 0&&(n=!1);const r=e.getBoundingClientRect(),o=r.left+t.scrollLeft-(n?0:mv(e,r)),i=r.top+t.scrollTop;return{x:o,y:i}}function xN(e){let{elements:t,rect:n,offsetParent:r,strategy:o}=e;const i=o==="fixed",a=Ar(r),s=t?Zc(t.floating):!1;if(r===a||s&&i)return n;let u={scrollLeft:0,scrollTop:0},l=Sr(1);const c=Sr(0),d=Ir(r);if((d||!d&&!i)&&((Za(r)!=="body"||gu(a))&&(u=ed(r)),Ir(r))){const h=Ti(r);l=ga(r),c.x=h.x+r.clientLeft,c.y=h.y+r.clientTop}const f=a&&!d&&!i?zw(a,u,!0):Sr(0);return{width:n.width*l.x,height:n.height*l.y,x:n.x*l.x-u.scrollLeft*l.x+c.x+f.x,y:n.y*l.y-u.scrollTop*l.y+c.y+f.y}}function wN(e){return Array.from(e.getClientRects())}function bN(e){const t=Ar(e),n=ed(e),r=e.ownerDocument.body,o=pn(t.scrollWidth,t.clientWidth,r.scrollWidth,r.clientWidth),i=pn(t.scrollHeight,t.clientHeight,r.scrollHeight,r.clientHeight);let a=-n.scrollLeft+mv(e);const s=-n.scrollTop;return ar(r).direction==="rtl"&&(a+=pn(t.clientWidth,r.clientWidth)-o),{width:o,height:i,x:a,y:s}}function CN(e,t){const n=bn(e),r=Ar(e),o=n.visualViewport;let i=r.clientWidth,a=r.clientHeight,s=0,u=0;if(o){i=o.width,a=o.height;const l=pv();(!l||l&&t==="fixed")&&(s=o.offsetLeft,u=o.offsetTop)}return{width:i,height:a,x:s,y:u}}function EN(e,t){const n=Ti(e,!0,t==="fixed"),r=n.top+e.clientTop,o=n.left+e.clientLeft,i=Ir(e)?ga(e):Sr(1),a=e.clientWidth*i.x,s=e.clientHeight*i.y,u=o*i.x,l=r*i.y;return{width:a,height:s,x:u,y:l}}function ny(e,t,n){let r;if(t==="viewport")r=CN(e,n);else if(t==="document")r=bN(Ar(e));else if(ir(t))r=EN(t,n);else{const o=Ww(e);r={x:t.x-o.x,y:t.y-o.y,width:t.width,height:t.height}}return ic(r)}function Uw(e,t){const n=Ko(e);return n===t||!ir(n)||Ua(n)?!1:ar(n).position==="fixed"||Uw(n,t)}function _N(e,t){const n=t.get(e);if(n)return n;let r=Js(e,[],!1).filter(s=>ir(s)&&Za(s)!=="body"),o=null;const i=ar(e).position==="fixed";let a=i?Ko(e):e;for(;ir(a)&&!Ua(a);){const s=ar(a),u=hv(a);!u&&s.position==="fixed"&&(o=null),(i?!u&&!o:!u&&s.position==="static"&&!!o&&["absolute","fixed"].includes(o.position)||gu(a)&&!u&&Uw(e,a))?r=r.filter(c=>c!==a):o=s,a=Ko(a)}return t.set(e,r),r}function SN(e){let{element:t,boundary:n,rootBoundary:r,strategy:o}=e;const a=[...n==="clippingAncestors"?Zc(t)?[]:_N(t,this._c):[].concat(n),r],s=a[0],u=a.reduce((l,c)=>{const d=ny(t,c,o);return l.top=pn(d.top,l.top),l.right=qo(d.right,l.right),l.bottom=qo(d.bottom,l.bottom),l.left=pn(d.left,l.left),l},ny(t,s,o));return{width:u.right-u.left,height:u.bottom-u.top,x:u.left,y:u.top}}function kN(e){const{width:t,height:n}=jw(e);return{width:t,height:n}}function RN(e,t,n){const r=Ir(t),o=Ar(t),i=n==="fixed",a=Ti(e,!0,i,t);let s={scrollLeft:0,scrollTop:0};const u=Sr(0);function l(){u.x=mv(o)}if(r||!r&&!i)if((Za(t)!=="body"||gu(o))&&(s=ed(t)),r){const h=Ti(t,!0,i,t);u.x=h.x+t.clientLeft,u.y=h.y+t.clientTop}else o&&l();i&&!r&&o&&l();const c=o&&!r&&!i?zw(o,s):Sr(0),d=a.left+s.scrollLeft-u.x-c.x,f=a.top+s.scrollTop-u.y-c.y;return{x:d,y:f,width:a.width,height:a.height}}function nf(e){return ar(e).position==="static"}function ry(e,t){if(!Ir(e)||ar(e).position==="fixed")return null;if(t)return t(e);let n=e.offsetParent;return Ar(e)===n&&(n=n.ownerDocument.body),n}function $w(e,t){const n=bn(e);if(Zc(e))return n;if(!Ir(e)){let o=Ko(e);for(;o&&!Ua(o);){if(ir(o)&&!nf(o))return o;o=Ko(o)}return n}let r=ry(e,t);for(;r&&vN(r)&&nf(r);)r=ry(r,t);return r&&Ua(r)&&nf(r)&&!hv(r)?n:r||mN(e)||n}const NN=async function(e){const t=this.getOffsetParent||$w,n=this.getDimensions,r=await n(e.floating);return{reference:RN(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}};function IN(e){return ar(e).direction==="rtl"}const TN={convertOffsetParentRelativeRectToViewportRelativeRect:xN,getDocumentElement:Ar,getClippingRect:SN,getOffsetParent:$w,getElementRects:NN,getClientRects:wN,getDimensions:kN,getScale:ga,isElement:ir,isRTL:IN};function Vw(e,t){return e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height}function AN(e,t){let n=null,r;const o=Ar(e);function i(){var s;clearTimeout(r),(s=n)==null||s.disconnect(),n=null}function a(s,u){s===void 0&&(s=!1),u===void 0&&(u=1),i();const l=e.getBoundingClientRect(),{left:c,top:d,width:f,height:h}=l;if(s||t(),!f||!h)return;const v=Qu(d),m=Qu(o.clientWidth-(c+f)),g=Qu(o.clientHeight-(d+h)),p=Qu(c),x={rootMargin:-v+"px "+-m+"px "+-g+"px "+-p+"px",threshold:pn(0,qo(1,u))||1};let w=!0;function b(C){const E=C[0].intersectionRatio;if(E!==u){if(!w)return a();E?a(!1,E):r=setTimeout(()=>{a(!1,1e-7)},1e3)}E===1&&!Vw(l,e.getBoundingClientRect())&&a(),w=!1}try{n=new IntersectionObserver(b,{...x,root:o.ownerDocument})}catch{n=new IntersectionObserver(b,x)}n.observe(e)}return a(!0),i}function PN(e,t,n,r){r===void 0&&(r={});const{ancestorScroll:o=!0,ancestorResize:i=!0,elementResize:a=typeof ResizeObserver=="function",layoutShift:s=typeof IntersectionObserver=="function",animationFrame:u=!1}=r,l=vv(e),c=o||i?[...l?Js(l):[],...Js(t)]:[];c.forEach(p=>{o&&p.addEventListener("scroll",n,{passive:!0}),i&&p.addEventListener("resize",n)});const d=l&&s?AN(l,n):null;let f=-1,h=null;a&&(h=new ResizeObserver(p=>{let[y]=p;y&&y.target===l&&h&&(h.unobserve(t),cancelAnimationFrame(f),f=requestAnimationFrame(()=>{var x;(x=h)==null||x.observe(t)})),n()}),l&&!u&&h.observe(l),h.observe(t));let v,m=u?Ti(e):null;u&&g();function g(){const p=Ti(e);m&&!Vw(m,p)&&n(),m=p,v=requestAnimationFrame(g)}return n(),()=>{var p;c.forEach(y=>{o&&y.removeEventListener("scroll",n),i&&y.removeEventListener("resize",n)}),d==null||d(),(p=h)==null||p.disconnect(),h=null,u&&cancelAnimationFrame(v)}}const DN=dN,FN=fN,MN=uN,ON=pN,LN=lN,oy=sN,BN=hN,jN=(e,t,n)=>{const r=new Map,o={platform:TN,...n},i={...o.platform,_c:r};return aN(e,t,{...o,platform:i})};var WN=typeof document<"u",zN=function(){},Rl=WN?A.useLayoutEffect:zN;function ac(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if(typeof e=="function"&&e.toString()===t.toString())return!0;let n,r,o;if(e&&t&&typeof e=="object"){if(Array.isArray(e)){if(n=e.length,n!==t.length)return!1;for(r=n;r--!==0;)if(!ac(e[r],t[r]))return!1;return!0}if(o=Object.keys(e),n=o.length,n!==Object.keys(t).length)return!1;for(r=n;r--!==0;)if(!{}.hasOwnProperty.call(t,o[r]))return!1;for(r=n;r--!==0;){const i=o[r];if(!(i==="_owner"&&e.$$typeof)&&!ac(e[i],t[i]))return!1}return!0}return e!==e&&t!==t}function Hw(e){return typeof window>"u"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function iy(e,t){const n=Hw(e);return Math.round(t*n)/n}function rf(e){const t=A.useRef(e);return Rl(()=>{t.current=e}),t}function UN(e){e===void 0&&(e={});const{placement:t="bottom",strategy:n="absolute",middleware:r=[],platform:o,elements:{reference:i,floating:a}={},transform:s=!0,whileElementsMounted:u,open:l}=e,[c,d]=A.useState({x:0,y:0,strategy:n,placement:t,middlewareData:{},isPositioned:!1}),[f,h]=A.useState(r);ac(f,r)||h(r);const[v,m]=A.useState(null),[g,p]=A.useState(null),y=A.useCallback(D=>{D!==C.current&&(C.current=D,m(D))},[]),x=A.useCallback(D=>{D!==E.current&&(E.current=D,p(D))},[]),w=i||v,b=a||g,C=A.useRef(null),E=A.useRef(null),S=A.useRef(c),R=u!=null,k=rf(u),P=rf(o),T=rf(l),j=A.useCallback(()=>{if(!C.current||!E.current)return;const D={placement:t,strategy:n,middleware:f};P.current&&(D.platform=P.current),jN(C.current,E.current,D).then(M=>{const B={...M,isPositioned:T.current!==!1};O.current&&!ac(S.current,B)&&(S.current=B,vu.flushSync(()=>{d(B)}))})},[f,t,n,P,T]);Rl(()=>{l===!1&&S.current.isPositioned&&(S.current.isPositioned=!1,d(D=>({...D,isPositioned:!1})))},[l]);const O=A.useRef(!1);Rl(()=>(O.current=!0,()=>{O.current=!1}),[]),Rl(()=>{if(w&&(C.current=w),b&&(E.current=b),w&&b){if(k.current)return k.current(w,b,j);j()}},[w,b,j,k,R]);const W=A.useMemo(()=>({reference:C,floating:E,setReference:y,setFloating:x}),[y,x]),U=A.useMemo(()=>({reference:w,floating:b}),[w,b]),z=A.useMemo(()=>{const D={position:n,left:0,top:0};if(!U.floating)return D;const M=iy(U.floating,c.x),B=iy(U.floating,c.y);return s?{...D,transform:"translate("+M+"px, "+B+"px)",...Hw(U.floating)>=1.5&&{willChange:"transform"}}:{position:n,left:M,top:B}},[n,s,U.floating,c.x,c.y]);return A.useMemo(()=>({...c,update:j,refs:W,elements:U,floatingStyles:z}),[c,j,W,U,z])}const $N=e=>{function t(n){return{}.hasOwnProperty.call(n,"current")}return{name:"arrow",options:e,fn(n){const{element:r,padding:o}=typeof e=="function"?e(n):e;return r&&t(r)?r.current!=null?oy({element:r.current,padding:o}).fn(n):{}:r?oy({element:r,padding:o}).fn(n):{}}}},VN=(e,t)=>({...DN(e),options:[e,t]}),HN=(e,t)=>({...FN(e),options:[e,t]}),GN=(e,t)=>({...BN(e),options:[e,t]}),qN=(e,t)=>({...MN(e),options:[e,t]}),KN=(e,t)=>({...ON(e),options:[e,t]}),XN=(e,t)=>({...LN(e),options:[e,t]}),YN=(e,t)=>({...$N(e),options:[e,t]});var QN="Arrow",Gw=A.forwardRef((e,t)=>{const{children:n,width:r=10,height:o=5,...i}=e;return _.jsx(cn.svg,{...i,ref:t,width:r,height:o,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?n:_.jsx("polygon",{points:"0,0 30,0 15,10"})})});Gw.displayName=QN;var JN=Gw;function ZN(e){const[t,n]=A.useState(void 0);return Go(()=>{if(e){n({width:e.offsetWidth,height:e.offsetHeight});const r=new ResizeObserver(o=>{if(!Array.isArray(o)||!o.length)return;const i=o[0];let a,s;if("borderBoxSize"in i){const u=i.borderBoxSize,l=Array.isArray(u)?u[0]:u;a=l.inlineSize,s=l.blockSize}else a=e.offsetWidth,s=e.offsetHeight;n({width:a,height:s})});return r.observe(e,{box:"border-box"}),()=>r.unobserve(e)}else n(void 0)},[e]),t}var qw="Popper",[Kw,Xw]=Xc(qw),[_L,Yw]=Kw(qw),Qw="PopperAnchor",Jw=A.forwardRef((e,t)=>{const{__scopePopper:n,virtualRef:r,...o}=e,i=Yw(Qw,n),a=A.useRef(null),s=or(t,a);return A.useEffect(()=>{i.onAnchorChange((r==null?void 0:r.current)||a.current)}),r?null:_.jsx(cn.div,{...o,ref:s})});Jw.displayName=Qw;var gv="PopperContent",[eI,tI]=Kw(gv),Zw=A.forwardRef((e,t)=>{var re,xe,me,Pe,pe,ke;const{__scopePopper:n,side:r="bottom",sideOffset:o=0,align:i="center",alignOffset:a=0,arrowPadding:s=0,avoidCollisions:u=!0,collisionBoundary:l=[],collisionPadding:c=0,sticky:d="partial",hideWhenDetached:f=!1,updatePositionStrategy:h="optimized",onPlaced:v,...m}=e,g=Yw(gv,n),[p,y]=A.useState(null),x=or(t,Ce=>y(Ce)),[w,b]=A.useState(null),C=ZN(w),E=(C==null?void 0:C.width)??0,S=(C==null?void 0:C.height)??0,R=r+(i!=="center"?"-"+i:""),k=typeof c=="number"?c:{top:0,right:0,bottom:0,left:0,...c},P=Array.isArray(l)?l:[l],T=P.length>0,j={padding:k,boundary:P.filter(rI),altBoundary:T},{refs:O,floatingStyles:W,placement:U,isPositioned:z,middlewareData:D}=UN({strategy:"fixed",placement:R,whileElementsMounted:(...Ce)=>PN(...Ce,{animationFrame:h==="always"}),elements:{reference:g.anchor},middleware:[VN({mainAxis:o+S,alignmentAxis:a}),u&&HN({mainAxis:!0,crossAxis:!1,limiter:d==="partial"?GN():void 0,...j}),u&&qN({...j}),KN({...j,apply:({elements:Ce,rects:Oe,availableWidth:Le,availableHeight:Fe})=>{const{width:Yt,height:Nt}=Oe.reference,ot=Ce.floating.style;ot.setProperty("--radix-popper-available-width",`${Le}px`),ot.setProperty("--radix-popper-available-height",`${Fe}px`),ot.setProperty("--radix-popper-anchor-width",`${Yt}px`),ot.setProperty("--radix-popper-anchor-height",`${Nt}px`)}}),w&&YN({element:w,padding:s}),oI({arrowWidth:E,arrowHeight:S}),f&&XN({strategy:"referenceHidden",...j})]}),[M,B]=nb(U),q=Ho(v);Go(()=>{z&&(q==null||q())},[z,q]);const K=(re=D.arrow)==null?void 0:re.x,Q=(xe=D.arrow)==null?void 0:xe.y,Z=((me=D.arrow)==null?void 0:me.centerOffset)!==0,[se,de]=A.useState();return Go(()=>{p&&de(window.getComputedStyle(p).zIndex)},[p]),_.jsx("div",{ref:O.setFloating,"data-radix-popper-content-wrapper":"",style:{...W,transform:z?W.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:se,"--radix-popper-transform-origin":[(Pe=D.transformOrigin)==null?void 0:Pe.x,(pe=D.transformOrigin)==null?void 0:pe.y].join(" "),...((ke=D.hide)==null?void 0:ke.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:e.dir,children:_.jsx(eI,{scope:n,placedSide:M,onArrowChange:b,arrowX:K,arrowY:Q,shouldHideArrow:Z,children:_.jsx(cn.div,{"data-side":M,"data-align":B,...m,ref:x,style:{...m.style,animation:z?void 0:"none"}})})})});Zw.displayName=gv;var eb="PopperArrow",nI={top:"bottom",right:"left",bottom:"top",left:"right"},tb=A.forwardRef(function(t,n){const{__scopePopper:r,...o}=t,i=tI(eb,r),a=nI[i.placedSide];return _.jsx("span",{ref:i.onArrowChange,style:{position:"absolute",left:i.arrowX,top:i.arrowY,[a]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[i.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[i.placedSide],visibility:i.shouldHideArrow?"hidden":void 0},children:_.jsx(JN,{...o,ref:n,style:{...o.style,display:"block"}})})});tb.displayName=eb;function rI(e){return e!==null}var oI=e=>({name:"transformOrigin",options:e,fn(t){var g,p,y;const{placement:n,rects:r,middlewareData:o}=t,a=((g=o.arrow)==null?void 0:g.centerOffset)!==0,s=a?0:e.arrowWidth,u=a?0:e.arrowHeight,[l,c]=nb(n),d={start:"0%",center:"50%",end:"100%"}[c],f=(((p=o.arrow)==null?void 0:p.x)??0)+s/2,h=(((y=o.arrow)==null?void 0:y.y)??0)+u/2;let v="",m="";return l==="bottom"?(v=a?d:`${f}px`,m=`${-u}px`):l==="top"?(v=a?d:`${f}px`,m=`${r.floating.height+u}px`):l==="right"?(v=`${-u}px`,m=a?d:`${h}px`):l==="left"&&(v=`${r.floating.width+u}px`,m=a?d:`${h}px`),{data:{x:v,y:m}}}});function nb(e){const[t,n="center"]=e.split("-");return[t,n]}var iI=Jw,aI=Zw,sI=tb,[td,SL]=Xc("Tooltip",[Xw]),yv=Xw(),rb="TooltipProvider",uI=700,ay="tooltip.open",[lI,ob]=td(rb),ib=e=>{const{__scopeTooltip:t,delayDuration:n=uI,skipDelayDuration:r=300,disableHoverableContent:o=!1,children:i}=e,a=A.useRef(!0),s=A.useRef(!1),u=A.useRef(0);return A.useEffect(()=>{const l=u.current;return()=>window.clearTimeout(l)},[]),_.jsx(lI,{scope:t,isOpenDelayedRef:a,delayDuration:n,onOpen:A.useCallback(()=>{window.clearTimeout(u.current),a.current=!1},[]),onClose:A.useCallback(()=>{window.clearTimeout(u.current),u.current=window.setTimeout(()=>a.current=!0,r)},[r]),isPointerInTransitRef:s,onPointerInTransitChange:A.useCallback(l=>{s.current=l},[]),disableHoverableContent:o,children:i})};ib.displayName=rb;var ab="Tooltip",[kL,nd]=td(ab),Mh="TooltipTrigger",cI=A.forwardRef((e,t)=>{const{__scopeTooltip:n,...r}=e,o=nd(Mh,n),i=ob(Mh,n),a=yv(n),s=A.useRef(null),u=or(t,s,o.onTriggerChange),l=A.useRef(!1),c=A.useRef(!1),d=A.useCallback(()=>l.current=!1,[]);return A.useEffect(()=>()=>document.removeEventListener("pointerup",d),[d]),_.jsx(iI,{asChild:!0,...a,children:_.jsx(cn.button,{"aria-describedby":o.open?o.contentId:void 0,"data-state":o.stateAttribute,...r,ref:u,onPointerMove:lt(e.onPointerMove,f=>{f.pointerType!=="touch"&&!c.current&&!i.isPointerInTransitRef.current&&(o.onTriggerEnter(),c.current=!0)}),onPointerLeave:lt(e.onPointerLeave,()=>{o.onTriggerLeave(),c.current=!1}),onPointerDown:lt(e.onPointerDown,()=>{o.open&&o.onClose(),l.current=!0,document.addEventListener("pointerup",d,{once:!0})}),onFocus:lt(e.onFocus,()=>{l.current||o.onOpen()}),onBlur:lt(e.onBlur,o.onClose),onClick:lt(e.onClick,o.onClose)})})});cI.displayName=Mh;var dI="TooltipPortal",[RL,fI]=td(dI,{forceMount:void 0}),$a="TooltipContent",sb=A.forwardRef((e,t)=>{const n=fI($a,e.__scopeTooltip),{forceMount:r=n.forceMount,side:o="top",...i}=e,a=nd($a,e.__scopeTooltip);return _.jsx(iv,{present:r||a.open,children:a.disableHoverableContent?_.jsx(ub,{side:o,...i,ref:t}):_.jsx(hI,{side:o,...i,ref:t})})}),hI=A.forwardRef((e,t)=>{const n=nd($a,e.__scopeTooltip),r=ob($a,e.__scopeTooltip),o=A.useRef(null),i=or(t,o),[a,s]=A.useState(null),{trigger:u,onClose:l}=n,c=o.current,{onPointerInTransitChange:d}=r,f=A.useCallback(()=>{s(null),d(!1)},[d]),h=A.useCallback((v,m)=>{const g=v.currentTarget,p={x:v.clientX,y:v.clientY},y=yI(p,g.getBoundingClientRect()),x=xI(p,y),w=wI(m.getBoundingClientRect()),b=CI([...x,...w]);s(b),d(!0)},[d]);return A.useEffect(()=>()=>f(),[f]),A.useEffect(()=>{if(u&&c){const v=g=>h(g,c),m=g=>h(g,u);return u.addEventListener("pointerleave",v),c.addEventListener("pointerleave",m),()=>{u.removeEventListener("pointerleave",v),c.removeEventListener("pointerleave",m)}}},[u,c,h,f]),A.useEffect(()=>{if(a){const v=m=>{const g=m.target,p={x:m.clientX,y:m.clientY},y=(u==null?void 0:u.contains(g))||(c==null?void 0:c.contains(g)),x=!bI(p,a);y?f():x&&(f(),l())};return document.addEventListener("pointermove",v),()=>document.removeEventListener("pointermove",v)}},[u,c,a,l,f]),_.jsx(ub,{...e,ref:i})}),[pI,vI]=td(ab,{isInside:!1}),mI=DS("TooltipContent"),ub=A.forwardRef((e,t)=>{const{__scopeTooltip:n,children:r,"aria-label":o,onEscapeKeyDown:i,onPointerDownOutside:a,...s}=e,u=nd($a,n),l=yv(n),{onClose:c}=u;return A.useEffect(()=>(document.addEventListener(ay,c),()=>document.removeEventListener(ay,c)),[c]),A.useEffect(()=>{if(u.trigger){const d=f=>{const h=f.target;h!=null&&h.contains(u.trigger)&&c()};return window.addEventListener("scroll",d,{capture:!0}),()=>window.removeEventListener("scroll",d,{capture:!0})}},[u.trigger,c]),_.jsx(ov,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:i,onPointerDownOutside:a,onFocusOutside:d=>d.preventDefault(),onDismiss:c,children:_.jsxs(aI,{"data-state":u.stateAttribute,...l,...s,ref:t,style:{...s.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[_.jsx(mI,{children:r}),_.jsx(pI,{scope:n,isInside:!0,children:_.jsx(ok,{id:u.contentId,role:"tooltip",children:o||r})})]})})});sb.displayName=$a;var lb="TooltipArrow",gI=A.forwardRef((e,t)=>{const{__scopeTooltip:n,...r}=e,o=yv(n);return vI(lb,n).isInside?null:_.jsx(sI,{...o,...r,ref:t})});gI.displayName=lb;function yI(e,t){const n=Math.abs(t.top-e.y),r=Math.abs(t.bottom-e.y),o=Math.abs(t.right-e.x),i=Math.abs(t.left-e.x);switch(Math.min(n,r,o,i)){case i:return"left";case o:return"right";case n:return"top";case r:return"bottom";default:throw new Error("unreachable")}}function xI(e,t,n=5){const r=[];switch(t){case"top":r.push({x:e.x-n,y:e.y+n},{x:e.x+n,y:e.y+n});break;case"bottom":r.push({x:e.x-n,y:e.y-n},{x:e.x+n,y:e.y-n});break;case"left":r.push({x:e.x+n,y:e.y-n},{x:e.x+n,y:e.y+n});break;case"right":r.push({x:e.x-n,y:e.y-n},{x:e.x-n,y:e.y+n});break}return r}function wI(e){const{top:t,right:n,bottom:r,left:o}=e;return[{x:o,y:t},{x:n,y:t},{x:n,y:r},{x:o,y:r}]}function bI(e,t){const{x:n,y:r}=e;let o=!1;for(let i=0,a=t.length-1;i<t.length;a=i++){const s=t[i],u=t[a],l=s.x,c=s.y,d=u.x,f=u.y;c>r!=f>r&&n<(d-l)*(r-c)/(f-c)+l&&(o=!o)}return o}function CI(e){const t=e.slice();return t.sort((n,r)=>n.x<r.x?-1:n.x>r.x?1:n.y<r.y?-1:n.y>r.y?1:0),EI(t)}function EI(e){if(e.length<=1)return e.slice();const t=[];for(let r=0;r<e.length;r++){const o=e[r];for(;t.length>=2;){const i=t[t.length-1],a=t[t.length-2];if((i.x-a.x)*(o.y-a.y)>=(i.y-a.y)*(o.x-a.x))t.pop();else break}t.push(o)}t.pop();const n=[];for(let r=e.length-1;r>=0;r--){const o=e[r];for(;n.length>=2;){const i=n[n.length-1],a=n[n.length-2];if((i.x-a.x)*(o.y-a.y)>=(i.y-a.y)*(o.x-a.x))n.pop();else break}n.push(o)}return n.pop(),t.length===1&&n.length===1&&t[0].x===n[0].x&&t[0].y===n[0].y?t:t.concat(n)}var _I=ib,cb=sb;const SI=_I,kI=A.forwardRef(({className:e,sideOffset:t=4,...n},r)=>_.jsx(cb,{ref:r,sideOffset:t,className:qt("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...n}));kI.displayName=cb.displayName;var rd=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},od=typeof window>"u"||"Deno"in globalThis;function qn(){}function RI(e,t){return typeof e=="function"?e(t):e}function NI(e){return typeof e=="number"&&e>=0&&e!==1/0}function II(e,t){return Math.max(e+(t||0)-Date.now(),0)}function Oh(e,t){return typeof e=="function"?e(t):e}function TI(e,t){return typeof e=="function"?e(t):e}function sy(e,t){const{type:n="all",exact:r,fetchStatus:o,predicate:i,queryKey:a,stale:s}=e;if(a){if(r){if(t.queryHash!==xv(a,t.options))return!1}else if(!eu(t.queryKey,a))return!1}if(n!=="all"){const u=t.isActive();if(n==="active"&&!u||n==="inactive"&&u)return!1}return!(typeof s=="boolean"&&t.isStale()!==s||o&&o!==t.state.fetchStatus||i&&!i(t))}function uy(e,t){const{exact:n,status:r,predicate:o,mutationKey:i}=e;if(i){if(!t.options.mutationKey)return!1;if(n){if(Zs(t.options.mutationKey)!==Zs(i))return!1}else if(!eu(t.options.mutationKey,i))return!1}return!(r&&t.state.status!==r||o&&!o(t))}function xv(e,t){return((t==null?void 0:t.queryKeyHashFn)||Zs)(e)}function Zs(e){return JSON.stringify(e,(t,n)=>Lh(n)?Object.keys(n).sort().reduce((r,o)=>(r[o]=n[o],r),{}):n)}function eu(e,t){return e===t?!0:typeof e!=typeof t?!1:e&&t&&typeof e=="object"&&typeof t=="object"?Object.keys(t).every(n=>eu(e[n],t[n])):!1}function db(e,t){if(e===t)return e;const n=ly(e)&&ly(t);if(n||Lh(e)&&Lh(t)){const r=n?e:Object.keys(e),o=r.length,i=n?t:Object.keys(t),a=i.length,s=n?[]:{},u=new Set(r);let l=0;for(let c=0;c<a;c++){const d=n?c:i[c];(!n&&u.has(d)||n)&&e[d]===void 0&&t[d]===void 0?(s[d]=void 0,l++):(s[d]=db(e[d],t[d]),s[d]===e[d]&&e[d]!==void 0&&l++)}return o===a&&l===o?e:s}return t}function ly(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function Lh(e){if(!cy(e))return!1;const t=e.constructor;if(t===void 0)return!0;const n=t.prototype;return!(!cy(n)||!n.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(e)!==Object.prototype)}function cy(e){return Object.prototype.toString.call(e)==="[object Object]"}function AI(e){return new Promise(t=>{setTimeout(t,e)})}function PI(e,t,n){return typeof n.structuralSharing=="function"?n.structuralSharing(e,t):n.structuralSharing!==!1?db(e,t):t}function DI(e,t,n=0){const r=[...e,t];return n&&r.length>n?r.slice(1):r}function FI(e,t,n=0){const r=[t,...e];return n&&r.length>n?r.slice(0,-1):r}var wv=Symbol();function fb(e,t){return!e.queryFn&&(t!=null&&t.initialPromise)?()=>t.initialPromise:!e.queryFn||e.queryFn===wv?()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`)):e.queryFn}var mi,Co,Ra,_0,MI=(_0=class extends rd{constructor(){super();Ie(this,mi);Ie(this,Co);Ie(this,Ra);ye(this,Ra,t=>{if(!od&&window.addEventListener){const n=()=>t();return window.addEventListener("visibilitychange",n,!1),()=>{window.removeEventListener("visibilitychange",n)}}})}onSubscribe(){G(this,Co)||this.setEventListener(G(this,Ra))}onUnsubscribe(){var t;this.hasListeners()||((t=G(this,Co))==null||t.call(this),ye(this,Co,void 0))}setEventListener(t){var n;ye(this,Ra,t),(n=G(this,Co))==null||n.call(this),ye(this,Co,t(r=>{typeof r=="boolean"?this.setFocused(r):this.onFocus()}))}setFocused(t){G(this,mi)!==t&&(ye(this,mi,t),this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(n=>{n(t)})}isFocused(){var t;return typeof G(this,mi)=="boolean"?G(this,mi):((t=globalThis.document)==null?void 0:t.visibilityState)!=="hidden"}},mi=new WeakMap,Co=new WeakMap,Ra=new WeakMap,_0),hb=new MI,Na,Eo,Ia,S0,OI=(S0=class extends rd{constructor(){super();Ie(this,Na,!0);Ie(this,Eo);Ie(this,Ia);ye(this,Ia,t=>{if(!od&&window.addEventListener){const n=()=>t(!0),r=()=>t(!1);return window.addEventListener("online",n,!1),window.addEventListener("offline",r,!1),()=>{window.removeEventListener("online",n),window.removeEventListener("offline",r)}}})}onSubscribe(){G(this,Eo)||this.setEventListener(G(this,Ia))}onUnsubscribe(){var t;this.hasListeners()||((t=G(this,Eo))==null||t.call(this),ye(this,Eo,void 0))}setEventListener(t){var n;ye(this,Ia,t),(n=G(this,Eo))==null||n.call(this),ye(this,Eo,t(this.setOnline.bind(this)))}setOnline(t){G(this,Na)!==t&&(ye(this,Na,t),this.listeners.forEach(r=>{r(t)}))}isOnline(){return G(this,Na)}},Na=new WeakMap,Eo=new WeakMap,Ia=new WeakMap,S0),sc=new OI;function LI(){let e,t;const n=new Promise((o,i)=>{e=o,t=i});n.status="pending",n.catch(()=>{});function r(o){Object.assign(n,o),delete n.resolve,delete n.reject}return n.resolve=o=>{r({status:"fulfilled",value:o}),e(o)},n.reject=o=>{r({status:"rejected",reason:o}),t(o)},n}function BI(e){return Math.min(1e3*2**e,3e4)}function pb(e){return(e??"online")==="online"?sc.isOnline():!0}var vb=class extends Error{constructor(e){super("CancelledError"),this.revert=e==null?void 0:e.revert,this.silent=e==null?void 0:e.silent}};function of(e){return e instanceof vb}function mb(e){let t=!1,n=0,r=!1,o;const i=LI(),a=m=>{var g;r||(f(new vb(m)),(g=e.abort)==null||g.call(e))},s=()=>{t=!0},u=()=>{t=!1},l=()=>hb.isFocused()&&(e.networkMode==="always"||sc.isOnline())&&e.canRun(),c=()=>pb(e.networkMode)&&e.canRun(),d=m=>{var g;r||(r=!0,(g=e.onSuccess)==null||g.call(e,m),o==null||o(),i.resolve(m))},f=m=>{var g;r||(r=!0,(g=e.onError)==null||g.call(e,m),o==null||o(),i.reject(m))},h=()=>new Promise(m=>{var g;o=p=>{(r||l())&&m(p)},(g=e.onPause)==null||g.call(e)}).then(()=>{var m;o=void 0,r||(m=e.onContinue)==null||m.call(e)}),v=()=>{if(r)return;let m;const g=n===0?e.initialPromise:void 0;try{m=g??e.fn()}catch(p){m=Promise.reject(p)}Promise.resolve(m).then(d).catch(p=>{var C;if(r)return;const y=e.retry??(od?0:3),x=e.retryDelay??BI,w=typeof x=="function"?x(n,p):x,b=y===!0||typeof y=="number"&&n<y||typeof y=="function"&&y(n,p);if(t||!b){f(p);return}n++,(C=e.onFail)==null||C.call(e,n,p),AI(w).then(()=>l()?void 0:h()).then(()=>{t?f(p):v()})})};return{promise:i,cancel:a,continue:()=>(o==null||o(),i),cancelRetry:s,continueRetry:u,canStart:c,start:()=>(c()?v():h().then(v),i)}}var jI=e=>setTimeout(e,0);function WI(){let e=[],t=0,n=s=>{s()},r=s=>{s()},o=jI;const i=s=>{t?e.push(s):o(()=>{n(s)})},a=()=>{const s=e;e=[],s.length&&o(()=>{r(()=>{s.forEach(u=>{n(u)})})})};return{batch:s=>{let u;t++;try{u=s()}finally{t--,t||a()}return u},batchCalls:s=>(...u)=>{i(()=>{s(...u)})},schedule:i,setNotifyFunction:s=>{n=s},setBatchNotifyFunction:s=>{r=s},setScheduler:s=>{o=s}}}var Ht=WI(),gi,k0,gb=(k0=class{constructor(){Ie(this,gi)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),NI(this.gcTime)&&ye(this,gi,setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(od?1/0:5*60*1e3))}clearGcTimeout(){G(this,gi)&&(clearTimeout(G(this,gi)),ye(this,gi,void 0))}},gi=new WeakMap,k0),Ta,yi,Rn,xi,Dt,uu,wi,Kn,jr,R0,zI=(R0=class extends gb{constructor(t){super();Ie(this,Kn);Ie(this,Ta);Ie(this,yi);Ie(this,Rn);Ie(this,xi);Ie(this,Dt);Ie(this,uu);Ie(this,wi);ye(this,wi,!1),ye(this,uu,t.defaultOptions),this.setOptions(t.options),this.observers=[],ye(this,xi,t.client),ye(this,Rn,G(this,xi).getQueryCache()),this.queryKey=t.queryKey,this.queryHash=t.queryHash,ye(this,Ta,$I(this.options)),this.state=t.state??G(this,Ta),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var t;return(t=G(this,Dt))==null?void 0:t.promise}setOptions(t){this.options={...G(this,uu),...t},this.updateGcTime(this.options.gcTime)}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&G(this,Rn).remove(this)}setData(t,n){const r=PI(this.state.data,t,this.options);return Tt(this,Kn,jr).call(this,{data:r,type:"success",dataUpdatedAt:n==null?void 0:n.updatedAt,manual:n==null?void 0:n.manual}),r}setState(t,n){Tt(this,Kn,jr).call(this,{type:"setState",state:t,setStateOptions:n})}cancel(t){var r,o;const n=(r=G(this,Dt))==null?void 0:r.promise;return(o=G(this,Dt))==null||o.cancel(t),n?n.then(qn).catch(qn):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(G(this,Ta))}isActive(){return this.observers.some(t=>TI(t.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===wv||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(t=>Oh(t.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(t=>t.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(t=0){return this.state.data===void 0?!0:t==="static"?!1:this.state.isInvalidated?!0:!II(this.state.dataUpdatedAt,t)}onFocus(){var n;const t=this.observers.find(r=>r.shouldFetchOnWindowFocus());t==null||t.refetch({cancelRefetch:!1}),(n=G(this,Dt))==null||n.continue()}onOnline(){var n;const t=this.observers.find(r=>r.shouldFetchOnReconnect());t==null||t.refetch({cancelRefetch:!1}),(n=G(this,Dt))==null||n.continue()}addObserver(t){this.observers.includes(t)||(this.observers.push(t),this.clearGcTimeout(),G(this,Rn).notify({type:"observerAdded",query:this,observer:t}))}removeObserver(t){this.observers.includes(t)&&(this.observers=this.observers.filter(n=>n!==t),this.observers.length||(G(this,Dt)&&(G(this,wi)?G(this,Dt).cancel({revert:!0}):G(this,Dt).cancelRetry()),this.scheduleGc()),G(this,Rn).notify({type:"observerRemoved",query:this,observer:t}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||Tt(this,Kn,jr).call(this,{type:"invalidate"})}fetch(t,n){var l,c,d;if(this.state.fetchStatus!=="idle"){if(this.state.data!==void 0&&(n!=null&&n.cancelRefetch))this.cancel({silent:!0});else if(G(this,Dt))return G(this,Dt).continueRetry(),G(this,Dt).promise}if(t&&this.setOptions(t),!this.options.queryFn){const f=this.observers.find(h=>h.options.queryFn);f&&this.setOptions(f.options)}const r=new AbortController,o=f=>{Object.defineProperty(f,"signal",{enumerable:!0,get:()=>(ye(this,wi,!0),r.signal)})},i=()=>{const f=fb(this.options,n),v=(()=>{const m={client:G(this,xi),queryKey:this.queryKey,meta:this.meta};return o(m),m})();return ye(this,wi,!1),this.options.persister?this.options.persister(f,v,this):f(v)},s=(()=>{const f={fetchOptions:n,options:this.options,queryKey:this.queryKey,client:G(this,xi),state:this.state,fetchFn:i};return o(f),f})();(l=this.options.behavior)==null||l.onFetch(s,this),ye(this,yi,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((c=s.fetchOptions)==null?void 0:c.meta))&&Tt(this,Kn,jr).call(this,{type:"fetch",meta:(d=s.fetchOptions)==null?void 0:d.meta});const u=f=>{var h,v,m,g;of(f)&&f.silent||Tt(this,Kn,jr).call(this,{type:"error",error:f}),of(f)||((v=(h=G(this,Rn).config).onError)==null||v.call(h,f,this),(g=(m=G(this,Rn).config).onSettled)==null||g.call(m,this.state.data,f,this)),this.scheduleGc()};return ye(this,Dt,mb({initialPromise:n==null?void 0:n.initialPromise,fn:s.fetchFn,abort:r.abort.bind(r),onSuccess:f=>{var h,v,m,g;if(f===void 0){u(new Error(`${this.queryHash} data is undefined`));return}try{this.setData(f)}catch(p){u(p);return}(v=(h=G(this,Rn).config).onSuccess)==null||v.call(h,f,this),(g=(m=G(this,Rn).config).onSettled)==null||g.call(m,f,this.state.error,this),this.scheduleGc()},onError:u,onFail:(f,h)=>{Tt(this,Kn,jr).call(this,{type:"failed",failureCount:f,error:h})},onPause:()=>{Tt(this,Kn,jr).call(this,{type:"pause"})},onContinue:()=>{Tt(this,Kn,jr).call(this,{type:"continue"})},retry:s.options.retry,retryDelay:s.options.retryDelay,networkMode:s.options.networkMode,canRun:()=>!0})),G(this,Dt).start()}},Ta=new WeakMap,yi=new WeakMap,Rn=new WeakMap,xi=new WeakMap,Dt=new WeakMap,uu=new WeakMap,wi=new WeakMap,Kn=new WeakSet,jr=function(t){const n=r=>{switch(t.type){case"failed":return{...r,fetchFailureCount:t.failureCount,fetchFailureReason:t.error};case"pause":return{...r,fetchStatus:"paused"};case"continue":return{...r,fetchStatus:"fetching"};case"fetch":return{...r,...UI(r.data,this.options),fetchMeta:t.meta??null};case"success":return ye(this,yi,void 0),{...r,data:t.data,dataUpdateCount:r.dataUpdateCount+1,dataUpdatedAt:t.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!t.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};case"error":const o=t.error;return of(o)&&o.revert&&G(this,yi)?{...G(this,yi),fetchStatus:"idle"}:{...r,error:o,errorUpdateCount:r.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:r.fetchFailureCount+1,fetchFailureReason:o,fetchStatus:"idle",status:"error"};case"invalidate":return{...r,isInvalidated:!0};case"setState":return{...r,...t.state}}};this.state=n(this.state),Ht.batch(()=>{this.observers.forEach(r=>{r.onQueryUpdate()}),G(this,Rn).notify({query:this,type:"updated",action:t})})},R0);function UI(e,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:pb(t.networkMode)?"fetching":"paused",...e===void 0&&{error:null,status:"pending"}}}function $I(e){const t=typeof e.initialData=="function"?e.initialData():e.initialData,n=t!==void 0,r=n?typeof e.initialDataUpdatedAt=="function"?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:n?r??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:n?"success":"pending",fetchStatus:"idle"}}var pr,N0,VI=(N0=class extends rd{constructor(t={}){super();Ie(this,pr);this.config=t,ye(this,pr,new Map)}build(t,n,r){const o=n.queryKey,i=n.queryHash??xv(o,n);let a=this.get(i);return a||(a=new zI({client:t,queryKey:o,queryHash:i,options:t.defaultQueryOptions(n),state:r,defaultOptions:t.getQueryDefaults(o)}),this.add(a)),a}add(t){G(this,pr).has(t.queryHash)||(G(this,pr).set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const n=G(this,pr).get(t.queryHash);n&&(t.destroy(),n===t&&G(this,pr).delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){Ht.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return G(this,pr).get(t)}getAll(){return[...G(this,pr).values()]}find(t){const n={exact:!0,...t};return this.getAll().find(r=>sy(n,r))}findAll(t={}){const n=this.getAll();return Object.keys(t).length>0?n.filter(r=>sy(t,r)):n}notify(t){Ht.batch(()=>{this.listeners.forEach(n=>{n(t)})})}onFocus(){Ht.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){Ht.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},pr=new WeakMap,N0),vr,$t,bi,mr,go,I0,HI=(I0=class extends gb{constructor(t){super();Ie(this,mr);Ie(this,vr);Ie(this,$t);Ie(this,bi);this.mutationId=t.mutationId,ye(this,$t,t.mutationCache),ye(this,vr,[]),this.state=t.state||GI(),this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options=t,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){G(this,vr).includes(t)||(G(this,vr).push(t),this.clearGcTimeout(),G(this,$t).notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){ye(this,vr,G(this,vr).filter(n=>n!==t)),this.scheduleGc(),G(this,$t).notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){G(this,vr).length||(this.state.status==="pending"?this.scheduleGc():G(this,$t).remove(this))}continue(){var t;return((t=G(this,bi))==null?void 0:t.continue())??this.execute(this.state.variables)}async execute(t){var i,a,s,u,l,c,d,f,h,v,m,g,p,y,x,w,b,C,E,S;const n=()=>{Tt(this,mr,go).call(this,{type:"continue"})};ye(this,bi,mb({fn:()=>this.options.mutationFn?this.options.mutationFn(t):Promise.reject(new Error("No mutationFn found")),onFail:(R,k)=>{Tt(this,mr,go).call(this,{type:"failed",failureCount:R,error:k})},onPause:()=>{Tt(this,mr,go).call(this,{type:"pause"})},onContinue:n,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>G(this,$t).canRun(this)}));const r=this.state.status==="pending",o=!G(this,bi).canStart();try{if(r)n();else{Tt(this,mr,go).call(this,{type:"pending",variables:t,isPaused:o}),await((a=(i=G(this,$t).config).onMutate)==null?void 0:a.call(i,t,this));const k=await((u=(s=this.options).onMutate)==null?void 0:u.call(s,t));k!==this.state.context&&Tt(this,mr,go).call(this,{type:"pending",context:k,variables:t,isPaused:o})}const R=await G(this,bi).start();return await((c=(l=G(this,$t).config).onSuccess)==null?void 0:c.call(l,R,t,this.state.context,this)),await((f=(d=this.options).onSuccess)==null?void 0:f.call(d,R,t,this.state.context)),await((v=(h=G(this,$t).config).onSettled)==null?void 0:v.call(h,R,null,this.state.variables,this.state.context,this)),await((g=(m=this.options).onSettled)==null?void 0:g.call(m,R,null,t,this.state.context)),Tt(this,mr,go).call(this,{type:"success",data:R}),R}catch(R){try{throw await((y=(p=G(this,$t).config).onError)==null?void 0:y.call(p,R,t,this.state.context,this)),await((w=(x=this.options).onError)==null?void 0:w.call(x,R,t,this.state.context)),await((C=(b=G(this,$t).config).onSettled)==null?void 0:C.call(b,void 0,R,this.state.variables,this.state.context,this)),await((S=(E=this.options).onSettled)==null?void 0:S.call(E,void 0,R,t,this.state.context)),R}finally{Tt(this,mr,go).call(this,{type:"error",error:R})}}finally{G(this,$t).runNext(this)}}},vr=new WeakMap,$t=new WeakMap,bi=new WeakMap,mr=new WeakSet,go=function(t){const n=r=>{switch(t.type){case"failed":return{...r,failureCount:t.failureCount,failureReason:t.error};case"pause":return{...r,isPaused:!0};case"continue":return{...r,isPaused:!1};case"pending":return{...r,context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:t.isPaused,status:"pending",variables:t.variables,submittedAt:Date.now()};case"success":return{...r,data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...r,data:void 0,error:t.error,failureCount:r.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"}}};this.state=n(this.state),Ht.batch(()=>{G(this,vr).forEach(r=>{r.onMutationUpdate(t)}),G(this,$t).notify({mutation:this,type:"updated",action:t})})},I0);function GI(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var $r,Xn,lu,T0,qI=(T0=class extends rd{constructor(t={}){super();Ie(this,$r);Ie(this,Xn);Ie(this,lu);this.config=t,ye(this,$r,new Set),ye(this,Xn,new Map),ye(this,lu,0)}build(t,n,r){const o=new HI({mutationCache:this,mutationId:++Iu(this,lu)._,options:t.defaultMutationOptions(n),state:r});return this.add(o),o}add(t){G(this,$r).add(t);const n=Ju(t);if(typeof n=="string"){const r=G(this,Xn).get(n);r?r.push(t):G(this,Xn).set(n,[t])}this.notify({type:"added",mutation:t})}remove(t){if(G(this,$r).delete(t)){const n=Ju(t);if(typeof n=="string"){const r=G(this,Xn).get(n);if(r)if(r.length>1){const o=r.indexOf(t);o!==-1&&r.splice(o,1)}else r[0]===t&&G(this,Xn).delete(n)}}this.notify({type:"removed",mutation:t})}canRun(t){const n=Ju(t);if(typeof n=="string"){const r=G(this,Xn).get(n),o=r==null?void 0:r.find(i=>i.state.status==="pending");return!o||o===t}else return!0}runNext(t){var r;const n=Ju(t);if(typeof n=="string"){const o=(r=G(this,Xn).get(n))==null?void 0:r.find(i=>i!==t&&i.state.isPaused);return(o==null?void 0:o.continue())??Promise.resolve()}else return Promise.resolve()}clear(){Ht.batch(()=>{G(this,$r).forEach(t=>{this.notify({type:"removed",mutation:t})}),G(this,$r).clear(),G(this,Xn).clear()})}getAll(){return Array.from(G(this,$r))}find(t){const n={exact:!0,...t};return this.getAll().find(r=>uy(n,r))}findAll(t={}){return this.getAll().filter(n=>uy(t,n))}notify(t){Ht.batch(()=>{this.listeners.forEach(n=>{n(t)})})}resumePausedMutations(){const t=this.getAll().filter(n=>n.state.isPaused);return Ht.batch(()=>Promise.all(t.map(n=>n.continue().catch(qn))))}},$r=new WeakMap,Xn=new WeakMap,lu=new WeakMap,T0);function Ju(e){var t;return(t=e.options.scope)==null?void 0:t.id}function dy(e){return{onFetch:(t,n)=>{var c,d,f,h,v;const r=t.options,o=(f=(d=(c=t.fetchOptions)==null?void 0:c.meta)==null?void 0:d.fetchMore)==null?void 0:f.direction,i=((h=t.state.data)==null?void 0:h.pages)||[],a=((v=t.state.data)==null?void 0:v.pageParams)||[];let s={pages:[],pageParams:[]},u=0;const l=async()=>{let m=!1;const g=x=>{Object.defineProperty(x,"signal",{enumerable:!0,get:()=>(t.signal.aborted?m=!0:t.signal.addEventListener("abort",()=>{m=!0}),t.signal)})},p=fb(t.options,t.fetchOptions),y=async(x,w,b)=>{if(m)return Promise.reject();if(w==null&&x.pages.length)return Promise.resolve(x);const E=(()=>{const P={client:t.client,queryKey:t.queryKey,pageParam:w,direction:b?"backward":"forward",meta:t.options.meta};return g(P),P})(),S=await p(E),{maxPages:R}=t.options,k=b?FI:DI;return{pages:k(x.pages,S,R),pageParams:k(x.pageParams,w,R)}};if(o&&i.length){const x=o==="backward",w=x?KI:fy,b={pages:i,pageParams:a},C=w(r,b);s=await y(b,C,x)}else{const x=e??i.length;do{const w=u===0?a[0]??r.initialPageParam:fy(r,s);if(u>0&&w==null)break;s=await y(s,w),u++}while(u<x)}return s};t.options.persister?t.fetchFn=()=>{var m,g;return(g=(m=t.options).persister)==null?void 0:g.call(m,l,{client:t.client,queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},n)}:t.fetchFn=l}}}function fy(e,{pages:t,pageParams:n}){const r=t.length-1;return t.length>0?e.getNextPageParam(t[r],t,n[r],n):void 0}function KI(e,{pages:t,pageParams:n}){var r;return t.length>0?(r=e.getPreviousPageParam)==null?void 0:r.call(e,t[0],t,n[0],n):void 0}var et,_o,So,Aa,Pa,ko,Da,Fa,A0,XI=(A0=class{constructor(e={}){Ie(this,et);Ie(this,_o);Ie(this,So);Ie(this,Aa);Ie(this,Pa);Ie(this,ko);Ie(this,Da);Ie(this,Fa);ye(this,et,e.queryCache||new VI),ye(this,_o,e.mutationCache||new qI),ye(this,So,e.defaultOptions||{}),ye(this,Aa,new Map),ye(this,Pa,new Map),ye(this,ko,0)}mount(){Iu(this,ko)._++,G(this,ko)===1&&(ye(this,Da,hb.subscribe(async e=>{e&&(await this.resumePausedMutations(),G(this,et).onFocus())})),ye(this,Fa,sc.subscribe(async e=>{e&&(await this.resumePausedMutations(),G(this,et).onOnline())})))}unmount(){var e,t;Iu(this,ko)._--,G(this,ko)===0&&((e=G(this,Da))==null||e.call(this),ye(this,Da,void 0),(t=G(this,Fa))==null||t.call(this),ye(this,Fa,void 0))}isFetching(e){return G(this,et).findAll({...e,fetchStatus:"fetching"}).length}isMutating(e){return G(this,_o).findAll({...e,status:"pending"}).length}getQueryData(e){var n;const t=this.defaultQueryOptions({queryKey:e});return(n=G(this,et).get(t.queryHash))==null?void 0:n.state.data}ensureQueryData(e){const t=this.defaultQueryOptions(e),n=G(this,et).build(this,t),r=n.state.data;return r===void 0?this.fetchQuery(e):(e.revalidateIfStale&&n.isStaleByTime(Oh(t.staleTime,n))&&this.prefetchQuery(t),Promise.resolve(r))}getQueriesData(e){return G(this,et).findAll(e).map(({queryKey:t,state:n})=>{const r=n.data;return[t,r]})}setQueryData(e,t,n){const r=this.defaultQueryOptions({queryKey:e}),o=G(this,et).get(r.queryHash),i=o==null?void 0:o.state.data,a=RI(t,i);if(a!==void 0)return G(this,et).build(this,r).setData(a,{...n,manual:!0})}setQueriesData(e,t,n){return Ht.batch(()=>G(this,et).findAll(e).map(({queryKey:r})=>[r,this.setQueryData(r,t,n)]))}getQueryState(e){var n;const t=this.defaultQueryOptions({queryKey:e});return(n=G(this,et).get(t.queryHash))==null?void 0:n.state}removeQueries(e){const t=G(this,et);Ht.batch(()=>{t.findAll(e).forEach(n=>{t.remove(n)})})}resetQueries(e,t){const n=G(this,et);return Ht.batch(()=>(n.findAll(e).forEach(r=>{r.reset()}),this.refetchQueries({type:"active",...e},t)))}cancelQueries(e,t={}){const n={revert:!0,...t},r=Ht.batch(()=>G(this,et).findAll(e).map(o=>o.cancel(n)));return Promise.all(r).then(qn).catch(qn)}invalidateQueries(e,t={}){return Ht.batch(()=>(G(this,et).findAll(e).forEach(n=>{n.invalidate()}),(e==null?void 0:e.refetchType)==="none"?Promise.resolve():this.refetchQueries({...e,type:(e==null?void 0:e.refetchType)??(e==null?void 0:e.type)??"active"},t)))}refetchQueries(e,t={}){const n={...t,cancelRefetch:t.cancelRefetch??!0},r=Ht.batch(()=>G(this,et).findAll(e).filter(o=>!o.isDisabled()&&!o.isStatic()).map(o=>{let i=o.fetch(void 0,n);return n.throwOnError||(i=i.catch(qn)),o.state.fetchStatus==="paused"?Promise.resolve():i}));return Promise.all(r).then(qn)}fetchQuery(e){const t=this.defaultQueryOptions(e);t.retry===void 0&&(t.retry=!1);const n=G(this,et).build(this,t);return n.isStaleByTime(Oh(t.staleTime,n))?n.fetch(t):Promise.resolve(n.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(qn).catch(qn)}fetchInfiniteQuery(e){return e.behavior=dy(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(qn).catch(qn)}ensureInfiniteQueryData(e){return e.behavior=dy(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return sc.isOnline()?G(this,_o).resumePausedMutations():Promise.resolve()}getQueryCache(){return G(this,et)}getMutationCache(){return G(this,_o)}getDefaultOptions(){return G(this,So)}setDefaultOptions(e){ye(this,So,e)}setQueryDefaults(e,t){G(this,Aa).set(Zs(e),{queryKey:e,defaultOptions:t})}getQueryDefaults(e){const t=[...G(this,Aa).values()],n={};return t.forEach(r=>{eu(e,r.queryKey)&&Object.assign(n,r.defaultOptions)}),n}setMutationDefaults(e,t){G(this,Pa).set(Zs(e),{mutationKey:e,defaultOptions:t})}getMutationDefaults(e){const t=[...G(this,Pa).values()],n={};return t.forEach(r=>{eu(e,r.mutationKey)&&Object.assign(n,r.defaultOptions)}),n}defaultQueryOptions(e){if(e._defaulted)return e;const t={...G(this,So).queries,...this.getQueryDefaults(e.queryKey),...e,_defaulted:!0};return t.queryHash||(t.queryHash=xv(t.queryKey,t)),t.refetchOnReconnect===void 0&&(t.refetchOnReconnect=t.networkMode!=="always"),t.throwOnError===void 0&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.queryFn===wv&&(t.enabled=!1),t}defaultMutationOptions(e){return e!=null&&e._defaulted?e:{...G(this,So).mutations,...(e==null?void 0:e.mutationKey)&&this.getMutationDefaults(e.mutationKey),...e,_defaulted:!0}}clear(){G(this,et).clear(),G(this,_o).clear()}},et=new WeakMap,_o=new WeakMap,So=new WeakMap,Aa=new WeakMap,Pa=new WeakMap,ko=new WeakMap,Da=new WeakMap,Fa=new WeakMap,A0),YI=A.createContext(void 0),QI=({client:e,children:t})=>(A.useEffect(()=>(e.mount(),()=>{e.unmount()}),[e]),_.jsx(YI.Provider,{value:e,children:t}));/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function uc(){return uc=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},uc.apply(this,arguments)}var Io;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(Io||(Io={}));const hy="popstate";function JI(e){e===void 0&&(e={});function t(r,o){let{pathname:i,search:a,hash:s}=r.location;return Bh("",{pathname:i,search:a,hash:s},o.state&&o.state.usr||null,o.state&&o.state.key||"default")}function n(r,o){return typeof o=="string"?o:xb(o)}return eT(t,n,null,e)}function sn(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function yb(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function ZI(){return Math.random().toString(36).substr(2,8)}function py(e,t){return{usr:e.state,key:e.key,idx:t}}function Bh(e,t,n,r){return n===void 0&&(n=null),uc({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?id(t):t,{state:n,key:t&&t.key||r||ZI()})}function xb(e){let{pathname:t="/",search:n="",hash:r=""}=e;return n&&n!=="?"&&(t+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(t+=r.charAt(0)==="#"?r:"#"+r),t}function id(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substr(n),e=e.substr(0,n));let r=e.indexOf("?");r>=0&&(t.search=e.substr(r),e=e.substr(0,r)),e&&(t.pathname=e)}return t}function eT(e,t,n,r){r===void 0&&(r={});let{window:o=document.defaultView,v5Compat:i=!1}=r,a=o.history,s=Io.Pop,u=null,l=c();l==null&&(l=0,a.replaceState(uc({},a.state,{idx:l}),""));function c(){return(a.state||{idx:null}).idx}function d(){s=Io.Pop;let g=c(),p=g==null?null:g-l;l=g,u&&u({action:s,location:m.location,delta:p})}function f(g,p){s=Io.Push;let y=Bh(m.location,g,p);l=c()+1;let x=py(y,l),w=m.createHref(y);try{a.pushState(x,"",w)}catch(b){if(b instanceof DOMException&&b.name==="DataCloneError")throw b;o.location.assign(w)}i&&u&&u({action:s,location:m.location,delta:1})}function h(g,p){s=Io.Replace;let y=Bh(m.location,g,p);l=c();let x=py(y,l),w=m.createHref(y);a.replaceState(x,"",w),i&&u&&u({action:s,location:m.location,delta:0})}function v(g){let p=o.location.origin!=="null"?o.location.origin:o.location.href,y=typeof g=="string"?g:xb(g);return y=y.replace(/ $/,"%20"),sn(p,"No window.location.(origin|href) available to create URL for href: "+y),new URL(y,p)}let m={get action(){return s},get location(){return e(o,a)},listen(g){if(u)throw new Error("A history only accepts one active listener");return o.addEventListener(hy,d),u=g,()=>{o.removeEventListener(hy,d),u=null}},createHref(g){return t(o,g)},createURL:v,encodeLocation(g){let p=v(g);return{pathname:p.pathname,search:p.search,hash:p.hash}},push:f,replace:h,go(g){return a.go(g)}};return m}var vy;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(vy||(vy={}));function tT(e,t,n){return n===void 0&&(n="/"),nT(e,t,n)}function nT(e,t,n,r){let o=typeof t=="string"?id(t):t,i=Cb(o.pathname||"/",n);if(i==null)return null;let a=wb(e);rT(a);let s=null;for(let u=0;s==null&&u<a.length;++u){let l=vT(i);s=fT(a[u],l)}return s}function wb(e,t,n,r){t===void 0&&(t=[]),n===void 0&&(n=[]),r===void 0&&(r="");let o=(i,a,s)=>{let u={relativePath:s===void 0?i.path||"":s,caseSensitive:i.caseSensitive===!0,childrenIndex:a,route:i};u.relativePath.startsWith("/")&&(sn(u.relativePath.startsWith(r),'Absolute route path "'+u.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),u.relativePath=u.relativePath.slice(r.length));let l=ya([r,u.relativePath]),c=n.concat(u);i.children&&i.children.length>0&&(sn(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+l+'".')),wb(i.children,t,c,l)),!(i.path==null&&!i.index)&&t.push({path:l,score:cT(l,i.index),routesMeta:c})};return e.forEach((i,a)=>{var s;if(i.path===""||!((s=i.path)!=null&&s.includes("?")))o(i,a);else for(let u of bb(i.path))o(i,a,u)}),t}function bb(e){let t=e.split("/");if(t.length===0)return[];let[n,...r]=t,o=n.endsWith("?"),i=n.replace(/\?$/,"");if(r.length===0)return o?[i,""]:[i];let a=bb(r.join("/")),s=[];return s.push(...a.map(u=>u===""?i:[i,u].join("/"))),o&&s.push(...a),s.map(u=>e.startsWith("/")&&u===""?"/":u)}function rT(e){e.sort((t,n)=>t.score!==n.score?n.score-t.score:dT(t.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const oT=/^:[\w-]+$/,iT=3,aT=2,sT=1,uT=10,lT=-2,my=e=>e==="*";function cT(e,t){let n=e.split("/"),r=n.length;return n.some(my)&&(r+=lT),t&&(r+=aT),n.filter(o=>!my(o)).reduce((o,i)=>o+(oT.test(i)?iT:i===""?sT:uT),r)}function dT(e,t){return e.length===t.length&&e.slice(0,-1).every((r,o)=>r===t[o])?e[e.length-1]-t[t.length-1]:0}function fT(e,t,n){let{routesMeta:r}=e,o={},i="/",a=[];for(let s=0;s<r.length;++s){let u=r[s],l=s===r.length-1,c=i==="/"?t:t.slice(i.length)||"/",d=hT({path:u.relativePath,caseSensitive:u.caseSensitive,end:l},c),f=u.route;if(!d)return null;Object.assign(o,d.params),a.push({params:o,pathname:ya([i,d.pathname]),pathnameBase:mT(ya([i,d.pathnameBase])),route:f}),d.pathnameBase!=="/"&&(i=ya([i,d.pathnameBase]))}return a}function hT(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[n,r]=pT(e.path,e.caseSensitive,e.end),o=t.match(n);if(!o)return null;let i=o[0],a=i.replace(/(.)\/+$/,"$1"),s=o.slice(1);return{params:r.reduce((l,c,d)=>{let{paramName:f,isOptional:h}=c;if(f==="*"){let m=s[d]||"";a=i.slice(0,i.length-m.length).replace(/(.)\/+$/,"$1")}const v=s[d];return h&&!v?l[f]=void 0:l[f]=(v||"").replace(/%2F/g,"/"),l},{}),pathname:i,pathnameBase:a,pattern:e}}function pT(e,t,n){t===void 0&&(t=!1),n===void 0&&(n=!0),yb(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let r=[],o="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(a,s,u)=>(r.push({paramName:s,isOptional:u!=null}),u?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(r.push({paramName:"*"}),o+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?o+="\\/*$":e!==""&&e!=="/"&&(o+="(?:(?=\\/|$))"),[new RegExp(o,t?void 0:"i"),r]}function vT(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return yb(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function Cb(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,r=e.charAt(n);return r&&r!=="/"?null:e.slice(n)||"/"}const ya=e=>e.join("/").replace(/\/\/+/g,"/"),mT=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/");function gT(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const Eb=["post","put","patch","delete"];new Set(Eb);const yT=["get",...Eb];new Set(yT);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function lc(){return lc=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},lc.apply(this,arguments)}const xT=A.createContext(null),wT=A.createContext(null),_b=A.createContext(null),ad=A.createContext(null),sd=A.createContext({outlet:null,matches:[],isDataRoute:!1}),Sb=A.createContext(null);function bv(){return A.useContext(ad)!=null}function kb(){return bv()||sn(!1),A.useContext(ad).location}function bT(e,t){return CT(e,t)}function CT(e,t,n,r){bv()||sn(!1);let{navigator:o}=A.useContext(_b),{matches:i}=A.useContext(sd),a=i[i.length-1],s=a?a.params:{};a&&a.pathname;let u=a?a.pathnameBase:"/";a&&a.route;let l=kb(),c;if(t){var d;let g=typeof t=="string"?id(t):t;u==="/"||(d=g.pathname)!=null&&d.startsWith(u)||sn(!1),c=g}else c=l;let f=c.pathname||"/",h=f;if(u!=="/"){let g=u.replace(/^\//,"").split("/");h="/"+f.replace(/^\//,"").split("/").slice(g.length).join("/")}let v=tT(e,{pathname:h}),m=RT(v&&v.map(g=>Object.assign({},g,{params:Object.assign({},s,g.params),pathname:ya([u,o.encodeLocation?o.encodeLocation(g.pathname).pathname:g.pathname]),pathnameBase:g.pathnameBase==="/"?u:ya([u,o.encodeLocation?o.encodeLocation(g.pathnameBase).pathname:g.pathnameBase])})),i,n,r);return t&&m?A.createElement(ad.Provider,{value:{location:lc({pathname:"/",search:"",hash:"",state:null,key:"default"},c),navigationType:Io.Pop}},m):m}function ET(){let e=AT(),t=gT(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,o={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return A.createElement(A.Fragment,null,A.createElement("h2",null,"Unexpected Application Error!"),A.createElement("h3",{style:{fontStyle:"italic"}},t),n?A.createElement("pre",{style:o},n):null,null)}const _T=A.createElement(ET,null);class ST extends A.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,n){return n.location!==t.location||n.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:n.error,location:n.location,revalidation:t.revalidation||n.revalidation}}componentDidCatch(t,n){console.error("React Router caught the following error during render",t,n)}render(){return this.state.error!==void 0?A.createElement(sd.Provider,{value:this.props.routeContext},A.createElement(Sb.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function kT(e){let{routeContext:t,match:n,children:r}=e,o=A.useContext(xT);return o&&o.static&&o.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(o.staticContext._deepestRenderedBoundaryId=n.route.id),A.createElement(sd.Provider,{value:t},r)}function RT(e,t,n,r){var o;if(t===void 0&&(t=[]),n===void 0&&(n=null),r===void 0&&(r=null),e==null){var i;if(!n)return null;if(n.errors)e=n.matches;else if((i=r)!=null&&i.v7_partialHydration&&t.length===0&&!n.initialized&&n.matches.length>0)e=n.matches;else return null}let a=e,s=(o=n)==null?void 0:o.errors;if(s!=null){let c=a.findIndex(d=>d.route.id&&(s==null?void 0:s[d.route.id])!==void 0);c>=0||sn(!1),a=a.slice(0,Math.min(a.length,c+1))}let u=!1,l=-1;if(n&&r&&r.v7_partialHydration)for(let c=0;c<a.length;c++){let d=a[c];if((d.route.HydrateFallback||d.route.hydrateFallbackElement)&&(l=c),d.route.id){let{loaderData:f,errors:h}=n,v=d.route.loader&&f[d.route.id]===void 0&&(!h||h[d.route.id]===void 0);if(d.route.lazy||v){u=!0,l>=0?a=a.slice(0,l+1):a=[a[0]];break}}}return a.reduceRight((c,d,f)=>{let h,v=!1,m=null,g=null;n&&(h=s&&d.route.id?s[d.route.id]:void 0,m=d.route.errorElement||_T,u&&(l<0&&f===0?(PT("route-fallback"),v=!0,g=null):l===f&&(v=!0,g=d.route.hydrateFallbackElement||null)));let p=t.concat(a.slice(0,f+1)),y=()=>{let x;return h?x=m:v?x=g:d.route.Component?x=A.createElement(d.route.Component,null):d.route.element?x=d.route.element:x=c,A.createElement(kT,{match:d,routeContext:{outlet:c,matches:p,isDataRoute:n!=null},children:x})};return n&&(d.route.ErrorBoundary||d.route.errorElement||f===0)?A.createElement(ST,{location:n.location,revalidation:n.revalidation,component:m,error:h,children:y(),routeContext:{outlet:null,matches:p,isDataRoute:!0}}):y()},null)}var Rb=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(Rb||{});function NT(e){let t=A.useContext(wT);return t||sn(!1),t}function IT(e){let t=A.useContext(sd);return t||sn(!1),t}function TT(e){let t=IT(),n=t.matches[t.matches.length-1];return n.route.id||sn(!1),n.route.id}function AT(){var e;let t=A.useContext(Sb),n=NT(Rb.UseRouteError),r=TT();return t!==void 0?t:(e=n.errors)==null?void 0:e[r]}const gy={};function PT(e,t,n){gy[e]||(gy[e]=!0)}function DT(e,t){e==null||e.v7_startTransition,e==null||e.v7_relativeSplatPath}function jh(e){sn(!1)}function FT(e){let{basename:t="/",children:n=null,location:r,navigationType:o=Io.Pop,navigator:i,static:a=!1,future:s}=e;bv()&&sn(!1);let u=t.replace(/^\/*/,"/"),l=A.useMemo(()=>({basename:u,navigator:i,static:a,future:lc({v7_relativeSplatPath:!1},s)}),[u,s,i,a]);typeof r=="string"&&(r=id(r));let{pathname:c="/",search:d="",hash:f="",state:h=null,key:v="default"}=r,m=A.useMemo(()=>{let g=Cb(c,u);return g==null?null:{location:{pathname:g,search:d,hash:f,state:h,key:v},navigationType:o}},[u,c,d,f,h,v,o]);return m==null?null:A.createElement(_b.Provider,{value:l},A.createElement(ad.Provider,{children:n,value:m}))}function MT(e){let{children:t,location:n}=e;return bT(Wh(t),n)}new Promise(()=>{});function Wh(e,t){t===void 0&&(t=[]);let n=[];return A.Children.forEach(e,(r,o)=>{if(!A.isValidElement(r))return;let i=[...t,o];if(r.type===A.Fragment){n.push.apply(n,Wh(r.props.children,i));return}r.type!==jh&&sn(!1),!r.props.index||!r.props.children||sn(!1);let a={id:r.props.id||i.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(a.children=Wh(r.props.children,i)),n.push(a)}),n}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */const OT="6";try{window.__reactRouterVersion=OT}catch{}const LT="startTransition",yy=$0[LT];function BT(e){let{basename:t,children:n,future:r,window:o}=e,i=A.useRef();i.current==null&&(i.current=JI({window:o,v5Compat:!0}));let a=i.current,[s,u]=A.useState({action:a.action,location:a.location}),{v7_startTransition:l}=r||{},c=A.useCallback(d=>{l&&yy?yy(()=>u(d)):u(d)},[u,l]);return A.useLayoutEffect(()=>a.listen(c),[a,c]),A.useEffect(()=>DT(r),[r]),A.createElement(FT,{basename:t,children:n,location:s.location,navigationType:s.action,navigator:a,future:r})}var xy;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(xy||(xy={}));var wy;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(wy||(wy={}));const jT=()=>_.jsx("header",{className:"bg-white/80 backdrop-blur-md shadow-sm border-b border-blue-100 sticky top-0 z-50",children:_.jsx("div",{className:"container mx-auto px-6 py-4",children:_.jsxs("div",{className:"flex items-center justify-between",children:[_.jsxs("div",{className:"flex items-center space-x-3",children:[_.jsx("div",{className:"p-2 bg-blue-600 rounded-lg",children:_.jsx(Ih,{className:"w-6 h-6 text-white"})}),_.jsxs("div",{children:[_.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"FACECOM Challenge"}),_.jsx("p",{className:"text-sm text-gray-600",children:"Face Recognition in Challenging Environments"})]})]}),_.jsxs("nav",{className:"hidden md:flex items-center space-x-6",children:[_.jsx("a",{href:"#detector",className:"text-gray-700 hover:text-blue-600 transition-colors",children:"Detector"}),_.jsx("a",{href:"#tasks",className:"text-gray-700 hover:text-blue-600 transition-colors",children:"Tasks"}),_.jsx("a",{href:"#dataset",className:"text-gray-700 hover:text-blue-600 transition-colors",children:"Dataset"}),_.jsx("a",{href:"#metrics",className:"text-gray-700 hover:text-blue-600 transition-colors",children:"Metrics"})]})]})})}),WT=()=>_.jsx("section",{className:"py-20 px-6",children:_.jsx("div",{className:"container mx-auto text-center",children:_.jsxs("div",{className:"max-w-4xl mx-auto",children:[_.jsxs("h1",{className:"text-5xl md:text-6xl font-bold text-gray-900 mb-6 leading-tight",children:["Robust Face Recognition",_.jsx("span",{className:"block text-blue-600",children:"Under Adverse Conditions"})]}),_.jsx("p",{className:"text-xl text-gray-600 mb-8 leading-relaxed",children:"Develop models that maintain consistent performance despite challenging environmental conditions including blur, fog, rain, low-light, and overexposed scenes."}),_.jsxs("div",{className:"grid md:grid-cols-3 gap-8 mt-12",children:[_.jsxs("div",{className:"p-6 bg-white rounded-xl shadow-sm border border-blue-100 hover:shadow-md transition-shadow",children:[_.jsx(Rk,{className:"w-8 h-8 text-blue-600 mx-auto mb-4"}),_.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"Two-Task Pipeline"}),_.jsx("p",{className:"text-gray-600 text-sm",children:"Gender classification and face recognition in one integrated challenge"})]}),_.jsxs("div",{className:"p-6 bg-white rounded-xl shadow-sm border border-green-100 hover:shadow-md transition-shadow",children:[_.jsx(Lk,{className:"w-8 h-8 text-green-600 mx-auto mb-4"}),_.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"5,000+ Images"}),_.jsx("p",{className:"text-gray-600 text-sm",children:"Comprehensive dataset with real-world visual degradations"})]}),_.jsxs("div",{className:"p-6 bg-white rounded-xl shadow-sm border border-purple-100 hover:shadow-md transition-shadow",children:[_.jsx(Sw,{className:"w-8 h-8 text-purple-600 mx-auto mb-4"}),_.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"Robust Evaluation"}),_.jsx("p",{className:"text-gray-600 text-sm",children:"Multiple metrics across diverse challenging conditions"})]})]})]})})}),zT=()=>_.jsx("section",{id:"tasks",className:"py-16 px-6 bg-white",children:_.jsxs("div",{className:"container mx-auto",children:[_.jsxs("div",{className:"text-center mb-12",children:[_.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-4",children:"Challenge Tasks"}),_.jsx("p",{className:"text-gray-600 max-w-2xl mx-auto",children:"Two interconnected tasks designed to evaluate robustness across different semantic attributes"})]}),_.jsxs("div",{className:"grid md:grid-cols-2 gap-8 max-w-6xl mx-auto",children:[_.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 rounded-2xl p-8 border border-blue-100",children:[_.jsxs("div",{className:"flex items-center mb-6",children:[_.jsx("div",{className:"p-3 bg-blue-600 rounded-lg mr-4",children:_.jsx(_w,{className:"w-6 h-6 text-white"})}),_.jsxs("div",{children:[_.jsx("h3",{className:"text-2xl font-bold text-gray-900",children:"Task A"}),_.jsx("p",{className:"text-blue-600 font-medium",children:"Gender Classification"})]})]}),_.jsxs("div",{className:"space-y-4",children:[_.jsxs("div",{className:"bg-white rounded-lg p-4 border border-blue-200",children:[_.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"Objective"}),_.jsx("p",{className:"text-gray-600 text-sm",children:"Predict the gender (Male/Female) of a subject from face images captured under visually degraded conditions"})]}),_.jsxs("div",{className:"bg-white rounded-lg p-4 border border-blue-200",children:[_.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"Dataset Structure"}),_.jsxs("div",{className:"text-sm text-gray-600 space-y-1",children:[_.jsx("p",{children:" train/: male/ and female/ subfolders"}),_.jsx("p",{children:" val/: similarly structured validation data"})]})]}),_.jsxs("div",{className:"bg-blue-600 text-white rounded-lg p-4",children:[_.jsx("p",{className:"font-medium",children:"Binary Classification"}),_.jsx("p",{className:"text-blue-100 text-sm",children:"Male vs Female identification"})]})]})]}),_.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-emerald-50 rounded-2xl p-8 border border-green-100",children:[_.jsxs("div",{className:"flex items-center mb-6",children:[_.jsx("div",{className:"p-3 bg-green-600 rounded-lg mr-4",children:_.jsx(Wk,{className:"w-6 h-6 text-white"})}),_.jsxs("div",{children:[_.jsx("h3",{className:"text-2xl font-bold text-gray-900",children:"Task B"}),_.jsx("p",{className:"text-green-600 font-medium",children:"Face Recognition"})]})]}),_.jsxs("div",{className:"space-y-4",children:[_.jsxs("div",{className:"bg-white rounded-lg p-4 border border-green-200",children:[_.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"Objective"}),_.jsx("p",{className:"text-gray-600 text-sm",children:"Assign each face image to the correct person identity from a known set of individuals"})]}),_.jsxs("div",{className:"bg-white rounded-lg p-4 border border-green-200",children:[_.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"Dataset Structure"}),_.jsxs("div",{className:"text-sm text-gray-600 space-y-1",children:[_.jsx("p",{children:" Each folder = unique individual"}),_.jsx("p",{children:" distorted/ folder with altered versions"})]})]}),_.jsxs("div",{className:"bg-green-600 text-white rounded-lg p-4",children:[_.jsx("p",{className:"font-medium",children:"Multi-Class Classification"}),_.jsx("p",{className:"text-green-100 text-sm",children:"Person identity matching"})]})]})]})]}),_.jsx("div",{className:"mt-12 text-center",children:_.jsxs("div",{className:"inline-flex items-center space-x-4 bg-gray-50 rounded-full px-6 py-3 border",children:[_.jsx("span",{className:"bg-blue-600 text-white px-3 py-1 rounded-full text-sm font-medium",children:"Task A"}),_.jsx(kk,{className:"w-4 h-4 text-gray-400"}),_.jsx("span",{className:"bg-green-600 text-white px-3 py-1 rounded-full text-sm font-medium",children:"Task B"}),_.jsx("span",{className:"text-gray-600 text-sm ml-2",children:"Two-Task Pipeline"})]})})]})}),UT=()=>_.jsx("section",{id:"dataset",className:"py-16 px-6 bg-gradient-to-br from-slate-50 to-gray-50",children:_.jsxs("div",{className:"container mx-auto",children:[_.jsxs("div",{className:"text-center mb-12",children:[_.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-4",children:"FACECOM Dataset"}),_.jsx("p",{className:"text-gray-600 max-w-2xl mx-auto",children:"Face Attributes in Challenging Environments - purpose-built for evaluating face analysis under real-world degradations"})]}),_.jsxs("div",{className:"grid md:grid-cols-3 gap-8 max-w-4xl mx-auto mb-12",children:[_.jsxs("div",{className:"text-center",children:[_.jsx("div",{className:"p-4 bg-blue-600 rounded-full w-16 h-16 mx-auto mb-4 flex items-center justify-center",children:_.jsx(Dk,{className:"w-8 h-8 text-white"})}),_.jsx("h3",{className:"font-bold text-2xl text-gray-900",children:"5,000+"}),_.jsx("p",{className:"text-gray-600",children:"Face Images"})]}),_.jsxs("div",{className:"text-center",children:[_.jsx("div",{className:"p-4 bg-green-600 rounded-full w-16 h-16 mx-auto mb-4 flex items-center justify-center",children:_.jsx(_w,{className:"w-8 h-8 text-white"})}),_.jsx("h3",{className:"font-bold text-2xl text-gray-900",children:"2"}),_.jsx("p",{className:"text-gray-600",children:"Main Tasks"})]}),_.jsxs("div",{className:"text-center",children:[_.jsx("div",{className:"p-4 bg-purple-600 rounded-full w-16 h-16 mx-auto mb-4 flex items-center justify-center",children:_.jsx(Nk,{className:"w-8 h-8 text-white"})}),_.jsx("h3",{className:"font-bold text-2xl text-gray-900",children:"6"}),_.jsx("p",{className:"text-gray-600",children:"Visual Conditions"})]})]}),_.jsxs("div",{className:"bg-white rounded-2xl p-8 shadow-sm border border-gray-200 max-w-3xl mx-auto",children:[_.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-6 text-center",children:"Dataset Splits"}),_.jsxs("div",{className:"space-y-4",children:[_.jsxs("div",{className:"flex items-center justify-between p-4 bg-blue-50 rounded-lg border border-blue-200",children:[_.jsx("span",{className:"font-medium text-gray-900",children:"Training Set"}),_.jsxs("div",{className:"flex items-center space-x-3",children:[_.jsx("div",{className:"w-32 bg-gray-200 rounded-full h-2",children:_.jsx("div",{className:"bg-blue-600 h-2 rounded-full",style:{width:"70%"}})}),_.jsx("span",{className:"font-bold text-blue-600",children:"70%"})]})]}),_.jsxs("div",{className:"flex items-center justify-between p-4 bg-green-50 rounded-lg border border-green-200",children:[_.jsx("span",{className:"font-medium text-gray-900",children:"Validation Set"}),_.jsxs("div",{className:"flex items-center space-x-3",children:[_.jsx("div",{className:"w-32 bg-gray-200 rounded-full h-2",children:_.jsx("div",{className:"bg-green-600 h-2 rounded-full",style:{width:"15%"}})}),_.jsx("span",{className:"font-bold text-green-600",children:"15%"})]})]}),_.jsxs("div",{className:"flex items-center justify-between p-4 bg-purple-50 rounded-lg border border-purple-200",children:[_.jsx("span",{className:"font-medium text-gray-900",children:"Test Set (Hidden)"}),_.jsxs("div",{className:"flex items-center space-x-3",children:[_.jsx("div",{className:"w-32 bg-gray-200 rounded-full h-2",children:_.jsx("div",{className:"bg-purple-600 h-2 rounded-full",style:{width:"15%"}})}),_.jsx("span",{className:"font-bold text-purple-600",children:"15%"})]})]})]})]})]})}),$T=()=>_.jsx("section",{id:"metrics",className:"py-16 px-6 bg-gradient-to-br from-blue-50 to-indigo-50",children:_.jsxs("div",{className:"container mx-auto",children:[_.jsxs("div",{className:"text-center mb-12",children:[_.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-4",children:"Evaluation Metrics"}),_.jsx("p",{className:"text-gray-600 max-w-2xl mx-auto",children:"Comprehensive evaluation across multiple performance indicators"})]}),_.jsxs("div",{className:"grid md:grid-cols-2 gap-8 max-w-4xl mx-auto",children:[_.jsxs("div",{className:"bg-white rounded-2xl p-8 shadow-sm border border-blue-200",children:[_.jsxs("div",{className:"flex items-center mb-6",children:[_.jsx("div",{className:"p-3 bg-blue-600 rounded-lg mr-4",children:_.jsx(Xu,{className:"w-6 h-6 text-white"})}),_.jsxs("div",{children:[_.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"Task A Metrics"}),_.jsx("p",{className:"text-blue-600",children:"Gender Classification"})]})]}),_.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[_.jsxs("div",{className:"p-4 bg-blue-50 rounded-lg border border-blue-200 text-center",children:[_.jsx(Gg,{className:"w-6 h-6 text-blue-600 mx-auto mb-2"}),_.jsx("p",{className:"font-semibold text-gray-900",children:"Accuracy"}),_.jsx("p",{className:"text-blue-600 text-sm",children:"Overall correctness"})]}),_.jsxs("div",{className:"p-4 bg-blue-50 rounded-lg border border-blue-200 text-center",children:[_.jsx(qg,{className:"w-6 h-6 text-blue-600 mx-auto mb-2"}),_.jsx("p",{className:"font-semibold text-gray-900",children:"Precision"}),_.jsx("p",{className:"text-blue-600 text-sm",children:"True positive rate"})]}),_.jsxs("div",{className:"p-4 bg-blue-50 rounded-lg border border-blue-200 text-center",children:[_.jsx(Xu,{className:"w-6 h-6 text-blue-600 mx-auto mb-2"}),_.jsx("p",{className:"font-semibold text-gray-900",children:"Recall"}),_.jsx("p",{className:"text-blue-600 text-sm",children:"Sensitivity measure"})]}),_.jsxs("div",{className:"p-4 bg-blue-50 rounded-lg border border-blue-200 text-center",children:[_.jsx(Hg,{className:"w-6 h-6 text-blue-600 mx-auto mb-2"}),_.jsx("p",{className:"font-semibold text-gray-900",children:"F1-Score"}),_.jsx("p",{className:"text-blue-600 text-sm",children:"Harmonic mean"})]})]})]}),_.jsxs("div",{className:"bg-white rounded-2xl p-8 shadow-sm border border-green-200",children:[_.jsxs("div",{className:"flex items-center mb-6",children:[_.jsx("div",{className:"p-3 bg-green-600 rounded-lg mr-4",children:_.jsx(Xu,{className:"w-6 h-6 text-white"})}),_.jsxs("div",{children:[_.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"Task B Metrics"}),_.jsx("p",{className:"text-green-600",children:"Face Recognition"})]})]}),_.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[_.jsxs("div",{className:"p-4 bg-green-50 rounded-lg border border-green-200 text-center",children:[_.jsx(Gg,{className:"w-6 h-6 text-green-600 mx-auto mb-2"}),_.jsx("p",{className:"font-semibold text-gray-900",children:"Accuracy"}),_.jsx("p",{className:"text-green-600 text-sm",children:"Identity matching"})]}),_.jsxs("div",{className:"p-4 bg-green-50 rounded-lg border border-green-200 text-center",children:[_.jsx(qg,{className:"w-6 h-6 text-green-600 mx-auto mb-2"}),_.jsx("p",{className:"font-semibold text-gray-900",children:"Precision"}),_.jsx("p",{className:"text-green-600 text-sm",children:"Match precision"})]}),_.jsxs("div",{className:"p-4 bg-green-50 rounded-lg border border-green-200 text-center",children:[_.jsx(Xu,{className:"w-6 h-6 text-green-600 mx-auto mb-2"}),_.jsx("p",{className:"font-semibold text-gray-900",children:"Recall"}),_.jsx("p",{className:"text-green-600 text-sm",children:"Recognition rate"})]}),_.jsxs("div",{className:"p-4 bg-green-50 rounded-lg border border-green-200 text-center",children:[_.jsx(Hg,{className:"w-6 h-6 text-green-600 mx-auto mb-2"}),_.jsx("p",{className:"font-semibold text-gray-900",children:"F1-Score"}),_.jsx("p",{className:"text-green-600 text-sm",children:"Balanced metric"})]})]}),_.jsx("div",{className:"mt-6 p-4 bg-yellow-50 rounded-lg border border-yellow-200",children:_.jsxs("p",{className:"text-sm text-gray-700",children:[_.jsx("strong",{children:"Special Evaluation:"})," Match (label=1) if test image matches any image in the same folder, Non-match (label=0) if it matches a different folder."]})})]})]})]})}),VT=()=>{const e=[{icon:Sw,name:"Motion Blur",description:"Images affected by camera or subject movement",color:"text-yellow-600",bg:"bg-yellow-50",border:"border-yellow-200"},{icon:Bk,name:"Overexposed/Sunny",description:"Bright lighting conditions with potential washout",color:"text-orange-600",bg:"bg-orange-50",border:"border-orange-200"},{icon:Pk,name:"Foggy Conditions",description:"Reduced visibility due to atmospheric conditions",color:"text-gray-600",bg:"bg-gray-50",border:"border-gray-200"},{icon:Ak,name:"Rainy Weather",description:"Simulated rain effects on image quality",color:"text-blue-600",bg:"bg-blue-50",border:"border-blue-200"},{icon:Ok,name:"Low Light",description:"Poor illumination with reduced visibility",color:"text-indigo-600",bg:"bg-indigo-50",border:"border-indigo-200"},{icon:Fk,name:"Uneven Lighting",description:"Irregular illumination and glare effects",color:"text-purple-600",bg:"bg-purple-50",border:"border-purple-200"}];return _.jsx("section",{className:"py-16 px-6 bg-white",children:_.jsxs("div",{className:"container mx-auto",children:[_.jsxs("div",{className:"text-center mb-12",children:[_.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-4",children:"Visual Conditions"}),_.jsx("p",{className:"text-gray-600 max-w-2xl mx-auto",children:"Challenging environmental conditions included in the FACECOM dataset"})]}),_.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-6 max-w-6xl mx-auto",children:e.map((t,n)=>{const r=t.icon;return _.jsxs("div",{className:`p-6 rounded-xl border ${t.bg} ${t.border} hover:shadow-md transition-all duration-300 hover:-translate-y-1`,children:[_.jsxs("div",{className:"flex items-center mb-4",children:[_.jsx(r,{className:`w-6 h-6 ${t.color} mr-3`}),_.jsx("h3",{className:"font-semibold text-gray-900",children:t.name})]}),_.jsx("p",{className:"text-gray-600 text-sm leading-relaxed",children:t.description})]},n)})})]})})},Nl=A.forwardRef(({className:e,...t},n)=>_.jsx("div",{ref:n,className:qt("rounded-lg border bg-card text-card-foreground shadow-sm",e),...t}));Nl.displayName="Card";const Nb=A.forwardRef(({className:e,...t},n)=>_.jsx("div",{ref:n,className:qt("flex flex-col space-y-1.5 p-6",e),...t}));Nb.displayName="CardHeader";const Ib=A.forwardRef(({className:e,...t},n)=>_.jsx("h3",{ref:n,className:qt("text-2xl font-semibold leading-none tracking-tight",e),...t}));Ib.displayName="CardTitle";const HT=A.forwardRef(({className:e,...t},n)=>_.jsx("p",{ref:n,className:qt("text-sm text-muted-foreground",e),...t}));HT.displayName="CardDescription";const Il=A.forwardRef(({className:e,...t},n)=>_.jsx("div",{ref:n,className:qt("p-6 pt-0",e),...t}));Il.displayName="CardContent";const GT=A.forwardRef(({className:e,...t},n)=>_.jsx("div",{ref:n,className:qt("flex items-center p-6 pt-0",e),...t}));GT.displayName="CardFooter";const by=Cw("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),Tl=A.forwardRef(({className:e,variant:t,size:n,asChild:r=!1,...o},i)=>r?_.jsx(AS,{className:qt(by({variant:t,size:n,className:e})),ref:i,...o}):_.jsx("button",{className:qt(by({variant:t,size:n,className:e})),ref:i,...o}));Tl.displayName="Button";const qT=()=>{const[e,t]=A.useState(null),[n,r]=A.useState(""),[o,i]=A.useState(!1),[a,s]=A.useState([]),[u,l]=A.useState(""),c=A.useRef(null),d=A.useRef(null),f=A.useCallback(g=>{var y;const p=(y=g.target.files)==null?void 0:y[0];p&&(t(p),r(URL.createObjectURL(p)),s([]),l(""))},[]),h=A.useCallback(async g=>{await new Promise(C=>setTimeout(C,2e3));const p=Math.random()*(g.width*.6),y=Math.random()*(g.height*.6),x=100+Math.random()*100,w=120+Math.random()*120,b=Math.random()>.5?"Male":"Female";return[{bbox:{x:p,y,width:x,height:w},confidence:.7+Math.random()*.29,gender:b}]},[]),v=A.useCallback(async()=>{if(!(!e||!d.current)){i(!0),l("");try{const g=new Image;g.onload=async()=>{const p=d.current;if(!p){l("Canvas not available."),i(!1);return}const y=p.getContext("2d");if(!y){l("Unable to get canvas context."),i(!1);return}p.width=g.width,p.height=g.height,y.drawImage(g,0,0);try{const x=await h(g);s(x),y.strokeStyle="#3b82f6",y.lineWidth=3,y.fillStyle="rgba(59, 130, 246, 0.2)",x.forEach(w=>{const{x:b,y:C,width:E,height:S}=w.bbox;y.fillRect(b,C,E,S),y.strokeRect(b,C,E,S),y.fillStyle="#3b82f6",y.fillRect(b,C-45,110,40),y.fillStyle="white",y.font="bold 13px Arial",y.fillText(`Conf: ${(w.confidence*100).toFixed(1)}%`,b+5,C-25),y.fillText(`Gender: ${w.gender}`,b+5,C-10),y.fillStyle="rgba(59, 130, 246, 0.2)"})}catch(x){l("Face detection failed. Please try again."),console.error("Detection error:",x)}finally{i(!1)}},g.onerror=()=>{l("Failed to load image. Please try a different file."),i(!1)},g.src=n}catch{l("An unexpected error occurred."),i(!1)}}},[e,n,h]),m=A.useCallback(()=>{t(null),r(""),s([]),l(""),c.current&&(c.current.value="")},[]);return _.jsx("section",{id:"detector",className:"py-16 px-6 bg-gradient-to-br from-purple-50 to-pink-50",children:_.jsxs("div",{className:"container mx-auto",children:[_.jsxs("div",{className:"text-center mb-12",children:[_.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-4",children:"Face Detector"}),_.jsx("p",{className:"text-gray-600 max-w-2xl mx-auto",children:"Test face detection capabilities on challenging images. Upload an image to see how well our system performs under adverse conditions."})]}),_.jsx("div",{className:"max-w-4xl mx-auto",children:_.jsxs(Nl,{className:"overflow-hidden",children:[_.jsx(Nb,{children:_.jsxs(Ib,{className:"flex items-center gap-2",children:[_.jsx(Ih,{className:"w-5 h-5 text-purple-600"}),"Face Detection Demo"]})}),_.jsxs(Il,{className:"space-y-6",children:[_.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-8 text-center hover:border-purple-400 transition-colors",children:[_.jsx("input",{ref:c,type:"file",accept:"image/*",onChange:f,className:"hidden"}),_.jsx(jk,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),_.jsx("p",{className:"text-gray-600 mb-4",children:"Choose an image to test face detection"}),_.jsx(Tl,{onClick:()=>{var g;return(g=c.current)==null?void 0:g.click()},className:"bg-purple-600 hover:bg-purple-700",children:"Select Image"})]}),n&&_.jsxs("div",{className:"space-y-4",children:[_.jsxs("div",{className:"flex gap-4 flex-wrap",children:[_.jsx(Tl,{onClick:v,disabled:o,className:"bg-blue-600 hover:bg-blue-700",children:o?_.jsxs(_.Fragment,{children:[_.jsx(Mk,{className:"w-4 h-4 mr-2 animate-spin"}),"Detecting..."]}):_.jsxs(_.Fragment,{children:[_.jsx(Ih,{className:"w-4 h-4 mr-2"}),"Detect Faces"]})}),_.jsx(Tl,{onClick:m,variant:"outline",children:"Reset"})]}),_.jsx("div",{className:"border rounded-lg overflow-hidden bg-gray-50",children:_.jsx("canvas",{ref:d,className:"max-w-full h-auto",style:{display:n?"block":"none"}})}),a.length>0&&_.jsx(Nl,{className:"bg-green-50 border-green-200",children:_.jsxs(Il,{className:"pt-6",children:[_.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[_.jsx(Tk,{className:"w-5 h-5 text-green-600"}),_.jsx("h3",{className:"font-semibold text-green-800",children:"Detection Results"})]}),_.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[_.jsxs("div",{children:[_.jsxs("p",{className:"text-sm text-green-700",children:[_.jsx("strong",{children:"Faces Detected:"})," ",a.length]}),_.jsxs("p",{className:"text-sm text-green-700",children:[_.jsx("strong",{children:"Average Confidence:"})," ",(a.reduce((g,p)=>g+p.confidence,0)/a.length*100).toFixed(1),"%"]}),_.jsxs("p",{className:"text-sm text-green-700",children:[_.jsx("strong",{children:"Detected Gender:"})," ",a[0].gender]})]}),_.jsxs("div",{children:[_.jsxs("p",{className:"text-sm text-green-700",children:[_.jsx("strong",{children:"Status:"})," Detection Complete"]}),_.jsxs("p",{className:"text-sm text-green-700",children:[_.jsx("strong",{children:"Processing Time:"})," ~2.0s"]})]})]})]})}),u&&_.jsx(Nl,{className:"bg-red-50 border-red-200",children:_.jsx(Il,{className:"pt-6",children:_.jsxs("div",{className:"flex items-center gap-2",children:[_.jsx(Ik,{className:"w-5 h-5 text-red-600"}),_.jsx("p",{className:"text-red-800",children:u})]})})})]})]})]})})]})})},KT=()=>_.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-blue-50",children:[_.jsx(jT,{}),_.jsx(WT,{}),_.jsx(qT,{}),_.jsx(zT,{}),_.jsx(UT,{}),_.jsx(VT,{}),_.jsx($T,{})]}),XT=()=>{const e=kb();return A.useEffect(()=>{console.error("404 Error: User attempted to access non-existent route:",e.pathname)},[e.pathname]),_.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-100",children:_.jsxs("div",{className:"text-center",children:[_.jsx("h1",{className:"text-4xl font-bold mb-4",children:"404"}),_.jsx("p",{className:"text-xl text-gray-600 mb-4",children:"Oops! Page not found"}),_.jsx("a",{href:"/",className:"text-blue-500 hover:text-blue-700 underline",children:"Return to Home"})]})})},YT=new XI,QT=()=>_.jsx(QI,{client:YT,children:_.jsxs(SI,{children:[_.jsx(ER,{}),_.jsx(QR,{}),_.jsx(BT,{children:_.jsxs(MT,{children:[_.jsx(jh,{path:"/",element:_.jsx(KT,{})}),_.jsx(jh,{path:"*",element:_.jsx(XT,{})})]})})]})});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Tb=function(e,t){return(Tb=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var o in r)r.hasOwnProperty(o)&&(n[o]=r[o])})(e,t)};function sr(e,t){function n(){this.constructor=e}Tb(e,t),e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}function oe(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(l){try{u(r.next(l))}catch(c){i(c)}}function s(l){try{u(r.throw(l))}catch(c){i(c)}}function u(l){l.done?o(l.value):new n(function(c){c(l.value)}).then(a,s)}u((r=r.apply(e,[])).next())})}function ie(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function s(u){return function(l){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return a.label++,{value:c[1],done:!1};case 5:a.label++,r=c[1],c=[0];continue;case 7:c=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(c[0]===6||c[0]===2)){a=0;continue}if(c[0]===3&&(!o||c[1]>o[0]&&c[1]<o[3])){a.label=c[1];break}if(c[0]===6&&a.label<o[1]){a.label=o[1],o=c;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(c);break}o[2]&&a.ops.pop(),a.trys.pop();continue}c=t.call(e,a)}catch(d){c=[6,d],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([u,l])}}}var JT=function(){function e(t){this.global=t,this.flags={},this.flagRegistry={},this.urlFlags={},this.populateURLFlags()}return e.prototype.setPlatform=function(t,n){this.platform!=null&&console.warn("Platform "+this.platformName+" has already been set. Overwriting the platform with "+n+"."),this.platformName=t,this.platform=n},e.prototype.registerFlag=function(t,n,r){if(this.flagRegistry[t]={evaluationFn:n,setHook:r},this.urlFlags[t]!=null){var o=this.urlFlags[t];console.warn("Setting feature override from URL "+t+": "+o+"."),this.set(t,o)}},e.prototype.get=function(t){return t in this.flags?this.flags[t]:(this.flags[t]=this.evaluateFlag(t),this.flags[t])},e.prototype.getNumber=function(t){return this.get(t)},e.prototype.getBool=function(t){return this.get(t)},e.prototype.getFlags=function(){return this.flags},Object.defineProperty(e.prototype,"features",{get:function(){return this.flags},enumerable:!0,configurable:!0}),e.prototype.set=function(t,n){if(this.flagRegistry[t]==null)throw new Error("Cannot set flag "+t+" as it has not been registered.");this.flags[t]=n,this.flagRegistry[t].setHook!=null&&this.flagRegistry[t].setHook(n)},e.prototype.evaluateFlag=function(t){if(this.flagRegistry[t]==null)throw new Error("Cannot evaluate flag '"+t+"': no evaluation function found.");return this.flagRegistry[t].evaluationFn()},e.prototype.setFlags=function(t){this.flags=Object.assign({},t)},e.prototype.reset=function(){this.flags={},this.urlFlags={},this.populateURLFlags()},e.prototype.populateURLFlags=function(){var t=this;if(this.global!==void 0&&this.global.location!==void 0&&this.global.location.search!==void 0){var n,r,o=(n=this.global.location.search,r={},n.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,function(i){for(var a=[],s=1;s<arguments.length;s++)a[s-1]=arguments[s];return ZT(r,a[0],a[1]),a.join("=")}),r);"tfjsflags"in o&&o.tfjsflags.split(",").forEach(function(i){var a=i.split(":"),s=a[0],u=a[1];t.urlFlags[s]=function(l,c){if((c=c.toLowerCase())==="true"||c==="false")return c==="true";if(""+ +c===c)return+c;throw new Error("Could not parse value flag value "+c+" for flag "+l+".")}(s,u)})}},e}();function ZT(e,t,n){e[decodeURIComponent(t)]=decodeURIComponent(n||"")}function H(){return Ab}var Ab=null,cc=new Map,zh=new Map;function Pb(e,t){var n=Fb(e,t);return cc.get(n)}function eA(e){return zh.get(e)}function Cy(e){for(var t=cc.entries(),n=[];;){var r=t.next(),o=r.done,i=r.value;if(o)break;var a=i[0],s=i[1];a.split("_")[0]===e&&n.push(s)}return n}function Db(e){var t=e.kernelName,n=e.backendName,r=Fb(t,n);if(cc.has(r))throw new Error("The kernel '"+t+"' for backend '"+n+"' is already registered");cc.set(r,e)}function tA(e){var t=e.kernelName;zh.has(t)&&console.warn("Overriding the gradient for '"+t+"'"),zh.set(t,e)}function Fb(e,t){return t+"_"+e}function Uh(e,t,n){return Math.max(e,Math.min(t,n))}function Mb(e){return e%2==0?e:e+1}function nA(e){for(var t=0,n=0;n<e.length;n++)t+=e[n];return t}function I(e,t){if(!e)throw new Error(typeof t=="string"?t:t())}function Ae(e,t,n){n===void 0&&(n=""),I(xt(e,t),function(){return n+" Shapes "+e+" and "+t+" must match"})}function es(e){I(e!=null,function(){return"The input to the tensor constructor must be a non-null value."})}function Va(e,t,n){if(t===void 0&&(t=[]),n===void 0&&(n=!1),t==null&&(t=[]),Array.isArray(e)||kr(e)&&!n)for(var r=0;r<e.length;++r)Va(e[r],t,n);else t.push(e);return t}function ae(e){if(e.length===0)return 1;for(var t=e[0],n=1;n<e.length;n++)t*=e[n];return t}function xt(e,t){if(e===t)return!0;if(e==null||t==null||e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function rt(e){return e%1==0}function rA(e){if(Math.tanh!=null)return Math.tanh(e);if(e===1/0)return 1;if(e===-1/0)return-1;var t=Math.exp(2*e);return(t-1)/(t+1)}function $h(e){var t=Math.ceil(Math.sqrt(e));return[t,Math.ceil(e/t)]}function xa(e,t){return t<=e.length?e:e+" ".repeat(t-e.length)}function Ey(e,t,n){return t===void 0&&(t=function(r){return 0}),new Promise(function(r,o){var i=0,a=function(){if(e())r();else{i++;var s=t(i);n!=null&&i>=n?o():setTimeout(a,s)}};a()})}function oA(e,t){for(var n=1,r=-1,o=0;o<e.length;++o)if(e[o]>=0)n*=e[o];else if(e[o]===-1){if(r!==-1)throw Error("Shapes can only have 1 implicit size. Found -1 at dim "+r+" and dim "+o);r=o}else if(e[o]<0)throw Error("Shapes can not be < 0. Found "+e[o]+" at dim "+o);if(r===-1){if(t>0&&t!==n)throw Error("Size("+t+") must match the product of shape "+e);return e}if(n===0)throw Error("Cannot infer the missing size in ["+e+"] when there are 0 elements");if(t%n!=0)throw Error("The implicit shape can't be a fractional number. Got "+t+" / "+n);var i=e.slice();return i[r]=t/n,i}function vt(e,t){var n=t.length;return I((e=e==null?t.map(function(r,o){return o}):[].concat(e)).every(function(r){return r>=-n&&r<n}),function(){return"All values in axis param must be in range [-"+n+", "+n+") but got axis "+e}),I(e.every(function(r){return rt(r)}),function(){return"All values in axis param must be integers but got axis "+e}),e.map(function(r){return r<0?n+r:r})}function ci(e,t){for(var n=[],r=[],o=t!=null&&Array.isArray(t)&&t.length===0,i=t==null||o?null:vt(t,e).sort(),a=0,s=0;s<e.length;++s){if(i!=null){if(i[a]===s&&e[s]!==1)throw new Error("Can't squeeze axis "+s+" since its dim '"+e[s]+"' is not 1");(i[a]==null||i[a]>s)&&e[s]===1&&(n.push(e[s]),r.push(s)),i[a]<=s&&a++}e[s]!==1&&(n.push(e[s]),r.push(s))}return{newShape:n,keptDims:r}}function tu(e,t){var n=null;if(e==null||e==="float32")n=new Float32Array(t);else if(e==="int32")n=new Int32Array(t);else{if(e!=="bool")throw new Error("Unknown data type "+e);n=new Uint8Array(t)}return n}function dc(e,t){var n=null;if(e==null||e==="float32")n=new Float32Array(t);else if(e==="int32")n=new Int32Array(t);else if(e==="bool")n=new Uint8Array(t);else{if(e!=="string")throw new Error("Unknown data type "+e);n=new Array(t)}return n}function iA(e,t){for(var n=0;n<e.length;n++){var r=e[n];if(isNaN(r)||!isFinite(r))throw Error("A tensor of type "+t+" being uploaded contains "+r+".")}}function aA(e){return e==="bool"||e==="complex64"||e==="float32"||e==="int32"||e==="string"}function sA(e,t){return t!=="complex64"&&(t!=="float32"||e==="complex64")&&(t!=="int32"||e==="float32"||e==="complex64")&&(t!=="bool"||e!=="bool")}function kr(e){return e instanceof Float32Array||e instanceof Int32Array||e instanceof Uint8Array}function Ob(e){if(e==="float32"||e==="int32")return 4;if(e==="complex64")return 8;if(e==="bool")return 1;throw new Error("Unknown dtype "+e)}function uA(e){if(e==null)return 0;var t=0;return e.forEach(function(n){return t+=n.length}),t}function Cv(e){return typeof e=="string"||e instanceof String}function lA(e){return typeof e=="boolean"}function cA(e){return typeof e=="number"}function yu(e){return Array.isArray(e)?yu(e[0]):e instanceof Float32Array?"float32":e instanceof Int32Array||e instanceof Uint8Array?"int32":cA(e)?"float32":Cv(e)?"string":lA(e)?"bool":"float32"}function Vh(e){return!!(e&&e.constructor&&e.call&&e.apply)}function Hh(e,t){for(var n=t;n<e;++n)if(e%n==0)return n;return e}function Rr(e){var t=e.length;if(t<2)return[];var n=new Array(t-1);n[t-2]=e[t-1];for(var r=t-3;r>=0;--r)n[r]=n[r+1]*e[r+1];return n}function Lb(e,t,n){if(t==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(e)&&(e=Va(e)),n&&iA(e,t),function(i,a){return i instanceof Float32Array&&a==="float32"||i instanceof Int32Array&&a==="int32"||i instanceof Uint8Array&&a==="bool"}(e,t))return e;if(t==null||t==="float32"||t==="complex64")return new Float32Array(e);if(t==="int32")return new Int32Array(e);if(t==="bool"){for(var r=new Uint8Array(e.length),o=0;o<r.length;++o)Math.round(e[o])!==0&&(r[o]=1);return r}throw new Error("Unknown data type "+t)}function _y(e,t){if(e.length===0)return t[0];var n=e.reduce(function(r,o){return r*o});if(n===0)return[];if(n!==t.length)throw new Error("["+e+"] does not match the input size.");return function r(o,i,a){var s=new Array;if(i.length===1)for(var u=i[0],l=0;l<u;l++)s[l]=a[o+l];else{u=i[0];var c=i.slice(1),d=c.reduce(function(f,h){return f*h});for(l=0;l<u;l++)s[l]=r(o+l*d,c,a)}return s}(0,e,t)}function Bb(e,t){for(var n=xu(e,t),r=0;r<n.length;r++)n[r]=1;return n}function xu(e,t){if(t==null||t==="float32"||t==="complex64")return new Float32Array(e);if(t==="int32")return new Int32Array(e);if(t==="bool")return new Uint8Array(e);throw new Error("Unknown data type "+t)}function gr(){return H().platform.now()}function jb(e){e.forEach(function(t){I(Number.isInteger(t)&&t>=0,function(){return"Tensor must have a shape comprised of positive integers but got shape ["+e+"]."})})}function dA(e,t){return t===void 0&&(t="utf-8"),t=t||"utf-8",H().platform.encode(e,t)}function fc(e,t){return t===void 0&&(t="utf-8"),t=t||"utf-8",H().platform.decode(e,t)}function Sy(e,t,n){if(t===0)return 0;if(t===1)return e[0];for(var r=e[e.length-1],o=0;o<e.length-1;++o)r+=n[o]*e[o];return r}function fA(e,t,n){if(t===0)return[];if(t===1)return[e];for(var r=new Array(t),o=0;o<r.length-1;++o)r[o]=Math.floor(e/n[o]),e-=r[o]*n[o];return r[r.length-1]=e,r}var hA=function(){function e(t,n){this.backendTimer=t,this.logger=n,n==null&&(this.logger=new pA)}return e.prototype.profileKernel=function(t,n,r){var o,i=this,a=this.backendTimer.time(function(){o=r()});return o.forEach(function(s){s.data().then(function(u){(function(l,c,d){if(c!=="float32")return!1;for(var f=0;f<l.length;f++){var h=l[f];if(isNaN(h)||!isFinite(h))return console.warn("Found "+h+" in the result of '"+d+"'"),!0}})(u,s.dtype,t),a.then(function(l){var c="";l.getExtraProfileInfo!=null&&(c=l.getExtraProfileInfo()),i.logger.logKernelProfile(t,s,u,l.kernelMs,n,c)})})}),o},e}(),pA=function(){function e(){}return e.prototype.logKernelProfile=function(t,n,r,o,i,a){var s=typeof o=="number"?xa(o+"ms",9):o.error,u=xa(t,25),l=n.rank,c=n.size,d=xa(n.shape.toString(),14),f="";for(var h in i){var v=i[h].shape||n.shape,m=v.length;f+=h+": "+m+"D "+(m>0?v:"")+" "}console.log("%c"+u+"	%c"+s+"	%c"+l+"D "+d+"	%c"+c+"	%c"+f+"	%c"+a,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")},e}(),ky=20,hs=3,af=7;function vA(e,t,n,r){var o=Rr(t),i=function(l,c,d,f){var h=ae(c),v=f[f.length-1],m=new Array(v).fill(0),g=c.length,p=d==="complex64"?vs(l):l;if(g>1)for(var y=0;y<h/v;y++)for(var x=y*v,w=0;w<v;w++)m[w]=Math.max(m[w],ps(p[x+w],0,d).length);return m}(e,t,n,o),a=t.length,s=function l(c,d,f,h,v,m){m===void 0&&(m=!0);var g=f==="complex64"?2:1,p=d[0],y=d.length;if(y===0)return f==="complex64"?[ps(vs(c)[0],0,f)]:f==="bool"?[Wb(c[0])]:[c[0].toString()];if(y===1){if(p>ky){var x=hs*g,w=Array.from(c.slice(0,x)),b=Array.from(c.slice((p-hs)*g,p*g));return f==="complex64"&&(w=vs(w),b=vs(b)),["["+w.map(function(W,U){return ps(W,v[U],f)}).join(", ")+", ..., "+b.map(function(W,U){return ps(W,v[p-hs+U],f)}).join(", ")+"]"]}return["["+(f==="complex64"?vs(c):Array.from(c)).map(function(W,U){return ps(W,v[U],f)}).join(", ")+"]"]}var C=d.slice(1),E=h.slice(1),S=h[0]*g,R=[];if(p>ky){for(var k=0;k<hs;k++){var P=(T=k*S)+S;R.push.apply(R,l(c.slice(T,P),C,f,E,v,!1))}for(R.push("..."),k=p-hs;k<p;k++)P=(T=k*S)+S,R.push.apply(R,l(c.slice(T,P),C,f,E,v,k===p-1))}else for(k=0;k<p;k++){var T;P=(T=k*S)+S,R.push.apply(R,l(c.slice(T,P),C,f,E,v,k===p-1))}var j=y===2?",":"";for(R[0]="["+R[0]+j,k=1;k<R.length-1;k++)R[k]=" "+R[k]+j;var O=`,
`;for(k=2;k<y;k++)O+=`
`;return R[R.length-1]=" "+R[R.length-1]+"]"+(m?"":O),R}(e,t,n,o,i),u=["Tensor"];return r&&(u.push("  dtype: "+n),u.push("  rank: "+a),u.push("  shape: ["+t+"]"),u.push("  values:")),u.push(s.map(function(l){return"    "+l}).join(`
`)),u.join(`
`)}function ps(e,t,n){return xa(Array.isArray(e)?parseFloat(e[0].toFixed(af))+" + "+parseFloat(e[1].toFixed(af))+"j":Cv(e)?"'"+e+"'":n==="bool"?Wb(e):parseFloat(e.toFixed(af)).toString(),t)}function Wb(e){return e===0?"false":"true"}function vs(e){for(var t=[],n=0;n<e.length;n+=2)t.push([e[n],e[n+1]]);return t}var nu=function(){function e(t,n,r){var o=this;if(this.dtype=n,this.shape=t.slice(),this.size=ae(t),r!=null){var i=r.length;I(i===this.size,function(){return"Length of values '"+i+"' does not match the size inferred by the shape '"+o.size+"'."})}if(n==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=r||dc(n,this.size),this.strides=Rr(t)}return e.prototype.set=function(t){for(var n=this,r=[],o=1;o<arguments.length;o++)r[o-1]=arguments[o];r.length===0&&(r=[0]),I(r.length===this.rank,function(){return"The number of provided coordinates ("+r.length+") must match the rank ("+n.rank+")"});var i=this.locToIndex(r);this.values[i]=t},e.prototype.get=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];t.length===0&&(t=[0]);for(var r=0,o=0,i=t;o<i.length;o++){var a=i[o];if(a<0||a>=this.shape[r]){var s="Requested out of range element at "+t+".   Buffer shape="+this.shape;throw new Error(s)}r++}for(var u=t[t.length-1],l=0;l<t.length-1;++l)u+=this.strides[l]*t[l];return this.values[u]},e.prototype.locToIndex=function(t){if(this.rank===0)return 0;if(this.rank===1)return t[0];for(var n=t[t.length-1],r=0;r<t.length-1;++r)n+=this.strides[r]*t[r];return n},e.prototype.indexToLoc=function(t){if(this.rank===0)return[];if(this.rank===1)return[t];for(var n=new Array(this.shape.length),r=0;r<n.length-1;++r)n[r]=Math.floor(t/this.strides[r]),t-=n[r]*this.strides[r];return n[n.length-1]=t,n},Object.defineProperty(e.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),e.prototype.toTensor=function(){return xr().makeTensor(this.values,this.shape,this.dtype)},e}(),xr=null,V=null,zb=null,qe=function(){function e(t,n,r,o){this.kept=!1,this.isDisposedInternal=!1,this.shape=t.slice(),this.dtype=n||"float32",this.size=ae(t),this.strides=Rr(t),this.dataId=r,this.id=o,this.rankType=this.rank<5?this.rank.toString():"higher"}return e.prototype.flatten=function(){return this.throwIfDisposed(),this.as1D()},e.prototype.asScalar=function(){return this.throwIfDisposed(),I(this.size===1,function(){return"The array must have only 1 element."}),this.reshape([])},e.prototype.as1D=function(){return this.throwIfDisposed(),this.reshape([this.size])},e.prototype.as2D=function(t,n){return this.throwIfDisposed(),this.reshape([t,n])},e.prototype.as3D=function(t,n,r){return this.throwIfDisposed(),this.reshape([t,n,r])},e.prototype.as4D=function(t,n,r,o){return this.throwIfDisposed(),this.reshape([t,n,r,o])},e.prototype.as5D=function(t,n,r,o,i){return this.throwIfDisposed(),this.reshape([t,n,r,o,i])},e.prototype.asType=function(t){return this.throwIfDisposed(),V.cast(this,t)},Object.defineProperty(e.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),e.prototype.buffer=function(){return oe(this,void 0,void 0,function(){var t;return ie(this,function(n){switch(n.label){case 0:return[4,this.data()];case 1:return t=n.sent(),[2,V.buffer(this.shape,this.dtype,t)]}})})},e.prototype.bufferSync=function(){return V.buffer(this.shape,this.dtype,this.dataSync())},e.prototype.array=function(){return oe(this,void 0,void 0,function(){var t;return ie(this,function(n){switch(n.label){case 0:return[4,this.data()];case 1:return t=n.sent(),[2,_y(this.shape,t)]}})})},e.prototype.arraySync=function(){return _y(this.shape,this.dataSync())},e.prototype.data=function(){return oe(this,void 0,void 0,function(){var t,n;return ie(this,function(r){switch(r.label){case 0:return this.throwIfDisposed(),t=xr().read(this.dataId),this.dtype!=="string"?[3,2]:[4,t];case 1:n=r.sent();try{return[2,n.map(function(o){return fc(o)})]}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}r.label=2;case 2:return[2,t]}})})},e.prototype.dataSync=function(){this.throwIfDisposed();var t=xr().readSync(this.dataId);if(this.dtype==="string")try{return t.map(function(n){return fc(n)})}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return t},e.prototype.bytes=function(){return oe(this,void 0,void 0,function(){var t;return ie(this,function(n){switch(n.label){case 0:return this.throwIfDisposed(),[4,xr().read(this.dataId)];case 1:return t=n.sent(),this.dtype==="string"?[2,t]:[2,new Uint8Array(t.buffer)]}})})},e.prototype.dispose=function(){this.isDisposed||(xr().disposeTensor(this),this.isDisposedInternal=!0)},Object.defineProperty(e.prototype,"isDisposed",{get:function(){return this.isDisposedInternal},enumerable:!0,configurable:!0}),e.prototype.throwIfDisposed=function(){if(this.isDisposed)throw new Error("Tensor is disposed.")},e.prototype.toFloat=function(){return this.asType("float32")},e.prototype.toInt=function(){return this.asType("int32")},e.prototype.toBool=function(){return this.asType("bool")},e.prototype.print=function(t){return t===void 0&&(t=!1),V.print(this,t)},e.prototype.reshape=function(t){return this.throwIfDisposed(),V.reshape(this,t)},e.prototype.reshapeAs=function(t){return this.throwIfDisposed(),this.reshape(t.shape)},e.prototype.expandDims=function(t){return t===void 0&&(t=0),V.expandDims(this,t)},e.prototype.cumsum=function(t,n,r){return t===void 0&&(t=0),n===void 0&&(n=!1),r===void 0&&(r=!1),V.cumsum(this,t,n,r)},e.prototype.squeeze=function(t){return this.throwIfDisposed(),V.squeeze(this,t)},e.prototype.clone=function(){return this.throwIfDisposed(),V.clone(this)},e.prototype.oneHot=function(t,n,r){return this.throwIfDisposed(),V.oneHot(this,t,n,r)},e.prototype.toString=function(t){return t===void 0&&(t=!1),vA(this.dataSync(),this.shape,this.dtype,t)},e.prototype.tile=function(t){return this.throwIfDisposed(),V.tile(this,t)},e.prototype.gather=function(t,n){return n===void 0&&(n=0),this.throwIfDisposed(),V.gather(this,t,n)},e.prototype.matMul=function(t,n,r){return n===void 0&&(n=!1),r===void 0&&(r=!1),this.throwIfDisposed(),V.matMul(this,t,n,r)},e.prototype.dot=function(t){return this.throwIfDisposed(),V.dot(this,t)},e.prototype.norm=function(t,n,r){return t===void 0&&(t="euclidean"),n===void 0&&(n=null),r===void 0&&(r=!1),this.throwIfDisposed(),V.norm(this,t,n,r)},e.prototype.slice=function(t,n){return this.throwIfDisposed(),V.slice(this,t,n)},e.prototype.reverse=function(t){return this.throwIfDisposed(),V.reverse(this,t)},e.prototype.concat=function(t,n){return n===void 0&&(n=0),this.throwIfDisposed(),t instanceof e&&(t=[t]),V.concat([this].concat(t),n)},e.prototype.split=function(t,n){return n===void 0&&(n=0),this.throwIfDisposed(),V.split(this,t,n)},e.prototype.stack=function(t,n){return n===void 0&&(n=0),V.stack([this,t],n)},e.prototype.unstack=function(t){return t===void 0&&(t=0),V.unstack(this,t)},e.prototype.pad=function(t,n){return n===void 0&&(n=0),V.pad(this,t,n)},e.prototype.batchNormalization=function(t,n,r,o,i){return r===void 0&&(r=.001),zb("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon"),this.batchNorm(t,n,i,o,r)},e.prototype.batchNorm=function(t,n,r,o,i){return i===void 0&&(i=.001),this.throwIfDisposed(),V.batchNorm(this,t,n,r,o,i)},e.prototype.all=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),V.all(this,t,n)},e.prototype.any=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),V.any(this,t,n)},e.prototype.logSumExp=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),V.logSumExp(this,t,n)},e.prototype.sum=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),V.sum(this,t,n)},e.prototype.prod=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),V.prod(this,t,n)},e.prototype.mean=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),V.mean(this,t,n)},e.prototype.min=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),V.min(this,t,n)},e.prototype.max=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),V.max(this,t,n)},e.prototype.argMin=function(t){return t===void 0&&(t=null),this.throwIfDisposed(),V.argMin(this,t)},e.prototype.argMax=function(t){return t===void 0&&(t=null),this.throwIfDisposed(),V.argMax(this,t)},e.prototype.cast=function(t){return this.throwIfDisposed(),V.cast(this,t)},e.prototype.add=function(t){return this.throwIfDisposed(),V.add(this,t)},e.prototype.addStrict=function(t){return this.throwIfDisposed(),V.addStrict(this,t)},e.prototype.atan2=function(t){return this.throwIfDisposed(),V.atan2(this,t)},e.prototype.sub=function(t){return this.throwIfDisposed(),V.sub(this,t)},e.prototype.subStrict=function(t){return this.throwIfDisposed(),V.subStrict(this,t)},e.prototype.pow=function(t){return this.throwIfDisposed(),V.pow(this,t)},e.prototype.powStrict=function(t){return this.throwIfDisposed(),V.powStrict(this,t)},e.prototype.mul=function(t){return this.throwIfDisposed(),V.mul(this,t)},e.prototype.mulStrict=function(t){return this.throwIfDisposed(),V.mulStrict(this,t)},e.prototype.div=function(t){return this.throwIfDisposed(),V.div(this,t)},e.prototype.divNoNan=function(t){return this.throwIfDisposed(),V.divNoNan(this,t)},e.prototype.floorDiv=function(t){return this.throwIfDisposed(),V.floorDiv(this,t)},e.prototype.divStrict=function(t){return this.throwIfDisposed(),V.divStrict(this,t)},e.prototype.minimum=function(t){return this.throwIfDisposed(),V.minimum(this,t)},e.prototype.minimumStrict=function(t){return this.throwIfDisposed(),V.minimumStrict(this,t)},e.prototype.maximum=function(t){return this.throwIfDisposed(),V.maximum(this,t)},e.prototype.maximumStrict=function(t){return this.throwIfDisposed(),V.maximumStrict(this,t)},e.prototype.mod=function(t){return this.throwIfDisposed(),V.mod(this,t)},e.prototype.modStrict=function(t){return this.throwIfDisposed(),V.modStrict(this,t)},e.prototype.squaredDifferenceStrict=function(t){return this.throwIfDisposed(),V.squaredDifferenceStrict(this,t)},e.prototype.transpose=function(t){return this.throwIfDisposed(),V.transpose(this,t)},e.prototype.notEqual=function(t){return this.throwIfDisposed(),V.notEqual(this,t)},e.prototype.notEqualStrict=function(t){return this.throwIfDisposed(),V.notEqualStrict(this,t)},e.prototype.less=function(t){return this.throwIfDisposed(),V.less(this,t)},e.prototype.lessStrict=function(t){return this.throwIfDisposed(),V.lessStrict(this,t)},e.prototype.equal=function(t){return this.throwIfDisposed(),V.equal(this,t)},e.prototype.equalStrict=function(t){return this.throwIfDisposed(),V.equalStrict(this,t)},e.prototype.lessEqual=function(t){return this.throwIfDisposed(),V.lessEqual(this,t)},e.prototype.lessEqualStrict=function(t){return this.throwIfDisposed(),V.lessEqualStrict(this,t)},e.prototype.greater=function(t){return this.throwIfDisposed(),V.greater(this,t)},e.prototype.greaterStrict=function(t){return this.throwIfDisposed(),V.greaterStrict(this,t)},e.prototype.greaterEqual=function(t){return this.throwIfDisposed(),V.greaterEqual(this,t)},e.prototype.greaterEqualStrict=function(t){return this.throwIfDisposed(),V.greaterEqualStrict(this,t)},e.prototype.logicalAnd=function(t){return this.throwIfDisposed(),V.logicalAnd(this,t)},e.prototype.logicalOr=function(t){return this.throwIfDisposed(),V.logicalOr(this,t)},e.prototype.logicalNot=function(){return this.throwIfDisposed(),V.logicalNot(this)},e.prototype.logicalXor=function(t){return this.throwIfDisposed(),V.logicalXor(this,t)},e.prototype.where=function(t,n){return this.throwIfDisposed(),V.where(t,this,n)},e.prototype.neg=function(){return this.throwIfDisposed(),V.neg(this)},e.prototype.ceil=function(){return this.throwIfDisposed(),V.ceil(this)},e.prototype.floor=function(){return this.throwIfDisposed(),V.floor(this)},e.prototype.sign=function(){return this.throwIfDisposed(),V.sign(this)},e.prototype.isNaN=function(){return this.throwIfDisposed(),V.isNaN(this)},e.prototype.isInf=function(){return this.throwIfDisposed(),V.isInf(this)},e.prototype.isFinite=function(){return this.throwIfDisposed(),V.isFinite(this)},e.prototype.exp=function(){return this.throwIfDisposed(),V.exp(this)},e.prototype.expm1=function(){return this.throwIfDisposed(),V.expm1(this)},e.prototype.log=function(){return this.throwIfDisposed(),V.log(this)},e.prototype.log1p=function(){return this.throwIfDisposed(),V.log1p(this)},e.prototype.sqrt=function(){return this.throwIfDisposed(),V.sqrt(this)},e.prototype.rsqrt=function(){return this.throwIfDisposed(),V.rsqrt(this)},e.prototype.square=function(){return this.throwIfDisposed(),V.square(this)},e.prototype.reciprocal=function(){return this.throwIfDisposed(),V.reciprocal(this)},e.prototype.abs=function(){return this.throwIfDisposed(),V.abs(this)},e.prototype.clipByValue=function(t,n){return this.throwIfDisposed(),V.clipByValue(this,t,n)},e.prototype.relu=function(){return this.throwIfDisposed(),V.relu(this)},e.prototype.relu6=function(){return this.throwIfDisposed(),V.relu6(this)},e.prototype.elu=function(){return this.throwIfDisposed(),V.elu(this)},e.prototype.selu=function(){return this.throwIfDisposed(),V.selu(this)},e.prototype.leakyRelu=function(t){return t===void 0&&(t=.2),this.throwIfDisposed(),V.leakyRelu(this,t)},e.prototype.prelu=function(t){return this.throwIfDisposed(),V.prelu(this,t)},e.prototype.sigmoid=function(){return this.throwIfDisposed(),V.sigmoid(this)},e.prototype.logSigmoid=function(){return this.throwIfDisposed(),V.logSigmoid(this)},e.prototype.softplus=function(){return this.throwIfDisposed(),V.softplus(this)},e.prototype.zerosLike=function(){return this.throwIfDisposed(),V.zerosLike(this)},e.prototype.onesLike=function(){return this.throwIfDisposed(),V.onesLike(this)},e.prototype.sin=function(){return this.throwIfDisposed(),V.sin(this)},e.prototype.cos=function(){return this.throwIfDisposed(),V.cos(this)},e.prototype.tan=function(){return this.throwIfDisposed(),V.tan(this)},e.prototype.asin=function(){return this.throwIfDisposed(),V.asin(this)},e.prototype.acos=function(){return this.throwIfDisposed(),V.acos(this)},e.prototype.atan=function(){return this.throwIfDisposed(),V.atan(this)},e.prototype.sinh=function(){return this.throwIfDisposed(),V.sinh(this)},e.prototype.cosh=function(){return this.throwIfDisposed(),V.cosh(this)},e.prototype.tanh=function(){return this.throwIfDisposed(),V.tanh(this)},e.prototype.asinh=function(){return this.throwIfDisposed(),V.asinh(this)},e.prototype.acosh=function(){return this.throwIfDisposed(),V.acosh(this)},e.prototype.atanh=function(){return this.throwIfDisposed(),V.atanh(this)},e.prototype.erf=function(){return this.throwIfDisposed(),V.erf(this)},e.prototype.round=function(){return this.throwIfDisposed(),V.round(this)},e.prototype.step=function(t){return t===void 0&&(t=0),this.throwIfDisposed(),V.step(this,t)},e.prototype.softmax=function(t){return t===void 0&&(t=-1),this.throwIfDisposed(),V.softmax(this,t)},e.prototype.logSoftmax=function(t){return t===void 0&&(t=-1),this.throwIfDisposed(),V.logSoftmax(this,t)},e.prototype.resizeBilinear=function(t,n){return n===void 0&&(n=!1),this.throwIfDisposed(),V.image.resizeBilinear(this,t,n)},e.prototype.resizeNearestNeighbor=function(t,n){return n===void 0&&(n=!1),this.throwIfDisposed(),V.image.resizeNearestNeighbor(this,t,n)},e.prototype.conv1d=function(t,n,r,o,i,a){return o===void 0&&(o="NWC"),i===void 0&&(i=1),this.throwIfDisposed(),V.conv1d(this,t,n,r,o,i,a)},e.prototype.conv2d=function(t,n,r,o,i,a){return o===void 0&&(o="NHWC"),i===void 0&&(i=[1,1]),this.throwIfDisposed(),V.conv2d(this,t,n,r,o,i,a)},e.prototype.conv2dTranspose=function(t,n,r,o,i){return this.throwIfDisposed(),V.conv2dTranspose(this,t,n,r,o,i)},e.prototype.depthwiseConv2D=function(t,n,r,o,i,a){return o===void 0&&(o="NHWC"),i===void 0&&(i=[1,1]),this.throwIfDisposed(),V.depthwiseConv2d(this,t,n,r,o,i,a)},e.prototype.separableConv2d=function(t,n,r,o,i,a){return i===void 0&&(i=[1,1]),a===void 0&&(a="NHWC"),this.throwIfDisposed(),V.separableConv2d(this,t,n,r,o,i,a)},e.prototype.avgPool=function(t,n,r,o){return this.throwIfDisposed(),V.avgPool(this,t,n,r,o)},e.prototype.maxPool=function(t,n,r,o){return this.throwIfDisposed(),V.maxPool(this,t,n,r,o)},e.prototype.localResponseNormalization=function(t,n,r,o){return t===void 0&&(t=5),n===void 0&&(n=1),r===void 0&&(r=1),o===void 0&&(o=.5),V.localResponseNormalization(this,t,n,r,o)},e.prototype.pool=function(t,n,r,o,i){return this.throwIfDisposed(),V.pool(this,t,n,r,o,i)},e.prototype.variable=function(t,n,r){return t===void 0&&(t=!0),this.throwIfDisposed(),xr().makeVariable(this,t,n,r)},e.prototype.unsortedSegmentSum=function(t,n){return this.throwIfDisposed(),V.unsortedSegmentSum(this,t,n)},e.prototype.batchToSpaceND=function(t,n){return this.throwIfDisposed(),V.batchToSpaceND(this,t,n)},e.prototype.spaceToBatchND=function(t,n){return this.throwIfDisposed(),V.spaceToBatchND(this,t,n)},e.prototype.topk=function(t,n){return t===void 0&&(t=1),n===void 0&&(n=!0),this.throwIfDisposed(),V.topk(this,t,n)},e.prototype.stridedSlice=function(t,n,r,o,i,a,s,u){return o===void 0&&(o=0),i===void 0&&(i=0),a===void 0&&(a=0),s===void 0&&(s=0),u===void 0&&(u=0),this.throwIfDisposed(),V.stridedSlice(this,t,n,r,o,i,a,s,u)},e.prototype.depthToSpace=function(t,n){return this.throwIfDisposed(),V.depthToSpace(this,t,n)},e.prototype.fft=function(){return this.throwIfDisposed(),V.spectral.fft(this)},e.prototype.ifft=function(){return this.throwIfDisposed(),V.spectral.ifft(this)},e.prototype.rfft=function(){return this.throwIfDisposed(),V.spectral.rfft(this)},e.prototype.irfft=function(){return this.throwIfDisposed(),V.spectral.irfft(this)},e}();Object.defineProperty(qe,Symbol.hasInstance,{value:function(e){return!!e&&e.dataId!=null&&e.shape!=null&&e.dtype!=null}});var Ry,Gh,qh,Kh,Xh,Ha=function(e){function t(n,r,o,i){var a=e.call(this,n.shape,n.dtype,n.dataId,i)||this;return a.trainable=r,a.name=o,a}return sr(t,e),t.prototype.assign=function(n){if(n.dtype!==this.dtype)throw new Error("dtype of the new value ("+n.dtype+") and previous value ("+this.dtype+") must match");if(!xt(n.shape,this.shape))throw new Error("shape of the new value ("+n.shape+") and previous value ("+this.shape+") must match");xr().disposeTensor(this),this.dataId=n.dataId,xr().incRef(this,null)},t.prototype.dispose=function(){xr().disposeVariable(this),this.isDisposedInternal=!0},t}(qe);Object.defineProperty(Ha,Symbol.hasInstance,{value:function(e){return e instanceof qe&&e.assign!=null&&e.assign instanceof Function}}),function(e){e.R0="R0",e.R1="R1",e.R2="R2",e.R3="R3",e.R4="R4",e.R5="R5",e.R6="R6"}(Ry||(Ry={})),function(e){e.float32="float32",e.int32="int32",e.bool="int32",e.complex64="complex64"}(Gh||(Gh={})),function(e){e.float32="float32",e.int32="int32",e.bool="bool",e.complex64="complex64"}(qh||(qh={})),function(e){e.float32="float32",e.int32="float32",e.bool="float32",e.complex64="complex64"}(Kh||(Kh={})),function(e){e.float32="complex64",e.int32="complex64",e.bool="complex64",e.complex64="complex64"}(Xh||(Xh={}));var mA={float32:Kh,int32:Gh,bool:qh,complex64:Xh};function _t(e,t){if(e==="string"||t==="string"){if(e==="string"&&t==="string")return"string";throw new Error("Can not upcast "+e+" with "+t)}return mA[e][t]}function sf(e){return _t(e,"int32")}function Qe(e,t){if(e.dtype===t.dtype)return[e,t];var n=_t(e.dtype,t.dtype);return[e.cast(n),t.cast(n)]}function gA(e,t){I(e.dtype===t.dtype,function(){return"The dtypes of the first("+e.dtype+") and second("+t.dtype+") input must match"})}function Ub(e){var t=[];return function n(r,o,i){if(r!=null){if(r instanceof qe)return void o.push(r);if(a=r,!(!Array.isArray(a)&&typeof a!="object")){var a,s=r;for(var u in s){var l=s[u];i.has(l)||(i.add(l),n(l,o,i))}}}}(e,t,new Set),t}var uf,Ny=function(){function e(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null}}return e.prototype.dispose=function(){for(var t in this.registeredVariables)this.registeredVariables[t].dispose()},e}(),yA=function(){function e(t){this.ENV=t,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new Ny}return e.prototype.ready=function(){return oe(this,void 0,void 0,function(){var t,n,r;return ie(this,function(o){switch(o.label){case 0:if(this.pendingBackendInit!=null)return[2,this.pendingBackendInit.then(function(){})];if(this.backendInstance!=null)return[2];t=this.getSortedBackends(),n=0,o.label=1;case 1:return n<t.length?(r=t[n],[4,this.initializeBackend(r).success]):[3,5];case 2:return o.sent()?[4,this.setBackend(r)]:[3,4];case 3:return o.sent(),[2];case 4:return n++,[3,1];case 5:throw new Error("Could not initialize any backends, all backend initializations failed.")}})})},Object.defineProperty(e.prototype,"backend",{get:function(){if(this.pendingBackendInit!=null)throw new Error("Backend '"+this.backendName+"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");if(this.backendInstance==null){var t=this.initializeBackendsAndReturnBest(),n=t.name;if(t.asyncInit)throw new Error("The highest priority backend '"+n+"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");this.setBackend(n)}return this.backendInstance},enumerable:!0,configurable:!0}),e.prototype.backendNames=function(){return Object.keys(this.registryFactory)},e.prototype.findBackend=function(t){return!(t in this.registry)&&(!(t in this.registryFactory)||this.initializeBackend(t).asyncInit)?null:this.registry[t]},e.prototype.findBackendFactory=function(t){return t in this.registryFactory?this.registryFactory[t].factory:null},e.prototype.registerBackend=function(t,n,r){return r===void 0&&(r=1),t in this.registryFactory?(console.warn(t+" backend was already registered. Reusing existing backend factory."),!1):(this.registryFactory[t]={factory:n,priority:r},!0)},e.prototype.setBackend=function(t){return oe(this,void 0,void 0,function(){var n,r,o;return ie(this,function(i){switch(i.label){case 0:if(this.registryFactory[t]==null)throw new Error("Backend name '"+t+"' not found in registry");return this.backendName=t,this.registry[t]!=null?[3,4]:(this.backendInstance=null,n=this.initializeBackend(t),r=n.success,n.asyncInit?[4,r]:[3,2]);case 1:return o=i.sent(),[3,3];case 2:o=r,i.label=3;case 3:if(!o)return[2,!1];i.label=4;case 4:return this.backendInstance=this.registry[t],this.setupRegisteredKernels(),this.profiler=new hA(this.backendInstance),[2,!0]}})})},e.prototype.setupRegisteredKernels=function(){var t=this;Cy(this.backendName).forEach(function(n){n.setupFunc!=null&&n.setupFunc(t.backendInstance)})},e.prototype.disposeRegisteredKernels=function(t){var n=this;Cy(t).forEach(function(r){r.disposeFunc!=null&&r.disposeFunc(n.registry[t])})},e.prototype.initializeBackend=function(t){var n=this,r=this.registryFactory[t];if(r==null)throw new Error("Cannot initialize backend "+t+", no registration found.");try{var o=r.factory();if(Promise.resolve(o)===o){var i=++this.pendingBackendInitId,a=o.then(function(s){return!(i<n.pendingBackendInitId)&&(n.registry[t]=s,n.pendingBackendInit=null,!0)}).catch(function(s){return!(i<n.pendingBackendInitId)&&(n.pendingBackendInit=null,console.warn("Initialization of backend "+t+" failed"),console.warn(s.stack||s.message),!1)});return this.pendingBackendInit=a,{success:a,asyncInit:!0}}return this.registry[t]=o,{success:!0,asyncInit:!1}}catch(s){return console.warn("Initialization of backend "+t+" failed"),console.warn(s.stack||s.message),{success:!1,asyncInit:!1}}},e.prototype.removeBackend=function(t){if(!(t in this.registryFactory))throw new Error(t+" backend not found in registry");this.backendName===t&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,t in this.registry&&(this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t]),delete this.registryFactory[t],this.backendName===t&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)},e.prototype.getSortedBackends=function(){var t=this;if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort(function(n,r){return t.registryFactory[r].priority-t.registryFactory[n].priority})},e.prototype.initializeBackendsAndReturnBest=function(){for(var t=this.getSortedBackends(),n=0;n<t.length;n++){var r=t[n],o=this.initializeBackend(r),i=o.success,a=o.asyncInit;if(a||i)return{name:r,asyncInit:a}}throw new Error("Could not initialize any backends, all backend initializations failed.")},e.prototype.moveData=function(t,n){var r=this.state.tensorInfo.get(n),o=r.backend,i=this.readSync(n);o.disposeData(n),r.backend=t,t.move(n,i,r.shape,r.dtype),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++},e.prototype.tidy=function(t,n){var r,o=this,i=null;if(n==null){if(typeof t!="function")throw new Error("Please provide a function to tidy()");n=t}else{if(typeof t!="string"&&!(t instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof n!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");i=t}return this.scopedRun(function(){return o.startScope(i)},function(){return o.endScope(r)},function(){return(r=n())instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),r})},e.prototype.scopedRun=function(t,n,r){t();try{var o=r();return n(),o}catch(i){throw n(),i}},e.prototype.nextTensorId=function(){return e.nextTensorId++},e.prototype.nextVariableId=function(){return e.nextVariableId++},e.prototype.clone=function(t){var n=this.makeTensorFromDataId(t.dataId,t.shape,t.dtype),r={x:t};return this.addTapeNode(this.state.activeScope.name,r,[n],function(o){return{x:function(){return o.toFloat()}}},[]),n},e.prototype.runKernel=function(t,n,r,o,i){return this.runKernelFunc(null,n,null,t,r,o,i)},e.prototype.shouldCheckForMemLeaks=function(){return this.ENV.getBool("IS_TEST")},e.prototype.checkKernelForMemLeak=function(t,n,r){var o=this.backend.numDataIds(),i=0;r.forEach(function(u){i+=u.dtype==="complex64"?3:1});var a=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],s=o-n-i-a;if(s>0)throw new Error("Backend '"+this.backendName+"' has an internal memory leak ("+s+" data ids) after running '"+t+"'")},e.prototype.runKernelFunc=function(t,n,r,o,i,a,s){var u,l=this;a===void 0&&(a=[]),s===void 0&&(s=[]);var c=[],d=this.isTapeOn();o==null&&(o=this.state.activeScope!=null?this.state.activeScope.name:"");var f,h=function(y){d&&(c=y.map(function(x){return l.keep(l.clone(x))}))},v=this.state.numBytes,m=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);var g,p=Pb(o,this.backendName);return f=p!=null?function(){var y=l.backend.numDataIds();g=p.kernelFunc({inputs:n,attrs:i,backend:l.backend});var x=Array.isArray(g)?g:[g];l.shouldCheckForMemLeaks()&&l.checkKernelForMemLeak(o,y,x);var w=x.map(function(C){var E=C.dataId,S=C.shape,R=C.dtype;return l.makeTensorFromDataId(E,S,R)}),b=w.filter(function(C,E){return s[E]});return h((a||[]).slice().concat(b)),w}:function(){var y=l.backend.numDataIds();g=l.tidy(function(){return t(l.backend,h)});var x=Array.isArray(g)?g:[g];return l.shouldCheckForMemLeaks()&&l.checkKernelForMemLeak(o,y,x),x},this.scopedRun(function(){return l.state.kernelDepth++},function(){return l.state.kernelDepth--},function(){u=l.ENV.getBool("DEBUG")?l.profiler.profileKernel(o,n,function(){return f()}):f()}),d&&this.addTapeNode(o,n,u,r,c),this.state.profiling&&this.state.activeProfile.kernels.push({name:o,bytesAdded:this.state.numBytes-v,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-m,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(n).map(function(y){return n[y].shape}),outputShapes:u.map(function(y){return y.shape})}),Array.isArray(g)?u:u[0]},e.prototype.makeTensor=function(t,n,r,o){if(t==null)throw new Error("Values passed to engine.makeTensor() are null");r=r||"float32",o=o||this.backend;var i=t;r==="string"&&Cv(t[0])&&(i=t.map(function(c){return dA(c)}));var a=o.write(i,n,r),s=new qe(n,r,a,this.nextTensorId());if(this.incRef(s,o),r==="string"){var u=this.state.tensorInfo.get(a),l=uA(i);this.state.numBytes+=l-u.bytes,u.bytes=l}return s},e.prototype.makeTensorFromDataId=function(t,n,r,o){var i=new qe(n,r=r||"float32",t,this.nextTensorId());return this.incRef(i,o),i},e.prototype.makeVariable=function(t,n,r,o){n===void 0&&(n=!0),r=r||this.nextVariableId().toString(),o!=null&&o!==t.dtype&&(t=t.asType(o));var i=new Ha(t,n,r,this.nextTensorId());if(this.state.registeredVariables[i.name]!=null)throw new Error("Variable with name "+i.name+" was already registered");return this.state.registeredVariables[i.name]=i,this.incRef(i,this.backend),i},e.prototype.incRef=function(t,n){var r=this.state.tensorInfo.has(t.dataId)?this.state.tensorInfo.get(t.dataId).refCount:0;if(this.state.numTensors++,t.dtype==="string"&&this.state.numStringTensors++,r===0){this.state.numDataBuffers++;var o=0;t.dtype!=="complex64"&&t.dtype!=="string"&&(o=t.size*Ob(t.dtype)),this.state.tensorInfo.set(t.dataId,{backend:n||this.backend,dtype:t.dtype,shape:t.shape,bytes:o,refCount:0}),this.state.numBytes+=o}this.state.tensorInfo.get(t.dataId).refCount++,t instanceof Ha||this.track(t)},e.prototype.disposeTensor=function(t){if(this.state.tensorInfo.has(t.dataId)){this.state.numTensors--,t.dtype==="string"&&this.state.numStringTensors--;var n=this.state.tensorInfo.get(t.dataId);n.refCount<=1?(t.dtype!=="complex64"&&(this.state.numBytes-=n.bytes),this.state.numDataBuffers--,n.backend.disposeData(t.dataId),this.state.tensorInfo.delete(t.dataId)):this.state.tensorInfo.get(t.dataId).refCount--}},e.prototype.disposeVariables=function(){for(var t in this.state.registeredVariables){var n=this.state.registeredVariables[t];this.disposeVariable(n)}},e.prototype.disposeVariable=function(t){this.disposeTensor(t),this.state.registeredVariables[t.name]!=null&&delete this.state.registeredVariables[t.name]},e.prototype.memory=function(){var t=this.backend.memory();return t.numTensors=this.state.numTensors,t.numDataBuffers=this.state.numDataBuffers,t.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(t.unreliable=!0,t.reasons==null&&(t.reasons=[]),t.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),t},e.prototype.profile=function(t){return oe(this,void 0,void 0,function(){var n,r;return ie(this,function(o){return this.state.profiling=!0,n=this.state.numBytes,r=this.state.numTensors,this.state.activeProfile.kernels=[],this.state.activeProfile.result=t(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max.apply(Math,this.state.activeProfile.kernels.map(function(i){return i.totalBytesSnapshot})),this.state.activeProfile.newBytes=this.state.numBytes-n,this.state.activeProfile.newTensors=this.state.numTensors-r,[2,this.state.activeProfile]})})},e.prototype.isTapeOn=function(){return this.state.gradientDepth>0&&this.state.kernelDepth===0},e.prototype.addTapeNode=function(t,n,r,o,i){var a=this,s={id:this.state.nextTapeNodeId++,kernelName:t,inputs:n,outputs:r,saved:i},u=eA(t);u!=null&&(o=u.gradFunc),o!=null&&(s.gradient=function(l){return l=l.map(function(c,d){if(c==null){var f=r[d],h=xu(f.size,f.dtype);return a.makeTensor(h,f.shape,f.dtype)}return c}),o(l.length>1?l:l[0],i)}),this.state.activeTape.push(s)},e.prototype.keep=function(t){return t.kept=!0,t},e.prototype.startTape=function(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++},e.prototype.endTape=function(){this.state.gradientDepth--},e.prototype.startScope=function(t){var n={track:[],name:"unnamed scope",id:this.state.nextScopeId++};t&&(n.name=t),this.state.scopeStack.push(n),this.state.activeScope=n},e.prototype.endScope=function(t){for(var n=this,r=Ub(t),o=new Set(r.map(function(u){return u.id})),i=0;i<this.state.activeScope.track.length;i++){var a=this.state.activeScope.track[i];a.kept||o.has(a.id)||a.dispose()}var s=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],r.forEach(function(u){u.kept||u.scopeId!==s.id||n.track(u)})},e.prototype.gradients=function(t,n,r,o){var i=this;if(o===void 0&&(o=!1),I(n.length>0,function(){return"gradients() received an empty list of xs."}),r!=null&&r.dtype!=="float32")throw new Error("dy must have 'float32' dtype, but has '"+r.dtype+"'");var a=this.scopedRun(function(){return i.startTape()},function(){return i.endTape()},function(){return i.tidy("forward",t)});I(a instanceof qe,function(){return"The result y returned by f() must be a tensor."});var s=function(u,l,c){for(var d={},f={},h=0;h<l.length;h++)d[l[h].id]=!0;for(h=0;h<u.length;h++){var v=(C=u[h]).inputs;for(var m in v){for(var g=v[m],p=!1,y=0;y<l.length;y++)if(d[g.id]){C.outputs.forEach(function(k){return d[k.id]=!0}),p=!0,f[C.id]=!0;break}if(p)break}}var x={};x[c.id]=!0;var w={};for(h=u.length-1;h>=0;h--)for(v=(C=u[h]).inputs,y=0;y<C.outputs.length;y++)if(x[C.outputs[y].id]){for(var m in v)x[v[m].id]=!0,w[C.id]=!0;break}var b=[];for(h=0;h<u.length;h++){var C;if(f[(C=u[h]).id]&&w[C.id]){var E={};for(var m in C.inputs){var S=C.inputs[m];d[S.id]&&(E[m]=S)}var R=Object.assign({},C);R.inputs=E,R.outputs=C.outputs,b.push(R)}}return b}(this.state.activeTape,n,a);if(!o&&s.length===0&&n.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",function(){var u,l,c={};c[a.id]=r??(u=a.shape,l=Bb(ae(u),"float32"),L.makeTensor(l,u,"float32")),function(f,h,v){for(var m=function(p){var y=h[p],x=[];if(y.outputs.forEach(function(E){var S=f[E.id];S!=null?x.push(S):x.push(null)}),y.gradient==null)throw new Error("Cannot compute gradient: gradient function not found for "+y.kernelName+".");var w=y.gradient(x),b=function(E){if(!(E in w))throw new Error("Cannot backprop through input "+E+". Available gradients found: "+Object.keys(w)+".");var S=v(function(){return w[E]()});if(S.dtype!=="float32")throw new Error("Error in gradient for op "+y.kernelName+". The gradient of input "+E+" must have 'float32' dtype, but has '"+S.dtype+"'");var R=y.inputs[E];if(!xt(S.shape,R.shape))throw new Error("Error in gradient for op "+y.kernelName+". The gradient of input '"+E+"' has shape '"+S.shape+"', which does not match the shape of the input '"+R.shape+"'");if(f[R.id]==null)f[R.id]=S;else{var k=f[R.id];f[R.id]=k.add(S),k.dispose()}};for(var C in y.inputs)b(C)},g=h.length-1;g>=0;g--)m(g)}(c,s,function(f){return i.tidy(f)});var d=n.map(function(f){return c[f.id]});return i.state.gradientDepth===0&&(i.state.activeTape.forEach(function(f){for(var h=0,v=f.saved;h<v.length;h++)v[h].dispose()}),i.state.activeTape=null),{value:a,grads:d}})},e.prototype.customGrad=function(t){var n=this;return I(Vh(t),function(){return"The f passed in customGrad(f) must be a function."}),function(){for(var r,o=[],i=0;i<arguments.length;i++)o[i]=arguments[i];I(o.every(function(s){return s instanceof qe}),function(){return"The args passed in customGrad(f)(x1, x2,...) must all be tensors"});var a={};return o.forEach(function(s,u){a[u]=s}),n.runKernelFunc(function(s,u){return I((r=t.apply(void 0,o.concat([u]))).value instanceof qe,function(){return"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"}),I(Vh(r.gradFunc),function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."}),r.value},a,function(s,u){var l=r.gradFunc(s,u),c=Array.isArray(l)?l:[l];I(c.length===o.length,function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."}),I(c.every(function(f){return f instanceof qe}),function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors."});var d={};return c.forEach(function(f,h){d[h]=function(){return f}}),d})}},e.prototype.readSync=function(t){return this.state.tensorInfo.get(t).backend.readSync(t)},e.prototype.read=function(t){return this.state.tensorInfo.get(t).backend.read(t)},e.prototype.time=function(t){return oe(this,void 0,void 0,function(){var n,r;return ie(this,function(o){switch(o.label){case 0:return n=gr(),[4,this.backend.time(t)];case 1:return(r=o.sent()).wallMs=gr()-n,[2,r]}})})},e.prototype.track=function(t){return this.state.activeScope!=null&&(t.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(t)),t},Object.defineProperty(e.prototype,"registeredVariables",{get:function(){return this.state.registeredVariables},enumerable:!0,configurable:!0}),e.prototype.reset=function(){for(var t in this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new Ny,this.registry)this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null},e.nextTensorId=0,e.nextVariableId=0,e}(),L=function(){var e=function(){if(uf==null){var n=void 0;if(typeof window<"u")n=window;else if(typeof global<"u")n=global;else if(typeof process<"u")n=process;else{if(typeof self>"u")throw new Error("Could not find a global object");n=self}uf=n}return uf}();if(e._tfengine==null){var t=new JT(e);e._tfengine=new yA(t)}return function(n){Ab=n}(e._tfengine.ENV),xr=function(){return e._tfengine},e._tfengine}();function $b(){return typeof window<"u"&&window.document!=null||typeof WorkerGlobalScope<"u"}var Br=H();Br.registerFlag("DEBUG",function(){return!1},function(e){e&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")}),Br.registerFlag("IS_BROWSER",function(){return $b()}),Br.registerFlag("IS_NODE",function(){return typeof process<"u"&&process.versions!==void 0&&process.versions.node!==void 0}),Br.registerFlag("IS_CHROME",function(){return typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)}),Br.registerFlag("PROD",function(){return!1}),Br.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",function(){return Br.getBool("DEBUG")}),Br.registerFlag("DEPRECATION_WARNINGS_ENABLED",function(){return!0}),Br.registerFlag("IS_TEST",function(){return!1});var ru,gn,vn,ui={},lf={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function xA(e,t){ui[e]=t}function Pr(e){e in ui||(ui[e]=function(n){if(n!==1&&n!==2)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");var r=function(o){if(typeof OffscreenCanvas<"u"&&o===2)return new OffscreenCanvas(300,150);if(typeof document<"u")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}(n);return r.addEventListener("webglcontextlost",function(o){o.preventDefault(),delete ui[n]},!1),n===1?r.getContext("webgl",lf)||r.getContext("experimental-webgl",lf):r.getContext("webgl2",lf)}(e));var t=ui[e];return t.isContextLost()?(delete ui[e],Pr(e)):(t.disable(t.DEPTH_TEST),t.disable(t.STENCIL_TEST),t.disable(t.BLEND),t.disable(t.DITHER),t.disable(t.POLYGON_OFFSET_FILL),t.disable(t.SAMPLE_COVERAGE),t.enable(t.SCISSOR_TEST),t.enable(t.CULL_FACE),t.cullFace(t.BACK),ui[e])}function ud(e,t){return[t,e]}function As(e){var t=ae(e);return $h(Math.ceil(t/4))}function wu(e,t){return[Math.max(1,Math.ceil(t/2)),Math.max(1,Math.ceil(e/2))]}function Ev(e,t){var n,r,o,i,a,s,u,l,c,d=e;return H().getNumber("WEBGL_VERSION")===2?(n=d.R32F,r=d.R16F,o=d.RGBA16F,i=d.RGBA32F,a=d.RED,s=4,u=1,l=d.HALF_FLOAT,c=d.FLOAT):(n=e.RGBA,r=e.RGBA,o=e.RGBA,i=d.RGBA,a=e.RGBA,s=4,u=4,l=t!=null?t.HALF_FLOAT_OES:null,c=e.FLOAT),{internalFormatFloat:n,internalFormatHalfFloat:r,internalFormatPackedHalfFloat:o,internalFormatPackedFloat:i,textureFormatFloat:a,downloadTextureFormat:e.RGBA,downloadUnpackNumChannels:s,defaultNumChannels:u,textureTypeHalfFloat:l,textureTypeFloat:c}}function ue(e,t,n){var r=n();return t&&function(o){var i=o.getError();if(i!==o.NO_ERROR)throw new Error("WebGL Error: "+EA(o,i))}(e),r}(function(e){e[e.DENSE=0]="DENSE",e[e.SHARED_BATCH=1]="SHARED_BATCH"})(ru||(ru={})),function(e){e[e.RENDER=0]="RENDER",e[e.UPLOAD=1]="UPLOAD",e[e.PIXELS=2]="PIXELS",e[e.DOWNLOAD=3]="DOWNLOAD"}(gn||(gn={})),function(e){e[e.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",e[e.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",e[e.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",e[e.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",e[e.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"}(vn||(vn={}));var wA=596e-10,bA=65504;function CA(e){return!!(H().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||e===0||wA<Math.abs(e)&&Math.abs(e)<bA)}function EA(e,t){switch(t){case e.NO_ERROR:return"NO_ERROR";case e.INVALID_ENUM:return"INVALID_ENUM";case e.INVALID_VALUE:return"INVALID_VALUE";case e.INVALID_OPERATION:return"INVALID_OPERATION";case e.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case e.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case e.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return"Unknown error code "+t}}function Zu(e,t,n){return to(e,t,function(){return e.getExtension(n)},'Extension "'+n+'" not supported on this browser.')}function _A(e,t,n){var r=to(e,t,function(){return e.createShader(e.VERTEX_SHADER)},"Unable to create vertex WebGLShader.");if(ue(e,t,function(){return e.shaderSource(r,n)}),ue(e,t,function(){return e.compileShader(r)}),e.getShaderParameter(r,e.COMPILE_STATUS)===!1)throw console.log(e.getShaderInfoLog(r)),new Error("Failed to compile vertex shader.");return r}function SA(e,t,n){var r=to(e,t,function(){return e.createShader(e.FRAGMENT_SHADER)},"Unable to create fragment WebGLShader.");if(ue(e,t,function(){return e.shaderSource(r,n)}),ue(e,t,function(){return e.compileShader(r)}),e.getShaderParameter(r,e.COMPILE_STATUS)===!1)throw function(o,i){var a=kA.exec(i);if(a==null)return console.log("Couldn't parse line number in error: "+i),void console.log(o);for(var s=+a[1],u=o.split(`
`),l=u.length.toString().length+2,c=u.map(function(g,p){return xa((p+1).toString(),l)+g}),d=0,f=0;f<c.length;f++)d=Math.max(c[f].length,d);var h=c.slice(0,s-1),v=c.slice(s-1,s),m=c.slice(s);console.log(h.join(`
`)),console.log(i.split(`
`)[0]),console.log("%c "+xa(v[0],d),"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(m.join(`
`))}(n,e.getShaderInfoLog(r)),new Error("Failed to compile fragment shader.");return r}var cf,df,kA=/ERROR: [0-9]+:([0-9]+):/g;function RA(e,t){return to(e,t,function(){return e.createProgram()},"Unable to create WebGLProgram.")}function NA(e,t,n){if(ue(e,t,function(){return e.linkProgram(n)}),e.getProgramParameter(n,e.LINK_STATUS)===!1)throw console.log(e.getProgramInfoLog(n)),new Error("Failed to link vertex and fragment shaders.")}function ff(e,t,n){if(ue(e,t,function(){return e.validateProgram(n)}),e.getProgramParameter(n,e.VALIDATE_STATUS)===!1)throw console.log(e.getProgramInfoLog(n)),new Error("Shader program validation failed.")}function IA(e,t,n){var r=to(e,t,function(){return e.createBuffer()},"Unable to create WebGLBuffer");return ue(e,t,function(){return e.bindBuffer(e.ARRAY_BUFFER,r)}),ue(e,t,function(){return e.bufferData(e.ARRAY_BUFFER,n,e.STATIC_DRAW)}),r}function TA(e,t,n){var r=to(e,t,function(){return e.createBuffer()},"Unable to create WebGLBuffer");return ue(e,t,function(){return e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,r)}),ue(e,t,function(){return e.bufferData(e.ELEMENT_ARRAY_BUFFER,n,e.STATIC_DRAW)}),r}function AA(e,t){return to(e,t,function(){return e.createTexture()},"Unable to create WebGLTexture.")}function PA(e,t){var n=H().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(e<=0||t<=0){var r="["+e+"x"+t+"]";throw new Error("Requested texture size "+r+" is invalid.")}if(e>n||t>n)throw r="["+e+"x"+t+"]",new Error("Requested texture size "+r+" greater than WebGL maximum on this browser / GPU "+("["+n+"x"+n+"]")+".")}function DA(e,t){return to(e,t,function(){return e.createFramebuffer()},"Unable to create WebGLFramebuffer.")}function Iy(e,t,n,r,o,i,a,s){var u=e.getAttribLocation(n,r);return u!==-1&&(ue(e,t,function(){return e.bindBuffer(e.ARRAY_BUFFER,o)}),ue(e,t,function(){return e.vertexAttribPointer(u,i,e.FLOAT,!1,a,s)}),ue(e,t,function(){return e.enableVertexAttribArray(u)}),!0)}function FA(e,t,n,r){jA(e,r),ue(e,t,function(){return e.activeTexture(e.TEXTURE0+r)}),ue(e,t,function(){return e.bindTexture(e.TEXTURE_2D,n)})}function MA(e,t,n,r){return to(e,t,function(){return e.getUniformLocation(n,r)},'uniform "'+r+'" not present in program.')}function OA(e,t,n){return e.getUniformLocation(t,n)}function LA(e,t,n,r,o,i){ue(e,t,function(){return FA(e,t,r,i)}),ue(e,t,function(){return e.uniform1i(o,i)})}function hf(e,t,n,r){ue(e,t,function(){return e.bindFramebuffer(e.FRAMEBUFFER,r)}),ue(e,t,function(){return e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,n,0)})}function Ty(e,t,n){ue(e,t,function(){return e.bindFramebuffer(e.FRAMEBUFFER,n)}),ue(e,t,function(){return e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,null,0)})}function el(e){var t=e.checkFramebufferStatus(e.FRAMEBUFFER);if(t!==e.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+BA(e,t))}function BA(e,t){switch(t){case e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case e.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return"unknown error "+t}}function to(e,t,n,r){var o=ue(e,t,function(){return n()});if(o==null)throw new Error(r);return o}function jA(e,t){var n=e.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=t+e.TEXTURE0;if(r<e.TEXTURE0||r>n)throw new Error("textureUnit must be in "+("[gl.TEXTURE0, gl.TEXTURE"+n+"]")+".")}function hc(e,t){return t===void 0&&(t=2),ae(e.slice(0,e.length-t))}function pc(e){if(e.length===0)throw Error("Cannot get rows and columns of an empty shape array.");return[e.length>1?e[e.length-2]:1,e[e.length-1]]}function pf(e){var t=[1,1,1];return e.length===0||e.length===1&&e[0]===1||(t=[hc(e)].concat(pc(e))),t}function WA(e,t){var n;t===void 0&&(t=!1);var r=H().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(t&&(r*=2,(e=e.map(function(l,c){return c>=e.length-2?Mb(e[c]):e[c]})).length===1&&(e=[2,e[0]])),e.length!==2){var o=ci(e);e=o.newShape}var i=ae(e);if(e.length<=1&&i<=r)return[1,i];if(e.length===2&&e[0]<=r&&e[1]<=r)return e;if(e.length===3&&e[0]*e[1]<=r&&e[2]<=r)return[e[0]*e[1],e[2]];if(e.length===3&&e[0]<=r&&e[1]*e[2]<=r)return[e[0],e[1]*e[2]];if(e.length===4&&e[0]*e[1]*e[2]<=r&&e[3]<=r)return[e[0]*e[1]*e[2],e[3]];if(e.length===4&&e[0]<=r&&e[1]*e[2]*e[3]<=r)return[e[0],e[1]*e[2]*e[3]];if(t){var a=hc(e),s=2,u=2;return e.length&&(s=(n=pc(e))[0],u=n[1]),$h(i=a*(s/2)*(u/2)).map(function(l){return 2*l})}return $h(i)}function tl(e){return e%2==0}function nl(e,t){if(xt(e=e.slice(-2),t=t.slice(-2))||!e.length||!t.length||e[0]===0||e[1]===0||t[0]===0||t[1]===0)return!0;if(e.length!==t.length){var n=e.slice(-1)[0],r=t.slice(-1)[0];if(n===r||tl(n)&&tl(r)&&(e[0]===1||t[0]===1))return!0}return e[1]===t[1]&&tl(e[0])&&tl(t[0])}function zA(e){if(cf==null){var t=Pr(e);cf=t.getParameter(t.MAX_TEXTURE_SIZE)}return cf}function UA(e){if(df==null){var t=Pr(e);df=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,df)}function $A(e){if(e===0)return 0;var t=Pr(e);return Dn(t,"EXT_disjoint_timer_query_webgl2")&&e===2?2:Dn(t,"EXT_disjoint_timer_query")?1:0}function Dn(e,t){return e.getExtension(t)!=null}function Ay(e){try{if(Pr(e)!=null)return!0}catch{return!1}return!1}function VA(e){if(e===0)return!1;var t=Pr(e);if(e===1){if(!Dn(t,"OES_texture_float"))return!1}else if(!Dn(t,"EXT_color_buffer_float"))return!1;return Yh(t)}function HA(e){if(e===0)return!1;var t=Pr(e);if(e!==1){if(Dn(t,"EXT_color_buffer_float"))return Yh(t);if(Dn(t,"EXT_color_buffer_half_float")){var n=t.getExtension("EXT_color_buffer_half_float");return function(r,o){var i=Ev(r,o),a=r.createTexture();r.bindTexture(r.TEXTURE_2D,a),r.texImage2D(r.TEXTURE_2D,0,i.internalFormatHalfFloat,1,1,0,i.textureFormatFloat,i.textureTypeHalfFloat,null);var s=r.createFramebuffer();r.bindFramebuffer(r.FRAMEBUFFER,s),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,a,0);var u=r.checkFramebufferStatus(r.FRAMEBUFFER)===r.FRAMEBUFFER_COMPLETE;return r.bindTexture(r.TEXTURE_2D,null),r.bindFramebuffer(r.FRAMEBUFFER,null),r.deleteTexture(a),r.deleteFramebuffer(s),u}(t,n)}return!1}return!!Dn(t,"OES_texture_float")&&!!Dn(t,"WEBGL_color_buffer_float")&&Yh(t)}function Yh(e){var t=Ev(e),n=e.createTexture();e.bindTexture(e.TEXTURE_2D,n),e.texImage2D(e.TEXTURE_2D,0,t.internalFormatFloat,1,1,0,t.textureFormatFloat,t.textureTypeFloat,null);var r=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,r),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,n,0);var o=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(n),e.deleteFramebuffer(r),o}function GA(e){return e===2&&Pr(e).fenceSync!=null}var fe=H();function Vb(e){H().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(e+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function te(e,t){return L.tidy(e,t)}function an(e){Ub(e).forEach(function(t){return t.dispose()})}function qA(e){return L.keep(e)}function vc(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];H().getBool("IS_TEST")||console.warn.apply(console,e)}function ei(e,t){var n=e;if(kr(e))return t==="string"?[]:[e.length];if(!Array.isArray(e))return[];for(var r=[];Array.isArray(n)||kr(n)&&t!=="string";)r.push(n.length),n=n[0];return Array.isArray(e)&&H().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&function o(i,a,s){if(s=s||[],!Array.isArray(i)&&!kr(i))return void I(a.length===0,function(){return"Element arr["+s.join("][")+"] is a primitive, but should be an array/TypedArray of "+a[0]+" elements"});I(a.length>0,function(){return"Element arr["+s.join("][")+"] should be a primitive, but is an array of "+i.length+" elements"}),I(i.length===a[0],function(){return"Element arr["+s.join("][")+"] should have "+a[0]+" elements, but has "+i.length+" elements"});for(var u=a.slice(1),l=0;l<i.length;++l)o(i[l],u,s.concat(l))}(e,r,[]),r}function Py(e,t,n,r){if(e!=null&&(e!=="numeric"&&e!==t||e==="numeric"&&t==="string"))throw new Error("Argument '"+n+"' passed to '"+r+"' must be "+e+" tensor, but got "+t+" tensor")}function N(e,t,n,r){if(r===void 0&&(r="numeric"),e instanceof qe)return Py(r,e.dtype,t,n),e;var o=yu(e);if(o!=="string"&&["bool","int32","float32"].indexOf(r)>=0&&(o=r),Py(r,o,t,n),e==null||!kr(e)&&!Array.isArray(e)&&typeof e!="number"&&typeof e!="boolean"&&typeof e!="string"){var i=e==null?"null":e.constructor.name;throw new Error("Argument '"+t+"' passed to '"+n+"' must be a Tensor or TensorLike, but got '"+i+"'")}var a=ei(e,o);kr(e)||Array.isArray(e)||(e=[e]);var s=o!=="string"?Lb(e,o,H().getBool("DEBUG")):Va(e,[],!0);return L.makeTensor(s,a,o)}function mc(e,t,n,r){if(r===void 0&&(r="numeric"),!Array.isArray(e))throw new Error("Argument "+t+" passed to "+n+" must be a `Tensor[]` or `TensorLike[]`");return e.map(function(o,i){return N(o,t+"["+i+"]",n)},r)}function Hb(e,t){for(var n=0;n<e.length;++n)if(e[e.length-n-1]!==t-1-n)return!1;return!0}function KA(e,t,n){for(var r=e.length+t.length,o=[],i=0,a=0,s=0;s<r;s++)n.indexOf(s)===-1?o.push(e[i++]):o.push(t[a++]);return o}function Ft(e,t){for(var n=[],r=e.length,o=0;o<r;o++)t.indexOf(o)===-1&&n.push(e[o]);return[n,t.map(function(i){return e[i]})]}function un(e,t){return KA(e,t.map(function(n){return 1}),t)}function hn(e,t,n){I(Hb(t,n),function(){return e+" supports only inner-most axes for now. Got axes "+t+" and rank-"+n+" input."})}function Dr(e,t){if(Hb(e,t))return null;for(var n=[],r=0;r<t;++r)e.indexOf(r)===-1&&n.push(r);return e.forEach(function(o){return n.push(o)}),n}function _v(e){return e.map(function(t,n){return[n,t]}).sort(function(t,n){return t[1]-n[1]}).map(function(t){return t[0]})}function Fr(e,t){for(var n=[],r=t-e;r<t;++r)n.push(r);return n}function XA(e,t){var n=e[0].length;e.forEach(function(o,i){I(o.length===n,function(){return"Error in concat"+n+"D: rank of tensors["+i+"] must be the same as the rank of the rest ("+n+")"})}),I(t>=0&&t<n,function(){return"Error in concat"+n+"D: axis must be between 0 and "+(n-1)+"."});var r=e[0];e.forEach(function(o,i){for(var a=0;a<n;a++)I(a===t||o[a]===r[a],function(){return"Error in concat"+n+"D: Shape of tensors["+i+"] ("+o+") does not match the shape of the rest ("+r+") along the non-concatenated axis "+i+"."})})}function Ga(e,t){for(var n=e[0].slice(),r=1;r<e.length;r++)n[t]+=e[r][t];return n}function F(e){var t=Object.keys(e);if(t.length!==1)throw new Error("Please provide an object with a single key (operation name) mapping to a function. Got an object with "+t.length+" keys.");var n=t[0],r=e[n];n.endsWith("_")&&(n=n.substring(0,n.length-1));var o=function(){for(var i=[],a=0;a<arguments.length;a++)i[a]=arguments[a];L.startScope(n);try{var s=r.apply(void 0,i);return s instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),L.endScope(s),s}catch(u){throw L.endScope(null),u}};return Object.defineProperty(o,"name",{value:n,configurable:!0}),o}fe.registerFlag("HAS_WEBGL",function(){return fe.getNumber("WEBGL_VERSION")>0}),fe.registerFlag("WEBGL_VERSION",function(){return Ay(2)?2:Ay(1)?1:0}),fe.registerFlag("WEBGL_BUFFER_SUPPORTED",function(){return fe.get("WEBGL_VERSION")===2}),fe.registerFlag("WEBGL_CPU_FORWARD",function(){return!0}),fe.registerFlag("WEBGL_FORCE_F16_TEXTURES",function(){return!1}),fe.registerFlag("WEBGL_PACK",function(){return fe.getBool("HAS_WEBGL")}),fe.registerFlag("WEBGL_PACK_NORMALIZATION",function(){return fe.getBool("WEBGL_PACK")}),fe.registerFlag("WEBGL_PACK_CLIP",function(){return fe.getBool("WEBGL_PACK")}),fe.registerFlag("WEBGL_PACK_DEPTHWISECONV",function(){return!1}),fe.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",function(){return fe.getBool("WEBGL_PACK")}),fe.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",function(){return fe.getBool("WEBGL_PACK")}),fe.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",function(){return fe.getBool("WEBGL_PACK")}),fe.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",function(){return fe.getBool("WEBGL_PACK")}),fe.registerFlag("WEBGL_PACK_REDUCE",function(){return fe.getBool("WEBGL_PACK")}),fe.registerFlag("WEBGL_LAZILY_UNPACK",function(){return fe.getBool("WEBGL_PACK")}),fe.registerFlag("WEBGL_CONV_IM2COL",function(){return fe.getBool("WEBGL_PACK")}),fe.registerFlag("WEBGL_MAX_TEXTURE_SIZE",function(){return zA(fe.getNumber("WEBGL_VERSION"))}),fe.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",function(){return UA(fe.getNumber("WEBGL_VERSION"))}),fe.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",function(){var e=fe.getNumber("WEBGL_VERSION");return e===0?0:$A(e)}),fe.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",function(){return fe.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&(e=navigator.userAgent||navigator.vendor||window.opera,!(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))));var e}),fe.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",function(){return VA(fe.getNumber("WEBGL_VERSION"))}),fe.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",function(){return!fe.getBool("WEBGL_FORCE_F16_TEXTURES")&&fe.getBool("WEBGL_RENDER_FLOAT32_CAPABLE")}),fe.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",function(){return HA(fe.getNumber("WEBGL_VERSION"))}),fe.registerFlag("WEBGL_FENCE_API_ENABLED",function(){return GA(fe.getNumber("WEBGL_VERSION"))}),fe.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",function(){return fe.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0}),zb=Vb;var Et=F({complex_:function(e,t){var n=N(e,"real","complex"),r=N(t,"imag","complex");return Ae(n.shape,r.shape,"real and imag shapes, "+n.shape+" and "+r.shape+", must match in call to tf.complex()."),L.runKernelFunc(function(o){return o.complex(n,r)},{$real:n,$imag:r})}}),An=F({real_:function(e){var t=N(e,"input","real");return L.runKernelFunc(function(n){return n.real(t)},{$input:t})}}),wr=F({imag_:function(e){var t=N(e,"input","imag");return L.runKernelFunc(function(n){return n.imag(t)},{$input:t})}});function St(e,t,n){return ti(e,t,ei(e,n),n)}function ti(e,t,n,r){if(r==null&&(r=yu(e)),r==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(!kr(e)&&!Array.isArray(e)&&typeof e!="number"&&typeof e!="boolean"&&typeof e!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(t!=null){jb(t);var o=ae(t),i=ae(n);I(o===i,function(){return"Based on the provided shape, ["+t+"], the tensor should have "+o+" values but has "+i});for(var a=0;a<n.length;++a){var s=n[a],u=a!==n.length-1||s!==ae(t.slice(a));I(n[a]===t[a]||!u,function(){return"Error creating a new Tensor. Inferred shape ("+n+") does not match the provided shape ("+t+"). "})}}return kr(e)||Array.isArray(e)||(e=[e]),t=t||n,e=r!=="string"?Lb(e,r,H().getBool("DEBUG")):Va(e,[],!0),L.makeTensor(e,t,r)}function ee(e,t){if((kr(e)&&t!=="string"||Array.isArray(e))&&t!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(t==="string"&&kr(e)&&!(e instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return ti(e,[],[],t)}function at(e,t){es(e);var n=ei(e,t);if(n.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");return ti(e,null,n,t)}function Wo(e,t,n){if(es(e),t!=null&&t.length!==2)throw new Error("tensor2d() requires shape to have two numbers");var r=ei(e,n);if(r.length!==2&&r.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return ti(e,t,r,n)}function Sv(e,t,n){if(es(e),t!=null&&t.length!==3)throw new Error("tensor3d() requires shape to have three numbers");var r=ei(e,n);if(r.length!==3&&r.length!==1)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return ti(e,t,r,n)}function Zt(e,t,n){if(es(e),t!=null&&t.length!==4)throw new Error("tensor4d() requires shape to have four numbers");var r=ei(e,n);if(r.length!==4&&r.length!==1)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return ti(e,t,r,n)}function YA(e,t,n){if(es(e),t!=null&&t.length!==5)throw new Error("tensor5d() requires shape to have five numbers");var r=ei(e,n);if(r.length!==5&&r.length!==1)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return ti(e,t,r,n)}function QA(e,t,n){if(es(e),t!=null&&t.length!==6)throw new Error("tensor6d() requires shape to have six numbers");var r=ei(e,n);if(r.length!==6&&r.length!==1)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return ti(e,t=t||r,r,n)}function JA(e,t,n,r){return t===void 0&&(t=!0),L.makeVariable(e,t,n,r)}function ts(e,t){if(t===void 0&&(t="float32"),t==="complex64"){var n=ts(e,"float32"),r=Ue(e,"float32");return Et(n,r)}var o=Bb(ae(e),t);return L.makeTensor(o,e,t)}function Ue(e,t){if(t===void 0&&(t="float32"),t==="complex64"){var n=Ue(e,"float32"),r=Ue(e,"float32");return Et(n,r)}var o=xu(ae(e),t);return L.makeTensor(o,e,t)}function Nr(e,t,n){return L.runKernelFunc(function(r){return r.fill(e,t,n)},{})}function ZA(e,t,n){if(n<=0)throw new Error("The number of values should be positive.");return L.runKernelFunc(function(r){return r.linspace(e,t,n)},{})}function gc(e,t,n,r){if(n===void 0&&(n=1),r===void 0&&(r="float32"),n===0)throw new Error("Cannot have a step of zero");if(e===t||e<t&&n<0||t<e&&n>1)return Ue([0],r);var o=xu(Math.abs(Math.ceil((t-e)/n)),r);t<e&&n===1&&(n=-1),o[0]=e;for(var i=1;i<o.length;i++)o[i]=o[i-1]+n;return at(o,r)}var Gb=F({onesLike_:function(e){var t=N(e,"x","onesLike");if(t.dtype==="complex64"){var n=Gb(An(t)),r=Re(wr(t));return Et(n,r)}return L.runKernelFunc(function(o){return o.onesLike(t)},{$x:t},function(o,i){return{$x:function(){return Re(o)}}})}}),Re=F({zerosLike_:function(e){var t=N(e,"x","zerosLike");return L.runKernelFunc(function(n){return n.zerosLike(t)},{$x:t},function(n,r){return{$x:function(){return Re(n)}}})}}),dt=F({concat_:function(e,t){t===void 0&&(t=0),I(e.length>=1,function(){return"Pass at least one tensor to concat"});var n=mc(e,"tensors","concat");n[0].dtype==="complex64"&&n.forEach(function(s){if(s.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype `+s.dtype+". ")}),t=vt(t,n[0].shape)[0];var r=Ga(n.map(function(s){return s.shape}),t);if(ae(r)===0)return St([],r);if((n=n.filter(function(s){return s.size>0})).length===1)return n[0];var o=n.map(function(s){return s.shape});XA(o,t);var i=n,a={axis:t};return L.runKernelFunc(function(s){return s.concat(n,t)},i,function(s){var u=o.map(function(l){return l[t]});return kv(s,u,t).map(function(l){return function(){return l}})},"Concat",a)}}),eP=F({concat1d_:function(e){return dt(e,0)}}),tP=F({concat2d_:function(e,t){return dt(e,t)}}),nP=F({concat3d_:function(e,t){return dt(e,t)}}),rP=F({concat4d_:function(e,t){return dt(e,t)}}),kv=F({split_:function(e,t,n){n===void 0&&(n=0);var r,o=N(e,"x","split");return n=vt(n,o.shape)[0],typeof t=="number"?(I(o.shape[n]%t==0,function(){return"Number of splits must evenly divide the axis."}),r=new Array(t).fill(o.shape[n]/t)):(I(o.shape[n]===t.reduce(function(i,a){return i+a}),function(){return"The sum of sizes must match the size of the axis dimension."}),r=t),L.runKernelFunc(function(i){return i.split(o,r,n)},{$x:o},function(i){return{$x:function(){return dt(i,n)}}})}});function Mi(e,t){return e(t={exports:{}},t.exports),t.exports}var oP=Mi(function(e){(function(t,n,r){function o(s){var u,l=this,c=(u=4022871197,function(d){d=d.toString();for(var f=0;f<d.length;f++){var h=.02519603282416938*(u+=d.charCodeAt(f));h-=u=h>>>0,u=(h*=u)>>>0,u+=4294967296*(h-=u)}return 23283064365386963e-26*(u>>>0)});l.next=function(){var d=2091639*l.s0+23283064365386963e-26*l.c;return l.s0=l.s1,l.s1=l.s2,l.s2=d-(l.c=0|d)},l.c=1,l.s0=c(" "),l.s1=c(" "),l.s2=c(" "),l.s0-=c(s),l.s0<0&&(l.s0+=1),l.s1-=c(s),l.s1<0&&(l.s1+=1),l.s2-=c(s),l.s2<0&&(l.s2+=1),c=null}function i(s,u){return u.c=s.c,u.s0=s.s0,u.s1=s.s1,u.s2=s.s2,u}function a(s,u){var l=new o(s),c=u&&u.state,d=l.next;return d.int32=function(){return 4294967296*l.next()|0},d.double=function(){return d()+11102230246251565e-32*(2097152*d()|0)},d.quick=d,c&&(typeof c=="object"&&i(c,l),d.state=function(){return i(l,{})}),d}n&&n.exports?n.exports=a:this.alea=a})(0,e)}),iP=Mi(function(e){(function(t,n,r){function o(s){var u=this,l="";u.x=0,u.y=0,u.z=0,u.w=0,u.next=function(){var d=u.x^u.x<<11;return u.x=u.y,u.y=u.z,u.z=u.w,u.w^=u.w>>>19^d^d>>>8},s===(0|s)?u.x=s:l+=s;for(var c=0;c<l.length+64;c++)u.x^=0|l.charCodeAt(c),u.next()}function i(s,u){return u.x=s.x,u.y=s.y,u.z=s.z,u.w=s.w,u}function a(s,u){var l=new o(s),c=u&&u.state,d=function(){return(l.next()>>>0)/4294967296};return d.double=function(){do var f=((l.next()>>>11)+(l.next()>>>0)/4294967296)/2097152;while(f===0);return f},d.int32=l.next,d.quick=d,c&&(typeof c=="object"&&i(c,l),d.state=function(){return i(l,{})}),d}n&&n.exports?n.exports=a:this.xor128=a})(0,e)}),aP=Mi(function(e){(function(t,n,r){function o(s){var u=this,l="";u.next=function(){var d=u.x^u.x>>>2;return u.x=u.y,u.y=u.z,u.z=u.w,u.w=u.v,(u.d=u.d+362437|0)+(u.v=u.v^u.v<<4^d^d<<1)|0},u.x=0,u.y=0,u.z=0,u.w=0,u.v=0,s===(0|s)?u.x=s:l+=s;for(var c=0;c<l.length+64;c++)u.x^=0|l.charCodeAt(c),c==l.length&&(u.d=u.x<<10^u.x>>>4),u.next()}function i(s,u){return u.x=s.x,u.y=s.y,u.z=s.z,u.w=s.w,u.v=s.v,u.d=s.d,u}function a(s,u){var l=new o(s),c=u&&u.state,d=function(){return(l.next()>>>0)/4294967296};return d.double=function(){do var f=((l.next()>>>11)+(l.next()>>>0)/4294967296)/2097152;while(f===0);return f},d.int32=l.next,d.quick=d,c&&(typeof c=="object"&&i(c,l),d.state=function(){return i(l,{})}),d}n&&n.exports?n.exports=a:this.xorwow=a})(0,e)}),sP=Mi(function(e){(function(t,n,r){function o(s){var u=this;u.next=function(){var l,c,d=u.x,f=u.i;return l=d[f],c=(l^=l>>>7)^l<<24,c^=(l=d[f+1&7])^l>>>10,c^=(l=d[f+3&7])^l>>>3,c^=(l=d[f+4&7])^l<<7,l=d[f+7&7],c^=(l^=l<<13)^l<<9,d[f]=c,u.i=f+1&7,c},function(l,c){var d,f=[];if(c===(0|c))f[0]=c;else for(c=""+c,d=0;d<c.length;++d)f[7&d]=f[7&d]<<15^c.charCodeAt(d)+f[d+1&7]<<13;for(;f.length<8;)f.push(0);for(d=0;d<8&&f[d]===0;++d);for(d==8?f[7]=-1:f[d],l.x=f,l.i=0,d=256;d>0;--d)l.next()}(u,s)}function i(s,u){return u.x=s.x.slice(),u.i=s.i,u}function a(s,u){s==null&&(s=+new Date);var l=new o(s),c=u&&u.state,d=function(){return(l.next()>>>0)/4294967296};return d.double=function(){do var f=((l.next()>>>11)+(l.next()>>>0)/4294967296)/2097152;while(f===0);return f},d.int32=l.next,d.quick=d,c&&(c.x&&i(c,l),d.state=function(){return i(l,{})}),d}n&&n.exports?n.exports=a:this.xorshift7=a})(0,e)}),uP=Mi(function(e){(function(t,n,r){function o(s){var u=this;u.next=function(){var l,c,d=u.w,f=u.X,h=u.i;return u.w=d=d+1640531527|0,c=f[h+34&127],l=f[h=h+1&127],c^=c<<13,l^=l<<17,c^=c>>>15,l^=l>>>12,c=f[h]=c^l,u.i=h,c+(d^d>>>16)|0},function(l,c){var d,f,h,v,m,g=[],p=128;for(c===(0|c)?(f=c,c=null):(c+="\0",f=0,p=Math.max(p,c.length)),h=0,v=-32;v<p;++v)c&&(f^=c.charCodeAt((v+32)%c.length)),v===0&&(m=f),f^=f<<10,f^=f>>>15,f^=f<<4,f^=f>>>13,v>=0&&(m=m+1640531527|0,h=(d=g[127&v]^=f+m)==0?h+1:0);for(h>=128&&(g[127&(c&&c.length||0)]=-1),h=127,v=512;v>0;--v)f=g[h+34&127],d=g[h=h+1&127],f^=f<<13,d^=d<<17,f^=f>>>15,d^=d>>>12,g[h]=f^d;l.w=m,l.X=g,l.i=h}(u,s)}function i(s,u){return u.i=s.i,u.w=s.w,u.X=s.X.slice(),u}function a(s,u){s==null&&(s=+new Date);var l=new o(s),c=u&&u.state,d=function(){return(l.next()>>>0)/4294967296};return d.double=function(){do var f=((l.next()>>>11)+(l.next()>>>0)/4294967296)/2097152;while(f===0);return f},d.int32=l.next,d.quick=d,c&&(c.X&&i(c,l),d.state=function(){return i(l,{})}),d}n&&n.exports?n.exports=a:this.xor4096=a})(0,e)}),lP=Mi(function(e){(function(t,n,r){function o(s){var u=this,l="";u.next=function(){var d=u.b,f=u.c,h=u.d,v=u.a;return d=d<<25^d>>>7^f,f=f-h|0,h=h<<24^h>>>8^v,v=v-d|0,u.b=d=d<<20^d>>>12^f,u.c=f=f-h|0,u.d=h<<16^f>>>16^v,u.a=v-d|0},u.a=0,u.b=0,u.c=-1640531527,u.d=1367130551,s===Math.floor(s)?(u.a=s/4294967296|0,u.b=0|s):l+=s;for(var c=0;c<l.length+20;c++)u.b^=0|l.charCodeAt(c),u.next()}function i(s,u){return u.a=s.a,u.b=s.b,u.c=s.c,u.d=s.d,u}function a(s,u){var l=new o(s),c=u&&u.state,d=function(){return(l.next()>>>0)/4294967296};return d.double=function(){do var f=((l.next()>>>11)+(l.next()>>>0)/4294967296)/2097152;while(f===0);return f},d.int32=l.next,d.quick=d,c&&(typeof c=="object"&&i(c,l),d.state=function(){return i(l,{})}),d}n&&n.exports?n.exports=a:this.tychei=a})(0,e)}),li=Mi(function(e){(function(t,n){var r,o=this,i=256,a=6,s="random",u=n.pow(i,a),l=n.pow(2,52),c=2*l,d=i-1;function f(p,y,x){var w=[],b=m(function S(R,k){var P,T=[],j=typeof R;if(k&&j=="object")for(P in R)try{T.push(S(R[P],k-1))}catch{}return T.length?T:j=="string"?R:R+"\0"}((y=y==1?{entropy:!0}:y||{}).entropy?[p,g(t)]:p??function(){try{var S;return r&&(S=r.randomBytes)?S=S(i):(S=new Uint8Array(i),(o.crypto||o.msCrypto).getRandomValues(S)),g(S)}catch{var R=o.navigator,k=R&&R.plugins;return[+new Date,o,k,o.screen,g(t)]}}(),3),w),C=new h(w),E=function(){for(var S=C.g(a),R=u,k=0;S<l;)S=(S+k)*i,R*=i,k=C.g(1);for(;S>=c;)S/=2,R/=2,k>>>=1;return(S+k)/R};return E.int32=function(){return 0|C.g(4)},E.quick=function(){return C.g(4)/4294967296},E.double=E,m(g(C.S),t),(y.pass||x||function(S,R,k,P){return P&&(P.S&&v(P,C),S.state=function(){return v(C,{})}),k?(n[s]=S,R):S})(E,b,"global"in y?y.global:this==n,y.state)}function h(p){var y,x=p.length,w=this,b=0,C=w.i=w.j=0,E=w.S=[];for(x||(p=[x++]);b<i;)E[b]=b++;for(b=0;b<i;b++)E[b]=E[C=d&C+p[b%x]+(y=E[b])],E[C]=y;(w.g=function(S){for(var R,k=0,P=w.i,T=w.j,j=w.S;S--;)R=j[P=d&P+1],k=k*i+j[d&(j[P]=j[T=d&T+R])+(j[T]=R)];return w.i=P,w.j=T,k})(i)}function v(p,y){return y.i=p.i,y.j=p.j,y.S=p.S.slice(),y}function m(p,y){for(var x,w=p+"",b=0;b<w.length;)y[d&b]=d&(x^=19*y[d&b])+w.charCodeAt(b++);return g(y)}function g(p){return String.fromCharCode.apply(0,p)}if(n["seed"+s]=f,m(n.random(),t),e.exports){e.exports=f;try{r=require("crypto")}catch{}}})([],Math)});li.alea=oP,li.xor128=iP,li.xorwow=aP,li.xorshift7=sP,li.xor4096=uP,li.tychei=lP;var ld=li.alea,Rv=function(){function e(t,n,r,o,i){this.mean=t,this.stdDev=n,this.dtype=r,this.nextVal=NaN,this.truncated=o,this.truncated&&(this.upper=this.mean+2*this.stdDev,this.lower=this.mean-2*this.stdDev);var a=i||Math.random();this.random=ld(a.toString())}return e.prototype.nextValue=function(){if(!isNaN(this.nextVal)){var t=this.nextVal;return this.nextVal=NaN,t}for(var n,r,o=!1;!o;){var i=void 0,a=void 0,s=void 0;do s=(i=2*this.random()-1)*i+(a=2*this.random()-1)*a;while(s>=1||s===0);var u=Math.sqrt(-2*Math.log(s)/s);n=this.mean+this.stdDev*i*u,r=this.mean+this.stdDev*a*u,this.truncated&&!this.isValidTruncated(n)||(o=!0)}return this.truncated&&!this.isValidTruncated(r)||(this.nextVal=this.convertValue(r)),this.convertValue(n)},e.prototype.convertValue=function(t){return this.dtype==null||this.dtype==="float32"?t:Math.round(t)},e.prototype.isValidTruncated=function(t){return t<=this.upper&&t>=this.lower},e}(),cP=function(){function e(t,n,r,o){this.alpha=t,this.beta=1/n,this.dtype=r;var i=o||Math.random();this.randu=ld(i.toString()),this.randn=new Rv(0,1,r,!1,this.randu()),this.d=t<1?t+2/3:t-1/3,this.c=1/Math.sqrt(9*this.d)}return e.prototype.nextValue=function(){for(var t,n,r,o,i,a;;){do o=this.randn.nextValue(),a=1+this.c*o;while(a<=0);if(a*=a*a,n=1-.331*(t=o*o)*t,r=.5*t+this.d*(1-a+Math.log(a)),(i=this.randu())<n||Math.log(i)<r)break}return a=1/this.beta*this.d*a,this.alpha<1&&(a*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(a)},e.prototype.convertValue=function(t){return this.dtype==="float32"?t:Math.round(t)},e}(),dP=function(){function e(t,n,r,o){var i=this;if(t===void 0&&(t=0),n===void 0&&(n=1),this.canReturnFloat=function(){return i.dtype==null||i.dtype==="float32"},this.min=t,this.range=n-t,this.dtype=r,o==null&&(o=Math.random()),typeof o=="number"&&(o=o.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error("The difference between "+t+" - "+n+" <= 1 and dtype is not float");this.random=ld(o)}return e.prototype.convertValue=function(t){return this.canReturnFloat()?t:Math.round(t)},e.prototype.nextValue=function(){return this.convertValue(this.min+this.range*this.random())},e}();function ve(e,t,n){return t===void 0&&(t="float32"),t=t||"float32",jb(e),new nu(e,t,n)}function fP(e,t){t===void 0&&(t=!1),console.log(e.toString(t))}var qb=F({batchToSpaceND_:function(e,t,n){var r=N(e,"x","batchToSpaceND"),o=t.reduce(function(i,a){return i*a});return I(r.rank>=1+t.length,function(){return"input rank is "+r.rank+" but should be > than blockShape.length "+t.length}),I(n.length===t.length,function(){return"crops.length is "+n.length+" but should be equal to blockShape.length  "+t.length}),I(r.shape[0]%o==0,function(){return"input tensor batch is "+r.shape[0]+" but is not divisible by the product of the elements of blockShape "+t.join(" * ")+" === "+o}),L.runKernelFunc(function(i){return i.batchToSpaceND(r,t,n)},{$x:r},function(i){return{$x:function(){return i.spaceToBatchND(t,n)}}})}}),hP=F({broadcastTo_:function(e,t){var n=N(e,"broadcastTo","x"),r=n.shape;if(t.some(function(u){return!(u>0)||u%1!=0}))throw new Error("broadcastTo(): Invalid broadcast shape ["+t+"].");if(t.length<n.rank)throw new Error("broadcastTo(): shape.length="+t.length+" < input.rank="+n.rank+".");if(t.length>n.rank){for(var o=n.shape.slice();o.length<t.length;)o.unshift(1);n=n.reshape(o)}for(var i=Array.from(t),a=t.length-1;a>=0;a--)if(n.shape[a]===t[a])i[a]=1;else if(n.shape[a]!==1)throw new Error("broadcastTo(): ["+r+"] cannot be broadcast to ["+t+"].");var s=i.map(function(u,l){return u>1?l:-1}).filter(function(u){return u>=0});return s.length===0?n.clone():L.runKernelFunc(function(u){return u.tile(n,i)},{input:n},function(u){return{input:function(){return u.sum(s,!0)}}})}}),pP=F({cast_:function(e,t){var n=N(e,"x","cast");if(!aA(t))throw new Error("Failed to cast to unknown dtype "+t);if(t==="string"&&n.dtype!=="string"||t!=="string"&&n.dtype==="string")throw new Error("Only strings can be casted to strings");var r={dtype:t};return L.runKernelFunc(function(o){return o.cast(n,t)},{x:n},function(o){return{x:function(){return o.clone()}}},"Cast",r)}}),vP=F({clone_:function(e){var t=N(e,"x","clone",null);return L.runKernelFunc(function(){return L.makeTensorFromDataId(t.dataId,t.shape,t.dtype)},{$x:t},function(n){return{$x:function(){return n.toFloat()}}})}}),mP=F({cumsum_:function(e,t,n,r){t===void 0&&(t=0),n===void 0&&(n=!1),r===void 0&&(r=!1);var o=N(e,"x","cumsum"),i=Dr([t|=0],o.rank),a=o;i!=null&&(a=o.transpose(i));var s=Fr(1,o.rank)[0],u=L.runKernelFunc(function(l){return l.cumsum(a,s,n,r)},{permutedX:a},function(l){return{permutedX:function(){return l.cumsum(t,n,!r)}}});return i!=null&&(u=u.transpose(i)),u}}),gP=F({depthToSpace_:function(e,t,n){n===void 0&&(n="NHWC");var r=N(e,"x","depthToSpace"),o=n==="NHWC"?r.shape[1]:r.shape[2],i=n==="NHWC"?r.shape[2]:r.shape[3],a=n==="NHWC"?r.shape[3]:r.shape[1];return I(o*t>=0,function(){return`Negative dimension size caused by overflow when multiplying
      `+o+" and "+t+`  for depthToSpace with input shape
      `+r.shape}),I(i*t>=0,function(){return`Negative dimension size caused by overflow when multiplying
      `+i+" and "+t+` for depthToSpace with input shape
          `+r.shape}),I(a%(t*t)==0,function(){return"Dimension size must be evenly divisible by "+t*t+" but is "+a+" for depthToSpace with input shape "+r.shape}),L.runKernelFunc(function(s){return s.depthToSpace(r,t,n)},{$x:r})}}),Tn=F({expandDims_:function(e,t){t===void 0&&(t=0);var n=N(e,"x","expandDims",null);I(t<=n.rank,function(){return"Axis must be <= rank of the tensor"});var r=n.shape.slice();return t<0&&(I(-(n.rank+1)<=t,function(){return"Axis must be in the interval ["+-(n.rank+1)+", "+n.rank+"]"}),t=n.rank+t+1),r.splice(t,0,1),Zn(n,r)}}),Kb=F({eye_:function(e,t,n,r){r===void 0&&(r="float32"),t==null&&(t=e);for(var o=ve([e,t],r),i=e<=t?e:t,a=0;a<i;++a)o.set(1,a,a);var s=o.toTensor().as2D(e,t);if(n==null)return s;if(n.length===1)return wa(Tn(s,0),[n[0],1,1]);if(n.length===2)return wa(Tn(Tn(s,0),0),[n[0],n[1],1,1]);if(n.length===3)return wa(Tn(Tn(Tn(s,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error("eye() currently supports only 1D and 2D batchShapes, but received "+n.length+"D.")}}),yP=F({multinomial_:function(e,t,n,r){r===void 0&&(r=!1);var o=N(e,"logits","multinomial"),i=o.size,a=o.rank;if(i<2)throw new Error("Error in multinomial: you need at least 2 outcomes, but got "+i+".");if(a>2)throw new Error("Rank of probabilities must be 1 or 2, but is "+a);n=n||Math.random();var s=a===1?o.as2D(1,-1):o,u=L.runKernelFunc(function(l){return l.multinomial(s,r,t,n)},{logits2D:s});return a===1?u.as1D():u}}),Qh=F({oneHot_:function(e,t,n,r){if(n===void 0&&(n=1),r===void 0&&(r=0),t<2)throw new Error("Error in oneHot: depth must be >=2, but it is "+t);var o=N(e,"indices","oneHot","int32"),i=o.shape.concat([t]);return o=o.flatten(),L.runKernelFunc(function(a){return a.oneHot(o,t,n,r)},{$indices:o},function(a){return{$indices:function(){return Ue(o.shape,"float32")}}}).reshape(i)}}),Oi=F({pad_:function(e,t,n){n===void 0&&(n=0);var r=N(e,"x","pad");if(r.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");var o={paddings:t,constantValue:n};return L.runKernelFunc(function(i){return i.pad(r,t,n)},{x:r},function(i){var a=t.map(function(s){return s[0]});return{x:function(){return i.slice(a,r.shape)}}},"PadV2",o)}}),xP=F({pad1d_:function(e,t,n){return n===void 0&&(n=0),I(t.length===2,function(){return"Invalid number of paddings. Must be length of 2."}),Oi(e,[t],n)}}),wP=F({pad2d_:function(e,t,n){return n===void 0&&(n=0),I(t.length===2&&t[0].length===2&&t[1].length===2,function(){return"Invalid number of paddings. Must be length of 2 each."}),Oi(e,t,n)}}),bP=F({pad3d_:function(e,t,n){return n===void 0&&(n=0),I(t.length===3&&t[0].length===2&&t[1].length===2&&t[2].length===2,function(){return"Invalid number of paddings. Must be length of 2 each."}),Oi(e,t,n)}}),CP=F({pad4d_:function(e,t,n){return n===void 0&&(n=0),I(t.length===4&&t[0].length===2&&t[1].length===2&&t[2].length===2&&t[3].length===2,function(){return"Invalid number of paddings. Must be length of 2 each."}),Oi(e,t,n)}}),EP=F({rand_:function(e,t,n){var r=ae(e),o=null;if(n==null||n==="float32")o=new Float32Array(r);else if(n==="int32")o=new Int32Array(r);else{if(n!=="bool")throw new Error("Unknown data type "+n);o=new Uint8Array(r)}for(var i=0;i<r;i++)o[i]=t();return L.makeTensor(o,e,n)}}),_P=F({randomNormal_:function(e,t,n,r,o){if(t===void 0&&(t=0),n===void 0&&(n=1),r!=null&&r==="bool")throw new Error("Unsupported data type "+r);for(var i=new Rv(t,n,r,!1,o),a=ve(e,r),s=0;s<a.values.length;s++)a.values[s]=i.nextValue();return a.toTensor()}}),SP=F({randomGamma_:function(e,t,n,r,o){if(n===void 0&&(n=1),r===void 0&&(r="float32"),n==null&&(n=1),r==null&&(r="float32"),r!=="float32"&&r!=="int32")throw new Error("Unsupported data type "+r);for(var i=new cP(t,n,r,o),a=ve(e,r),s=0;s<a.values.length;s++)a.values[s]=i.nextValue();return a.toTensor()}}),Xb=F({randomUniform_:function(e,t,n,r,o){t===void 0&&(t=0),n===void 0&&(n=1),r===void 0&&(r="float32");for(var i=ve(e,r),a=new dP(t,n,null,o),s=0;s<i.values.length;s++)i.values[s]=a.nextValue();return i.toTensor()}}),Zn=F({reshape_:function(e,t){var n=N(e,"x","reshape",null);t=oA(t,n.size),I(n.size===ae(t),function(){return"new shape and old shape must have the same number of elements."});var r={shape:t};return L.runKernelFunc(function(o){return o.reshape(n,t)},{x:n},function(o){return{x:function(){return o.reshape(n.shape)}}},"Reshape",r)}}),Yb=F({spaceToBatchND_:function(e,t,n){var r=N(e,"x","spaceToBatchND");return I(r.rank>=1+t.length,function(){return"input rank "+r.rank+" should be > than [blockShape] "+t.length}),I(n.length===t.length,function(){return"paddings.shape[0] "+n.length+" must be equal to [blockShape] "+t.length}),I(r.shape.reduce(function(o,i,a){return a>0&&a<=t.length?o&&(i+n[a-1][0]+n[a-1][1])%t[a-1]==0:o},!0),function(){return"input spatial dimensions "+r.shape.slice(1)+" with paddings "+n.toString()+" must be divisible by blockShapes "+t.toString()}),L.runKernelFunc(function(o){return o.spaceToBatchND(r,t,n)},{$x:r},function(o){return{$x:function(){return o.batchToSpaceND(t,n)}}})}}),Qb=F({squeeze_:function(e,t){var n=N(e,"x","squeeze");return Zn(n,ci(n.shape,t).newShape)}}),Cn=F({stack_:function(e,t){t===void 0&&(t=0);var n=mc(e,"tensors","stack");if(I(n.length>=1,function(){return"Pass at least one tensor to tf.stack"}),n.length===1)return n[0].expandDims(t);var r=n[0].rank,o=n[0].shape,i=n[0].dtype;I(t<=r,function(){return"Axis must be <= rank of the tensor"}),n.forEach(function(s){Ae(o,s.shape,"All tensors passed to stack must have matching shapes")}),n.forEach(function(s){I(i===s.dtype,function(){return"All tensors passed to stack must have matching dtypes"})});var a=n.map(function(s){return s.expandDims(t)});return dt(a,t)}}),wa=F({tile_:function(e,t){var n=N(e,"x","tile",null);I(n.rank===t.length,function(){return"Error in transpose: rank of input "+n.rank+" must match length of reps "+t+"."});var r=[n],o={reps:t};return L.runKernelFunc(function(i,a){var s=i.tile(n,t);return a([n]),s},{x:n},function(i,a){var s=a[0];return{x:function(){var u=Re(s);if(s.rank===1)for(var l=0;l<t[0];++l)u=u.add(i.slice([l*s.shape[0]],[s.shape[0]]));else if(s.rank===2)for(l=0;l<t[0];++l)for(var c=0;c<t[1];++c)u=u.add(i.slice([l*s.shape[0],c*s.shape[1]],[s.shape[0],s.shape[1]]));else if(s.rank===3)for(l=0;l<t[0];++l)for(c=0;c<t[1];++c)for(var d=0;d<t[2];++d)u=u.add(i.slice([l*s.shape[0],c*s.shape[1],d*s.shape[2]],[s.shape[0],s.shape[1],s.shape[2]]));else{if(s.rank!==4)throw new Error("Gradient for tile operation is not implemented for rank-"+s.rank+" tensors yet.");for(l=0;l<t[0];++l)for(c=0;c<t[1];++c)for(d=0;d<t[2];++d)for(var f=0;f<t[3];++f)u=u.add(i.slice([l*s.shape[0],c*s.shape[1],d*s.shape[2],f*s.shape[3]],[s.shape[0],s.shape[1],s.shape[2],s.shape[3]]))}return u}}},"Tile",o,r)}}),kP=F({truncatedNormal_:function(e,t,n,r,o){if(t===void 0&&(t=0),n===void 0&&(n=1),r!=null&&r==="bool")throw new Error("Unsupported data type "+r);for(var i=new Rv(t,n,r,!0,o),a=ve(e,r),s=0;s<a.values.length;s++)a.values[s]=i.nextValue();return a.toTensor()}}),ft=F({unstack_:function(e,t){t===void 0&&(t=0),t=t||0;var n=N(e,"x","unstack");I(t>=-n.shape.length&&t<n.shape.length,function(){return"Axis = "+t+" is not in [-"+n.shape.length+", "+n.shape.length+")"}),t<0&&(t+=n.shape.length);var r={axis:t};return L.runKernelFunc(function(o){return o.unstack(n,t)},{x:n},function(o){return{x:function(){return Cn(o,t)}}},"Unpack",r)}}),RP=function(e,t){return oe(this,void 0,void 0,function(){var n,r,o,i,a,s,u,l,c,d;return ie(this,function(f){switch(f.label){case 0:return n=N(e,"x","setdiff1d"),r=N(t,"y","setdiff1d"),I(n.dtype===r.dtype,function(){return"x and y should have the same dtype, but got x ("+n.dtype+") and y ("+r.dtype+")."}),I(n.rank===1,function(){return"x should be 1D tensor, but got x ("+n.shape+")."}),I(r.rank===1,function(){return"y should be 1D tensor, but got y ("+r.shape+")."}),[4,n.data()];case 1:return o=f.sent(),[4,r.data()];case 2:for(i=f.sent(),a=new Set(i),s=0,c=0;c<o.length;c++)a.has(o[c])||s++;for(u=new nu([s],n.dtype),l=new nu([s],"int32"),c=0,d=0;c<o.length;c++)a.has(o[c])||(u.values[d]=o[c],l.values[d]=c,d++);return[2,[u.toTensor(),l.toTensor()]]}})})};function yc(e,t,n,r){r===void 0&&(r=!0);var o=[];if(r)(o=o.concat(t.slice(0))).push(e[0]/n),o=o.concat(e.slice(1));else{o=o.concat(e[0]);for(var i=t.length,a=0;a<i;++a)o=o.concat([e[a+1]/t[a],t[a]]);o=o.concat(e.slice(i+1))}return o}function xc(e,t,n){n===void 0&&(n=!0);var r=[];if(n){r.push(t);for(var o=t+1;o<e;++o)o<=2*t?(r.push(o),r.push(o-(t+1))):r.push(o)}else{var i=[],a=[];for(o=1;o<e;++o)o>=2*t+1||o%2==1?a.push(o):i.push(o);r.push.apply(r,i),r.push(0),r.push.apply(r,a)}return r}function wc(e,t,n,r){r===void 0&&(r=!0);var o=[];r?o.push(e[0]/n):o.push(e[0]*n);for(var i=1;i<e.length;++i)i<=t.length?r?o.push(t[i-1]*e[i]):o.push(e[i]/t[i-1]):o.push(e[i]);return o}function Jb(e,t){for(var n=[0],r=0;r<t;++r)n.push(e[r][0]);return n}function Zb(e,t,n){for(var r=e.slice(0,1),o=0;o<n;++o)r.push(e[o+1]-t[o][0]-t[o][1]);return r}function e2(e,t){if(e.rank<1)throw new Error("tf.gatherND() expects the input to be rank 1 or higher, but the rank was "+e.rank+".");if(t.rank<1)throw new Error("tf.gatherND() expects the indices to be rank 1 or higher, but the rank was "+t.rank+".");if(t.dtype!=="int32")throw new Error("tf.gatherND() expects the indices to be int32 type, but the dtype was "+t.dtype+".");if(t.shape[t.rank-1]>e.rank)throw new Error("index innermost dimension length must be <= tensor rank; saw: "+t.shape[t.rank-1]+" vs. "+e.rank);if(e.size===0)throw new Error("Requested more than 0 entries, but input is empty. Input shape: "+e.shape+".");for(var n=t.shape,r=n[n.length-1],o=1,i=0;i<n.length-1;++i)o*=n[i];var a=e.shape,s=n.slice();s.pop();var u=1;for(i=r;i<e.rank;++i)u*=a[i],s.push(a[i]);var l=Rr(e.shape).map(function(c){return c/u}).concat([1]).slice(0,r);return[s,o,u,l]}var t2=30;function vf(e){return e<=t2?e:Hh(e,Math.floor(Math.sqrt(e)))}function NP(e,t,n){var r=t.rank>1?t.shape[t.rank-1]:1,o=t.rank>1?t.rank-1:1,i="Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: "+n.shape+", indices.shape: "+t.shape+", shape: "+e+", sliceDim: "+r+", and batchDim: "+o+".";if(n.rank<o)throw new Error(i+" update.rank < "+o+". ");if(e.length<r+(n.rank-o))throw new Error(i+" Output shape length < "+(r+(n.rank-o)));if(n.rank!==o+e.length-r)throw new Error(i+" update.rank != "+(o+e.length-r));for(var a=0;a<o;++a)if(n.shape[a]!==t.shape[a])throw new Error(i+" updates.shape["+a+"] ("+n.shape[a]+") != indices.shape["+a+"] ("+t.shape[a]+").");for(a=0;a<n.rank-o;++a)if(n.shape[a+o]!==e[a+r])throw new Error(i+" updates.shape["+(a+o)+"] ("+n.shape[a+o]+") != shape["+(a+o)+"] ("+e[a+o]+")")}function IP(e,t,n){if(t.rank<1)throw new Error("tf.scatterND() expects the indices to be rank 1 or higher, but the rank was "+t.rank+".");if(e.rank<1)throw new Error("tf.scatterND() expects the updates to be rank 1 or higher, but the rank was "+e.rank+".");if(t.dtype!=="int32")throw new Error("The dtype of 'indices' should be int32, but got dtype: "+t.dtype);if(n.length<1)throw new Error("Output rank must be greater or equal to 1, but got shape: "+n);if(n.length===0){if(t.size===0)throw new Error("Indices specified for empty output. indices shape: "+t.shape);if(e.size===0)throw new Error("Updates specified for empty output. updates shape: "+e.shape)}NP(n,t,e)}function bc(e,t,n){for(var r=t.shape.length,o=r>1?t.shape[r-1]:1,i=n.length,a=1,s=o;s<i;++s)a*=n[s];var u=o<1?1:o;return{sliceRank:o,numUpdates:ae(t.shape)/u,sliceSize:a,strides:Rr(n.slice(0,o)).concat([1]),outputSize:ae(n)}}function TP(e,t,n){I(e.rank===t.length,function(){return"Error in slice"+e.rank+"D: Length of begin "+t+" must match the rank of the array ("+e.rank+")."}),I(e.rank===n.length,function(){return"Error in slice"+e.rank+"D: Length of size "+n+" must match the rank of the array ("+e.rank+")."});for(var r=function(i){I(t[i]+n[i]<=e.shape[i],function(){return"Error in slice"+e.rank+"D: begin["+i+"] + size["+i+"] ("+(t[i]+n[i])+") would overflow input.shape["+i+"] ("+e.shape[i]+")"})},o=0;o<e.rank;++o)r(o)}function Dy(e){for(var t=[],n=0;e>0;)1&e&&t.push(n),e/=2,n++;return t}function Nv(e,t,n){for(var r=[],o=0;o<e.length;o++)r[o]=Math.ceil((t[o]-e[o])/n[o]);return r}function AP(e,t,n,r,o){var i=t[o],a=n[o]||1;(e&1<<o||i==null)&&(i=a>0?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER);var s=r[o];return i<0&&(i+=s),i=Uh(0,i,s-1)}function PP(e,t,n,r,o){var i=t[o],a=n[o]||1;(e&1<<o||i==null)&&(i=a>0?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER);var s=r[o];return i<0&&(i+=s),i=a>0?Uh(0,i,s):Uh(-1,i,s-1)}function n2(e,t,n){for(var r=n.length,o=0;o<n.length;o++)if(n[o]>1){r=o;break}for(o=r+1;o<n.length;o++)if(t[o]>0||n[o]!==e[o])return!1;return!0}function r2(e,t){for(var n=e.length>0?e[e.length-1]:1,r=0;r<e.length-1;r++)n+=e[r]*t[r];return n}function DP(e,t){I(Vh(e),function(){return"The f passed in variableGrads(f) must be a function"}),I(t==null||Array.isArray(t)&&t.every(function(c){return c instanceof Ha}),function(){return"The varList passed in variableGrads(f, varList) must be an array of variables"});var n=t!=null;if(!n)for(var r in t=[],L.registeredVariables)t.push(L.registeredVariables[r]);var o=n?t.filter(function(c){return!c.trainable}):null,i=t.length;I((t=t.filter(function(c){return c.trainable})).length>0,function(){return"variableGrads() expects at least one of the input variables to be trainable, but none of the "+i+" variables is trainable."});var a=L.gradients(e,t,null,!0),s=a.value,u=a.grads;I(u.some(function(c){return c!=null}),function(){return"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."}),I(s.rank===0,function(){return"The f passed in variableGrads(f) must return a scalar, but it returned a rank-"+s.rank+" tensor"});var l={};return t.forEach(function(c,d){u[d]!=null&&(l[c.name]=u[d])}),o!=null&&o.forEach(function(c){return l[c.name]=null}),{value:s,grads:l}}function cd(e){return L.customGrad(e)}var no=F({softmax_:function(e,t){t===void 0&&(t=-1);var n=N(e,"logits","softmax","float32");if(t===-1&&(t=n.rank-1),t!==n.rank-1)throw Error("Softmax along a non-last dimension is not yet supported. Logits was rank "+n.rank+" and dim was "+t);return L.runKernelFunc(function(r,o){var i=r.softmax(n,t);return o([i]),i},{logits:n},function(r,o){var i=o[0],a=r.mul(i);return{logits:function(){return a.sub(a.sum([t],!0).mul(i))}}},"Softmax",{dim:t},[],[!0])}}),FP=F({logSoftmax_:function(e,t){t===void 0&&(t=-1);var n=N(e,"logits","logSoftmax");if(t===-1&&(t=n.rank-1),t!==n.rank-1)throw Error("Log Softmax along a non-last dimension is not yet supported. Logits was rank "+n.rank+" and axis was "+t);return cd(function(r,o){var i=r.max(t,!0),a=r.sub(i),s=a.toFloat().sub(a.exp().sum(t,!0).log());return o([s]),{value:s,gradFunc:function(u,l){var c=l[0].exp();return u.sub(u.sum(t,!0).mul(c))}}})(n)}}),o2=function(){function e(t,n){this.backend=t,this.dataMover=n,this.data=new WeakMap,this.dataIdsCount=0}return e.prototype.get=function(t){return this.data.has(t)||this.dataMover.moveData(this.backend,t),this.data.get(t)},e.prototype.set=function(t,n){this.dataIdsCount++,this.data.set(t,n)},e.prototype.has=function(t){return this.data.has(t)},e.prototype.delete=function(t){return this.dataIdsCount--,this.data.delete(t)},e.prototype.numDataIds=function(){return this.dataIdsCount},e}(),i2=function(){function e(){}return e.prototype.time=function(t){return $("time")},e.prototype.read=function(t){return $("read")},e.prototype.readSync=function(t){return $("readSync")},e.prototype.numDataIds=function(){return $("numDataIds")},e.prototype.disposeData=function(t){return $("disposeData")},e.prototype.write=function(t,n,r){return $("write")},e.prototype.move=function(t,n,r,o){return $("move")},e.prototype.memory=function(){return $("memory")},e.prototype.floatPrecision=function(){return $("floatPrecision")},e.prototype.epsilon=function(){return this.floatPrecision()===32?1e-7:1e-4},e.prototype.batchMatMul=function(t,n,r,o){return $("batchMatMul")},e.prototype.fusedBatchMatMul=function(t){return t.a,t.b,t.transposeA,t.transposeB,t.bias,t.activation,t.preluActivationWeights,$("fusedBatchMatMul")},e.prototype.slice=function(t,n,r){return $("slice")},e.prototype.stridedSlice=function(t,n,r,o){return $("stridedSlice")},e.prototype.unstack=function(t,n){return $("unstack")},e.prototype.reverse=function(t,n){return $("reverse")},e.prototype.concat=function(t,n){return $("concat")},e.prototype.neg=function(t){return $("neg")},e.prototype.add=function(t,n){return $("add")},e.prototype.addN=function(t){return $("addN")},e.prototype.subtract=function(t,n){return $("subtract")},e.prototype.multiply=function(t,n){return $("multiply")},e.prototype.realDivide=function(t,n){return $("realDivide")},e.prototype.floorDiv=function(t,n){return $("floorDiv")},e.prototype.sum=function(t,n){return $("sum")},e.prototype.prod=function(t,n){return $("prod")},e.prototype.unsortedSegmentSum=function(t,n,r){return $("unsortedSegmentSum")},e.prototype.argMin=function(t,n){return $("argMin")},e.prototype.argMax=function(t,n){return $("argMax")},e.prototype.equal=function(t,n){return $("equal")},e.prototype.notEqual=function(t,n){return $("notEqual")},e.prototype.less=function(t,n){return $("less")},e.prototype.lessEqual=function(t,n){return $("lessEqual")},e.prototype.greater=function(t,n){return $("greater")},e.prototype.greaterEqual=function(t,n){return $("greaterEqual")},e.prototype.logicalNot=function(t){return $("logicalNot")},e.prototype.logicalAnd=function(t,n){return $("logicalAnd")},e.prototype.logicalOr=function(t,n){return $("logicalOr")},e.prototype.where=function(t){return $("where")},e.prototype.select=function(t,n,r){return $("select")},e.prototype.topk=function(t,n,r){return $("topk")},e.prototype.min=function(t,n){return $("min")},e.prototype.minimum=function(t,n){return $("minimum")},e.prototype.mod=function(t,n){return $("mod")},e.prototype.max=function(t,n){return $("max")},e.prototype.maximum=function(t,n){return $("maximum")},e.prototype.all=function(t,n){return $("all")},e.prototype.any=function(t,n){return $("any")},e.prototype.squaredDifference=function(t,n){return $("squaredDifference")},e.prototype.ceil=function(t){return $("ceil")},e.prototype.floor=function(t){return $("floor")},e.prototype.round=function(t){return $("round")},e.prototype.sign=function(t){return $("sign")},e.prototype.isNaN=function(t){return $("isNaN")},e.prototype.isInf=function(t){return $("isInf")},e.prototype.isFinite=function(t){return $("isFinite")},e.prototype.pow=function(t,n){return $("pow")},e.prototype.exp=function(t){return $("exp")},e.prototype.expm1=function(t){return $("expm1")},e.prototype.softmax=function(t,n){return $("softmax")},e.prototype.log=function(t){return $("log")},e.prototype.log1p=function(t){return $("log1p")},e.prototype.sqrt=function(t){return $("sqrt")},e.prototype.rsqrt=function(t){return $("rsqrt")},e.prototype.square=function(t){return $("square")},e.prototype.reciprocal=function(t){return $("reciprocal")},e.prototype.relu=function(t){return $("relu")},e.prototype.relu6=function(t){return $("relu6")},e.prototype.prelu=function(t,n){return $("prelu")},e.prototype.elu=function(t){return $("elu")},e.prototype.eluDer=function(t,n){return $("eluDer")},e.prototype.selu=function(t){return $("selu")},e.prototype.int=function(t){return $("int")},e.prototype.clip=function(t,n,r){return $("clip")},e.prototype.abs=function(t){return $("abs")},e.prototype.complexAbs=function(t){return $("complexAbs")},e.prototype.sigmoid=function(t){return $("sigmoid")},e.prototype.softplus=function(t){return $("softplus")},e.prototype.sin=function(t){return $("sin")},e.prototype.cos=function(t){return $("cos")},e.prototype.tan=function(t){return $("tan")},e.prototype.asin=function(t){return $("asin")},e.prototype.acos=function(t){return $("acos")},e.prototype.atan=function(t){return $("atan")},e.prototype.atan2=function(t,n){return $("atan2")},e.prototype.sinh=function(t){return $("sinh")},e.prototype.cosh=function(t){return $("cosh")},e.prototype.tanh=function(t){return $("tanh")},e.prototype.asinh=function(t){return $("asinh")},e.prototype.acosh=function(t){return $("acosh")},e.prototype.atanh=function(t){return $("atanh")},e.prototype.erf=function(t){return $("erf")},e.prototype.step=function(t,n){return $("step")},e.prototype.fusedConv2d=function(t){return t.input,t.filter,t.convInfo,t.bias,t.activation,t.preluActivationWeights,$("fusedConv2d")},e.prototype.conv2d=function(t,n,r){return $("conv2d")},e.prototype.conv2dDerInput=function(t,n,r){return $("conv2dDerInput")},e.prototype.conv2dDerFilter=function(t,n,r){return $("conv2dDerFilter")},e.prototype.fusedDepthwiseConv2D=function(t){return t.input,t.filter,t.convInfo,t.bias,t.activation,t.preluActivationWeights,$("fusedDepthwiseConv2D")},e.prototype.depthwiseConv2D=function(t,n,r){return $("depthwiseConv2D")},e.prototype.depthwiseConv2DDerInput=function(t,n,r){return $("depthwiseConv2DDerInput")},e.prototype.depthwiseConv2DDerFilter=function(t,n,r){return $("depthwiseConv2DDerFilter")},e.prototype.conv3d=function(t,n,r){return $("conv3d")},e.prototype.conv3dDerInput=function(t,n,r){return $("conv3dDerInput")},e.prototype.conv3dDerFilter=function(t,n,r){return $("conv3dDerFilter")},e.prototype.maxPool=function(t,n){return $("maxPool")},e.prototype.maxPoolBackprop=function(t,n,r,o){return $("maxPoolBackprop")},e.prototype.avgPool=function(t,n){return $("avgPool")},e.prototype.avgPoolBackprop=function(t,n,r){return $("avgPoolBackprop")},e.prototype.avgPool3d=function(t,n){return $("avgPool3d")},e.prototype.avgPool3dBackprop=function(t,n,r){return $("avgPool3dBackprop")},e.prototype.maxPool3d=function(t,n){return $("maxPool3d")},e.prototype.maxPool3dBackprop=function(t,n,r,o){return $("maxPool3dBackprop")},e.prototype.reshape=function(t,n){return $("reshape")},e.prototype.cast=function(t,n){return $("cast")},e.prototype.tile=function(t,n){return $("tile")},e.prototype.pad=function(t,n,r){return $("pad")},e.prototype.transpose=function(t,n){return $("transpose")},e.prototype.gather=function(t,n,r){return $("gather")},e.prototype.gatherND=function(t,n){return $("gatherND")},e.prototype.scatterND=function(t,n,r){return $("scatterND")},e.prototype.batchToSpaceND=function(t,n,r){return $("batchToSpaceND")},e.prototype.spaceToBatchND=function(t,n,r){return $("spaceToBatchND")},e.prototype.resizeBilinear=function(t,n,r,o){return $("resizeBilinear")},e.prototype.resizeBilinearBackprop=function(t,n,r){return $("resizeBilinearBackprop")},e.prototype.resizeNearestNeighbor=function(t,n,r,o){return $("resizeNearestNeighbor")},e.prototype.resizeNearestNeighborBackprop=function(t,n,r){return $("resizeNearestNeighborBackprop")},e.prototype.batchNormalization=function(t,n,r,o,i,a){return $("batchNormalization")},e.prototype.localResponseNormalization4D=function(t,n,r,o,i){return $("localResponseNormalization4D")},e.prototype.LRNGrad=function(t,n,r,o,i,a,s){return $("LRNGrad")},e.prototype.multinomial=function(t,n,r,o){return $("multinomial")},e.prototype.oneHot=function(t,n,r,o){return $("oneHot")},e.prototype.cumsum=function(t,n,r,o){return $("cumsum")},e.prototype.nonMaxSuppression=function(t,n,r,o,i){return $("nonMaxSuppression")},e.prototype.fft=function(t){return $("fft")},e.prototype.ifft=function(t){return $("ifft")},e.prototype.complex=function(t,n){return $("complex")},e.prototype.real=function(t){return $("real")},e.prototype.imag=function(t){return $("imag")},e.prototype.cropAndResize=function(t,n,r,o,i,a){return $("cropAndResize")},e.prototype.depthToSpace=function(t,n,r){return $("depthToSpace")},e.prototype.split=function(t,n,r){return $("split")},e.prototype.sparseToDense=function(t,n,r,o){return $("sparseToDense")},e.prototype.diag=function(t){return $("diag")},e.prototype.fill=function(t,n,r){return $("fill")},e.prototype.onesLike=function(t){return $("onesLike")},e.prototype.zerosLike=function(t){return $("zerosLike")},e.prototype.linspace=function(t,n,r){return $("linspace")},e.prototype.dispose=function(){return $("dispose")},e}();function $(e){throw new Error("'"+e+"' not yet implemented or not found in the registry. Did you forget to import the kernel?")}function To(e,t){for(var n=e.length,r=[],o=0;o<n;o++){var i=n-1-o,a=e[i]||1;(t[t.length-1-o]||1)>1&&a===1&&r.unshift(i)}return r}function ht(e,t){for(var n=[],r=0;r<t.length;r++){var o=e[e.length-r-1],i=t.length-r-1,a=t[i];(o==null||o===1&&a>1)&&n.unshift(i)}return n}function _e(e,t){for(var n=[],r=Math.max(e.length,t.length),o=0;o<r;o++){var i=e[e.length-o-1];i==null&&(i=1);var a=t[t.length-o-1];if(a==null&&(a=1),i===1)n.unshift(a);else if(a===1)n.unshift(i);else{if(i!==a)throw Error("Operands could not be broadcast together with shapes "+e+" and "+t+".");n.unshift(i)}}return n}function ou(e,t,n,r,o,i,a){a===void 0&&(a="channelsLast");var s,u=_c(t),l=u[0],c=u[1];if(a==="channelsLast")s=[l,c,e[3],e[3]];else{if(a!=="channelsFirst")throw new Error("Unknown dataFormat "+a);s=[l,c,e[1],e[1]]}return Li(e,s,n,r,o,i,!1,a)}function Cc(e,t,n,r,o,i,a){a===void 0&&(a="NDHWC");var s,u,l=Jh(t),c=l[0],d=l[1],f=l[2];if(a==="NDHWC")u="channelsLast",s=[c,d,f,e[4],e[4]];else{if(a!=="NCDHW")throw new Error("Unknown dataFormat "+a);u="channelsFirst",s=[c,d,f,e[1],e[1]]}return Ec(e,s,n,r,o,!1,u,i)}function Li(e,t,n,r,o,i,a,s){a===void 0&&(a=!1),s===void 0&&(s="channelsLast");var u=[-1,-1,-1,-1],l=u[0],c=u[1],d=u[2],f=u[3];if(s==="channelsLast")l=e[0],c=e[1],d=e[2],f=e[3];else{if(s!=="channelsFirst")throw new Error("Unknown dataFormat "+s);l=e[0],f=e[1],c=e[2],d=e[3]}var h,v=t[0],m=t[1],g=t[3],p=_c(n),y=p[0],x=p[1],w=_c(r),b=w[0],C=w[1],E=ba(v,b),S=ba(m,C),R=function(O,W,U,z,D,M,B,q){var K,Q,Z;if(typeof O=="number"){K={top:O,bottom:O,left:O,right:O,type:O===0?"VALID":"NUMBER"};var se=function(pe,ke,Ce,Oe,Le){Oe==null&&(Oe=a2(pe,ke,Ce));var Fe=pe[0],Yt=pe[1],Nt=Ps((Fe-ke+2*Oe)/Ce+1,Le);I(rt(Nt),function(){return"The output # of rows ("+Nt+") must be an integer. Change the stride and/or zero pad parameters"});var ot=Ps((Yt-ke+2*Oe)/Ce+1,Le);return I(rt(ot),function(){return"The output # of columns ("+ot+") must be an integer. Change the stride and/or zero pad parameters"}),[Nt,ot]}([W,U],M,z,O,q);Q=se[0],Z=se[1]}else if(O==="same"){Q=Math.ceil(W/z),Z=Math.ceil(U/D);var de=Math.max(0,(Q-1)*z+M-W),re=Math.max(0,(Z-1)*D+B-U),xe=Math.floor(de/2),me=de-xe,Pe=Math.floor(re/2);K={top:xe,bottom:me,left:Pe,right:re-Pe,type:"SAME"}}else{if(O!=="valid")throw Error("Unknown padding parameter: "+O);K={top:0,bottom:0,left:0,right:0,type:"VALID"},Q=Math.ceil((W-M+1)/z),Z=Math.ceil((U-B+1)/D)}return{padInfo:K,outHeight:Q,outWidth:Z}}(o,c,d,y,x,E,S,i),k=R.padInfo,P=R.outHeight,T=R.outWidth,j=a?g*f:g;return s==="channelsFirst"?h=[l,j,P,T]:s==="channelsLast"&&(h=[l,P,T,j]),{batchSize:l,dataFormat:s,inHeight:c,inWidth:d,inChannels:f,outHeight:P,outWidth:T,outChannels:j,padInfo:k,strideHeight:y,strideWidth:x,filterHeight:v,filterWidth:m,effectiveFilterHeight:E,effectiveFilterWidth:S,dilationHeight:b,dilationWidth:C,inShape:e,outShape:h,filterShape:t}}function Ec(e,t,n,r,o,i,a,s){i===void 0&&(i=!1),a===void 0&&(a="channelsLast");var u=[-1,-1,-1,-1,-1],l=u[0],c=u[1],d=u[2],f=u[3],h=u[4];if(a==="channelsLast")l=e[0],c=e[1],d=e[2],f=e[3],h=e[4];else{if(a!=="channelsFirst")throw new Error("Unknown dataFormat "+a);l=e[0],h=e[1],c=e[2],d=e[3],f=e[4]}var v,m=t[0],g=t[1],p=t[2],y=t[4],x=Jh(n),w=x[0],b=x[1],C=x[2],E=Jh(r),S=E[0],R=E[1],k=E[2],P=ba(m,S),T=ba(g,R),j=ba(p,k),O=function(B,q,K,Q,Z,se,de,re,xe,me,Pe){var pe,ke,Ce,Oe;if(typeof B=="number"){pe={top:B,bottom:B,left:B,right:B,front:B,back:B,type:B===0?"VALID":"NUMBER"};var Le=function(so,Wn,It,dn,kn,ns){kn==null&&(kn=a2(so,Wn,dn));var Wi=so[0],Ed=so[1],Nu=so[2],ri=Ps((Wi-Wn+2*kn)/dn+1,ns);I(rt(ri),function(){return"The output # of depths ("+ri+") must be an integer. Change the stride and/or zero pad parameters"});var lr=Ps((Ed-Wn+2*kn)/dn+1,ns);I(rt(lr),function(){return"The output # of rows ("+lr+") must be an integer. Change the stride and/or zero pad parameters"});var zi=Ps((Nu-Wn+2*kn)/dn+1,ns);return I(rt(zi),function(){return"The output # of columns ("+zi+") must be an integer. Change the stride and/or zero pad parameters"}),[ri,lr,zi,It]}([q,K,Q,1],re,1,Z,B,Pe);ke=Le[0],Ce=Le[1],Oe=Le[2]}else if(B==="same"){ke=Math.ceil(q/Z),Ce=Math.ceil(K/se),Oe=Math.ceil(Q/de);var Fe=(ke-1)*Z+re-q,Yt=(Ce-1)*se+xe-K,Nt=(Oe-1)*de+me-Q,ot=Math.floor(Fe/2),Or=Fe-ot,Ut=Math.floor(Yt/2),jn=Yt-Ut,bt=Math.floor(Nt/2);pe={top:Ut,bottom:jn,left:bt,right:Nt-bt,front:ot,back:Or,type:"SAME"}}else{if(B!=="valid")throw Error("Unknown padding parameter: "+B);pe={top:0,bottom:0,left:0,right:0,front:0,back:0,type:"VALID"},ke=Math.ceil((q-re+1)/Z),Ce=Math.ceil((K-xe+1)/se),Oe=Math.ceil((Q-me+1)/de)}return{padInfo:pe,outDepth:ke,outHeight:Ce,outWidth:Oe}}(o,c,d,f,w,b,C,P,T,j,s),W=O.padInfo,U=O.outDepth,z=O.outHeight,D=O.outWidth,M=i?y*h:y;return a==="channelsFirst"?v=[l,M,U,z,D]:a==="channelsLast"&&(v=[l,U,z,D,M]),{batchSize:l,dataFormat:a,inDepth:c,inHeight:d,inWidth:f,inChannels:h,outDepth:U,outHeight:z,outWidth:D,outChannels:M,padInfo:W,strideDepth:w,strideHeight:b,strideWidth:C,filterDepth:m,filterHeight:g,filterWidth:p,effectiveFilterDepth:P,effectiveFilterHeight:T,effectiveFilterWidth:j,dilationDepth:S,dilationHeight:R,dilationWidth:k,inShape:e,outShape:v,filterShape:t}}function a2(e,t,n,r){r===void 0&&(r=1);var o=ba(t,r);return Math.floor((e[0]*(n-1)-n+o)/2)}function _c(e){return typeof e=="number"?[e,e,e]:e.length===2?[e[0],e[1],1]:e}function Jh(e){return typeof e=="number"?[e,e,e]:e}function ba(e,t){return t<=1?e:e+(e-1)*(t-1)}function Ps(e,t){if(!t)return e;switch(t){case"round":return Math.round(e);case"ceil":return Math.ceil(e);case"floor":return Math.floor(e);default:throw new Error("Unknown roundingMode "+t)}}function qa(e){var t=_c(e),n=t[0],r=t[1],o=t[2];return n===1&&r===1&&o===1}function ln(e,t){return qa(e)||qa(t)}function Iv(e){if(e==="NHWC")return"channelsLast";if(e==="NCHW")return"channelsFirst";throw new Error("Unknown dataFormat "+e)}function s2(e,t,n){if(t==="complex64"){if(e.dtype==="complex64")return e.clone();var r=Ue(e.shape),o=e.toFloat(),i=n.complex(o,r);return r.dispose(),o.dispose(),i}if(!sA(e.dtype,t))return L.makeTensorFromDataId(e.dataId,e.shape,t);if(e.dtype==="complex64"){var a=n.real(e);return i=a.cast(t),a.dispose(),i}if(t==="int32")return n.int(e);if(t==="bool"){var s=ee(0,e.dtype);return i=n.notEqual(e,s),s.dispose(),i}throw new Error("Error in Cast: failed to cast "+e.dtype+" to "+t)}function Zh(e,t){return L.makeTensorFromDataId(e.dataId,t,e.dtype)}function u2(e,t,n){var r=(t-e)/(n-1),o=xu(n,"float32");o[0]=e;for(var i=1;i<o.length;i++)o[i]=o[i-1]+r;return at(o,"float32")}function ep(e,t){if(e.length!==t.length)throw new Error("Cannot merge real and imag arrays of different lengths. real:"+e.length+", imag: "+t.length+".");for(var n=new Float32Array(2*e.length),r=0;r<n.length;r+=2)n[r]=e[r/2],n[r+1]=t[r/2];return n}function Fy(e,t){return{real:e[2*t],imag:e[2*t+1]}}function MP(e,t,n,r){e[2*r]=t,e[2*r+1]=n}function OP(e,t,n){var r=(n?2:-2)*Math.PI*(e/t);return{real:Math.cos(r),imag:Math.sin(r)}}function LP(e,t,n){var r=function(i,a,s){return function(u,l,c){for(var d=0,f=u.length,h=0,v=!1;d<f;){var m=c(l,u[h=d+(f-d>>>1)]);m>0?d=h+1:(f=h,v=!m)}return v?d:-d-1}(i,a,s||BP)}(e,t,n),o=r<0?-(r+1):r;e.splice(o,0,t)}function BP(e,t){return e>t?1:e<t?-1:0}function Tv(e,t,n,r,o){return l2(e,t,n,r,o,0).selectedIndices}function Av(e,t,n,r,o,i){var a=l2(e,t,n,r,o,i);return a.numValidOutputs.dispose(),{selectedIndices:a.selectedIndices,selectedScores:a.selectedScores}}function l2(e,t,n,r,o,i,a,s){s===void 0&&(s=!1);for(var u=Array.from(t).map(function(w,b){return{score:w,boxIndex:b,suppressBeginIndex:0}}).filter(function(w){return w.score>o}).sort(My),l=i>0?-.5/i:0,c=[],d=[];c.length<n&&u.length>0;){var f=u.pop(),h=f.score,v=f.boxIndex,m=f.suppressBeginIndex;if(h<o)break;for(var g=!1,p=c.length-1;p>=m;--p){var y=jP(e,v,c[p]);if(y>=r){g=!0;break}if(f.score=f.score*WP(r,l,y),f.score<=o)break}f.suppressBeginIndex=c.length,g||(f.score===h?(c.push(v),d.push(f.score)):f.score>o&&LP(u,f,My))}var x=c.length;return s&&(c.fill(0,x),d.fill(0,x)),{selectedIndices:at(c,"int32"),selectedScores:at(d,"float32"),numValidOutputs:ee(x,"int32")}}function jP(e,t,n){var r=e.subarray(4*t,4*t+4),o=e.subarray(4*n,4*n+4),i=Math.min(r[0],r[2]),a=Math.min(r[1],r[3]),s=Math.max(r[0],r[2]),u=Math.max(r[1],r[3]),l=Math.min(o[0],o[2]),c=Math.min(o[1],o[3]),d=Math.max(o[0],o[2]),f=Math.max(o[1],o[3]),h=(s-i)*(u-a),v=(d-l)*(f-c);if(h<=0||v<=0)return 0;var m=Math.max(i,l),g=Math.max(a,c),p=Math.min(s,d),y=Math.min(u,f),x=Math.max(p-m,0)*Math.max(y-g,0);return x/(h+v-x)}function WP(e,t,n){var r=Math.exp(t*n*n);return n<=e?r:0}function My(e,t){return e.score-t.score||e.score===t.score&&t.boxIndex-e.boxIndex}function c2(e,t,n){var r=new Array(e.rank).fill(0),o=e.shape.slice();return t.map(function(i){o[n]=i;var a=e.slice(r,o);return r[n]+=i,a})}function d2(e,t){for(var n=new Array(e.rank),r=0;r<n.length;r++)n[r]=e.shape[r]*t[r];var o=ve(n,e.dtype);for(r=0;r<o.values.length;++r){for(var i=o.indexToLoc(r),a=new Array(e.rank),s=0;s<a.length;s++)a[s]=i[s]%e.shape[s];var u=e.locToIndex(a);o.values[r]=e.values[u]}return o.toTensor()}function f2(e,t,n,r,o){for(var i=t[t.length-1],a=[e.length/i,i],s=a[0],u=a[1],l=tu(n,s*r),c=tu("int32",s*r),d=0;d<s;d++){for(var f=d*u,h=e.subarray(f,f+u),v=[],m=0;m<h.length;m++)v.push({value:h[m],index:m});v.sort(function(w,b){return b.value-w.value});var g=d*r,p=l.subarray(g,g+r),y=c.subarray(g,g+r);for(m=0;m<r;m++)p[m]=v[m].value,y[m]=v[m].index}var x=t.slice();return x[x.length-1]=r,[St(l,x,n),St(c,x,"int32")]}function Pv(e,t){for(var n=[],r=0;r<t.length;r++)t[r]&&n.push(r);var o=ve(e,"int32"),i=ve([n.length,e.length],"int32");for(r=0;r<n.length;r++){var a=o.indexToLoc(n[r]),s=r*e.length;i.values.set(a,s)}return i.toTensor()}var zP=function(e,t){this.outputShape=[],this.outputShape=e,this.variableNames=t.map(function(o,i){return"T"+i});var n=[];this.variableNames.forEach(function(o){n.push("float v"+o+" = get"+o+"AtOutCoords();")});var r=this.variableNames.map(function(o){return"v"+o}).join(" + ");this.userCode=`
      void main() {
        `+n.join(`
        `)+`

        float result = `+r+`;
        setOutput(result);
      }
    `},UP=function(e,t){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.variableNames=t.map(function(o,i){return"T"+i});var n=[];this.variableNames.forEach(function(o){n.push("vec4 v"+o+" = get"+o+"AtOutCoords();")});var r=this.variableNames.map(function(o){return"v"+o}).join(" + ");this.userCode=`
      void main() {
        `+n.join(`
        `)+`

        vec4 result = `+r+`;
        setOutput(result);
      }
    `},$P=function(e,t,n){this.variableNames=["A"];var r=e.windowSize,o=e.batchSize,i=e.inSize,a=Math.ceil(i/r);n||this.variableNames.push("bestIndicesA"),this.outputShape=[o,a];var s=t==="max"?">":"<",u=n?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * `+r+`;

        int bestIndex = inOffset;
        float bestValue = getA(batch, bestIndex);

        for (int i = 0; i < `+r+`; i++) {
          int inIdx = `+u+`;
          float candidate = getA(batch, inIdx);
          if (candidate `+s+` bestValue) {
            bestValue = candidate;
            bestIndex = inIdx;
          }
        }
        setOutput(float(bestIndex));
      }
    `};function h2(e,t){return["x","y","z","w","u","v"].slice(0,t).map(function(n){return e+"."+n})}function en(e,t){return t===1?[e]:h2(e,t)}function Lt(){var e,t,n,r,o,i,a,s,u,l;return H().getNumber("WEBGL_VERSION")===2?(e="#version 300 es",t="in",n="out",r="in",o="texture",i="outputColor",a="out vec4 outputColor;",s=`
      bool isnan_custom(float val) {
        return (val > 0.0 || val < 0.0) ? false : val != 0.0;
      }

      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan_custom(val.x),
          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));
      }

      #define isnan(value) isnan_custom(value)
    `,u="",l=`
      #define round(value) newRound(value)
      int newRound(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 newRound(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `):(e="",t="attribute",n="varying",r="varying",o="texture2D",i="gl_FragColor",a="",s=`
      #define isnan(value) isnan_custom(value)
      bool isnan_custom(float val) {
        return (val > 0. || val < 1. || val == 0.) ? false : true;
      }
      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));
      }
    `,u=`
      uniform float INFINITY;

      bool isinf(float val) {
        return abs(val) == INFINITY;
      }
      bvec4 isinf(vec4 val) {
        return equal(abs(val), vec4(INFINITY));
      }
    `,l=`
      int round(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 round(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `),{version:e,attribute:t,varyingVs:n,varyingFs:r,texture2D:o,output:i,defineOutput:a,defineSpecialNaN:s,defineSpecialInf:u,defineRound:l}}function pi(e,t,n){n===void 0&&(n="index");var r=Rr(t);return r.map(function(o,i){return"int "+e[i]+" = "+n+" / "+o+"; "+(i===r.length-1?"int "+e[i+1]+" = "+n+" - "+e[i]+" * "+o:"index -= "+e[i]+" * "+o)+";"}).join("")}function Dv(e){var t=Rr(e).map(function(n){return n.toString()});return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * `+t[0]+" + coords.y * "+t[1]+` + coords.z;
  }
`}var p2=`
  const float FLOAT_MAX = 1.70141184e38;
  const float FLOAT_MIN = 1.17549435e-38;

  lowp vec4 encode_float(highp float v) {
    if (isnan(v)) {
      return vec4(255, 255, 255, 255);
    }

    highp float av = abs(v);

    if(av < FLOAT_MIN) {
      return vec4(0.0, 0.0, 0.0, 0.0);
    } else if(v > FLOAT_MAX) {
      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
    } else if(v < -FLOAT_MAX) {
      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
    }

    highp vec4 c = vec4(0,0,0,0);

    highp float e = floor(log2(av));
    highp float m = exp2(fract(log2(av))) - 1.0;

    c[2] = floor(128.0 * m);
    m -= c[2] / 128.0;
    c[1] = floor(32768.0 * m);
    m -= c[1] / 32768.0;
    c[0] = floor(8388608.0 * m);

    highp float ebias = e + 127.0;
    c[3] = floor(ebias / 2.0);
    ebias -= c[3] * 2.0;
    c[2] += floor(ebias) * 128.0;

    c[3] += 128.0 * step(0.0, -v);

    return c / 255.0;
  }
`;function VP(e,t,n,r){var o=[];e.forEach(function(h){var v=ae(h.shapeInfo.logicalShape);h.shapeInfo.isUniform?o.push("uniform float "+h.name+(v>1?"["+v+"]":"")+";"):(o.push("uniform sampler2D "+h.name+";"),o.push("uniform int offset"+h.name+";"))});var i,a,s=o.join(`
`),u=e.map(function(h){return function(v,m,g){g===void 0&&(g=!1);var p="";p+=g?v2(v):Ki(v);var y=v.shapeInfo.logicalShape,x=m.logicalShape;return y.length<=x.length&&(p+=g?function(w,b){var C,E=w.name,S=E.charAt(0).toUpperCase()+E.slice(1),R="get"+S+"AtOutCoords",k=w.shapeInfo.logicalShape.length,P=b.logicalShape.length,T=To(w.shapeInfo.logicalShape,b.logicalShape),j=je(P),O=P-k,W=["x","y","z","w","u","v"];C=k===0?"":P<2&&T.length>=1?"coords = 0;":T.map(function(K){return"coords."+W[K+O]+" = 0;"}).join(`
`);var U="";U=P<2&&k>0?"coords":w.shapeInfo.logicalShape.map(function(K,Q){return"coords."+W[Q+O]}).join(", ");var z="return outputValue;",D=ae(w.shapeInfo.logicalShape)===1,M=ae(b.logicalShape)===1;if(k!==1||D||M){if(D&&!M)z=P===1?`
        return vec4(outputValue.x, outputValue.x, 0., 0.);
      `:`
        return vec4(outputValue.x);
      `;else if(T.length){var B=k-2,q=k-1;T.indexOf(B)>-1&&T.indexOf(q)>-1?z="return vec4(outputValue.x);":T.indexOf(B)>-1?z="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":T.indexOf(q)>-1&&(z="return vec4(outputValue.xx, outputValue.zz);")}}else z=`
      return vec4(outputValue.xy, outputValue.xy);
    `;return`
    vec4 `+R+`() {
      `+j+` coords = getOutputCoords();
      `+C+`
      vec4 outputValue = get`+S+"("+U+`);
      `+z+`
    }
  `}(v,m):function(w,b){var C=w.name,E=C.charAt(0).toUpperCase()+C.slice(1),S="get"+E+"AtOutCoords",R=b.texShape,k=w.shapeInfo.texShape,P=w.shapeInfo.logicalShape.length,T=b.logicalShape.length;if(!w.shapeInfo.isUniform&&P===T&&w.shapeInfo.flatOffset==null&&xt(k,R))return`
      float `+S+`() {
        return sampleTexture(`+C+`, resultUV);
      }
    `;var j,O=je(T),W=To(w.shapeInfo.logicalShape,b.logicalShape),U=T-P,z=["x","y","z","w","u","v"];j=P===0?"":T<2&&W.length>=1?"coords = 0;":W.map(function(M){return"coords."+z[M+U]+" = 0;"}).join(`
`);var D="";return D=T<2&&P>0?"coords":w.shapeInfo.logicalShape.map(function(M,B){return"coords."+z[B+U]}).join(", "),`
    float `+S+`() {
      `+O+` coords = getOutputCoords();
      `+j+`
      return get`+E+"("+D+`);
    }
  `}(v,m)),p}(h,t,r)}).join(`
`),l=t.texShape,c=Lt(),d=function(h){return`
    float sampleTexture(sampler2D textureSampler, vec2 uv) {
      return `+h.texture2D+`(textureSampler, uv).r;
    }
  `}(c),f=function(h){return h.version+`
    precision highp float;
    precision highp int;
    precision highp sampler2D;
    `+h.varyingFs+` vec2 resultUV;
    `+h.defineOutput+`
    const vec2 halfCR = vec2(0.5, 0.5);

    struct ivec5
    {
      int x;
      int y;
      int z;
      int w;
      int u;
    };

    struct ivec6
    {
      int x;
      int y;
      int z;
      int w;
      int u;
      int v;
    };

    uniform float NAN;
    `+h.defineSpecialNaN+`
    `+h.defineSpecialInf+`
    `+h.defineRound+`

    int imod(int x, int y) {
      return x - y * (x / y);
    }

    int idiv(int a, int b, float sign) {
      int res = a / b;
      int mod = imod(a, b);
      if (sign < 0. && mod != 0) {
        res -= 1;
      }
      return res;
    }

    //Based on the work of Dave Hoskins
    //https://www.shadertoy.com/view/4djSRW
    #define HASHSCALE1 443.8975
    float random(float seed){
      vec2 p = resultUV * seed;
      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);
      p3 += dot(p3, p3.yzx + 19.19);
      return fract((p3.x + p3.y) * p3.z);
    }

    `+HP+`
    `+GP+`
    `+qP+`
  `}(c);return t.isPacked?(i=function(h,v){switch(h.length){case 0:return`
    int getOutputCoords() {
      return 0;
    }
  `;case 1:return function(w,b){var C=[Math.ceil(b[0]/2),Math.ceil(b[1]/2)];return C[0]===1?`
      int getOutputCoords() {
        return 2 * int(resultUV.x * `+C[1]+`.0);
      }
    `:C[1]===1?`
      int getOutputCoords() {
        return 2 * int(resultUV.y * `+C[0]+`.0);
      }
    `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+C[0]+", "+C[1]+`));
      return 2 * (resTexRC.x * `+C[1]+` + resTexRC.y);
    }
  `}(0,v);case 2:return function(w,b){var C=[Math.ceil(b[0]/2),Math.ceil(b[1]/2)];if(xt(w,b))return`
      ivec2 getOutputCoords() {
        return 2 * ivec2(resultUV.yx * vec2(`+C[0]+", "+C[1]+`));
      }
    `;var E=Math.ceil(w[1]/2);return`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+C[0]+", "+C[1]+`));

      int index = resTexRC.x * `+C[1]+` + resTexRC.y;
      int r = 2 * (index / `+E+`);
      int c = imod(index, `+E+`) * 2;

      return ivec2(r, c);
    }
  `}(h,v);case 3:return m=h,g=v,p=[Math.ceil(g[0]/2),Math.ceil(g[1]/2)],y=Math.ceil(m[2]/2),x=y*Math.ceil(m[1]/2),`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+p[0]+", "+p[1]+`));
      int index = resTexRC.x * `+p[1]+` + resTexRC.y;

      int b = index / `+x+`;
      index -= b * `+x+`;

      int r = 2 * (index / `+y+`);
      int c = imod(index, `+y+`) * 2;

      return ivec3(b, r, c);
    }
  `;default:return function(w,b){for(var C=[Math.ceil(b[0]/2),Math.ceil(b[1]/2)],E=Math.ceil(w[w.length-1]/2),S=E*Math.ceil(w[w.length-2]/2),R=S,k="",P="b, r, c",T=2;T<w.length-1;T++)R*=w[w.length-T-1],k=`
      int b`+T+" = index / "+R+`;
      index -= b`+T+" * "+R+`;
    `+k,P="b"+T+", "+P;return`
    ivec`+w.length+` getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+C[0]+", "+C[1]+`));
      int index = resTexRC.x * `+C[1]+` + resTexRC.y;

      `+k+`

      int b = index / `+S+`;
      index -= b * `+S+`;

      int r = 2 * (index / `+E+`);
      int c = imod(index, `+E+`) * 2;

      return ivec`+w.length+"("+P+`);
    }
  `}(h,v)}var m,g,p,y,x}(t.logicalShape,l),a=function(h){return`
    void setOutput(vec4 val) {
      `+h.output+` = val;
    }
  `}(c)):(i=function(h,v){switch(h.length){case 0:return`
    int getOutputCoords() {
      return 0;
    }
  `;case 1:return function(p,y){return y[0]===1?`
      int getOutputCoords() {
        return int(resultUV.x * `+y[1]+`.0);
      }
    `:y[1]===1?`
      int getOutputCoords() {
        return int(resultUV.y * `+y[0]+`.0);
      }
    `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+y[0]+", "+y[1]+`));
      return resTexRC.x * `+y[1]+` + resTexRC.y;
    }
  `}(0,v);case 2:return function(p,y){return xt(p,y)?`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(`+y[0]+", "+y[1]+`));
      }
    `:p[1]===1?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(`+y[0]+", "+y[1]+`));
        int index = resTexRC.x * `+y[1]+` + resTexRC.y;
        return ivec2(index, 0);
      }
    `:p[0]===1?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(`+y[0]+", "+y[1]+`));
        int index = resTexRC.x * `+y[1]+` + resTexRC.y;
        return ivec2(0, index);
      }
    `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+y[0]+", "+y[1]+`));
      int index = resTexRC.x * `+y[1]+` + resTexRC.y;
      int r = index / `+p[1]+`;
      int c = index - r * `+p[1]+`;
      return ivec2(r, c);
    }
  `}(h,v);case 3:return m=v,g=pi(["r","c","d"],h),`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+m[0]+", "+m[1]+`));
      int index = resTexRC.x * `+m[1]+` + resTexRC.y;
      `+g+`
      return ivec3(r, c, d);
    }
  `;case 4:return function(p,y){var x=pi(["r","c","d","d2"],p);return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(`+y[0]+", "+y[1]+`));
      int index = resTexRC.x * `+y[1]+` + resTexRC.y;
      `+x+`
      return ivec4(r, c, d, d2);
    }
  `}(h,v);case 5:return function(p,y){var x=pi(["r","c","d","d2","d3"],p);return`
    ivec5 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx * vec2(`+y[0]+`,
                             `+y[1]+`));

      int index = resTexRC.x * `+y[1]+` + resTexRC.y;

      `+x+`

      ivec5 outShape = ivec5(r, c, d, d2, d3);
      return outShape;
    }
  `}(h,v);case 6:return function(p,y){var x=pi(["r","c","d","d2","d3","d4"],p);return`
    ivec6 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(`+y[0]+", "+y[1]+`));
      int index = resTexRC.x * `+y[1]+` + resTexRC.y;

      `+x+`

      ivec6 result = ivec6(r, c, d, d2, d3, d4);
      return result;
    }
  `}(h,v);default:throw new Error(h.length+"-D output sampling is not yet supported")}var m,g}(t.logicalShape,l),a=function(h){return`
    void setOutput(float val) {
      `+h.output+` = vec4(val, 0, 0, 0);
    }
  `}(c)),r&&(f+=KP),[f,d,a,s,i,u,n].join(`
`)}function Ki(e){var t=e.shapeInfo.logicalShape;switch(t.length){case 0:return function(n){var r=n.name,o="get"+r.charAt(0).toUpperCase()+r.slice(1);if(n.shapeInfo.isUniform)return"float "+o+"() {return "+r+";}";var i=n.shapeInfo.texShape,a=i[0],s=i[1];if(a===1&&s===1)return`
      float `+o+`() {
        return sampleTexture(`+r+`, halfCR);
      }
    `;var u=n.shapeInfo.texShape,l=u[0],c=u[1],d=ii(r);return`
    float `+o+`() {
      vec2 uv = uvFromFlat(`+l+", "+c+", "+d+`);
      return sampleTexture(`+r+`, uv);
    }
  `}(e);case 1:return function(n){var r=n.name,o="get"+r.charAt(0).toUpperCase()+r.slice(1);if(n.shapeInfo.isUniform)return`
      float `+o+`(int index) {
        `+Vi(n)+`
      }
    `;var i=n.shapeInfo.texShape,a=i[0],s=i[1];if(s===1&&a===1)return`
      float `+o+`(int index) {
        return sampleTexture(`+r+`, halfCR);
      }
    `;var u=ii(r);return s===1?`
      float `+o+`(int index) {
        vec2 uv = vec2(0.5, (float(index + `+u+") + 0.5) / "+a+`.0);
        return sampleTexture(`+r+`, uv);
      }
    `:a===1?`
      float `+o+`(int index) {
        vec2 uv = vec2((float(index + `+u+") + 0.5) / "+s+`.0, 0.5);
        return sampleTexture(`+r+`, uv);
      }
    `:`
    float `+o+`(int index) {
      vec2 uv = uvFromFlat(`+a+", "+s+", index + "+u+`);
      return sampleTexture(`+r+`, uv);
    }
  `}(e);case 2:return function(n){var r=n.shapeInfo.logicalShape,o=n.name,i="get"+o.charAt(0).toUpperCase()+o.slice(1),a=n.shapeInfo.texShape;if(a!=null&&xt(r,a)){var s=a[0],u=a[1];return`
    float `+i+`(int row, int col) {
      vec2 uv = (vec2(col, row) + halfCR) / vec2(`+u+".0, "+s+`.0);
      return sampleTexture(`+o+`, uv);
    }
  `}var l=ci(r),c=l.newShape,d=l.keptDims,f=c;if(f.length<r.length){var h=Xi(n,f);return`
      `+Ki(h)+`
      float `+i+`(int row, int col) {
        return `+i+"("+Yi(["row","col"],d)+`);
      }
    `}if(n.shapeInfo.isUniform)return`
      float `+i+`(int row, int col) {
        int index = round(dot(vec2(row, col), vec2(`+r[1]+`, 1)));
        `+Vi(n)+`
      }
    `;var v=a[0],m=a[1],g=ii(o);return m===1?`
    float `+i+`(int row, int col) {
      float index = dot(vec3(row, col, `+g+"), vec3("+r[1]+`, 1, 1));
      vec2 uv = vec2(0.5, (index + 0.5) / `+v+`.0);
      return sampleTexture(`+o+`, uv);
    }
  `:v===1?`
    float `+i+`(int row, int col) {
      float index = dot(vec3(row, col, `+g+"), vec3("+r[1]+`, 1, 1));
      vec2 uv = vec2((index + 0.5) / `+m+`.0, 0.5);
      return sampleTexture(`+o+`, uv);
    }
  `:`
  float `+i+`(int row, int col) {
    // Explicitly use integer operations as dot() only works on floats.
    int index = row * `+r[1]+" + col + "+g+`;
    vec2 uv = uvFromFlat(`+v+", "+m+`, index);
    return sampleTexture(`+o+`, uv);
  }
`}(e);case 3:return function(n){var r=n.shapeInfo.logicalShape,o=n.name,i="get"+o.charAt(0).toUpperCase()+o.slice(1),a=r[1]*r[2],s=r[2],u=ci(r),l=u.newShape,c=u.keptDims,d=l;if(d.length<r.length){var f=Xi(n,d);return`
        `+Ki(f)+`
        float `+i+`(int row, int col, int depth) {
          return `+i+"("+Yi(["row","col","depth"],c)+`);
        }
      `}if(n.shapeInfo.isUniform)return`
      float `+i+`(int row, int col, int depth) {
        int index = round(dot(vec3(row, col, depth),
                          vec3(`+a+", "+s+`, 1)));
        `+Vi(n)+`
      }
    `;var h=n.shapeInfo.texShape,v=h[0],m=h[1],g=n.shapeInfo.flatOffset;if(m===a&&g==null)return`
        float `+i+`(int row, int col, int depth) {
          float texR = float(row);
          float texC = dot(vec2(col, depth), vec2(`+s+`, 1));
          vec2 uv = (vec2(texC, texR) + halfCR) /
                     vec2(`+m+".0, "+v+`.0);
          return sampleTexture(`+o+`, uv);
        }
      `;if(m===s&&g==null)return`
    float `+i+`(int row, int col, int depth) {
      float texR = dot(vec2(row, col), vec2(`+r[1]+`, 1));
      float texC = float(depth);
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(`+m+".0, "+v+`.0);
      return sampleTexture(`+o+`, uv);
    }
  `;var p=ii(o);return`
      float `+i+`(int row, int col, int depth) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * `+a+" + col * "+s+" + depth + "+p+`;
        vec2 uv = uvFromFlat(`+v+", "+m+`, index);
        return sampleTexture(`+o+`, uv);
      }
  `}(e);case 4:return function(n){var r=n.shapeInfo.logicalShape,o=n.name,i="get"+o.charAt(0).toUpperCase()+o.slice(1),a=r[3],s=r[2]*a,u=r[1]*s,l=ci(r),c=l.newShape,d=l.keptDims;if(c.length<r.length){var f=Xi(n,c);return`
      `+Ki(f)+`
      float `+i+`(int row, int col, int depth, int depth2) {
        return `+i+"("+Yi(["row","col","depth","depth2"],d)+`);
      }
    `}if(n.shapeInfo.isUniform)return`
      float `+i+`(int row, int col, int depth, int depth2) {
        int index = round(dot(vec4(row, col, depth, depth2),
                          vec4(`+u+", "+s+", "+a+`, 1)));
        `+Vi(n)+`
      }
    `;var h=n.shapeInfo.flatOffset,v=n.shapeInfo.texShape,m=v[0],g=v[1];if(g===u&&h==null)return`
      float `+i+`(int row, int col, int depth, int depth2) {
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(`+s+", "+a+`, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(`+g+".0, "+m+`.0);
        return sampleTexture(`+o+`, uv);
      }
    `;if(g===a&&h==null)return`
      float `+i+`(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(`+r[1]*r[2]+", "+r[2]+`, 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(`+g+".0, "+m+`.0);
        return sampleTexture(`+o+`, uv);
      }
    `;var p=ii(o);return`
    float `+i+`(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * `+u+" + col * "+s+` +
          depth * `+a+` + depth2;
      vec2 uv = uvFromFlat(`+m+", "+g+", index + "+p+`);
      return sampleTexture(`+o+`, uv);
    }
  `}(e);case 5:return function(n){var r=n.shapeInfo.logicalShape,o=n.name,i="get"+o.charAt(0).toUpperCase()+o.slice(1),a=r[4],s=r[3]*a,u=r[2]*s,l=r[1]*u,c=ci(r),d=c.newShape,f=c.keptDims;if(d.length<r.length){var h=Xi(n,d);return`
      `+Ki(h)+`
      float `+i+`(int row, int col, int depth, int depth2, int depth3) {
        return `+i+"("+Yi(["row","col","depth","depth2","depth3"],f)+`);
      }
    `}if(n.shapeInfo.isUniform)return`
      float `+i+`(int row, int col, int depth, int depth2, int depth3) {
        float index = dot(
          vec4(row, col, depth, depth2),
          vec4(`+l+", "+u+", "+s+", "+a+`)) +
          depth3;
        `+Vi(n)+`
      }
    `;var v=n.shapeInfo.flatOffset,m=n.shapeInfo.texShape,g=m[0],p=m[1];if(p===l&&v==null)return`
      float `+i+`(int row, int col, int depth, int depth2, int depth3) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
                         vec4(`+u+", "+s+", "+a+`, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(`+p+".0, "+g+`.0);
        return sampleTexture(`+o+`, uv);
      }
    `;if(p===a&&v==null)return`
      float `+i+`(int row, int col, int depth, int depth2, int depth3) {
        float texR = dot(
          vec4(row, col, depth, depth2),
          vec4(`+r[1]*r[2]*r[3]+`,
               `+r[2]*r[3]+", "+r[3]+`, 1));
        int texC = depth3;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(`+p+".0, "+g+`.0);
        return sampleTexture(`+o+`, uv);
      }
    `;var y=ii(o);return`
    float `+i+`(int row, int col, int depth, int depth2, int depth3) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * `+l+" + col * "+u+" + depth * "+s+` +
          depth2 * `+a+" + depth3 + "+y+`;
      vec2 uv = uvFromFlat(`+g+", "+p+`, index);
      return sampleTexture(`+o+`, uv);
    }
  `}(e);case 6:return function(n){var r=n.shapeInfo.logicalShape,o=n.name,i="get"+o.charAt(0).toUpperCase()+o.slice(1),a=ci(r),s=a.newShape,u=a.keptDims;if(s.length<r.length){var l=Xi(n,s);return`
      `+Ki(l)+`
      float `+i+`(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        return `+i+"("+Yi(["row","col","depth","depth2","depth3","depth4"],u)+`);
      }
    `}var c=r[5],d=r[4]*c,f=r[3]*d,h=r[2]*f,v=r[1]*h;if(n.shapeInfo.isUniform)return`
      float `+i+`(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
        int index = round(dot(
          vec4(row, col, depth, depth2),
          vec4(`+v+", "+h+", "+f+", "+d+`)) +
          dot(
            vec2(depth3, depth4),
            vec2(`+c+`, 1)));
        `+Vi(n)+`
      }
    `;var m=n.shapeInfo.flatOffset,g=n.shapeInfo.texShape,p=g[0],y=g[1];if(y===v&&m==null)return`
      float `+i+`(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
          vec4(`+h+", "+f+", "+d+", "+c+`)) +
               float(depth4);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(`+y+".0, "+p+`.0);
        return sampleTexture(`+o+`, uv);
      }
    `;if(y===c&&m==null)return`
      float `+i+`(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        float texR = dot(vec4(row, col, depth, depth2),
          vec4(`+r[1]*r[2]*r[3]*r[4]+`,
               `+r[2]*r[3]*r[4]+`,
               `+r[3]*r[4]+`,
               `+r[4]+`)) + float(depth3);
        int texC = depth4;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(`+y+".0, "+p+`.0);
        return sampleTexture(`+o+`, uv);
      }
    `;var x=ii(o);return`
    float `+i+`(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * `+v+" + col * "+h+" + depth * "+f+` +
          depth2 * `+d+" + depth3 * "+c+" + depth4 + "+x+`;
      vec2 uv = uvFromFlat(`+p+", "+y+`, index);
      return sampleTexture(`+o+`, uv);
    }
  `}(e);default:throw new Error(t.length+"-D input sampling is not yet supported")}}function v2(e){var t,n,r;switch(e.shapeInfo.logicalShape.length){case 0:return t=e.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1),r=Lt(),`
    vec4 `+n+`() {
      return `+r.texture2D+"("+t+`, halfCR);
    }
  `;case 1:return function(o){var i=o.name,a="get"+i.charAt(0).toUpperCase()+i.slice(1),s=o.shapeInfo.texShape,u=[Math.ceil(s[0]/2),Math.ceil(s[1]/2)],l=Lt();return`
    vec4 `+a+`(int index) {
      vec2 uv = packedUVfrom1D(
        `+u[0]+", "+u[1]+`, index);
      return `+l.texture2D+"("+i+`, uv);
    }
  `}(e);case 2:return function(o){var i=o.shapeInfo.logicalShape,a=o.name,s="get"+a.charAt(0).toUpperCase()+a.slice(1),u=o.shapeInfo.texShape,l=u[0],c=u[1],d=Lt();if(u!=null&&xt(i,u))return`
      vec4 `+s+`(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(`+c+".0, "+l+`.0);

        return `+d.texture2D+"("+a+`, uv);
      }
    `;var f=[Math.ceil(u[0]/2),Math.ceil(u[1]/2)],h=Math.ceil(i[1]/2);return`
    vec4 `+s+`(int row, int col) {
      vec2 uv = packedUVfrom2D(`+h+", "+f[0]+", "+f[1]+`, row, col);
      return `+d.texture2D+"("+a+`, uv);
    }
  `}(e);case 3:return function(o){var i=o.shapeInfo.logicalShape,a=o.name,s="get"+a.charAt(0).toUpperCase()+a.slice(1),u=o.shapeInfo.texShape,l=[Math.ceil(u[0]/2),Math.ceil(u[1]/2)];if(i[0]===1){var c=i.slice(1),d=Xi(o,c);return`
        `+v2(d)+`
        vec4 `+s+`(int b, int row, int col) {
          return `+s+"("+Yi(["b","row","col"],[1,2])+`);
        }
      `}var f=l[0],h=l[1],v=Math.ceil(i[2]/2),m=v*Math.ceil(i[1]/2),g=Lt();return`
    vec4 `+s+`(int b, int row, int col) {
      vec2 uv = packedUVfrom3D(
        `+f+", "+h+", "+m+", "+v+`, b, row, col);
      return `+g.texture2D+"("+a+`, uv);
    }
  `}(e);default:return function(o){for(var i=o.shapeInfo.logicalShape,a=i.length,s=o.name,u="get"+s.charAt(0).toUpperCase()+s.slice(1),l=o.shapeInfo.texShape,c=[Math.ceil(l[0]/2),Math.ceil(l[1]/2)],d=c[0],f=c[1],h=Math.ceil(i[a-1]/2),v=h*Math.ceil(i[a-2]/2),m="int b, int row, int col",g="b * "+v+" + (row / 2) * "+h+" + (col / 2)",p=2;p<a-1;p++)m="int b"+p+", "+m,v*=i[a-p-1],g="b"+p+" * "+v+" + "+g;var y=Lt();return`
    vec4 `+u+"("+m+`) {
      int index = `+g+`;
      int texR = index / `+f+`;
      int texC = index - texR * `+f+`;
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(`+f+", "+d+`);
      return `+y.texture2D+"("+s+`, uv);
    }
  `}(e)}}var HP=`
vec2 uvFromFlat(int texNumR, int texNumC, int index) {
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {
  int texelIndex = index / 2;
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,GP=`
vec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,
  int texNumC, int row, int col) {
  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,qP=`
vec2 packedUVfrom3D(int texNumR, int texNumC,
    int texelsInBatch, int texelsInLogicalRow, int b,
    int row, int col) {
  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,KP=`
  float getChannel(vec4 frag, vec2 innerDims) {
    vec2 modCoord = mod(innerDims, 2.);
    return modCoord.x == 0. ?
      (modCoord.y == 0. ? frag.r : frag.g) :
      (modCoord.y == 0. ? frag.b : frag.a);
  }
  float getChannel(vec4 frag, int dim) {
    float modCoord = mod(float(dim), 2.);
    return modCoord == 0. ? frag.r : frag.g;
  }
`;function ii(e){return"offset"+e}function Vi(e){var t=e.name,n=ae(e.shapeInfo.logicalShape);return n<2?"return "+t+";":`
    for (int i = 0; i < `+n+`; i++) {
      if (i == index) {
        return `+t+`[i];
      }
    }
  `}function je(e){if(e<=1)return"int";if(e===2)return"ivec2";if(e===3)return"ivec3";if(e===4)return"ivec4";if(e===5)return"ivec5";if(e===6)return"ivec6";throw Error("GPU for rank "+e+" is not yet supported")}function Xi(e,t){var n=JSON.parse(JSON.stringify(e));return n.shapeInfo.logicalShape=t,n}function Yi(e,t){return t.map(function(n){return e[n]}).join(", ")}var XP=function(e,t,n,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,I(e.length>2,function(){return"Packed arg"+(n.charAt(0).toUpperCase()+n.slice(1))+" supports only inputs with rank above 2."});var o=e[e.length-1],i=Math.ceil(o/t);this.outputShape=e.slice(0,-1),i>1&&this.outputShape.push(i),r||this.variableNames.push("bestIndicesA");var a,s,u=this.outputShape,l=u.length,c=je(l),d=en("coords",l);if(i===1){var f=je(s=l+1);a=`
        `+f+" sourceLocR = "+f+"("+d.join()+`, 0);
        ++`+d[l-1]+`;
        `+f+" sourceLocG = "+f+"("+d.join()+`, 0);
        ++`+d[l-2]+`;
        `+f+" sourceLocA = "+f+"("+d.join()+`, 0);
        --`+d[l-1]+`;
        `+f+" sourceLocB = "+f+"("+d.join()+`, 0);
        --`+d[l-2]+";"}else s=l,a=`
        `+c+` sourceLocR = coords;
        ++`+d[l-1]+`;
        `+c+` sourceLocG = coords;
        ++`+d[l-2]+`;
        `+c+` sourceLocA = coords;
        --`+d[l-1]+`;
        `+c+` sourceLocB = coords;
        --`+d[l-2]+";";var h=["x","y","z","w","u","v"].slice(0,s),v="."+h[s-1],m=h.map(function(S){return"int "+S}),g=en("sourceLocR",s-1).concat("inIdx.r"),p=en("sourceLocG",s-1).concat("inIdx.g"),y=en("sourceLocB",s-1).concat("inIdx.b"),x=en("sourceLocA",s-1).concat("inIdx.a"),w=n==="max"?"greaterThan":"lessThan",b=r?"":`
          inIdx = round(vec4(getBestIndicesAChannel(`+g.join()+`),
                             getBestIndicesAChannel(`+p.join()+`),
                             getBestIndicesAChannel(`+y.join()+`),
                             getBestIndicesAChannel(`+x.join()+")));",C=`vec4(
            getAChannel(`+g.join()+`),
            hasNextCol ? getAChannel(`+p.join()+`) : 0.,
            hasNextRow ? getAChannel(`+y.join()+`) : 0.,
            hasNextRow && hasNextCol ? getAChannel(`+x.join()+") : 0.)",E=r?"":`
      float getBestIndicesAChannel(`+m.join()+`) {
        return getChannel(getBestIndicesA(`+h.join()+`),
                                          vec2(`+h.slice(-2).join()+`));
      }`;this.userCode=`
      float getAChannel(`+m.join()+`) {
        return getChannel(getA(`+h.join()+`),
                               vec2(`+h.slice(-2).join()+`));
      }
      `+E+`
      void main() {
        `+c+` coords = getOutputCoords();
        bool hasNextCol = `+d[l-1]+" < "+(u[l-1]-1)+`;
        bool hasNextRow = `+d[l-2]+" < "+(u[l-2]-1)+`;
        `+a+`
        ivec4 srcIdx = ivec4(sourceLocR`+v+", sourceLocG"+v+`,
          sourceLocB`+v+", sourceLocA"+v+") * "+t+`;
        ivec4 inIdx = srcIdx;
        vec4 bestIndex = vec4(inIdx);
        vec4 bestValue = `+C+`;

        for (int i = 0; i < `+t+`; i++) {
          inIdx = srcIdx;
          `+b+`
          vec4 candidate = `+C+`;
          bvec4 nan = isnan(candidate);
          bvec4 replace = bvec4(
            vec4(`+w+`(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));

          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,
                           replace.y  ? candidate.y : bestValue.y,
                           replace.z  ? candidate.z : bestValue.z,
                           replace.w  ? candidate.w : bestValue.w);
          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));
          srcIdx++;
        }
        setOutput(bestIndex);
      }
    `},YP=function(e){this.variableNames=["dy"],this.outputShape=e.inShape;var t=e.filterHeight,n=e.filterWidth,r=e.strideHeight,o=e.strideWidth,i=e.dilationHeight,a=e.dilationWidth,s=e.effectiveFilterHeight,u=e.effectiveFilterWidth,l=s-1-e.padInfo.top,c=u-1-e.padInfo.left,d=1/(t*n);this.userCode=`
      const ivec2 pads = ivec2(`+l+", "+c+`);
      const float avgMultiplier = float(`+d+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+s+`;
            wR += `+i+`) {
          float dyR = float(dyRCorner + wR) / `+r+`.0;

          if (dyR < 0.0 || dyR >= `+e.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < `+u+`;
            wC+= `+a+`) {
            float dyC = float(dyCCorner + wC) / `+o+`.0;

            if (dyC < 0.0 || dyC >= `+e.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);

            dotProd += dyValue * avgMultiplier;
          }
        }
        setOutput(dotProd);
      }
    `},QP=function(e){this.variableNames=["dy"],this.outputShape=e.inShape;var t=e.filterDepth,n=e.filterHeight,r=e.filterWidth,o=e.strideDepth,i=e.strideHeight,a=e.strideWidth,s=e.dilationDepth,u=e.dilationHeight,l=e.dilationWidth,c=e.effectiveFilterDepth,d=e.effectiveFilterHeight,f=e.effectiveFilterWidth,h=c-1-e.padInfo.front,v=d-1-e.padInfo.top,m=f-1-e.padInfo.left,g=1/(t*n*r);this.userCode=`
      const ivec3 pads = ivec3(`+h+", "+v+", "+m+`);
      const float avgMultiplier = float(`+g+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < `+c+`;
            wD += `+s+`) {
          float dyD = float(dyDCorner + wD) / `+o+`.0;

          if (dyD < 0.0 || dyD >= `+e.outDepth+`.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < `+d+`;
              wR += `+u+`) {
            float dyR = float(dyRCorner + wR) / `+i+`.0;

            if (dyR < 0.0 || dyR >= `+e.outHeight+`.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < `+f+`;
                wC += `+l+`) {
              float dyC = float(dyCCorner + wC) / `+a+`.0;

              if (dyC < 0.0 || dyC >= `+e.outWidth+`.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);

              dotProd += dyValue * avgMultiplier;
            }
          }
        }
        setOutput(dotProd);
      }
    `},JP=function(e,t,n,r,o,i){this.outputShape=[],this.variableNames=["x","mean","variance"],_e(e,t),_e(e,n);var a="0.0";r!=null&&(_e(e,r),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");var s="1.0";o!=null&&(_e(e,o),this.variableNames.push("scale"),s="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        float x = getXAtOutCoords();
        float mean = getMeanAtOutCoords();
        float variance = getVarianceAtOutCoords();
        float offset = `+a+`;
        float scale = `+s+`;
        float inv = scale * inversesqrt(variance + float(`+i+`));
        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));
      }
    `},ZP=function(e,t,n,r,o,i){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],_e(e,t),_e(e,n);var a="vec4(0.0)";r!=null&&(_e(e,r),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");var s="vec4(1.0)";o!=null&&(_e(e,o),this.variableNames.push("scale"),s="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        vec4 offset = `+a+`;
        vec4 scale = `+s+`;

        vec4 x = getXAtOutCoords();
        vec4 mean = getMeanAtOutCoords();
        vec4 variance = getVarianceAtOutCoords();

        vec4 inv = scale * inversesqrt(variance + vec4(`+i+`));

        setOutput((x - mean) * inv + offset);
      }
    `},eD="return areal * breal - aimag * bimag;",tD="return areal * bimag + aimag * breal;",Oy=function(e,t,n){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=_e(t,n),this.userCode=`
      float binaryOpComplex(
          float areal, float aimag, float breal, float bimag) {
        `+e+`
      }

      void main() {
        float areal = getARealAtOutCoords();
        float aimag = getAImagAtOutCoords();
        float breal = getBRealAtOutCoords();
        float bimag = getBImagAtOutCoords();
        setOutput(binaryOpComplex(areal, aimag, breal, bimag));
      }
    `},mf="return a + b;",gf="return a - b;",Ly="return a * b;",m2="return (a < 0.) ? b * a : a;",Ze=function(e,t,n){this.variableNames=["A","B"],this.outputShape=_e(t,n),this.userCode=`
      float binaryOperation(float a, float b) {
        `+e+`
      }

      void main() {
        float a = getAAtOutCoords();
        float b = getBAtOutCoords();
        setOutput(binaryOperation(a, b));
      }
    `},g2=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`,Wr=function(e,t,n,r){r===void 0&&(r=!1),this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=_e(t,n);var o=this.outputShape.length,i="";if(r)if(o===0||ae(this.outputShape)===1)i=`
          result.y = 0.;
          result.z = 0.;
          result.w = 0.;
        `;else if(i=`
          `+je(o)+` coords = getOutputCoords();
        `,o===1)i+=`
            result.y = (coords + 1) >= `+this.outputShape[0]+` ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `;else{var a=en("coords",o);i+=`
            bool nextRowOutOfBounds =
              (`+a[o-2]+" + 1) >= "+this.outputShape[o-2]+`;
            bool nextColOutOfBounds =
              (`+a[o-1]+" + 1) >= "+this.outputShape[o-1]+`;
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `}this.userCode=`
      vec4 binaryOperation(vec4 a, vec4 b) {
        `+e+`
      }

      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();

        vec4 result = binaryOperation(a, b);
        `+i+`

        setOutput(result);
      }
    `},nD=function(){function e(t){this.variableNames=["A"],this.outputShape=t,this.userCode=`
      uniform float minVal;
      uniform float maxVal;

      void main() {
        float value = getAAtOutCoords();
        if (isnan(value)) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, minVal, maxVal));
      }
    `}return e.prototype.getCustomSetupFunc=function(t,n){var r=this;return function(o,i){r.minLoc==null&&(r.minLoc=o.getUniformLocationNoThrow(i,"minVal"),r.maxLoc=o.getUniformLocationNoThrow(i,"maxVal")),o.gl.uniform1f(r.minLoc,t),o.gl.uniform1f(r.maxLoc,n)}},e}(),rD=function(){function e(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.userCode=`
      uniform float minVal;
      uniform float maxVal;

      void main() {
        vec4 value = getAAtOutCoords();

        if (any(isnan(value))) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));
      }
    `}return e.prototype.getCustomSetupFunc=function(t,n){var r=this;return function(o,i){r.minLoc==null&&(r.minLoc=o.getUniformLocationNoThrow(i,"minVal"),r.maxLoc=o.getUniformLocationNoThrow(i,"maxVal")),o.gl.uniform1f(r.minLoc,t),o.gl.uniform1f(r.maxLoc,n)}},e}(),oD=function(e){this.variableNames=["real","imag"],this.outputShape=e,this.userCode=`
      void main() {
        float re = abs(getRealAtOutCoords());
        float im = abs(getImagAtOutCoords());
        float mx = max(re, im);

        // sadly the length function in glsl is not underflow-safe
        // (at least not on Intel GPUs). So the safe solution is
        // to ensure underflow-safety in all cases.
        setOutput(
          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))
        );
      }
    `},iD=function(e){this.outputShape=[],this.outputShape=Ga(e,1),this.variableNames=e.map(function(s,u){return"T"+u});var t=new Array(e.length-1);t[0]=e[0][1];for(var n=1;n<t.length;n++)t[n]=t[n-1]+e[n][1];var r=["if (yC < "+t[0]+") setOutput(getT0(yR, yC));"];for(n=1;n<t.length;n++){var o=t[n-1];r.push("else if (yC < "+t[n]+") setOutput(getT"+n+"(yR, yC-"+o+"));")}var i=t.length,a=t[t.length-1];r.push("else setOutput(getT"+i+"(yR, yC-"+a+"));"),this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int yR = coords.x;
        int yC = coords.y;

        `+r.join(`
        `)+`
      }
    `},aD=function(e,t){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=Ga(e,t);var n=this.outputShape,r=n.length,o=je(r),i=en("coords",r),a=["x","y","z","w","u","v"].slice(0,r);this.variableNames=e.map(function(g,p){return"T"+p});var s=new Array(e.length-1);s[0]=e[0][t];for(var u=1;u<s.length;u++)s[u]=s[u-1]+e[u][t];var l=a[t],c=a.slice(-2),d=a.join(),f="if ("+l+" < "+s[0]+`) {
        return getChannel(
            getT0(`+d+"), vec2("+c.join()+`));
        }`;for(u=1;u<s.length;u++){var h=s[u-1];f+=`
        if (`+l+" < "+s[u]+"  && "+l+" >= "+s[u-1]+`) {
          return getChannel(
            getT`+u+"("+rl(a,l,h)+`),
            vec2(`+rl(c,l,h)+`));
        }`}var v=s.length,m=s[s.length-1];f+=`
        return getChannel(
          getT`+v+"("+rl(a,l,m)+`),
          vec2(`+rl(c,l,m)+"));",this.userCode=`
      float getValue(`+a.map(function(g){return"int "+g})+`) {
        `+f+`
      }

      void main() {
        `+o+` coords = getOutputCoords();
        vec4 result = vec4(getValue(`+i+`), 0., 0., 0.);

        `+i[r-1]+" = "+i[r-1]+` + 1;
        if (`+i[r-1]+" < "+n[r-1]+`) {
          result.g = getValue(`+i+`);
        }

        `+i[r-2]+" = "+i[r-2]+` + 1;
        if (`+i[r-2]+" < "+n[r-2]+`) {
          result.a = getValue(`+i+`);
        }

        `+i[r-1]+" = "+i[r-1]+` - 1;
        if (`+i[r-2]+" < "+n[r-2]+` &&
            `+i[r-1]+" < "+n[r-1]+`) {
          result.b = getValue(`+i+`);
        }
        setOutput(result);
      }
    `};function rl(e,t,n){var r=e.indexOf(t);return e.map(function(o,i){return i===r?o+" - "+n:o}).join()}var sD=function(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;var t=e.strideHeight,n=e.strideWidth,r=e.padInfo.top,o=e.padInfo.left,i=e.dataFormat==="channelsLast";this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int d2 = coords.w;

        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int b = 0; b < `+e.batchSize+`; b++) {
          for (int yR = 0; yR < `+e.outHeight+`; yR++) {
            int xR = wR + yR * `+t+" - "+r+`;

            if (xR < 0 || xR >= `+e.inHeight+`) {
              continue;
            }

            for (int yC = 0; yC < `+e.outWidth+`; yC++) {
              int xC = wC + yC * `+n+" - "+o+`;

              if (xC < 0 || xC >= `+e.inWidth+`) {
                continue;
              }

              if (`+i+`) {
                float dyValue = getDy(b, yR, yC, d2);
                float xValue = getX(b, xR, xC, d1);
                dotProd += (xValue * dyValue);
              } else {
                float dyValue = getDy(b, d2, yR, yC);
                float xValue = getX(b, d1, xR, xC);
                dotProd += (xValue * dyValue);
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `},uD=function(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;var t=e.filterHeight,n=e.filterWidth,r=e.strideHeight,o=e.strideWidth,i=e.dataFormat==="channelsLast",a=t-1-e.padInfo.top,s=n-1-e.padInfo.left,u=i?1:2,l=i?2:3,c=i?3:1;this.userCode=`
      const ivec2 pads = ivec2(`+a+", "+s+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[`+c+`];

        ivec2 dyCorner = ivec2(coords[`+u+"], coords["+l+`]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+t+`; wR++) {
          float dyR = float(dyRCorner + wR) / `+r+`.0;

          if (dyR < 0.0 || dyR >= `+e.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = `+t+` - 1 - wR;

          for (int wC = 0; wC < `+n+`; wC++) {
            float dyC = float(dyCCorner + wC) / `+o+`.0;

            if (dyC < 0.0 || dyC >= `+e.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = `+n+` - 1 - wC;

            for (int d2 = 0; d2 < `+e.outChannels+`; d2++) {

              if (`+i+`) {
                float xValue = getDy(batch, idyR, idyC, d2);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              } else {
                float xValue = getDy(batch, d2, idyR, idyC);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `},lD=function(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;var t=e.strideDepth,n=e.strideHeight,r=e.strideWidth,o=e.padInfo.front,i=e.padInfo.top,a=e.padInfo.left;this.userCode=`
      void main() {
        ivec5 coords = getOutputCoords();
        int wF = coords.x;
        int wR = coords.y;
        int wC = coords.z;
        int d1 = coords.w;
        int d2 = coords.u;

        float dotProd = 0.0;

        for (int b = 0; b < `+e.batchSize+`; b++) {
          for (int yF = 0; yF < `+e.outDepth+`; yF++) {
            int xF = wF + yF * `+t+" - "+o+`;

            if (xF < 0 || xF >= `+e.inDepth+`) {
              continue;
            }

            for (int yR = 0; yR < `+e.outHeight+`; yR++) {
              int xR = wR + yR * `+n+" - "+i+`;

              if (xR < 0 || xR >= `+e.inHeight+`) {
                continue;
              }

              for (int yC = 0; yC < `+e.outWidth+`; yC++) {
                int xC = wC + yC * `+r+" - "+a+`;

                if (xC < 0 || xC >= `+e.inWidth+`) {
                  continue;
                }

                float dyValue = getDy(b, yF, yR, yC, d2);
                float xValue = getX(b, xF, xR, xC, d1);
                dotProd += (xValue * dyValue);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `},cD=function(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;var t=e.filterDepth,n=e.filterHeight,r=e.filterWidth,o=e.strideDepth,i=e.strideHeight,a=e.strideWidth,s=t-1-e.padInfo.front,u=n-1-e.padInfo.top,l=r-1-e.padInfo.left;this.userCode=`
      const ivec3 pads = ivec3(`+s+", "+u+", "+l+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.u;


        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyFCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        float dotProd = 0.0;
        for (int wF = 0; wF < `+t+`; wF++) {
          float dyF = float(dyFCorner + wF) / `+o+`.0;

          if (dyF < 0.0 || dyF >= `+e.outDepth+`.0 || fract(dyF) > 0.0) {
            continue;
          }
          int idyF = int(dyF);

          int wFPerm = `+t+` - 1 - wF;

          for (int wR = 0; wR < `+n+`; wR++) {
            float dyR = float(dyRCorner + wR) / `+i+`.0;

            if (dyR < 0.0 || dyR >= `+e.outHeight+`.0 ||
              fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            int wRPerm = `+n+` - 1 - wR;

            for (int wC = 0; wC < `+r+`; wC++) {
              float dyC = float(dyCCorner + wC) / `+a+`.0;

              if (dyC < 0.0 || dyC >= `+e.outWidth+`.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              int wCPerm = `+r+` - 1 - wC;

              for (int d2 = 0; d2 < `+e.outChannels+`; d2++) {
                float xValue = getDy(batch, idyF, idyR, idyC, d2);
                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `},dD=function(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;var t=e.strideHeight,n=e.strideWidth,r=e.padInfo.top,o=e.padInfo.left,i=e.outChannels/e.inChannels;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int dm = coords.w;
        int d2 = d1 * `+i+` + dm;

        float dotProd = 0.0;

        // TO DO: Vec4 over the batch size
        for (int b = 0; b < `+e.batchSize+`; b++) {
          for (int yR = 0; yR < `+e.outHeight+`; yR++) {
            int xR = wR + yR * `+t+" - "+r+`;

            if (xR < 0 || xR >= `+e.inHeight+`) {
              continue;
            }

            for (int yC = 0; yC < `+e.outWidth+`; yC++) {
              int xC = wC + yC * `+n+" - "+o+`;

              if (xC < 0 || xC >= `+e.inWidth+`) {
                continue;
              }

              float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);
            }
          }
        }
        setOutput(dotProd);
      }
    `},fD=function(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;var t=e.filterHeight,n=e.filterWidth,r=e.strideHeight,o=e.strideWidth,i=t-1-e.padInfo.top,a=n-1-e.padInfo.left,s=e.outChannels/e.inChannels;this.userCode=`
      const ivec2 pads = ivec2(`+i+", "+a+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];
        ivec2 dyCorner = coords.yz - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        float dotProd = 0.0;

        for (int wR = 0; wR < `+t+`; wR++) {
          float dyR = float(dyRCorner + wR) / `+r+`.0;

          if (dyR < 0.0 || dyR >= `+e.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = `+t+` - 1 - wR;

          for (int wC = 0; wC < `+n+`; wC++) {
            float dyC = float(dyCCorner + wC) / `+o+`.0;

            if (dyC < 0.0 || dyC >= `+e.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = `+n+` - 1 - wC;

            // TO DO: Vec4 over the channelMul
            for (int dm = 0; dm < `+s+`; dm++) {
              int d2 = d1 * `+s+` + dm;
              float xValue = getDy(batch, idyR, idyC, d2);
              float wValue = getW(wRPerm, wCPerm, d1, dm);
              dotProd += xValue * wValue;
            }
          }
        }
        setOutput(dotProd);
      }
    `},By=function(e,t,n,r){t===void 0&&(t=!1),n===void 0&&(n=null),r===void 0&&(r=!1),this.variableNames=["x","W"],this.outputShape=e.outShape;var o=e.padInfo.top,i=e.padInfo.left,a=e.strideHeight,s=e.strideWidth,u=e.dilationHeight,l=e.dilationWidth,c=e.filterHeight,d=e.filterWidth,f=4*Math.floor(e.inChannels/4),h=e.inChannels%4,v=e.dataFormat==="channelsLast",m=v?1:2,g=v?2:3,p=v?3:1,y="",x="";n&&(y=r?`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          `+n+`
        }`:`
          float activation(float x) {
            `+n+`
          }
        `,x="result = activation(result);");var w=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+y+`

      const ivec2 strides = ivec2(`+a+", "+s+`);
      const ivec2 pads = ivec2(`+o+", "+i+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d2 = coords[`+p+`];

        ivec2 xRCCorner =
            ivec2(coords[`+m+"], coords["+g+`]) * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+c+`; wR++) {
          int xR = xRCorner + wR * `+u+`;

          if (xR < 0 || xR >= `+e.inHeight+`) {
            continue;
          }

          for (int wC = 0; wC < `+d+`; wC++) {
            int xC = xCCorner + wC * `+l+`;

            if (xC < 0 || xC >= `+e.inWidth+`) {
              continue;
            }

            for (int d1 = 0; d1 < `+f+`; d1 += 4) {
              vec4 wValues = vec4(
                getW(wR, wC, d1, d2),
                getW(wR, wC, d1 + 1, d2),
                getW(wR, wC, d1 + 2, d2),
                getW(wR, wC, d1 + 3, d2)
              );

              if (`+v+`) {
                vec4 xValues = vec4(
                  getX(batch, xR, xC, d1),
                  getX(batch, xR, xC, d1 + 1),
                  getX(batch, xR, xC, d1 + 2),
                  getX(batch, xR, xC, d1 + 3)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec4 xValues = vec4(
                  getX(batch, d1, xR, xC),
                  getX(batch, d1 + 1, xR, xC),
                  getX(batch, d1 + 2, xR, xC),
                  getX(batch, d1 + 3, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }
            }

            if (`+(h===1)+`) {

              if (`+v+`) {
                dotProd +=
                    getX(batch, xR, xC, `+f+`) *
                    getW(wR, wC, `+f+`, d2);
              } else {
                dotProd +=
                    getX(batch, `+f+`, xR, xC) *
                    getW(wR, wC, `+f+`, d2);
              }

            } else if (`+(h===2)+`) {
              vec2 wValues = vec2(
                getW(wR, wC, `+f+`, d2),
                getW(wR, wC, `+f+` + 1, d2)
              );

              if (`+v+`) {
                vec2 xValues = vec2(
                  getX(batch, xR, xC, `+f+`),
                  getX(batch, xR, xC, `+f+` + 1)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec2 xValues = vec2(
                  getX(batch, `+f+`, xR, xC),
                  getX(batch, `+f+` + 1, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            } else if (`+(h===3)+`) {
              vec3 wValues = vec3(
                getW(wR, wC, `+f+`, d2),
                getW(wR, wC, `+f+` + 1, d2),
                getW(wR, wC, `+f+` + 2, d2)
              );

              if (`+v+`) {
                vec3 xValues = vec3(
                  getX(batch, xR, xC, `+f+`),
                  getX(batch, xR, xC, `+f+` + 1),
                  getX(batch, xR, xC, `+f+` + 2)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec3 xValues = vec3(
                  getX(batch, `+f+`, xR, xC),
                  getX(batch, `+f+` + 1, xR, xC),
                  getX(batch, `+f+` + 2, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            }
          }
        }

        float result = dotProd;
        `+w+`
        `+x+`
        setOutput(result);
      }
    `},hD=function(e){this.variableNames=["x","W"],this.outputShape=e.outShape;var t=e.padInfo.front,n=e.padInfo.top,r=e.padInfo.left,o=e.strideDepth,i=e.strideHeight,a=e.strideWidth,s=e.dilationDepth,u=e.dilationHeight,l=e.dilationWidth,c=e.filterDepth,d=e.filterHeight,f=e.filterWidth,h=4*Math.floor(e.inChannels/4),v=e.inChannels%4;this.userCode=`
      const ivec3 strides = ivec3(`+o+", "+i+", "+a+`);
      const ivec3 pads = ivec3(`+t+", "+n+", "+r+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d2 = coords.u;

        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xFCorner = xFRCCorner.x;
        int xRCorner = xFRCCorner.y;
        int xCCorner = xFRCCorner.z;

        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get
        // y(yF, yR, yC, d2). ? = to be determined. : = across all
        // values in that axis.
        float dotProd = 0.0;
        for (int wF = 0; wF < `+c+`; wF++) {
          int xF = xFCorner + wF * `+s+`;

          if (xF < 0 || xF >= `+e.inDepth+`) {
            continue;
          }

          for (int wR = 0; wR < `+d+`; wR++) {
            int xR = xRCorner + wR * `+u+`;

            if (xR < 0 || xR >= `+e.inHeight+`) {
              continue;
            }

            for (int wC = 0; wC < `+f+`; wC++) {
              int xC = xCCorner + wC * `+l+`;

              if (xC < 0 || xC >= `+e.inWidth+`) {
                continue;
              }

              for (int d1 = 0; d1 < `+h+`; d1 += 4) {
                vec4 xValues = vec4(
                  getX(batch, xF, xR, xC, d1),
                  getX(batch, xF, xR, xC, d1 + 1),
                  getX(batch, xF, xR, xC, d1 + 2),
                  getX(batch, xF, xR, xC, d1 + 3)
                );
                vec4 wValues = vec4(
                  getW(wF, wR, wC, d1, d2),
                  getW(wF, wR, wC, d1 + 1, d2),
                  getW(wF, wR, wC, d1 + 2, d2),
                  getW(wF, wR, wC, d1 + 3, d2)
                );

                dotProd += dot(xValues, wValues);
              }

              if (`+(v===1)+`) {
                dotProd +=
                  getX(batch, xF, xR, xC, `+h+`) *
                  getW(wF, wR, wC, `+h+`, d2);
              } else if (`+(v===2)+`) {
                vec2 xValues = vec2(
                  getX(batch, xF, xR, xC, `+h+`),
                  getX(batch, xF, xR, xC, `+h+` + 1)
                );
                vec2 wValues = vec2(
                  getW(wF, wR, wC, `+h+`, d2),
                  getW(wF, wR, wC, `+h+` + 1, d2)
                );
                dotProd += dot(xValues, wValues);
              } else if (`+(v===3)+`) {
                vec3 xValues = vec3(
                  getX(batch, xF, xR, xC, `+h+`),
                  getX(batch, xF, xR, xC, `+h+` + 1),
                  getX(batch, xF, xR, xC, `+h+` + 2)
                );
                vec3 wValues = vec3(
                  getW(wF, wR, wC, `+h+`, d2),
                  getW(wF, wR, wC, `+h+` + 1, d2),
                  getW(wF, wR, wC, `+h+` + 2, d2)
                );
                dotProd += dot(xValues, wValues);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `},jy=function(e,t,n,r){t===void 0&&(t=!1),n===void 0&&(n=null),r===void 0&&(r=!1),this.variableNames=["x","W"],this.outputShape=e.outShape;var o=e.inHeight,i=e.inWidth,a=e.padInfo.top,s=e.padInfo.left,u=e.strideHeight,l=e.strideWidth,c=e.dilationHeight,d=e.dilationWidth,f=e.filterHeight,h=e.filterWidth,v=e.outChannels/e.inChannels,m="",g="";n&&(m=r?`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          `+n+`
        }`:`
          float activation(float x) {
            `+n+`
          }
        `,g="result = activation(result);");var p=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+m+`

      const ivec2 strides = ivec2(`+u+", "+l+`);
      const ivec2 pads = ivec2(`+a+", "+s+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / `+v+`;
        int q = d2 - d1 * `+v+`;

        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.
        for (int wR = 0; wR < `+f+`; wR++) {
          int xR = xRCorner + wR * `+c+`;

          if (xR < 0 || xR >= `+o+`) {
            continue;
          }

          for (int wC = 0; wC < `+h+`; wC++) {
            int xC = xCCorner + wC * `+d+`;

            if (xC < 0 || xC >= `+i+`) {
              continue;
            }

            float xVal = getX(batch, xR, xC, d1);
            float wVal = getW(wR, wC, d1, q);
            dotProd += xVal * wVal;
          }
        }

        float result = dotProd;
        `+p+`
        `+g+`
        setOutput(result);
      }
    `},Wy=function(e,t,n,r){t===void 0&&(t=!1),n===void 0&&(n=null),r===void 0&&(r=!1),this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e.outShape;for(var o=e.inHeight,i=e.inWidth,a=e.padInfo.top,s=e.padInfo.left,u=e.strideHeight,l=e.strideWidth,c=e.dilationHeight,d=e.dilationWidth,f=e.filterHeight,h=e.filterWidth,v=h,m="int xR; int xC; int xCOffset;",g=0;g<f;g++)for(var p=0;p<h;p++)m+=`
          vec4 xTexelR`+g+"C"+2*p+` = vec4(0.);
          vec4 wR`+g+"C"+p+` = vec4(0.);
          vec4 xR`+g+"C"+p+" = vec4(0.);";for(g=0;g<f;g++)for(var y=0;y<v;y++){if(m+=`
          xR = xRCorner + `+g*c+`;
          xC = xCCorner + `+(p=2*y)*d+`;
        `,l===1){if(p<h&&(m+=s%2==1?`
                xCOffset = xC + 1;
                if(xR >= 0 && xR < `+o+" && xCOffset >= 0 && xCOffset < "+i+`) {
                  xTexelR`+g+"C"+p+` = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if(xCOffset + 1 >= `+i+`) {
                    xTexelR`+g+"C"+p+`.zw = vec2(0.);
                  }
                } else {
                  xTexelR`+g+"C"+p+` = vec4(0.);
                }

                xCOffset = xC + 1 - 2;
                if(xR >= 0 && xR < `+o+" && xCOffset >= 0 && xCOffset < "+i+`) {
                  vec4 previous = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if(xCOffset + 1 >= `+i+`) {
                    previous.zw = vec2(0.);
                  }

                  xR`+g+"C"+p+" = vec4(previous.zw, xTexelR"+g+"C"+p+`.xy);
                } else {
                  xR`+g+"C"+p+" = vec4(0, 0, xTexelR"+g+"C"+p+`.xy);
                }
              `:`
                if(xR >= 0 && xR < `+o+" && xC >= 0 && xC < "+i+`) {
                  xTexelR`+g+"C"+p+` = getX(batch, xR, xC, d1);
                } else {
                  xTexelR`+g+"C"+p+` = vec4(0.);
                }

                xR`+g+"C"+p+" = xTexelR"+g+"C"+p+`;
              `,p+1<h)){var x=s%2==0?Mb(d):d;d%2==0&&s%2==1||d%2!=0&&s%2!=1?(m+=`
                  xCOffset = xC + `+s%2+" + "+x+`;

                  if(xR >= 0 && xR < `+o+` &&
                    xCOffset >= 0 && xCOffset < `+i+`) {
                    xTexelR`+g+"C"+(p+2)+` = getX(batch, xR, xCOffset, d1);
                  }
                `,d>1&&(m+=`
                    xCOffset -= 2;
                    if(xR >= 0 && xR < `+o+` &&
                      xCOffset >= 0 && xCOffset < `+i+`) {
                      xTexelR`+g+"C"+p+` = getX(batch, xR, xCOffset, d1);
                    } else {
                      xTexelR`+g+"C"+p+` = vec4(0.);
                    }
                  `),m+=`
                  xR`+g+"C"+(p+1)+` = vec4(
                    xTexelR`+g+"C"+p+".zw, xTexelR"+g+"C"+(p+2)+`.xy);
                `):m+=`
                  xCOffset = xC + `+x+`;

                  if(xR >= 0 && xR < `+o+` &&
                    xCOffset >= 0 && xCOffset < `+i+`) {
                    xTexelR`+g+"C"+(p+2)+` = getX(batch, xR, xCOffset, d1);
                  }

                  xR`+g+"C"+(p+1)+" = xTexelR"+g+"C"+(p+2)+`;
                `}}else p<h&&(m+=`
              if(xR >= 0 && xR < `+o+`) {
            `,s%2==1?(m+=`
                xCOffset = xC + 1 - `+l+`;
                if(xCOffset >= 0 && xCOffset < `+i+`) {
                  xTexelR`+g+"C"+p+` = getX(batch, xR, xCOffset, d1);
                } else {
                  xTexelR`+g+"C"+p+` = vec4(0.);
                }

                if(xC + 1 >= 0 && xC + 1 < `+i+`) {
                  xTexelR`+g+"C"+(p+2)+` = getX(batch, xR, xC + 1, d1);
                } else {
                  xTexelR`+g+"C"+(p+2)+` = vec4(0.);
                }

                xR`+g+"C"+p+` = vec4(
                  xTexelR`+g+"C"+p+".zw, xTexelR"+g+"C"+(p+2)+`.zw);
              `,p+1<h&&(m+=`
                  vec4 final = vec4(0.);
                  xCOffset = xC + 1 + `+l+`;
                  if(xCOffset >= 0 && xCOffset < `+i+`) {
                    final = getX(batch, xR, xCOffset, d1);
                  }
                  xR`+g+"C"+(p+1)+" = vec4(xTexelR"+g+"C"+(p+2)+`.xy, final.xy);
                `)):(m+=`
                if(xC >= 0 && xC < `+i+`) {
                  xTexelR`+g+"C"+p+` = getX(batch, xR, xC, d1);
                } else {
                  xTexelR`+g+"C"+p+` = vec4(0.);
                }

                xCOffset = xC + `+l+`;
                if(xCOffset >= 0 && xCOffset < `+i+`) {
                  xTexelR`+g+"C"+(p+2)+` = getX(batch, xR, xCOffset, d1);
                } else {
                  xTexelR`+g+"C"+(p+2)+` = vec4(0.);
                }

                xR`+g+"C"+p+` = vec4(
                  xTexelR`+g+"C"+p+".xy, xTexelR"+g+"C"+(p+2)+`.xy);
              `,p+1<h&&(m+=`
                  xR`+g+"C"+(p+1)+` = vec4(
                    xTexelR`+g+"C"+p+".zw, xTexelR"+g+"C"+(p+2)+`.zw);
                `)),m+="}");p<h&&(m+=`
            vec4 wTexelR`+g+"C"+p+" = getW("+g+", "+p+`, d1, q);
            wR`+g+"C"+p+" = vec4(wTexelR"+g+"C"+p+".xz, wTexelR"+g+"C"+p+`.xz);
          `,p+1<h&&(m+=`
              vec4 wTexelR`+g+"C"+(p+1)+" = getW("+g+", "+(p+1)+`, d1, q);
              wR`+g+"C"+(p+1)+` =
                vec4(wTexelR`+g+"C"+(p+1)+".xz, wTexelR"+g+"C"+(p+1)+".xz);"))}for(g=0;g<f;g++)for(p=0;p<h;p++)m+="dotProd += xR"+g+"C"+p+" * wR"+g+"C"+p+";";var w="",b="";n&&(w=r?`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          `+n+`
        }`:`vec4 activation(vec4 x) {
          `+n+`
        }`,b="result = activation(result);");var C=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+w+`

      const ivec2 strides = ivec2(`+u+", "+l+`);
      const ivec2 pads = ivec2(`+a+", "+s+`);

      void main() {

        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2;
        int q = 0;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        vec4 dotProd = vec4(0.);

        `+m+`

        vec4 result = dotProd;
        `+C+`
        `+b+`
        setOutput(result);
      }
    `},pD=function(e,t,n,r,o){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];var i=e[0],a=e[1],s=e[2],u=e[3],l=t[0],c=n[0],d=n[1];this.outputShape=[l,c,d,u];var f=r==="bilinear"?1:0,h=[a-1+".0",s-1+".0"],v=h[0],m=h[1],g=c>1?[""+(a-1)/(c-1),"(y2-y1) * height_ratio","y1*"+v+" + float(y)*(height_scale)"]:["0.0","0.0","0.5 * (y1+y2) * "+v],p=g[0],y=g[1],x=g[2],w=d>1?[""+(s-1)/(d-1),"(x2-x1) * width_ratio","x1*"+m+" + float(x)*(width_scale)"]:["0.0","0.0","0.5 * (x1+x2) * "+m],b=w[0],C=w[1],E=w[2];this.userCode=`
      const float height_ratio = float(`+p+`);
      const float width_ratio = float(`+b+`);
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int y = coords[1];
        int x = coords[2];
        int d = coords[3];

        // get box vals
        float y1 = getBoxes(b,0);
        float x1 = getBoxes(b,1);
        float y2 = getBoxes(b,2);
        float x2 = getBoxes(b,3);

        // get image in batch index
        int bInd = round(getBoxInd(b));
        if(bInd < 0 || bInd >= `+i+`) {
          return;
        }

        float height_scale = `+y+`;
        float width_scale = `+C+`;

        float in_y = `+x+`;
        if( in_y < 0.0 || in_y > `+v+` ) {
          setOutput(float(`+o+`));
          return;
        }
        float in_x = `+E+`;
        if( in_x < 0.0 || in_x > `+m+` ) {
          setOutput(float(`+o+`));
          return;
        }

        vec2 sourceFracIndexCR = vec2(in_x,in_y);
        if(`+f+` == 1) {
          // Compute the four integer indices.
          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);
          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));

          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);
          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);
          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);
          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);

          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);

          float top = topLeft + (topRight - topLeft) * fracCR.x;
          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;
          float newValue = top + (bottom - top) * fracCR.y;
          setOutput(newValue);
        } else {
          // Compute the coordinators of nearest neighbor point.
          ivec2 sourceNearestCR = ivec2(floor(
            sourceFracIndexCR + vec2(0.5,0.5)));
          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);
          setOutput(newValue);
        }
      }
    `},vD=function(e,t,n){this.variableNames=["x"],this.outputShape=e;var r=e.length,o=e[e.length-1],i=n?"<":">";this.userCode=`
      int getIndex(int i) {
        `+(n?"return "+o+" -i - 1;":"return i;")+`
      }

      void main() {
        `+je(r)+` coords = getOutputCoords();
        int end = `+zy(r,"coords")+`;
        float val = 0.0;
        for (int i = `+o+` - 1; i >= 0; i -= 1) {
          int idx = getIndex(i);
          if (idx `+i+` end) {
            continue;
          }
          if (idx == end && `+t+`) {
            continue;
          }
          `+zy(r,"coords")+` = idx;
          val += getX(`+function(a,s){if(a===1)return""+s;if(a===2)return s+".x, "+s+".y";if(a===3)return s+".x, "+s+".y, "+s+".z";if(a===4)return s+".x, "+s+".y, "+s+".z, "+s+".w";throw Error("Cumulative sum for rank "+a+" is not yet supported")}(r,"coords")+`);
        }
        setOutput(val);
      }
    `};function zy(e,t){if(e===1)return""+t;if(e===2)return t+".y";if(e===3)return t+".z";if(e===4)return t+".w";throw Error("Cumulative sum for rank "+e+" is not yet supported")}var mD=function(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=ru.DENSE;var t=As(e),n=Lt();this.outputShape=e,this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        `+pi(["r","c","d"],e)+`
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx *
          vec2(`+t[0]+", "+t[1]+`));
        int index = 4 * (resTexRC.x * `+t[1]+` + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getA(rc.x, rc.y, rc.z);
        }

        `+n.output+` = result;
      }
    `},gD=function(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=ru.DENSE;var t=As(e),n=Lt();this.outputShape=e,this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        `+pi(["r","c","d"],e)+`
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx *
          vec2(`+t[0]+", "+t[1]+`));
        int index = 4 * (resTexRC.x * `+t[1]+` + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));
        }

        `+n.output+` = result;
      }
    `},yD=function(){function e(t,n,r){this.variableNames=["x"],this.outputShape=[],this.outputShape=t,this.blockSize=n,this.dataFormat=r,this.userCode=`
    void main() {
      ivec4 coords = getOutputCoords();
      int b = coords[0];
      int h = `+this.getHeightCoordString()+`;
      int w = `+this.getWidthCoordString()+`;
      int d = `+this.getDepthCoordString()+`;

      int in_h = h / `+n+`;
      int offset_h = imod(h, `+n+`);
      int in_w = w / `+n+`;
      int offset_w = imod(w, `+n+`);
      int offset_d = (offset_h * `+n+` + offset_w) *
        `+this.getOutputDepthSize()+`;
      int in_d = d + offset_d;

      float result = `+this.getInputSamplingString()+`;
      setOutput(result);
    }
  `}return e.prototype.getHeightCoordString=function(){return this.dataFormat==="NHWC"?"coords[1]":"coords[2]"},e.prototype.getWidthCoordString=function(){return this.dataFormat==="NHWC"?"coords[2]":"coords[3]"},e.prototype.getDepthCoordString=function(){return this.dataFormat==="NHWC"?"coords[3]":"coords[1]"},e.prototype.getOutputDepthSize=function(){return this.dataFormat==="NHWC"?this.outputShape[3]:this.outputShape[1]},e.prototype.getInputSamplingString=function(){return this.dataFormat==="NHWC"?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"},e}(),xD=function(e){this.variableNames=["X"],this.outputShape=[e,e],this.userCode=`
      void main() {
          ivec2 coords = getOutputCoords();
          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;
          setOutput(val);
      }
    `},wD=function(e){this.variableNames=["A"],this.outTexUsage=gn.DOWNLOAD;var t=Lt();this.outputShape=e,this.userCode=`
      `+p2+`

      void main() {
        float x = getAAtOutCoords();
        `+t.output+` = encode_float(x);
      }
    `},bD=function(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=gn.DOWNLOAD;var t=Lt();this.outputShape=e,this.userCode=`
      `+p2+`

      void main() {
        ivec3 coords = getOutputCoords();
        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));
        `+t.output+` = encode_float(x);
      }
    `},CD=function(e,t,n){n===void 0&&(n=!1),this.variableNames=["A"];var r=Lt(),o=t[0],i=t[1];this.outputShape=e;var a="result";n&&(a="floor(result * 255. + 0.5)"),this.userCode=`
      `+Dv(e)+`

      void main() {
        ivec3 coords = getOutputCoords();

        int flatIndex = getFlatIndex(coords);
        int offset = imod(flatIndex, 4);

        flatIndex = idiv(flatIndex, 4, 1.);
        
        int r = flatIndex / `+i+`;
        int c = imod(flatIndex, `+i+`);
        vec2 uv = (vec2(c, r) + halfCR) / vec2(`+i+".0, "+o+`.0);
        vec4 values = `+r.texture2D+`(A, uv);

        float result;

        if(offset == 0) {
          result = values[0];
        } else if(offset == 1) {
          result = values[1];
        } else if(offset == 2) {
          result = values[2];
        } else {
          result = values[3];
        }

        `+r.output+" = vec4("+a+`, 0., 0., 0.);
      }
    `},ED=function(e,t,n){n===void 0&&(n=!1),this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var r=Lt(),o=t[0],i=t[1];this.outputShape=e;var a="",s="result";n&&(s="floor(result * 255. + 0.5)");for(var u=0;u<=1;u++)for(var l=0;l<=1;l++){var c=2*u+l;a+=`
          localCoords = coords;
          if(localCoords[2] + `+l+" < "+e[2]+`) {
            localCoords[2] += `+l+`;
            if(localCoords[1] + `+u+" < "+e[1]+`) {
              localCoords[1] += `+u+`;

              flatIndex = getFlatIndex(localCoords);
              offset = imod(flatIndex, 4);

              flatIndex = idiv(flatIndex, 4, 1.);

              r = flatIndex / `+i+`;
              c = imod(flatIndex, `+i+`);
              uv = (vec2(c, r) + halfCR) / vec2(`+i+".0, "+o+`.0);
              values = `+r.texture2D+`(A, uv);

              if(offset == 0) {
                result[`+c+`] = values[0];
              } else if(offset == 1) {
                result[`+c+`] = values[1];
              } else if(offset == 2) {
                result[`+c+`] = values[2];
              } else {
                result[`+c+`] = values[3];
              }
            }
          }
        `}this.userCode=`
      `+Dv(e)+`

      void main() {
        ivec3 coords = getOutputCoords();

        vec4 result = vec4(0.);
        int flatIndex, r, c, offset;
        ivec3 localCoords;
        vec2 uv;
        vec4 values;

        `+a+`

        `+r.output+" = "+s+`;
      }
    `},_D="return real * expR - imag * expI;",SD="return real * expI + imag * expR;",Uy=function(e,t,n){this.variableNames=["real","imag"];var r=t[1];this.outputShape=t;var o=n?"2.0 * "+Math.PI:"-2.0 * "+Math.PI,i=n?r+".0":"1.0";this.userCode=`
      const float exponentMultiplier = `+o+`;

      float unaryOpComplex(float real, float expR, float imag, float expI) {
        `+e+`
      }

      float mulMatDFT(int batch, int index) {
        float indexRatio = float(index) / float(`+r+`);
        float exponentMultiplierTimesIndexRatio =
            exponentMultiplier * indexRatio;

        float result = 0.0;

        for (int i = 0; i < `+r+`; i++) {
          // x = (-2|2 * PI / N) * index * i;
          float x = exponentMultiplierTimesIndexRatio * float(i);
          float expR = cos(x);
          float expI = sin(x);
          float real = getReal(batch, i);
          float imag = getImag(batch, i);

          result +=
              unaryOpComplex(real, expR, imag, expI) / `+i+`;
        }

        return result;
      }

      void main() {
        ivec2 coords = getOutputCoords();
        setOutput(mulMatDFT(coords[0], coords[1]));
      }
    `},kD=function(){function e(t,n){this.outputShape=[],this.variableNames=["x"],this.outputShape=t,this.userCode=`
      uniform float value;
      void main() {
        // Input can be obtained from uniform value.
        setOutput(value);
      }
    `}return e.prototype.getCustomSetupFunc=function(t){var n=this;return function(r,o){n.valueLoc==null&&(n.valueLoc=r.getUniformLocationNoThrow(o,"value")),r.gl.uniform1f(n.valueLoc,t)}},e}(),RD=function(e,t,n){this.variableNames=["A","indices"];var r=e.slice();r[n]=t,this.outputShape=r,this.rank=r.length;var o=je(this.rank),i=function(a,s){var u=a.length;if(u>4)throw Error("Gather for rank "+u+" is not yet supported");if(u===1)return"int(getIndices(resRC))";for(var l=["resRC.x","resRC.y","resRC.z","resRC.w"],c=[],d=0;d<a.length;d++)d===s?c.push("int(getIndices("+l[d]+"))"):c.push(""+l[d]);return c.join()}(e,n);this.userCode=`
      void main() {
        `+o+` resRC = getOutputCoords();
        setOutput(getA(`+i+`));
      }
    `},ND=function(e,t,n){this.sliceDim=e,this.strides=t,this.variableNames=["x","indices"],this.outputShape=n;var r=je(t.length),o=je(n.length),i=this.sliceDim>1?"strides[j]":"strides";this.userCode=`
        `+r+" strides = "+r+"("+this.strides+`);
         void main() {
          `+o+` coords = getOutputCoords();
          int flattenIndex = 0;
          for (int j = 0; j < `+this.sliceDim+`; j++) {
            int index = round(getIndices(coords[0], j));
            flattenIndex += index * `+i+`;
          }
          setOutput(getX(flattenIndex, coords[1]));
        }
      `};function ID(e,t){var n=Lt();return _A(e,t,n.version+`
    precision highp float;
    `+n.attribute+` vec3 clipSpacePos;
    `+n.attribute+` vec2 uv;
    `+n.varyingVs+` vec2 resultUV;

    void main() {
      gl_Position = vec4(clipSpacePos, 1);
      resultUV = uv;
    }`)}function TD(e,t){return IA(e,t,new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]))}function AD(e,t){return TA(e,t,new Uint16Array([0,1,2,2,1,3]))}function bu(e,t,n,r,o,i,a){PA(n,r);var s=AA(e,t),u=e.TEXTURE_2D;return ue(e,t,function(){return e.bindTexture(u,s)}),ue(e,t,function(){return e.texParameteri(u,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE)}),ue(e,t,function(){return e.texParameteri(u,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE)}),ue(e,t,function(){return e.texParameteri(u,e.TEXTURE_MIN_FILTER,e.NEAREST)}),ue(e,t,function(){return e.texParameteri(u,e.TEXTURE_MAG_FILTER,e.NEAREST)}),ue(e,t,function(){return e.texImage2D(u,0,o,n,r,0,i,a,null)}),ue(e,t,function(){return e.bindTexture(e.TEXTURE_2D,null)}),s}function PD(e,t,n,r,o){var i=ud(n,r);return bu(e,t,i[0],i[1],o.internalFormatFloat,o.textureFormatFloat,e.FLOAT)}function DD(e,t,n,r,o){var i=ud(n,r);return bu(e,t,i[0],i[1],o.internalFormatHalfFloat,o.textureFormatFloat,o.textureTypeHalfFloat)}function FD(e,t,n,r,o){var i=ud(n,r);return bu(e,t,i[0],i[1],e.RGBA,e.RGBA,e.UNSIGNED_BYTE)}function MD(e,t,n,r,o){var i=wu(n,r);return bu(e,t,i[0],i[1],o.internalFormatPackedFloat,e.RGBA,e.FLOAT)}function OD(e,t,n,r,o){var i=wu(n,r);return bu(e,t,i[0],i[1],o.internalFormatPackedHalfFloat,e.RGBA,o.textureTypeHalfFloat)}function LD(e,t,n,r){return ue(e,t,function(){return e.bindBuffer(e.ARRAY_BUFFER,r)}),Iy(e,t,n,"clipSpacePos",r,3,20,0)&&Iy(e,t,n,"uv",r,2,20,12)}function BD(e,t,n,r,o,i,a){var s,u,l;ue(e,t,function(){return e.bindTexture(e.TEXTURE_2D,n)}),i instanceof Uint8Array?(s=new Uint8Array(r*o*4),u=e.UNSIGNED_BYTE,l=e.RGBA):(s=new Float32Array(r*o*4),u=e.FLOAT,l=a.internalFormatPackedFloat),s.set(i),ue(e,t,function(){return e.texImage2D(e.TEXTURE_2D,0,l,r,o,0,e.RGBA,u,s)}),ue(e,t,function(){return e.bindTexture(e.TEXTURE_2D,null)})}function jD(e,t,n,r){ue(e,t,function(){return e.bindTexture(e.TEXTURE_2D,n)}),r.data instanceof Uint8Array?ue(e,t,function(){return e.texImage2D(e.TEXTURE_2D,0,e.RGBA,r.width,r.height,0,e.RGBA,e.UNSIGNED_BYTE,r.data)}):ue(e,t,function(){return e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,r)}),ue(e,t,function(){return e.bindTexture(e.TEXTURE_2D,null)})}function WD(e,t,n,r,o){var i=e.createBuffer();ue(e,t,function(){return e.bindBuffer(e.PIXEL_PACK_BUFFER,i)});var a=16*n*r;return ue(e,t,function(){return e.bufferData(e.PIXEL_PACK_BUFFER,a,e.STREAM_READ)}),ue(e,t,function(){return e.readPixels(0,0,r,n,e.RGBA,e.FLOAT,0)}),ue(e,t,function(){return e.bindBuffer(e.PIXEL_PACK_BUFFER,null)}),i}function zD(e,t,n){var r=e,o=new Float32Array(n);return r.bindBuffer(r.PIXEL_PACK_BUFFER,t),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,o),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),o}function UD(e,t,n,r,o){var i=ud(n,r),a=i[0],s=i[1],u=new Uint8Array(n*r*4);return ue(e,t,function(){return e.readPixels(0,0,a,s,o.downloadTextureFormat,e.UNSIGNED_BYTE,u)}),new Float32Array(u.buffer)}function $D(e,t,n,r,o,i,a,s){var u=e,l=new Float32Array(function(c,d){var f=wu(c,d);return f[0]*f[1]*4}(i,a));return u.bindBuffer(u.PIXEL_PACK_BUFFER,t),u.getBufferSubData(u.PIXEL_PACK_BUFFER,0,l),u.bindBuffer(u.PIXEL_PACK_BUFFER,null),l}function VD(e,t,n,r){var o=new Float32Array(n*r*4);return ue(e,t,function(){return e.readPixels(0,0,r,n,e.RGBA,e.FLOAT,o)}),o}var HD=function(){function e(t){this.outputTexture=null,this.program=null,this.disposed=!1,this.vertexAttrsAreBound=!1,this.itemsToPoll=[];var n=H().getNumber("WEBGL_VERSION");t!=null?(this.gl=t,xA(n,t)):this.gl=Pr(n);var r="WEBGL_color_buffer_float";if(H().getNumber("WEBGL_VERSION")===1){if(this.textureFloatExtension=Zu(this.gl,this.debug,"OES_texture_float"),Dn(this.gl,"OES_texture_half_float"))this.textureHalfFloatExtension=Zu(this.gl,this.debug,"OES_texture_half_float");else if(H().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(r),Dn(this.gl,"EXT_color_buffer_half_float"))this.colorBufferHalfFloatExtension=Zu(this.gl,this.debug,"EXT_color_buffer_half_float");else if(H().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(r="EXT_color_buffer_float",Dn(this.gl,r))this.colorBufferFloatExtension=this.gl.getExtension(r);else{if(!Dn(this.gl,"EXT_color_buffer_half_float"))throw new Error("GL context does not support color renderable floats");this.colorBufferHalfFloatExtension=this.gl.getExtension("EXT_color_buffer_half_float")}this.vertexBuffer=TD(this.gl,this.debug),this.indexBuffer=AD(this.gl,this.debug),this.framebuffer=DA(this.gl,this.debug),this.textureConfig=Ev(this.gl,this.textureHalfFloatExtension)}return Object.defineProperty(e.prototype,"debug",{get:function(){return H().getBool("DEBUG")},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){var t=this;if(!this.disposed){this.program!=null&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),this.outputTexture!=null&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");var n=this.gl;ue(n,this.debug,function(){return n.finish()}),ue(n,this.debug,function(){return n.bindFramebuffer(n.FRAMEBUFFER,null)}),ue(n,this.debug,function(){return n.deleteFramebuffer(t.framebuffer)}),ue(n,this.debug,function(){return n.bindBuffer(n.ARRAY_BUFFER,null)}),ue(n,this.debug,function(){return n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,null)}),ue(n,this.debug,function(){return n.deleteBuffer(t.indexBuffer)}),this.disposed=!0}},e.prototype.createFloat32MatrixTexture=function(t,n){return this.throwIfDisposed(),PD(this.gl,this.debug,t,n,this.textureConfig)},e.prototype.createFloat16MatrixTexture=function(t,n){return this.throwIfDisposed(),DD(this.gl,this.debug,t,n,this.textureConfig)},e.prototype.createUnsignedBytesMatrixTexture=function(t,n){return this.throwIfDisposed(),FD(this.gl,this.debug,t,n,this.textureConfig)},e.prototype.uploadPixelDataToTexture=function(t,n){this.throwIfDisposed(),jD(this.gl,this.debug,t,n)},e.prototype.uploadDenseMatrixToTexture=function(t,n,r,o){this.throwIfDisposed(),BD(this.gl,this.debug,t,n,r,o,this.textureConfig)},e.prototype.createFloat16PackedMatrixTexture=function(t,n){return this.throwIfDisposed(),OD(this.gl,this.debug,t,n,this.textureConfig)},e.prototype.createPackedMatrixTexture=function(t,n){return this.throwIfDisposed(),MD(this.gl,this.debug,t,n,this.textureConfig)},e.prototype.deleteMatrixTexture=function(t){var n=this;this.throwIfDisposed(),this.outputTexture===t&&(Ty(this.gl,this.debug,this.framebuffer),this.outputTexture=null),ue(this.gl,this.debug,function(){return n.gl.deleteTexture(t)})},e.prototype.downloadByteEncodedFloatMatrixFromOutputTexture=function(t,n,r){var o=this;return this.downloadMatrixDriver(t,function(){return UD(o.gl,o.debug,n,r,o.textureConfig)})},e.prototype.downloadPackedMatrixFromBuffer=function(t,n,r,o,i,a){return $D(this.gl,t,0,0,0,i,a,this.textureConfig)},e.prototype.downloadFloat32MatrixFromBuffer=function(t,n){return zD(this.gl,t,n)},e.prototype.createBufferFromTexture=function(t,n,r){this.bindTextureToFrameBuffer(t);var o=WD(this.gl,this.debug,n,r,this.textureConfig);return this.unbindTextureToFrameBuffer(),o},e.prototype.createAndWaitForFence=function(){var t=this.createFence(this.gl);return this.pollFence(t)},e.prototype.createFence=function(t){var n,r,o=this;if(H().getBool("WEBGL_FENCE_API_ENABLED")){var i=t,a=i.fenceSync(i.SYNC_GPU_COMMANDS_COMPLETE,0);t.flush(),r=function(){var s=i.clientWaitSync(a,0,0);return s===i.ALREADY_SIGNALED||s===i.CONDITION_SATISFIED},n=a}else H().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(n=this.beginQuery(),this.endQuery(),r=function(){return o.isQueryAvailable(n,H().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}):r=function(){return!0};return{query:n,isFencePassed:r}},e.prototype.downloadMatrixFromPackedTexture=function(t,n,r){var o=this;return this.downloadMatrixDriver(t,function(){return VD(o.gl,o.debug,n,r)})},e.prototype.createProgram=function(t){this.throwIfDisposed();var n=this.gl,r=SA(n,this.debug,t),o=ID(n,this.debug),i=RA(n,this.debug);return ue(n,this.debug,function(){return n.attachShader(i,o)}),ue(n,this.debug,function(){return n.attachShader(i,r)}),NA(n,this.debug,i),this.debug&&ff(n,this.debug,i),this.vertexAttrsAreBound||(this.setProgram(i),this.vertexAttrsAreBound=LD(n,this.debug,this.program,this.vertexBuffer)),i},e.prototype.deleteProgram=function(t){var n=this;this.throwIfDisposed(),t===this.program&&(this.program=null),t!=null&&ue(this.gl,this.debug,function(){return n.gl.deleteProgram(t)})},e.prototype.setProgram=function(t){var n=this;this.throwIfDisposed(),this.program=t,this.program!=null&&this.debug&&ff(this.gl,this.debug,this.program),ue(this.gl,this.debug,function(){return n.gl.useProgram(t)})},e.prototype.getUniformLocation=function(t,n,r){return r===void 0&&(r=!0),this.throwIfDisposed(),r?MA(this.gl,this.debug,t,n):OA(this.gl,t,n)},e.prototype.getAttributeLocation=function(t,n){var r=this;return this.throwIfDisposed(),ue(this.gl,this.debug,function(){return r.gl.getAttribLocation(t,n)})},e.prototype.getUniformLocationNoThrow=function(t,n){return this.throwIfDisposed(),this.gl.getUniformLocation(t,n)},e.prototype.setInputMatrixTexture=function(t,n,r){this.throwIfDisposed(),this.throwIfNoProgram(),LA(this.gl,this.debug,this.program,t,n,r)},e.prototype.setOutputMatrixTexture=function(t,n,r){this.setOutputMatrixTextureDriver(t,r,n)},e.prototype.setOutputPackedMatrixTexture=function(t,n,r){this.throwIfDisposed();var o=wu(n,r),i=o[0],a=o[1];this.setOutputMatrixTextureDriver(t,i,a)},e.prototype.setOutputMatrixWriteRegion=function(t,n,r,o){this.setOutputMatrixWriteRegionDriver(r,t,o,n)},e.prototype.setOutputPackedMatrixWriteRegion=function(t,n,r,o){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")},e.prototype.debugValidate=function(){this.program!=null&&ff(this.gl,this.debug,this.program),el(this.gl)},e.prototype.executeProgram=function(){this.throwIfDisposed(),this.throwIfNoProgram();var t=this.gl;this.debug&&this.debugValidate(),ue(t,this.debug,function(){return t.drawElements(t.TRIANGLES,6,t.UNSIGNED_SHORT,0)})},e.prototype.blockUntilAllProgramsCompleted=function(){var t=this;this.throwIfDisposed(),ue(this.gl,this.debug,function(){return t.gl.finish()})},e.prototype.getQueryTimerExtension=function(){return this.disjointQueryTimerExtension==null&&(this.disjointQueryTimerExtension=Zu(this.gl,this.debug,H().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension},e.prototype.getQueryTimerExtensionWebGL2=function(){return this.getQueryTimerExtension()},e.prototype.getQueryTimerExtensionWebGL1=function(){return this.getQueryTimerExtension()},e.prototype.beginQuery=function(){if(H().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){var t=this.gl,n=this.getQueryTimerExtensionWebGL2(),r=t.createQuery();return t.beginQuery(n.TIME_ELAPSED_EXT,r),r}var o=this.getQueryTimerExtensionWebGL1(),i=o.createQueryEXT();return o.beginQueryEXT(o.TIME_ELAPSED_EXT,i),i},e.prototype.endQuery=function(){if(H().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")!==2){var t=this.getQueryTimerExtensionWebGL1();t.endQueryEXT(t.TIME_ELAPSED_EXT)}else{var n=this.gl,r=this.getQueryTimerExtensionWebGL2();n.endQuery(r.TIME_ELAPSED_EXT)}},e.prototype.waitForQueryAndGetTime=function(t){return oe(this,void 0,void 0,function(){var n=this;return ie(this,function(r){switch(r.label){case 0:return[4,Ey(function(){return n.disposed||n.isQueryAvailable(t,H().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))})];case 1:return r.sent(),[2,this.getQueryTime(t,H().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))]}})})},e.prototype.getQueryTime=function(t,n){if(n===0)return null;if(n===2){var r=this.gl;return r.getQueryParameter(t,r.QUERY_RESULT)/1e6}var o=this.getQueryTimerExtensionWebGL1();return o.getQueryObjectEXT(t,o.QUERY_RESULT_EXT)/1e6},e.prototype.isQueryAvailable=function(t,n){if(n===0)return!0;if(n===2){var r=this.gl,o=this.getQueryTimerExtensionWebGL2(),i=r.getQueryParameter(t,r.QUERY_RESULT_AVAILABLE);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(o.GPU_DISJOINT_EXT)),i&&!this.disjoint}return i=(o=this.getQueryTimerExtensionWebGL1()).getQueryObjectEXT(t,o.QUERY_RESULT_AVAILABLE_EXT),this.disjoint==null&&(this.disjoint=this.gl.getParameter(o.GPU_DISJOINT_EXT)),i&&!this.disjoint},e.prototype.pollFence=function(t){var n=this;return new Promise(function(r){n.addItemToPoll(function(){return t.isFencePassed()},function(){return r()})})},e.prototype.pollItems=function(){for(var t=function(r){for(var o=0;o<r.length&&r[o]();++o);return o-1}(this.itemsToPoll.map(function(r){return r.isDoneFn})),n=0;n<=t;++n)(0,this.itemsToPoll[n].resolveFn)();this.itemsToPoll=this.itemsToPoll.slice(t+1)},e.prototype.addItemToPoll=function(t,n){var r=this;this.itemsToPoll.push({isDoneFn:t,resolveFn:n}),this.itemsToPoll.length>1||Ey(function(){return r.pollItems(),r.itemsToPoll.length===0})},e.prototype.bindTextureToFrameBuffer=function(t){this.throwIfDisposed(),hf(this.gl,this.debug,t,this.framebuffer),this.debug&&el(this.gl)},e.prototype.unbindTextureToFrameBuffer=function(){this.outputTexture!=null?(hf(this.gl,this.debug,this.outputTexture,this.framebuffer),this.debug&&el(this.gl)):Ty(this.gl,this.debug,this.framebuffer)},e.prototype.downloadMatrixDriver=function(t,n){this.bindTextureToFrameBuffer(t);var r=n();return this.unbindTextureToFrameBuffer(),r},e.prototype.setOutputMatrixTextureDriver=function(t,n,r){this.throwIfDisposed();var o=this.gl;hf(o,this.debug,t,this.framebuffer),this.debug&&el(o),this.outputTexture=t,ue(o,this.debug,function(){return o.viewport(0,0,n,r)}),ue(o,this.debug,function(){return o.scissor(0,0,n,r)})},e.prototype.setOutputMatrixWriteRegionDriver=function(t,n,r,o){var i=this;this.throwIfDisposed(),ue(this.gl,this.debug,function(){return i.gl.scissor(t,n,r,o)})},e.prototype.throwIfDisposed=function(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")},e.prototype.throwIfNoProgram=function(){if(this.program==null)throw new Error("No GPU program is currently set.")},e}();function $y(e,t){if(e.length!==t.length)throw Error("Binary was compiled with "+e.length+" inputs, but was executed with "+t.length+" inputs");e.forEach(function(n,r){var o=n.logicalShape,i=t[r],a=i.shape;if(!xt(o,a))throw Error("Binary was compiled with different shapes than the current args. Shapes "+o+" and "+a+" must match");if(!n.isUniform||!i.isUniform){var s=n.texShape,u=i.isUniform?null:i.texData.texShape;if(!xt(s,u))throw Error("Binary was compiled with different texture shapes than the current args. Shape "+s+" and "+u+" must match")}})}var GD=function(e,t,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e;for(var r=n.filterWidth,o=n.inChannels,i=n.strideWidth,a=n.strideHeight,s=n.padInfo,u=n.outWidth,l=n.dilationWidth,c=n.dilationHeight,d=n.dataFormat,f=s.left,h=s.top,v=o*r,m=Lt(),g=d==="channelsLast",p=g?0:1,y=g?1:2,x="",w=0;w<=1;w++)for(var b=0;b<=1;b++)x+=`
          blockIndex = rc.y + `+b+`;
          pos = rc.x + `+w+`;

          if(blockIndex < `+e[1]+" && pos < "+e[0]+`) {
            offsetY = int(blockIndex / (`+u+")) * "+a+" - "+h+`;
            d0 = offsetY + `+c+" * (pos / "+v+`);

            if(d0 < `+t[p]+` && d0 >= 0) {

              offsetX = int(mod(float(blockIndex), `+u+".) * "+i+". - "+f+`.);
              d1 = offsetX + `+l+" * (int(mod(float(pos), "+v+".) / "+o+`.));

              if(d1 < `+t[y]+` && d1 >= 0) {

                ch = int(mod(float(pos), `+o+`.));

                if (`+g+`) {
                  innerDims = vec2(d1, ch);
                  result[`+(2*w+b)+`] = getChannel(
                    getA(d0, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                } else {
                  innerDims = vec2(d0, d1);
                  result[`+(2*w+b)+`] = getChannel(
                    getA(ch, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                }
              }
            }
          }
        `;this.userCode=`
      void main() {
        ivec2 rc = getOutputCoords();

        vec4 result = vec4(0);

        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
        vec2 innerDims;

        `+x+`

        `+m.output+` = result;
      }
    `},qD=function(e,t,n,r,o){this.variableNames=["x"],this.outputShape=[];var i,a=t,s=e[3]-1;this.outputShape=e;var u="float("+n+") + float("+r+") * sum";i=o===.5?"inversesqrt("+u+")":o===1?"1.0/("+u+")":"exp(log("+u+") * float(-"+o+"));",this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];
        int d = coords[3];
        float x = getX(b, r, c, d);
        float sum = 0.0;
        for (int j = -`+a+"; j <= "+a+`; j++) {
          int idx = d + j;
          if (idx >= 0 && idx <=  `+s+`) {
            float z = getX(b, r, c, idx);
            sum += z * z;
          }
        }
        float val = x * `+i+`;
        setOutput(val);
      }
    `},KD=function(e,t,n,r,o){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=e,this.depth=e[3],this.depthRadius=t,this.bias=n,this.alpha=r,this.beta=o,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];

        float result = 0.0;
        for (int d = 0; d < `+this.depth+`; ++d) {
          int depthBegin = int(max(0.0, float(d - `+t+`)));
          int depthEnd = int(min(float(`+this.depth+`),
              float(d + `+t+` + 1)));

          const int MIN_DEPTH_BEGIN = 0;
          const int MAX_DEPTH_END = `+this.depth+`;

          float norm = 0.0;
          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd) {
              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);
            }
            else {
              break;
            }
          }

          norm = float(`+r+") * norm + float("+n+`);

          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd){
              float dyi = -2.0 * float(`+r+`)
                * float(`+o+`)
                * getInputImage(b ,r ,c, k) * getOutputImage(b, r, c, d)
                / norm;
              if (k == d) {
                dyi += pow(norm, -1.0 * `+o+`);
              }
              if (k == coords[3]) {
                dyi *= getDy(b, r, c, d);
                result += dyi;
              }
            }
            else {
              break;
            }
          }
      }
      setOutput(result);
      }
    `},XD=function(e,t,n,r,o){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;var i,a=t,s=e[3]-1;this.outputShape=e;var u="float("+n+") + float("+r+") * sum";i=o===.5?"inversesqrt("+u+")":o===1?"1.0/("+u+")":"exp(log("+u+") * float(-"+o+"));",this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords.x;
        int r = coords.y;
        int c = coords.z;
        int d = coords.w;

        bool hasNextCol = d < `+this.outputShape[3]+`;
        bool hasNextRow = c < `+this.outputShape[2]+`;

        vec4 sum = vec4(0.);
        vec4 xFragAtOutputCoords = getX(b, r, c, d);

        vec4 xAtOutputCoords = vec4(
          getChannel(xFragAtOutputCoords, vec2(c, d)),
          hasNextCol ?
            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,
          hasNextRow ?
            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,
          (hasNextRow && hasNextCol) ?
            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0
        );

        int firstChannel = d - `+a+`;
        vec2 cache = vec2(0.);
        if(firstChannel >= 0){
          vec4 firstChannelFrag = getX(b, r, c, firstChannel);
          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));
            if(hasNextRow){
              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));
            }
        }

        ivec2 depth = ivec2(d, d + 1);
        for (int j = - `+a+"; j <= "+a+`; j++) {
          ivec2 idx = depth + j;
          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));
          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(`+s+`));

          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;
          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;

          if(depthInRange || depthPlusOneInRange){
            vec4 z = vec4(0.);
            vec4 xFragAtCurrentDepth;
            z.xz = cache.xy;
            if(depthPlusOneInRange && hasNextCol){
              xFragAtCurrentDepth = idx.y != d ?
                getX(b, r, c, idx.y) : xFragAtOutputCoords;
              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));
              if(hasNextRow){
                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));
              }
            }
            cache.xy = z.yw;
            sum += z * z;
          }
        }
        vec4 result = xAtOutputCoords * `+i+`;
        setOutput(result);
      }
    `},YD=function(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;var t=e.strideHeight,n=e.strideWidth,r=e.dilationHeight,o=e.effectiveFilterHeight,i=e.effectiveFilterWidth,a=o-1-e.padInfo.top,s=i-1-e.padInfo.left,u=o*i-1;this.userCode=`
      const ivec2 pads = ivec2(`+a+", "+s+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+o+`;
          wR += `+r+`) {
          float dyR = float(dyRCorner + wR) / `+t+`.0;

          if (dyR < 0.0 || dyR >= `+e.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < `+i+`; wC++) {
            float dyC = float(dyCCorner + wC) / `+n+`.0;

            if (dyC < 0.0 || dyC >= `+e.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);
            int maxPosValue = `+u+` - int(getMaxPos(b, idyR, idyC, d));

            // Get the current value, check it against the value from the
            // position matrix.
            int curPosValue = wR * `+i+` + wC;
            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

            dotProd += dyValue * mask;
          }
        }
        setOutput(dotProd);
      }
    `},QD=function(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;var t=e.strideDepth,n=e.strideHeight,r=e.strideWidth,o=e.dilationDepth,i=e.dilationHeight,a=e.dilationWidth,s=e.effectiveFilterDepth,u=e.effectiveFilterHeight,l=e.effectiveFilterWidth,c=s-1-e.padInfo.front,d=u-1-e.padInfo.top,f=l-1-e.padInfo.left,h=s*u*l-1;this.userCode=`
      const ivec3 pads = ivec3(`+c+", "+d+", "+f+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < `+s+`;
           wD += `+o+`) {
          float dyD = float(dyDCorner + wD) / `+t+`.0;

          if (dyD < 0.0 || dyD >= `+e.outDepth+`.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < `+u+`;
              wR += `+i+`) {
            float dyR = float(dyRCorner + wR) / `+n+`.0;

            if (dyR < 0.0 || dyR >= `+e.outHeight+`.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < `+l+`;
                wC += `+a+`) {
              float dyC = float(dyCCorner + wC) / `+r+`.0;

              if (dyC < 0.0 || dyC >= `+e.outWidth+`.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);
              int maxPosValue = `+h+` -
                  int(getMaxPos(batch, idyD, idyR, idyC, ch));

              // Get the current value, check it against the value from the
              // position matrix.
              int curPosValue =
                  wD * `+u+" * "+l+` +
                  wR * `+l+` + wC;
              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

              dotProd += dyValue * mask;
            }
          }
        }
        setOutput(dotProd);
      }
    `},yf=function(e,t,n,r,o,i,a){n===void 0&&(n=!1),r===void 0&&(r=!1),o===void 0&&(o=!1),i===void 0&&(i=null),a===void 0&&(a=!1),this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t;var s=n?e[1]:e[2],u=Math.ceil(s/2),l=n?"i * 2, rc.y":"rc.y, i * 2",c=r?"rc.z, i * 2":"i * 2, rc.z",d=n?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],f=r?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"],h="",v="";i&&(h=a?`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          `+i+`
        }`:`vec4 activation(vec4 x) {
          `+i+`
        }`,v="result = activation(result);");var m=o?"result += getBiasAtOutCoords();":"";o&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+h+`

      const float sharedDimension = `+u+`.0;

      vec4 dot2x2ARowBCol(ivec3 rc) {
        vec4 result = vec4(0);
        for (int i = 0; i < `+u+`; i++) {
          vec4 a = getMatrixA(rc.x, `+l+`);
          vec4 b = getMatrixB(rc.x, `+c+`);

          // These swizzled products need to be separately added.
          // See: https://github.com/tensorflow/tfjs/issues/1735
          result += (`+d[0]+" * "+f[0]+`);
          result += (`+d[1]+" * "+f[1]+`);
        }
        return result;
      }

      void main() {
        ivec3 rc = getOutputCoords();
        vec4 result = dot2x2ARowBCol(rc);

        `+m+`

        `+v+`

        setOutput(result);
      }
    `},JD=function(){function e(t,n,r){this.variableNames=["probs"],this.outputShape=[t,r],this.userCode=`
      uniform float seed;

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];

        float r = random(seed);
        float cdf = 0.0;

        for (int i = 0; i < `+(n-1)+`; i++) {
          cdf += getProbs(batch, i);

          if (r < cdf) {
            setOutput(float(i));
            return;
          }
        }

        // If no other event happened, last event happened.
        setOutput(float(`+(n-1)+`));
      }
    `}return e.prototype.getCustomSetupFunc=function(t){var n=this;return function(r,o){n.seedLoc==null&&(n.seedLoc=r.getUniformLocation(o,"seed")),r.gl.uniform1f(n.seedLoc,t)}},e}(),ZD=function(e,t,n,r){this.variableNames=["indices"],this.outputShape=[e,t],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int index = round(getIndices(coords.x));
        setOutput(mix(float(`+r+"), float("+n+`),
                      float(index == coords.y)));
      }
    `},e3=function(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=e;var t=e.length;if(t===0)this.userCode=`
        void main() {
          setOutput(vec4(getA(), 0., 0., 0.));
        }
      `;else{var n=en("rc",t),r=je(t),o=function(s,u,l){if(s===1)return"rc > "+u[0];for(var c="",d=s-2;d<s;d++)c+=l[d]+" >= "+u[d],d<s-1&&(c+="||");return c}(t,e,n),i=function(s,u,l,c){if(s===1)return"";var d=c.slice(-2);return`
    int r = `+d[0]+`;
    int c = `+d[1]+`;
    int rp1 = r + 1;
    int cp1 = c + 1;

    bool cEdge = cp1 >= `+u+`;
    bool rEdge = rp1 >= `+l+`;
  `}(t,e[e.length-1],e[e.length-2],n),a=function(s,u){var l=s.length,c=function(d,f){for(var h=[],v=0;v<=1;v++)for(var m=0;m<=1;m++){for(var g=(v===0?"r":"rp1")+", "+(m===0?"c":"cp1"),p=2;p<d;p++)g=f[f.length-1-p]+","+g;h.push(g)}return h}(l,u);return l===1?`getA(rc),
            rc + 1 >= `+s[0]+` ? 0. : getA(rc + 1),
            0, 0`:"getA("+c[0]+`),
          cEdge ? 0. : getA(`+c[1]+`),
          rEdge ? 0. : getA(`+c[2]+`),
          rEdge || cEdge ? 0. : getA(`+c[3]+")"}(e,n);this.userCode=`
        void main() {
          `+r+` rc = getOutputCoords();

          if(`+o+`) {
            setOutput(vec4(0));
          } else {
            `+i+`

            setOutput(vec4(`+a+`));
          }
        }
      `}},t3=function(e,t,n){this.variableNames=["x"],this.outputShape=t.map(function(u,l){return u[0]+e[l]+u[1]});var r=e.length,o=je(r),i=t.map(function(u){return u[0]}).join(","),a=t.map(function(u,l){return u[0]+e[l]}).join(","),s=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r);this.userCode=r!==1?`
      `+o+" start = "+o+"("+i+`);
      `+o+" end = "+o+"("+a+`);

      void main() {
        `+o+` outC = getOutputCoords();
        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {
          setOutput(float(`+n+`));
        } else {
          `+o+` coords = outC - start;
          setOutput(getX(`+s+`));
        }
      }
    `:`
        int start = `+i+`;
        int end = `+a+`;

        void main() {
          int outC = getOutputCoords();
          if (outC < start || outC >= end) {
            setOutput(float(`+n+`));
          } else {
            setOutput(getX(outC - start));
          }
        }
      `},n3=function(e,t,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t.map(function(g,p){return g[0]+e[p]+g[1]});for(var r=e.length,o=je(r),i=t.map(function(g){return g[0]}).join(","),a=t.map(function(g,p){return g[0]+e[p]}).join(","),s=en("rc",r),u=en("source",r),l=s[r-1]+" < "+this.outputShape[r-1],c=r===1?"source":"vec2("+u.slice(-2).join()+")",d=[o+" rc = outputLoc;",s[r-1]+` += 1;
       if(`+l+`) {
      `,r===1?"":`}
       rc = outputLoc;
       `+s[r-2]+` += 1;
       if(`+s[r-2]+" < "+this.outputShape[r-2]+") {",r===1?"":"  "+s[r-1]+` += 1;
         if(`+l+") {"],f=r===1?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))",h="",v=0,m=r===1?2:4;v<m;v++)h+=`
        `+d[v]+`
        if (`+f+`) {
          result[`+v+"] = float("+n+`);
        } else {
          `+o+` source = rc - start;
          result[`+v+"] = getChannel(getX("+u.join()+"), "+c+`);
        }
      `;h+=r===1?"} ":"}}",this.userCode=`
      const `+o+" start = "+o+"("+i+`);
      const `+o+" end = "+o+"("+a+`);

      void main() {
        `+o+` outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        `+h+`
        setOutput(result);
      }
    `},xf=function(e,t,n){if(this.variableNames=["x"],t==="avg"&&n)throw new Error("Cannot compute positions for average pool.");var r=e.filterWidth,o=e.strideHeight,i=e.strideWidth,a=e.dilationHeight,s=e.dilationWidth,u=e.effectiveFilterHeight,l=e.effectiveFilterWidth,c=e.padInfo.top,d=e.padInfo.left;this.outputShape=e.outShape;var f=t==="avg",h="0.0";if(f||(h="-1.0 / 1e-20"),n)this.userCode=`
        const ivec2 strides = ivec2(`+o+", "+i+`);
        const ivec2 pads = ivec2(`+c+", "+d+`);

        void main() {
          ivec4 coords = getOutputCoords();
          int batch = coords[0];
          int d = coords[3];

          ivec2 xRCCorner = coords.yz * strides - pads;
          int xRCorner = xRCCorner.x;
          int xCCorner = xRCCorner.y;

          // max/min x(?, ?, d) to get y(yR, yC, d).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;
          float avgValue = 0.0;

          for (int wR = 0; wR < `+u+`;
              wR += `+a+`) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= `+e.inHeight+`) {
              continue;
            }

            for (int wC = 0; wC < `+l+`;
                wC += `+s+`) {
              int xC = xCCorner + wC;

              if (xC < 0 || xC >= `+e.inWidth+`) {
                continue;
              }

              float value = getX(batch, xR, xC, d);

              // If a min / max value has already been found, use it. If not,
              // use the current value.
              float currMinMaxValue = mix(
                  value, minMaxValue, minMaxValueFound);
              if (value >= currMinMaxValue) {
                minMaxValue = value;
                minMaxValueFound = 1.0;
                minMaxPosition = wR * `+l+` + wC;
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;else{var v=t+"("+t+"("+t+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";t==="avg"&&(v="avgValue / count");var m=4*Math.floor(r/4),g=r%4,p=`
      if (`+f+`) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = max(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec2 strides = ivec2(`+o+", "+i+`);
      const ivec2 pads = ivec2(`+c+", "+d+`);
      const float initializationValue = `+h+`;
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xR, int xC, int d) {
        if (xC < 0 || xC >= `+e.inWidth+`) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xR, xC, d);
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d = coords[3];

        ivec2 xRCCorner = coords.yz * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // max/min x(?, ?, d) to get y(yR, yC, d).
        // ? = to be determined
        vec4 minMaxValue = vec4(`+h+`);
        float avgValue = 0.0;
        count = 0.0;

        for (int wR = 0; wR < `+u+`;
            wR += `+a+`) {
          int xR = xRCorner + wR;

          if (xR < 0 || xR >= `+e.inHeight+`) {
            continue;
          }

          for (int wC = 0; wC < `+m+`; wC += 4) {
            int xC = xCCorner + wC * `+s+`;

            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + `+s+`, d),
              getValue(batch, xR, xC + 2 * `+s+`, d),
              getValue(batch, xR, xC + 3 * `+s+`, d)
            );

            `+p+`
          }

          int xC = xCCorner + `+m+`;
          if (`+(g===1)+`) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              initializationValue,
              initializationValue,
              initializationValue
            );

            `+p+`
          } else if (`+(g===2)+`) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + `+s+`, d),
              initializationValue,
              initializationValue
            );

            `+p+`
          } else if (`+(g===3)+`) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + `+s+`, d),
              getValue(batch, xR, xC + 2 * `+s+`, d),
              initializationValue
            );

            `+p+`
          }
        }
        setOutput(`+v+`);
      }
    `}},wf=function(e,t,n){if(this.variableNames=["x"],t==="avg"&&n)throw new Error("Cannot compute positions for average pool.");var r=e.filterWidth,o=e.strideDepth,i=e.strideHeight,a=e.strideWidth,s=e.dilationDepth,u=e.dilationHeight,l=e.dilationWidth,c=e.effectiveFilterDepth,d=e.effectiveFilterHeight,f=e.effectiveFilterWidth,h=e.padInfo.front,v=e.padInfo.top,m=e.padInfo.left;this.outputShape=e.outShape;var g=t==="avg",p="0.0";if(g||(p="-1.0 / 1e-20"),n)this.userCode=`
        const ivec3 strides =
            ivec3(`+o+", "+i+", "+a+`);
        const ivec3 pads = ivec3(`+h+", "+v+", "+m+`);

        void main() {
          ivec5 coords = getOutputCoords();
          int batch = coords.x;
          int ch = coords.u;

          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
          int xDCorner = xCorner.x;
          int xRCorner = xCorner.y;
          int xCCorner = xCorner.z;

          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;

          for (int wD = 0; wD < `+c+`;
              wD += `+s+`) {
            int xD = xDCorner + wD;

            if (xD < 0 || xD >= `+e.inDepth+`) {
              continue;
            }

            for (int wR = 0; wR < `+d+`;
                wR += `+u+`) {
              int xR = xRCorner + wR;

              if (xR < 0 || xR >= `+e.inHeight+`) {
                continue;
              }

              for (int wC = 0; wC < `+f+`;
                  wC += `+l+`) {
                int xC = xCCorner + wC;

                if (xC < 0 || xC >= `+e.inWidth+`) {
                  continue;
                }

                float value = getX(batch, xD, xR, xC, ch);

                // If a min / max value has already been found, use it. If not,
                // use the current value.
                float currMinMaxValue = mix(
                    value, minMaxValue, minMaxValueFound);
                if (value >= currMinMaxValue) {
                  minMaxValue = value;
                  minMaxValueFound = 1.0;
                  minMaxPosition =
                      wD * `+d+" * "+f+` +
                      wR * `+f+` + wC;;
                }
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;else{var y=t+"("+t+"("+t+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";t==="avg"&&(y="avgValue / count");var x=4*Math.floor(r/4),w=r%4,b=`
      if (`+g+`) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = max(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec3 strides =
        ivec3(`+o+", "+i+", "+a+`);
      const ivec3 pads = ivec3(`+h+", "+v+", "+m+`);
      const float initializationValue = `+p+`;
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xD, int xR, int xC, int ch) {
        if (xC < 0 || xC >= `+e.inWidth+`) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xD, xR, xC, ch);
      }

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xDCorner = xCorner.x;
        int xRCorner = xCorner.y;
        int xCCorner = xCorner.z;

        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).
        // ? = to be determined
        vec4 minMaxValue = vec4(`+p+`);
        float avgValue = 0.0;
        count = 0.0;

        for (int wD = 0; wD < `+c+`;
            wD += `+s+`) {
          int xD = xDCorner + wD;

          if (xD < 0 || xD >= `+e.inDepth+`) {
            continue;
          }

          for (int wR = 0; wR < `+d+`;
            wR += `+u+`) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= `+e.inHeight+`) {
              continue;
            }

            for (int wC = 0; wC < `+x+`; wC += 4) {
              int xC = xCCorner + wC * `+l+`;

              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + `+l+`, ch),
                getValue(batch, xD, xR, xC + 2 * `+l+`, ch),
                getValue(batch, xD, xR, xC + 3 * `+l+`, ch)
              );

              `+b+`
            }

            int xC = xCCorner + `+x+`;
            if (`+(w===1)+`) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                initializationValue,
                initializationValue,
                initializationValue
              );

              `+b+`
            } else if (`+(w===2)+`) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + `+l+`, ch),
                initializationValue,
                initializationValue
              );

              `+b+`
            } else if (`+(w===3)+`) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + `+l+`, ch),
                getValue(batch, xD, xR, xC + 2 * `+l+`, ch),
                initializationValue
              );

              `+b+`
            }
          }
          setOutput(`+y+`);
        }
      }
    `}},r3=function(e,t){this.variableNames=["x"];var n=e.windowSize,r=e.batchSize,o=e.inSize,i=Math.ceil(o/n);this.outputShape=[r,i];var a="0.0",s="";t==="prod"?a="1.0":t==="min"?(a="1.0 / 1e-20",s="min"):t==="max"&&(a="-1.0 / 1e-20",s="max");var u=t+"("+t+"("+t+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";t==="sum"?u="sumValue":t==="prod"?u="prodValue":t==="all"?u="allValue":t==="any"&&(u="anyValue");var l=4*Math.floor(n/4),c=n%4,d=`
      if (`+(t==="sum")+`) {
        sumValue += dot(values, ones);
      } else if (`+(t==="prod")+`) {
        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);
        prodValue *= tmp[0] * tmp[1];
      } else {
        minMaxValue = `+s+`(values, minMaxValue);
      }
    `,f="vec4";t==="all"?(a="1.0",d=`
        bool reducedAllValue = all(values);
        float floatedReducedAllValue = float(reducedAllValue);
        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);
      `,f="bvec4"):t==="any"&&(a="0.0",d=`
        bool reducedAnyValue = any(values);
        float floatedReducedAnyValue = float(reducedAnyValue);
        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);
      `,f="bvec4");var h="";o%n>0&&(h=`
        if (inIdx < 0 || inIdx >= `+o+`) {
          return initializationValue;
        }
      `),this.userCode=`
      const float initializationValue = `+a+`;
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        `+h+`
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * `+n+`;

        vec4 minMaxValue = vec4(`+a+`);
        float prodValue = 1.0;
        float sumValue = 0.0;
        float allValue = 1.0;
        float anyValue = 0.0;

        for (int i = 0; i < `+l+`; i += 4) {
          int inIdx = inOffset + i;
          `+f+" values = "+f+`(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          `+d+`
        }

        int inIdx = inOffset + `+l+`;
        if (`+(c===1)+`) {
          `+f+" values = "+f+`(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          `+d+`
        } else if (`+(c===2)+`) {
          `+f+" values = "+f+`(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          `+d+`
        } else if (`+(c===3)+`) {
          `+f+" values = "+f+`(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          `+d+`
        }
        setOutput(`+u+`);
      }
    `},o3=function(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e;for(var n="",r=0;r<4;r++){var o="thisRC = rc;";r%2==1&&(o+="thisRC.z += 1;"),r>1&&(o+="thisRC.y += 1;"),n+=`
        `+o+`
        `+(r>0?"if(thisRC.y < rows && thisRC.z < cols){":"")+`
          int flatIndex = getFlatIndex(thisRC);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);
          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[`+r+`] =
            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);
        `+(r>0?"}":"")+`
      `}this.userCode=`
      
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      `+pi(["r","c","d"],t)+`
      return ivec3(r, c, d);
    }
  
      `+Dv(e)+`

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.);

        ivec3 thisRC;
        int rows = `+e[1]+`;
        int cols = `+e[2]+`;

        `+n+`

        setOutput(result);
      }
    `},i3=function(e,t,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t.shape;var r=t.shape,o=r[1],i=r[2],a=e.shape,s=a[1],u=a[2],l=[n&&s>1?o-1:o,n&&u>1?i-1:i],c=[n&&s>1?s-1:s,n&&u>1?u-1:u],d=l[0]/c[0],f=l[1]/c[1],h=1/d,v=1/f,m=2*Math.ceil(h)+2,g=2*Math.ceil(v)+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(`+d+`);
        const float widthScale = float(`+f+`);

        const float invHeightScale = float(`+h+`);
        const float invWidthScale = float(`+v+`);

        const int winHeight = int(`+m+`);
        const int winWidth = int(`+g+`);

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(startRLerp - float(winHeight / 2));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(startCLerp - float(winWidth / 2));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= `+s+`) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= `+u+`) {
              continue;
            }

            float dxR = float(dyR) * heightScale;
            int topDxRIndex = int(floor(dxR));
            int bottomDxRIndex = int(min(ceil(dxR), `+(o-1)+`.0));
            float dxRLerp = dxR - float(topDxRIndex);
            float inverseDxRLerp = 1.0 - dxRLerp;

            float dxC = float(dyC) * widthScale;
            int leftDxCIndex = int(floor(dxC));
            int rightDxCIndex = int(min(ceil(dxC), `+(i-1)+`.0));
            float dxCLerp = dxC - float(leftDxCIndex);
            float inverseDxCLerp = 1.0 - dxCLerp;

            if (r == topDxRIndex && c == leftDxCIndex) {
              // topLeft
              accumulator +=
                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;
            }

            if (r == topDxRIndex && c == rightDxCIndex) {
              // topRight
              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;
            }

            if (r == bottomDxRIndex && c == leftDxCIndex) {
              // bottomLeft
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;
            }

            if (r == bottomDxRIndex && c == rightDxCIndex) {
              // bottomRight
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `},a3=function(e,t,n,r){this.variableNames=["A"],this.outputShape=[];var o=e[0],i=e[1],a=e[2],s=e[3];this.outputShape=[o,t,n,s];var u=[r&&t>1?i-1:i,r&&n>1?a-1:a],l=[r&&t>1?t-1:t,r&&n>1?n-1:n];this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          `+u[0]/l[0]+`,
          `+u[1]/l[1]+`);
      const vec2 inputShapeRC = vec2(`+i+".0, "+a+`.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;

        // Compute the four integer indices.
        ivec2 sourceFloorRC = ivec2(sourceFracIndexRC);
        ivec2 sourceCeilRC = ivec2(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);
        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);
        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);
        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);

        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);

        float top = topLeft + (topRight - topLeft) * fracRC.y;
        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;
        float newValue = top + (bottom - top) * fracRC.x;

        setOutput(newValue);
      }
    `},s3=function(e,t,n,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];var o=e[0],i=e[1],a=e[2],s=e[3];this.outputShape=[o,t,n,s];var u=[r&&t>1?i-1:i,r&&n>1?a-1:a],l=[r&&t>1?t-1:t,r&&n>1?n-1:n];this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          `+u[0]/l[0]+`,
          `+u[1]/l[1]+`,
          `+u[1]/l[1]+`);
      const vec3 inputShapeRC = vec3(`+i+".0, "+a+`.0,
                                     `+a+`.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = vec3(yRC) * effectiveInputOverOutputRatioRC;

        // Compute the four integer indices.
        ivec3 sourceFloorRC = ivec3(sourceFracIndexRC);
        ivec3 sourceCeilRC = ivec3(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < `+(s-1)+`;
        bool hasNextRow = coords.z < `+(n-1)+`;

        // In parallel, construct four corners for all four components in
        // packed 2x2 cell.
        vec4 topLeft = vec4(
          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 bottomLeft = vec4(
          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 topRight = vec4(
          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec4 bottomRight = vec4(
          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);

        vec4 top = mix(topLeft, topRight, fracRC.yyzz);
        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);
        vec4 newValue = mix(top, bottom, fracRC.x);

        setOutput(newValue);
      }
    `},u3=function(e,t,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t.shape;var r=t.shape,o=r[1],i=r[2],a=e.shape,s=a[1],u=a[2],l=[n&&s>1?o-1:o,n&&u>1?i-1:i],c=[n&&s>1?s-1:s,n&&u>1?u-1:u],d=l[0]/c[0],f=l[1]/c[1],h=1/d,v=1/f,m=2*Math.ceil(h)+2,g=2*Math.ceil(v)+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(`+d+`);
        const float widthScale = float(`+f+`);

        const float invHeightScale = float(`+h+`);
        const float invWidthScale = float(`+v+`);

        const int winHeight = int(`+m+`);
        const int winWidth = int(`+g+`);

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(floor(startRLerp - float(winHeight / 2)));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(floor(startCLerp - float(winWidth / 2)));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= `+s+`) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= `+u+`) {
              continue;
            }

            float sourceFracRow =
              float(`+l[0]+`) *
                (float(dyR) / float(`+c[0]+`));

            float sourceFracCol =
                float(`+l[1]+`) *
                  (float(dyC) / float(`+c[1]+`));

            int sourceNearestRow = int(min(
                float(int(`+o+`) - 1),
                `+n+` ? float(round(sourceFracRow)) :
                                  float(floor(sourceFracRow))));

            int sourceNearestCol = int(min(
                float(int(`+i+`) - 1),
                `+n+` ? float(round(sourceFracCol)) :
                                  float(floor(sourceFracCol))));

            if (r == sourceNearestRow && c == sourceNearestCol) {
              accumulator += getDy(b, dyR, dyC, d);
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `},l3=function(e,t,n,r){this.variableNames=["A"],this.outputShape=[];var o=e[0],i=e[1],a=e[2],s=e[3];this.outputShape=[o,t,n,s];var u=[r&&t>1?i-1:i,r&&n>1?a-1:a],l=[r&&t>1?t-1:t,r&&n>1?n-1:n],c=r?"0.5":"0.0";this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          `+u[0]/l[0]+`,
          `+u[1]/l[1]+`);
      const vec2 inputShapeRC = vec2(`+i+".0, "+a+`.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;

        // Compute the coordinators of nearest neighbor point.
        ivec2 sourceNearestRC = ivec2(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + `+c+`)));

        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);

        setOutput(newValue);
      }
    `},c3=function(e,t){this.variableNames=["x"];var n=e.length;if(n>4)throw new Error("WebGL backend: Reverse of rank-"+n+" tensor is not yet supported");if(this.outputShape=e,n!==1){var r=e.map(function(i,a){return function(s){return t.indexOf(s)!==-1&&e[s]!==1?e[s]+" - coords["+s+"] - 1":"coords["+s+"]"}(a)}).join(","),o=je(n);this.userCode=`
      void main() {
        `+o+` coords = getOutputCoords();
        setOutput(getX(`+r+`));
      }
    `}else this.userCode=`
        void main() {
          int coord = getOutputCoords();
          setOutput(getX(`+e[0]+` - coord - 1));
        }
      `},d3=function(e,t){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;var n=e.length;if(n>4)throw new Error("WebGL backend: Reverse of rank-"+n+" tensor is not yet supported");this.outputShape=e;var r=en("rc",n),o=r[n-1]+" + 1 < "+this.outputShape[n-1],i=r[n-2]+" + 1 < "+this.outputShape[n-2],a=je(n);function s(u){var l=e.map(function(c,d){return function(f,h){return t.indexOf(f)!==-1&&e[f]!==1?e[f]+" - "+h[f]+" - 1":""+h[f]}(d,u)});return"getChannel(getX("+l.join(",")+"), vec2("+l.slice(-2).join(",")+"))"}this.userCode=n===1?`
        void main(){
          int rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = getChannel(getX(`+e[0]+` - rc - 1),
            `+e[0]+` - rc - 1);
          if(`+o+`){
              result.g = getChannel(getX(`+e[0]+` - (rc  + 1) - 1),
                `+e[0]+` - (rc  + 1) - 1);
          }
          setOutput(result);
        }
      `:`
        void main() {
          `+a+` rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = `+function(u){return s(u)}(r.slice())+`;
          if(`+o+`){
            result.g = `+function(u){return u[n-1]="("+u[n-1]+" + 1)",s(u)}(r.slice())+`;
          }
          if(`+i+`) {
            result.b = `+function(u){return u[n-2]="("+u[n-2]+" + 1)",s(u)}(r.slice())+`;
            if(`+o+`) {
              result.a = `+function(u){return u[n-1]="("+u[n-1]+" + 1)",u[n-2]="("+u[n-2]+" + 1)",s(u)}(r.slice())+`;
            }
          }
          setOutput(result);
        }
    `},Vy=function(e,t,n,r,o,i,a){this.variableNames=["updates","indices","defaultValue"],this.outputShape=i;var s=je(o.length),u=je(i.length),l="";n===1?l="i":n===2&&(l="i, j");var c="getIndices("+l+")",d="";r===1?d="i":r===2&&(d="i, coords[1]");var f="getUpdates("+d+")",h=t>1?"strides[j]":"strides";this.userCode=`
        `+s+" strides = "+s+"("+o+`);

        void main() {
          `+u+` coords = getOutputCoords();
          float sum = 0.0;
          bool found = false;
          for (int i = 0; i < `+e+`; i++) {
            int flattenedIndex = 0;
            for (int j = 0; j < `+t+`; j++) {
              int index = round(`+c+`);
              flattenedIndex += index * `+h+`;
            }
            if (flattenedIndex == coords[0]) {
              sum += `+f+`;
              found = true;
            }
          }
          setOutput(mix(getDefaultValue(), sum, float(found)));
        }
      `},f3=function(e,t){this.variableNames=["x","segmentIds"];var n=e.windowSize,r=e.batchSize,o=e.inSize,i=e.numSegments,a=i*Math.ceil(o/n);this.outputShape=[r,a];var s=4*Math.floor(n/4),u=n%4,l=`
        sumValue += dot(values, segFilter);
    `,c="";o%n>0&&(c=`
        if (inIdx < 0 || inIdx >= `+o+`) {
          return initializationValue;
        }
      `);var d="";o%n>0&&(d=`
        if (inIdx < 0 || inIdx >= `+o+`) {
          return -1.0;
        }
      `),this.userCode=`
      const float initializationValue = 0.0;

      float getValue(int batch, int inIdx) {
        `+c+`
        return getX(batch, inIdx);
      }

      float getSegmentIdAtIndex(int inIdx) {
        `+d+`
        return getSegmentIds(inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = int(floor(float(outIdx) / float(
          `+i+")) * float("+n+`));
        int currentSeg = int(mod(float(outIdx), float(`+i+`)));

        float sumValue = 0.0;

        for (int i = 0; i < `+s+`; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0
          );

          `+l+`
        }

        int inIdx = inOffset + `+s+`;
        if (`+(u===1)+`) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            0,
            0,
            0
          );

          `+l+`
        } else if (`+(u===2)+`) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
              0,
              0
          );

          `+l+`
        } else if (`+(u===3)+`) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            0
          );

          `+l+`
        }
        setOutput(sumValue);
      }
    `},h3=function(e,t,n){var r,o;if(this.variableNames=["c","a","b"],this.outputShape=t,n>4)throw Error("Where for rank "+n+" is not yet supported");if(n===1)o="resRC",r="resRC";else{for(var i=["resRC.x","resRC.y","resRC.z","resRC.w"],a=[],s=[],u=0;u<t.length;u++)s.push(""+i[u]),u<e&&a.push(""+i[u]);r=a.join(),o=s.join()}var l=je(n);this.userCode=`
      void main() {
        `+l+` resRC = getOutputCoords();
        float cVal = getC(`+r+`);
        if (cVal >= 1.0) {
          setOutput(getA(`+o+`));
        } else {
          setOutput(getB(`+o+`));
        }
      }
    `},p3=function(){function e(t){this.variableNames=["source"],this.outputShape=t,this.rank=t.length;var n,r=je(this.rank),o="uniform int start["+this.rank+"];",i=function(a){if(a===1)return"sourceLoc";if(a<=6)return bf.slice(0,a).map(function(s){return"sourceLoc."+s}).join(",");throw Error("Slicing for rank "+a+" is not yet supported")}(this.rank);n=`
        `+r+` sourceLoc;
        `+r+` coords = getOutputCoords();
        `+t.map(function(a,s){return"sourceLoc."+bf[s]+" = start["+s+"] + coords."+bf[s]+";"}).join(`
`)+`
      `,this.userCode=`
      `+o+`
      void main() {
        `+n+`
        setOutput(getSource(`+i+`));
      }
    `}return e.prototype.getCustomSetupFunc=function(t){var n=this;if(t.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+t.length+")");return function(r,o){n.startLoc==null&&(n.startLoc=r.getUniformLocationNoThrow(o,"start"),n.startLoc==null)||r.gl.uniform1iv(n.startLoc,t)}},e}(),bf=["x","y","z","w","u","v"],v3=function(){function e(t){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.rank=t.length;var n=je(this.rank),r=en("coords",this.rank),o=en("sourceLoc",this.rank),i=this.rank===1?"sourceLoc":"vec2("+o.slice(-2).join()+")",a="getChannel(getSource("+o.join()+"), "+i+")",s=`
      result.x = `+a+`;
      if (++`+r[this.rank-1]+" < "+t[this.rank-1]+`) {
        ++`+o[this.rank-1]+`;
        result.y = `+a+`;
        --`+o[this.rank-1]+`;
      }
    `,u=this.rank===1?"":`
      --`+r[this.rank-1]+`;
      if (++`+r[this.rank-2]+" < "+t[this.rank-2]+`) {
        ++`+o[this.rank-2]+`;
        result.z = `+a+`;
        if (++`+r[this.rank-1]+" < "+t[this.rank-1]+`) {
          ++`+o[this.rank-1]+`;
          result.w = `+a+`;
        }
      }
    `,l=this.rank<=4?`sourceLoc = coords +
            `+n+"("+t.map(function(c,d){return"start["+d+"]"}).join()+");":t.map(function(c,d){return o[d]+" = "+r[d]+" + start["+d+"];"}).join(`
`);this.userCode=`
      uniform int start[`+this.rank+`];
      void main() {
        `+n+` coords = getOutputCoords();
        `+n+` sourceLoc;
        `+l+`
        vec4 result = vec4(0.);
        `+s+`
        `+u+`
        setOutput(result);
      }
    `}return e.prototype.getCustomSetupFunc=function(t){var n=this;if(t.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+t.length+")");return function(r,o){n.startLoc==null&&(n.startLoc=r.getUniformLocationNoThrow(o,"start"),n.startLoc==null)||r.gl.uniform1iv(n.startLoc,t)}},e}(),m3=function(e,t,n){this.variableNames=["x"],this.outputShape=n;var r=n.length,o=je(n.length),i=je(n.length),a="";if(r===1)a="coords * strides + begin";else{var s=0;a=n.map(function(u,l){return s++,n.length===1?"coords * strides["+l+"] + begin["+l+"]":"coords["+(s-1)+"] * strides["+l+"] + begin["+l+"]"}).join(",")}this.userCode=`
      `+o+" begin = "+o+"("+e+`);
      `+o+" strides = "+o+"("+t+`);

      void main() {
        `+i+` coords = getOutputCoords();
        setOutput(getX(`+a+`));
      }
    `},g3=function(){function e(t){this.gpgpu=t,this.numUsedTextures=0,this.numFreeTextures=0,this.freeTextures={},this.logEnabled=!1,this.usedTextures={}}return e.prototype.acquireTexture=function(t,n,r){var o,i=Hy(n,r),a=Gy(t,i,r);if(a in this.freeTextures||(this.freeTextures[a]=[]),a in this.usedTextures||(this.usedTextures[a]=[]),this.freeTextures[a].length>0){this.numFreeTextures--,this.numUsedTextures++,this.log();var s=this.freeTextures[a].shift();return this.usedTextures[a].push(s),s}return this.numUsedTextures++,this.log(),i===vn.PACKED_2X2_FLOAT32?o=this.gpgpu.createPackedMatrixTexture(t[0],t[1]):i===vn.PACKED_2X2_FLOAT16?o=this.gpgpu.createFloat16PackedMatrixTexture(t[0],t[1]):i===vn.UNPACKED_FLOAT32?o=this.gpgpu.createFloat32MatrixTexture(t[0],t[1]):i===vn.UNPACKED_FLOAT16?o=this.gpgpu.createFloat16MatrixTexture(t[0],t[1]):i===vn.PACKED_4X1_UNSIGNED_BYTE&&(o=this.gpgpu.createUnsignedBytesMatrixTexture(t[0],t[1])),this.usedTextures[a].push(o),o},e.prototype.releaseTexture=function(t,n,r,o){if(this.freeTextures!=null){var i=Gy(n,Hy(r,o),o);i in this.freeTextures||(this.freeTextures[i]=[]),this.freeTextures[i].push(t),this.numFreeTextures++,this.numUsedTextures--;var a=this.usedTextures[i],s=a.indexOf(t);if(s<0)throw new Error("Cannot release a texture that was never provided by this texture manager");a.splice(s,1),this.log()}},e.prototype.log=function(){if(this.logEnabled){var t=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",this.numFreeTextures+" / "+this.numUsedTextures,"("+t+")")}},e.prototype.getNumUsedTextures=function(){return this.numUsedTextures},e.prototype.getNumFreeTextures=function(){return this.numFreeTextures},e.prototype.dispose=function(){var t=this;if(this.freeTextures!=null){for(var n in this.freeTextures)this.freeTextures[n].forEach(function(r){t.gpgpu.deleteMatrixTexture(r)});for(var n in this.usedTextures)this.usedTextures[n].forEach(function(o){t.gpgpu.deleteMatrixTexture(o)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0}},e}();function Hy(e,t){if(e===gn.UPLOAD)return vn.PACKED_2X2_FLOAT32;if(e===gn.RENDER||e==null)return function(n){return H().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?n?vn.PACKED_2X2_FLOAT32:vn.UNPACKED_FLOAT32:n?vn.PACKED_2X2_FLOAT16:vn.UNPACKED_FLOAT16}(t);if(e===gn.DOWNLOAD||e===gn.PIXELS)return vn.PACKED_4X1_UNSIGNED_BYTE;throw new Error("Unknown logical texture type "+e)}function Gy(e,t,n){return e[0]+"_"+e[1]+"_"+t+"_"+n}var y3=function(e,t){this.variableNames=["A"];for(var n=new Array(e.length),r=0;r<n.length;r++)n[r]=e[r]*t[r];this.outputShape=n,this.rank=n.length;var o=je(this.rank),i=function(a){var s=a.length;if(s>5)throw Error("Tile for rank "+s+" is not yet supported");if(s===1)return"imod(resRC, "+a[0]+")";for(var u=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],l=[],c=0;c<a.length;c++)l.push("imod("+u[c]+", "+a[c]+")");return l.join()}(e);this.userCode=`
      void main() {
        `+o+` resRC = getOutputCoords();
        setOutput(getA(`+i+`));
      }
    `},x3=function(e,t){this.variableNames=["A"];for(var n=new Array(e.length),r=0;r<n.length;r++)n[r]=e[t[r]];this.outputShape=n,this.rank=n.length;var o=je(this.rank),i=function(a){var s=a.length;if(s>6)throw Error("Transpose for rank "+s+" is not yet supported");for(var u=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],l=new Array(s),c=0;c<a.length;c++)l[a[c]]=u[c];return l.join()}(t);this.userCode=`
    void main() {
      `+o+` resRC = getOutputCoords();
      setOutput(getA(`+i+`));
    }
    `},w3=function(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;for(var n=new Array(e.length),r=0;r<n.length;r++)n[r]=e[t[r]];if(this.outputShape=n,this.rank=n.length,this.rank>6)throw Error("Packed transpose for rank "+this.rank+" is not yet supported.");var o=je(this.rank),i=h2("rc",this.rank),a=new Array(this.rank);for(r=0;r<t.length;r++)a[t[r]]=i[r];var s="vec2("+a.slice(-2).join()+")",u="++"+i[this.rank-1]+" < "+n[this.rank-1],l="getChannel(getA("+a.join()+"), "+s+")";this.userCode=`
    void main() {
      `+o+` rc = getOutputCoords();
      vec4 result = vec4(0.);
      result[0] = `+l+`;
      if(`+u+`) {
        result[1] = `+l+`;
      }
      --`+i[this.rank-1]+`;
      if(++`+i[this.rank-2]+" < "+n[this.rank-2]+`) {
        result[2] = `+l+`;
        if(`+u+`) {
          result[3] = `+l+`;
        }
      }
      setOutput(result);
    }
    `},Fv=1.7580993408473768,Mv=1.0507009873554805,be=function(e,t){this.variableNames=["A"],this.outputShape=e,this.userCode=`
      float unaryOperation(float x) {
        `+t+`
      }

      void main() {
        float x = getAAtOutCoords();
        float y = unaryOperation(x);

        setOutput(y);
      }
    `},ur="if (isnan(x)) return x;",b3="return x;",qy="return abs(x);",y2=ur+`
  return (x < 0.0) ? 0.0 : x;
`,x2=ur+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,w2="return (x >= 0.0) ? x : (exp(x) - 1.0);",C3=`
  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.
  // see: https://arxiv.org/abs/1706.02515
  float scaleAlpha = `+Fv+`;
  float scale = `+Mv+`;
  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);
`,Ky="return -x;",Xy="return ceil(x);",Yy="return floor(x);",Qy="return exp(x);",Jy="return exp(x) - 1.0;",E3=ur+`
  return sin(x);
`,_3=ur+`
  return cos(x);
`,S3=ur+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return asin(x);
`,k3=ur+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return acos(x);
`,R3=ur+`
  return atan(x);
`,N3=ur+"return log(x + sqrt(x * x + 1.0));",I3=ur+`
  if (x < 1.0) return NAN;
  return log(x + sqrt(x * x - 1.0));`,T3=ur+`
  if ((x < -1.0) || (x > 1.0)) return NAN;
  return (log(1.0 + x) - log(1.0 - x)) / 2.0;`,ol="return x;",A3="return x;",b2=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,C2=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,E2=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,ms=function(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.userCode=`
      vec4 unaryOperation(vec4 x) {
        `+t+`
      }

      void main() {
        vec4 x = getAAtOutCoords();
        vec4 y = unaryOperation(x);

        setOutput(y);
      }
    `},P3=function(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=e;var t=e.length,n=en("rc",t),r=je(t),o=function(s,u){if(s===1)return"rc";for(var l="",c=0;c<s;c++)l+=u[c],c<s-1&&(l+=",");return l}(t,n),i=n.slice(-2),a=t<=1?"rc":"vec2("+i.join(",")+")";this.userCode=`
      void main() {
        `+r+` rc = getOutputCoords();
        vec4 packedInput = getA(`+o+`);

        setOutput(getChannel(packedInput, `+a+`));
      }
    `},il={};function al(e,t){if(t===void 0&&(t=!1),e==="linear")return t?A3:b3;if(e==="relu")return t?b2:y2;if(e==="elu")return t?E2:w2;if(e==="relu6")return t?C2:x2;if(e==="prelu")return t?g2:m2;throw new Error("Activation "+e+" has not been implemented for the WebGL backend.")}var D3=600,F3=function(e){function t(n){var r,o=e.call(this)||this;if(o.pendingRead=new WeakMap,o.pendingDisposal=new WeakSet,o.dataRefCount=new WeakMap,o.numBytesInGPU=0,o.uploadWaitMs=0,o.downloadWaitMs=0,o.warnedAboutMemory=!1,o.pendingDeletes=0,o.disposed=!1,!H().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");if(n==null){var i=Pr(H().getNumber("WEBGL_VERSION"));o.binaryCache=((r=H().getNumber("WEBGL_VERSION"))in il||(il[r]={}),il[r]),o.gpgpu=new HD(i),o.canvas=i.canvas,o.gpgpuCreatedLocally=!0}else o.gpgpu=n,o.binaryCache={},o.gpgpuCreatedLocally=!1,o.canvas=n.gl.canvas;return o.textureManager=new g3(o.gpgpu),o.numMBBeforeWarning=H().global.screen==null?1024:H().global.screen.height*H().global.screen.width*window.devicePixelRatio*D3/1024/1024,o.texData=new o2(o,L),o}return sr(t,e),t.prototype.numDataIds=function(){return this.texData.numDataIds()+(this.cpuBackend?this.cpuBackend.numDataIds():0)-this.pendingDeletes},t.prototype.write=function(n,r,o){if(H().getBool("DEBUG")&&this.checkNumericalProblems(n),o==="complex64"&&n!=null)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");var i={};return this.texData.set(i,{shape:r,dtype:o,values:n,usage:gn.UPLOAD}),i},t.prototype.move=function(n,r,o,i){if(H().getBool("DEBUG")&&this.checkNumericalProblems(r),i==="complex64")throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(n,{shape:o,dtype:i,values:r,usage:gn.UPLOAD})},t.prototype.readSync=function(n){var r=this.texData.get(n),o=r.values,i=r.dtype,a=r.complexTensors,s=r.slice,u=r.shape,l=r.isPacked;if(s!=null){var c=void 0;c=l?new ms(u,ol):new be(u,ol);var d=this.runWebGLProgram(c,[{dataId:n,shape:u,dtype:i}],i),f=this.readSync(d.dataId);return this.disposeData(d.dataId),f}if(o!=null)return this.convertAndCacheOnCPU(n);if(i==="string")return o;var h,v,m=this.activeTimers!=null;return m&&(h=gr()),i==="complex64"?v=ep(a.real.dataSync(),a.imag.dataSync()):v=this.getValuesFromTexture(n),m&&(this.downloadWaitMs+=gr()-h),this.convertAndCacheOnCPU(n,v)},t.prototype.read=function(n){return oe(this,void 0,void 0,function(){var r,o,i,a,s,u,l,c,d,f,h,v,m,g,p,y,x,w,b,C,E,S;return ie(this,function(R){switch(R.label){case 0:if(this.pendingRead.has(n))return r=this.pendingRead.get(n),[2,new Promise(function(k){return r.push(k)})];if(o=this.texData.get(n),i=o.values,a=o.shape,s=o.slice,u=o.dtype,l=o.complexTensors,c=o.isPacked,s!=null)return d=void 0,d=c?new ms(a,ol):new be(a,ol),f=this.runWebGLProgram(d,[{dataId:n,shape:a,dtype:u}],u),h=this.read(f.dataId),this.disposeData(f.dataId),[2,h];if(i!=null)return[2,this.convertAndCacheOnCPU(n)];if(!H().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&H().getNumber("WEBGL_VERSION")===2)throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");return v=null,u!=="complex64"&&H().get("WEBGL_BUFFER_SUPPORTED")&&(m=this.decode(n),g=this.texData.get(m.dataId),v=(S=this.gpgpu).createBufferFromTexture.apply(S,[g.texture].concat(As(a)))),this.pendingRead.set(n,[]),u==="complex64"?[3,2]:[4,this.gpgpu.createAndWaitForFence()];case 1:R.sent(),R.label=2;case 2:return u!=="complex64"?[3,4]:[4,Promise.all([l.real.data(),l.imag.data()])];case 3:return y=R.sent(),x=y[0],w=y[1],p=ep(x,w),[3,5];case 4:v==null?p=this.getValuesFromTexture(n):(b=ae(a),p=this.gpgpu.downloadFloat32MatrixFromBuffer(v,b)),R.label=5;case 5:return m!=null&&this.disposeData(m.dataId),C=this.convertAndCacheOnCPU(n,p),E=this.pendingRead.get(n),this.pendingRead.delete(n),E.forEach(function(k){return k(C)}),this.pendingDisposal.has(n)&&(this.pendingDisposal.delete(n),this.disposeData(n),this.pendingDeletes--),[2,C]}})})},t.prototype.checkNumericalProblems=function(n){if(n!=null)for(var r=0;r<n.length;r++){var o=n[r];if(!CA(o))throw H().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error("The value "+o+" cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'"):Error("The value "+o+" cannot be represented on this device.")}},t.prototype.getValuesFromTexture=function(n){var r,o=this.texData.get(n),i=o.shape,a=o.dtype,s=o.isPacked,u=ae(i);if(H().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){var l=this.decode(n),c=this.texData.get(l.dataId),d=(r=this.gpgpu).downloadMatrixFromPackedTexture.apply(r,[c.texture].concat(As(i))).subarray(0,u);return this.disposeData(l.dataId),d}var f=H().getBool("WEBGL_PACK")&&s===!0,h=f?pf(i):i,v=f?new bD(h):new wD(h),m=this.runWebGLProgram(v,[{shape:h,dtype:a,dataId:n}],"float32"),g=this.texData.get(m.dataId),p=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(g.texture,g.texShape[0],g.texShape[1]).subarray(0,u);return this.disposeData(m.dataId),p},t.prototype.time=function(n){return oe(this,void 0,void 0,function(){var r,o,i,a,s,u,l;return ie(this,function(c){switch(c.label){case 0:return r=this.activeTimers,o=[],i=!1,this.programTimersStack==null?(this.programTimersStack=o,i=!0):this.activeTimers.push(o),this.activeTimers=o,n(),a=Va(this.activeTimers.map(function(d){return d.query})).filter(function(d){return d!=null}),s=Va(this.activeTimers.map(function(d){return d.name})).filter(function(d){return d!=null}),this.activeTimers=r,i&&(this.programTimersStack=null),u={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null},H().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?[4,Promise.all(a)]:[3,2];case 1:return l=c.sent(),u.kernelMs=nA(l),u.getExtraProfileInfo=function(){return l.map(function(d,f){return{name:s[f],ms:d}}).map(function(d){return d.name+": "+d.ms}).join(", ")},[3,3];case 2:u.kernelMs={error:"WebGL query timers are not supported in this environment."},c.label=3;case 3:return this.uploadWaitMs=0,this.downloadWaitMs=0,[2,u]}})})},t.prototype.memory=function(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU}},t.prototype.startTimer=function(){return H().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:gr(),endMs:null}},t.prototype.endTimer=function(n){return H().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),n):(n.endMs=gr(),n)},t.prototype.getQueryTime=function(n){return oe(this,void 0,void 0,function(){var r;return ie(this,function(o){return H().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?[2,this.gpgpu.waitForQueryAndGetTime(n)]:[2,(r=n).endMs-r.startMs]})})},t.prototype.disposeData=function(n){if(!this.pendingDisposal.has(n)){if(this.pendingRead.has(n))return this.pendingDisposal.add(n),void this.pendingDeletes++;if(this.texData.has(n)){this.releaseGPUData(n);var r=this.texData.get(n).complexTensors;r!=null&&(r.real.dispose(),r.imag.dispose()),this.texData.delete(n)}}},t.prototype.releaseGPUData=function(n){var r=this.texData.get(n),o=r.texture,i=r.dtype,a=r.texShape,s=r.usage,u=r.isPacked,l=r.slice,c=l&&l.origDataId||n,d=this.dataRefCount.get(c);d>1?this.dataRefCount.set(c,d-1):(this.dataRefCount.delete(c),o!=null&&(this.numBytesInGPU-=this.computeBytes(a,i),this.textureManager.releaseTexture(o,a,s,u)));var f=this.texData.get(n);f.texture=null,f.texShape=null,f.isPacked=!1,f.slice=null},t.prototype.getTexture=function(n){return this.uploadToGPU(n),this.texData.get(n).texture},t.prototype.getDataInfo=function(n){return this.texData.get(n)},t.prototype.getCPUBackend=function(){return H().getBool("WEBGL_CPU_FORWARD")?(this.cpuBackend==null&&(this.cpuBackend=L.findBackend("cpu")),this.cpuBackend):null},t.prototype.shouldExecuteOnCPU=function(n,r){var o=this;return r===void 0&&(r=128),this.getCPUBackend()!=null&&n.every(function(i){return o.texData.get(i.dataId).texture==null&&i.size<r})},t.prototype.getGPGPUContext=function(){return this.gpgpu},t.prototype.complex=function(n,r){var o=this.makeOutput(n.shape,"complex64");return this.texData.get(o.dataId).complexTensors={real:L.keep(n.clone()),imag:L.keep(r.clone())},o},t.prototype.real=function(n){return this.texData.get(n.dataId).complexTensors.real.clone()},t.prototype.imag=function(n){return this.texData.get(n.dataId).complexTensors.imag.clone()},t.prototype.slice=function(n,r,o){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.slice(n,r,o);if(ae(o)===0)return St([],o,n.dtype);var i=this.texData.get(n.dataId).isPacked,a=n2(n.shape,r,o);if(i||!a){var s=H().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new v3(o):new p3(o),u=s.getCustomSetupFunc(r);return this.compileAndRun(s,[n],null,u)}return this.uploadToGPU(n.dataId),this.shallowSlice(n,r,o)},t.prototype.shallowSlice=function(n,r,o){var i=this.texData.get(n.dataId),a=this.makeOutput(o,n.dtype),s=this.texData.get(a.dataId);Object.assign(s,i),s.shape=o,s.dtype=n.dtype;var u=r2(r,n.strides);i.slice&&(u+=i.slice.flatOffset),s.slice={flatOffset:u,origDataId:i.slice&&i.slice.origDataId||n.dataId};var l=this.dataRefCount.get(s.slice.origDataId)||1;return this.dataRefCount.set(s.slice.origDataId,l+1),a},t.prototype.stridedSlice=function(n,r,o,i){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.stridedSlice(n,r,o,i);var a=Nv(r,o,i);if(a.some(function(u){return u===0}))return St([],a);var s=new m3(r,i,a);return this.compileAndRun(s,[n])},t.prototype.reverse=function(n,r){var o=H().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new d3(n.shape,r):new c3(n.shape,r);return this.compileAndRun(o,[n])},t.prototype.concat=function(n,r){if(n[0].dtype==="complex64"){var o=n.map(function(h){return An(h)}),i=n.map(function(h){return wr(h)});return Et(this.concat(o,r),this.concat(i,r))}if(this.shouldExecuteOnCPU(n))return this.cpuBackend.concat(n,r);if(n.length===1)return n[0];if(n.length>H().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){var a=Math.floor(n.length/2),s=this.concat(n.slice(0,a),r),u=this.concat(n.slice(a),r);return this.concat([s,u],r)}if(H().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&n[0].rank>1){var l=new aD(n.map(function(h){return h.shape}),r);return this.compileAndRun(l,n)}var c=Ga(n.map(function(h){return h.shape}),r),d=n.map(function(h){return h.as2D(-1,ae(h.shape.slice(r)))}),f=new iD(d.map(function(h){return h.shape}));return this.compileAndRun(f,d).reshape(c)},t.prototype.neg=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.neg(n);if(H().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,Ky,n.dtype);var r=new be(n.shape,Ky);return this.compileAndRun(r,[n])},t.prototype.batchMatMul=function(n,r,o,i){var a=o?n.shape[2]:n.shape[1],s=i?r.shape[1]:r.shape[2],u=o?n.shape[1]:n.shape[2],l=n.shape[0];if((a===1||s===1)&&u>1e3){o&&(n=n.transpose([0,2,1])),i&&(r=r.transpose([0,2,1]));var c=s===1?n:n.as3D(l,u,1),d=s===1?2:1,f=s===1?r.as3D(l,1,u):r;return this.multiply(c,f).sum(d,!0)}var h=_t(n.dtype,r.dtype),v=new yf(n.shape,[l,a,s],o,i);return this.compileAndRun(v,[n,r],h)},t.prototype.fusedBatchMatMul=function(n){var r=n.a,o=n.b,i=n.transposeA,a=n.transposeB,s=n.bias,u=n.activation,l=n.preluActivationWeights,c=i?r.shape[2]:r.shape[1],d=a?o.shape[1]:o.shape[2],f=r.shape[0],h=_t(r.dtype,o.dtype),v=s!=null,m=l!=null,g=u?al(u,!0):null,p=new yf(r.shape,[f,c,d],i,a,v,g,m),y=[r,o];return s&&y.push(s),l&&y.push(l),this.compileAndRun(p,y,h)},t.prototype.multiply=function(n,r){if(n.dtype==="complex64"){var o=this.texData.get(n.dataId),i=this.texData.get(r.dataId),a=new Oy(eD,n.shape,r.shape),s=new Oy(tD,n.shape,r.shape),u=[this.makeComplexComponentTensorInfo(n,o.complexTensors.real),this.makeComplexComponentTensorInfo(n,o.complexTensors.imag),this.makeComplexComponentTensorInfo(r,i.complexTensors.real),this.makeComplexComponentTensorInfo(r,i.complexTensors.imag)],l=this.compileAndRun(a,u),c=this.compileAndRun(s,u),d=this.complex(l,c);return l.dispose(),c.dispose(),d}if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.multiply(n,r);if(H().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,Ly,n.dtype);var f=new Ze(Ly,n.shape,r.shape);return this.compileAndRun(f,[n,r],n.dtype)},t.prototype.batchNormalization=function(n,r,o,i,a,s){var u=[n,r,o],l=null;s!=null&&(l=s.shape,u.push(s));var c=null;if(a!=null&&(c=a.shape,u.push(a)),H().getBool("WEBGL_PACK_NORMALIZATION")){var d=new ZP(n.shape,r.shape,o.shape,l,c,i);return this.compileAndRun(d,u)}var f=new JP(n.shape,r.shape,o.shape,l,c,i);return this.compileAndRun(f,u)},t.prototype.localResponseNormalization4D=function(n,r,o,i,a){var s=H().getBool("WEBGL_PACK_NORMALIZATION")?new XD(n.shape,r,o,i,a):new qD(n.shape,r,o,i,a);return this.compileAndRun(s,[n])},t.prototype.LRNGrad=function(n,r,o,i,a,s,u){var l=new KD(r.shape,i,a,s,u);return this.compileAndRun(l,[r,o,n])},t.prototype.tile=function(n,r){if(n.dtype==="string"){var o=this.readSync(n.dataId).map(function(a){return fc(a)});return d2(ve(n.shape,n.dtype,o),r)}var i=new y3(n.shape,r);return this.compileAndRun(i,[n])},t.prototype.pad=function(n,r,o){var i=H().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new n3(n.shape,r,o):new t3(n.shape,r,o);return this.compileAndRun(i,[n])},t.prototype.transpose=function(n,r){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.transpose(n,r);var o=H().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new w3(n.shape,r):new x3(n.shape,r);return this.compileAndRun(o,[n])},t.prototype.gather=function(n,r,o){if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.gather(n,r,o);var i=new RD(n.shape,r.size,o);return this.compileAndRun(i,[n,r])},t.prototype.batchToSpaceND=function(n,r,o){I(n.rank<=4,function(){return"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet"});var i=r.reduce(function(d,f){return d*f}),a=yc(n.shape,r,i),s=xc(a.length,r.length),u=wc(n.shape,r,i),l=Jb(o,r.length),c=Zb(u,o,r.length);return n.reshape(a).transpose(s).reshape(u).slice(l,c)},t.prototype.spaceToBatchND=function(n,r,o){I(n.rank<=4,function(){return"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet"});var i=r.reduce(function(f,h){return f*h}),a=[[0,0]];a.push.apply(a,o);for(var s=1+r.length;s<n.shape.length;++s)a.push([0,0]);var u=n.pad(a),l=yc(u.shape,r,i,!1),c=xc(l.length,r.length,!1),d=wc(u.shape,r,i,!1);return u.reshape(l).transpose(c).reshape(d)},t.prototype.reduce=function(n,r,o){var i=n.shape[0],a=n.shape[1],s=vf(a),u=new r3({windowSize:s,inSize:a,batchSize:i},r),l=this.compileAndRun(u,[n],o);return l.shape[1]===1?l:this.reduce(l,r,o)},t.prototype.argReduce=function(n,r,o){o===void 0&&(o=null);var i=n.shape[0],a=n.shape[1];o!=null&&(i=o.shape[0],a=o.shape[1]);var s=vf(a),u=new $P({windowSize:s,inSize:a,batchSize:i},r,o==null),l=[n];o!=null&&l.push(o);var c=this.compileAndRun(u,l,"int32");return c.shape[1]===1?c:this.argReduce(n,r,c)},t.prototype.argReducePacked=function(n,r,o){o===void 0&&(o=null);var i=o!=null?o.shape:n.shape,a=vf(i[i.length-1]),s=new XP(i,a,r,o==null),u=o==null?[n]:[n,o],l=this.compileAndRun(s,u,"int32");return l.rank===n.rank?this.argReducePacked(n,r,l):l},t.prototype.sum=function(n,r){hn("sum",r,n.rank);var o=Ft(n.shape,r),i=o[0],a=ae(o[1]),s=n.as2D(-1,a),u=sf(n.dtype);return this.reduce(s,"sum",u).reshape(i)},t.prototype.prod=function(n,r){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.prod(n,r);var o=Ft(n.shape,r),i=o[0],a=ae(o[1]),s=n.as2D(-1,a),u=sf(n.dtype);return this.reduce(s,"prod",u).reshape(i)},t.prototype.unsortedSegmentSum=function(n,r,o){var i=0,a=Dr([i],n.rank),s=n;a!=null&&(s=n.transpose(a),i=Fr(1,n.rank)[0]);var u=function(h,v,m){for(var g=[],p=h.length,y=0;y<p;y++)y!==v?g.push(h[y]):g.push(m);return g}(s.shape,i,o),l=ae([s.shape[i]]),c=s.as2D(-1,l),d=sf(n.dtype),f=this.segOpCompute(c,"unsortedSegmentSum",r,d,o).reshape(u);return a!=null&&(f=f.transpose(_v(a))),f},t.prototype.segOpCompute=function(n,r,o,i,a){var s=n.shape[0],u=n.shape[1],l=function(f,h){var v,m=!1;for(f<=t2?(v=f,m=!0):v=Hh(f,Math.floor(Math.sqrt(f)));!m;)v>h||v===f?m=!0:v=Hh(f,v+1);return v}(u,a),c=new f3({windowSize:l,inSize:u,batchSize:s,numSegments:a}),d=this.compileAndRun(c,[n,o],i);return d.shape[1]===a?d:(o=gc(0,a).tile([u/l]),this.segOpCompute(d,r,o,i,a))},t.prototype.argMinMaxReduce=function(n,r,o){var i=[r];if(hn("arg"+o.charAt(0).toUpperCase()+o.slice(1),i,n.rank),!H().getBool("WEBGL_PACK_REDUCE")||n.rank<=2){var a=Ft(n.shape,i),s=a[0],u=ae(a[1]),l=n.as2D(-1,u);return this.argReduce(l,o).reshape(s)}return this.argReducePacked(n,o)},t.prototype.argMin=function(n,r){return this.argMinMaxReduce(n,r,"min")},t.prototype.argMax=function(n,r){return this.argMinMaxReduce(n,r,"max")},t.prototype.cumsum=function(n,r,o,i){if(r!==n.rank-1)throw new Error("WebGL cumsum shader expects an inner-most axis="+(n.rank-1)+" but got axis="+r);var a=new vD(n.shape,o,i);return this.compileAndRun(a,[n])},t.prototype.equal=function(n,r){if(H().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(equal(a, b));
`,"bool");var o=new Ze("return float(a == b);",n.shape,r.shape);return this.compileAndRun(o,[n,r],"bool")},t.prototype.notEqual=function(n,r){if(H().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(notEqual(a, b));
`,"bool");var o=new Ze("return float(a != b);",n.shape,r.shape);return this.compileAndRun(o,[n,r],"bool")},t.prototype.less=function(n,r){if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.less(n,r);if(H().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(lessThan(a, b));
`,"bool");var o=new Ze("return float(a < b);",n.shape,r.shape);return this.compileAndRun(o,[n,r],"bool")},t.prototype.lessEqual=function(n,r){if(H().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(lessThanEqual(a, b));
`,"bool");var o=new Ze("return float(a <= b);",n.shape,r.shape);return this.compileAndRun(o,[n,r],"bool")},t.prototype.greater=function(n,r){if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.greater(n,r);if(H().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(greaterThan(a, b));
`,"bool");var o=new Ze("return float(a > b);",n.shape,r.shape);return this.compileAndRun(o,[n,r],"bool")},t.prototype.greaterEqual=function(n,r){if(H().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(greaterThanEqual(a, b));
`,"bool");var o=new Ze("return float(a >= b);",n.shape,r.shape);return this.compileAndRun(o,[n,r],"bool")},t.prototype.logicalNot=function(n){var r=new be(n.shape,"return float(!(x >= 1.0));");return this.compileAndRun(r,[n])},t.prototype.logicalAnd=function(n,r){if(H().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(
    vec4(greaterThanEqual(a, vec4(1.0))) *
    vec4(greaterThanEqual(b, vec4(1.0))));
`,"bool");var o=new Ze("return float(a >= 1.0 && b >= 1.0);",n.shape,r.shape);return this.compileAndRun(o,[n,r],"bool")},t.prototype.logicalOr=function(n,r){if(H().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return min(
    vec4(greaterThanEqual(a, vec4(1.0))) +
    vec4(greaterThanEqual(b, vec4(1.0))),
    vec4(1.0));
`,"bool");var o=new Ze("return float(a >= 1.0 || b >= 1.0);",n.shape,r.shape);return this.compileAndRun(o,[n,r],"bool")},t.prototype.select=function(n,r,o){var i=new h3(n.rank,r.shape,r.rank);return this.compileAndRun(i,[n,r,o],_t(r.dtype,o.dtype))},t.prototype.where=function(n){vc("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");var r=n.dataSync();return Pv(n.shape,r)},t.prototype.topk=function(n,r,o){return f2(n.dataSync(),n.shape,n.dtype,r)},t.prototype.min=function(n,r){hn("min",r,n.rank);var o=Ft(n.shape,r),i=o[0],a=ae(o[1]),s=n.as2D(-1,a);return this.reduce(s,"min",s.dtype).reshape(i)},t.prototype.minimum=function(n,r){if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.minimum(n,r);var o=H().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Wr(`
  vec4 result = vec4(min(a, b));
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,n.shape,r.shape):new Ze(`
  if (isnan(a)) return a;
  if (isnan(b)) return b;

  return min(a, b);
`,n.shape,r.shape);return this.compileAndRun(o,[n,r])},t.prototype.mod=function(n,r){var o=H().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Wr(`
  vec4 result = mod(a, b);
  vec4 isNaN = vec4(equal(b, vec4(0.0)));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,n.shape,r.shape):new Ze(`if (b == 0.0) return NAN;
  return mod(a, b);`,n.shape,r.shape);return this.compileAndRun(o,[n,r])},t.prototype.max=function(n,r){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.max(n,r);hn("max",r,n.rank);var o=Ft(n.shape,r),i=o[0],a=ae(o[1]),s=n.as2D(-1,a);return this.reduce(s,"max",s.dtype).reshape(i)},t.prototype.maximum=function(n,r){if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.maximum(n,r);var o=H().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Wr(`
  vec4 result = vec4(max(a, b));
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,n.shape,r.shape):new Ze(`
  if (isnan(a)) return a;
  if (isnan(b)) return b;

  return max(a, b);
`,n.shape,r.shape);return this.compileAndRun(o,[n,r])},t.prototype.all=function(n,r){hn("all",r,n.rank);var o=Ft(n.shape,r),i=o[0],a=ae(o[1]),s=n.as2D(-1,a);return this.reduce(s,"all",s.dtype).reshape(i)},t.prototype.any=function(n,r){hn("any",r,n.rank);var o=Ft(n.shape,r),i=o[0],a=ae(o[1]),s=n.as2D(-1,a);return this.reduce(s,"any",s.dtype).reshape(i)},t.prototype.realDivide=function(n,r){if(H().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  // vec4 one = vec4(equal(a, b));
  // return one + (vec4(1.0) - one) * a / b;
  vec4 result = a / b;
  if(a.x == b.x) {
    result.x = 1.;
  }
  if(a.y == b.y) {
    result.y = 1.;
  }
  if(a.z == b.z) {
    result.z = 1.;
  }
  if(a.w == b.w) {
    result.w = 1.;
  }

  return result;
`,"float32",!0);var o=new Ze(`
if (a == b) {
  return 1.0;
};
return a / b;`,n.shape,r.shape);return this.compileAndRun(o,[n,r],"float32")},t.prototype.floorDiv=function(n,r){if(H().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  ivec4 ia = round(a);
  ivec4 ib = round(b);
  bvec4 cond = notEqual(ib, ivec4(0));
  ivec4 result = ivec4(0);
  vec4 s = sign(a) * sign(b);

  // Windows (D3D) wants guaranteed non-zero int division at compile-time.
  if (cond[0]) {
    result[0] = idiv(ia[0], ib[0], s[0]);
  }
  if (cond[1]) {
    result[1] = idiv(ia[1], ib[1], s[1]);
  }
  if (cond[2]) {
    result[2] = idiv(ia[2], ib[2], s[2]);
  }
  if (cond[3]) {
    result[3] = idiv(ia[3], ib[3], s[3]);
  }
  return vec4(result);
`,"int32");var o=new Ze(`
  float s = sign(a) * sign(b);
  int ia = round(a);
  int ib = round(b);
  if (ib != 0) {
    // Windows (D3D) wants guaranteed non-zero int division at compile-time.
    return float(idiv(ia, ib, s));
  } else {
    return NAN;
  }
`,n.shape,r.shape);return this.compileAndRun(o,[n,r],"int32")},t.prototype.add=function(n,r){if(n.dtype==="complex64"&&r.dtype==="complex64")return this.complexSeparableBinaryOp(n,r,mf);if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.add(n,r);var o=_t(n.dtype,r.dtype);if(H().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,mf,o);var i=new Ze(mf,n.shape,r.shape);return this.compileAndRun(i,[n,r],o)},t.prototype.packedUnaryOp=function(n,r,o){var i=new ms(n.shape,r);return this.compileAndRun(i,[n],o)},t.prototype.packedBinaryOp=function(n,r,o,i,a){a===void 0&&(a=!1);var s=new Wr(o,n.shape,r.shape,a);return this.compileAndRun(s,[n,r],i)},t.prototype.complexSeparableBinaryOp=function(n,r,o){var i=this,a=this.texData.get(n.dataId),s=this.texData.get(r.dataId),u=[[a.complexTensors.real,s.complexTensors.real],[a.complexTensors.imag,s.complexTensors.imag]].map(function(f){var h=f[0],v=f[1],m=i.makeComplexComponentTensorInfo(n,h),g=i.makeComplexComponentTensorInfo(r,v),p=new Ze(o,n.shape,r.shape);return i.compileAndRun(p,[m,g],_t(h.dtype,v.dtype))}),l=u[0],c=u[1],d=this.complex(l,c);return l.dispose(),c.dispose(),d},t.prototype.makeComplexComponentTensorInfo=function(n,r){return{dataId:r.dataId,dtype:r.dtype,shape:n.shape}},t.prototype.addN=function(n){if(n.length===1)return n[0];if(n.length>H().get("WEBGL_MAX_TEXTURES_IN_SHADER")){var r=Math.floor(n.length/2),o=this.addN(n.slice(0,r)),i=this.addN(n.slice(r));return this.addN([o,i])}var a=n.map(function(l){return l.dtype}).reduce(function(l,c){return _t(l,c)}),s=n.map(function(l){return l.shape}),u=H().getBool("WEBGL_PACK")?new UP(n[0].shape,s):new zP(n[0].shape,s);return this.compileAndRun(u,n,a)},t.prototype.subtract=function(n,r){if(n.dtype==="complex64"&&r.dtype==="complex64")return this.complexSeparableBinaryOp(n,r,gf);if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.subtract(n,r);var o=_t(n.dtype,r.dtype);if(H().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,gf,n.dtype);var i=new Ze(gf,n.shape,r.shape);return this.compileAndRun(i,[n,r],o)},t.prototype.pow=function(n,r){var o=H().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Wr(`
  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.
  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));
  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);
  vec4 result = multiplier * pow(abs(a), b);

  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS
  bvec4 isExpZero = equal(b, vec4(0.0));
  result.r = isExpZero.r ? 1.0 : result.r;
  result.g = isExpZero.g ? 1.0 : result.g;
  result.b = isExpZero.b ? 1.0 : result.b;
  result.a = isExpZero.a ? 1.0 : result.a;

  vec4 isNaN = vec4(lessThan(a, vec4(0.0))) * vec4(lessThan(floor(b), b));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,n.shape,r.shape):new Ze(`
if(a < 0.0 && floor(b) < b){
  return NAN;
}
if (b == 0.0) {
  return 1.0;
}
return (round(mod(b, 2.0)) != 1) ?
    pow(abs(a), b) : sign(a) * pow(abs(a), b);
`,n.shape,r.shape),i=_t(n.dtype,r.dtype);return this.compileAndRun(o,[n,r],i)},t.prototype.ceil=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.ceil(n);if(H().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,Xy,n.dtype);var r=new be(n.shape,Xy);return this.compileAndRun(r,[n])},t.prototype.floor=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.floor(n);if(H().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,Yy,n.dtype);var r=new be(n.shape,Yy);return this.compileAndRun(r,[n])},t.prototype.sign=function(n){var r=new be(n.shape,`
  if (isnan(x)) { return 0.0; }
  return sign(x);
`);return this.compileAndRun(r,[n])},t.prototype.isNaN=function(n){var r=new be(n.shape,"return float(isnan(x));");return this.compileAndRun(r,[n],"bool")},t.prototype.isInf=function(n){var r=new be(n.shape,"return float(isinf(x));");return this.compileAndRun(r,[n],"bool")},t.prototype.isFinite=function(n){var r=new be(n.shape,"return float(!isnan(x) && !isinf(x));");return this.compileAndRun(r,[n],"bool")},t.prototype.round=function(n){var r=new be(n.shape,`
  // OpenGL ES does not support round function.
  // The algorithm is based on banker's rounding.
  float base = floor(x);
  if ((x - base) < 0.5) {
    return floor(x);
  } else if ((x - base) > 0.5) {
    return ceil(x);
  } else {
    if (mod(base, 2.0) == 0.0) {
      return base;
    } else {
      return base + 1.0;
    }
  }
`);return this.compileAndRun(r,[n])},t.prototype.exp=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.exp(n);if(H().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,Qy,n.dtype);var r=new be(n.shape,Qy);return this.compileAndRun(r,[n])},t.prototype.expm1=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.expm1(n);if(H().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,Jy,n.dtype);var r=new be(n.shape,Jy);return this.compileAndRun(r,[n])},t.prototype.softmax=function(n,r){var o=vt([r],n.shape),i=this.max(n,o),a=un(i.shape,o),s=this.subtract(n,i.reshape(a)),u=this.exp(s),l=this.sum(u,o).reshape(a);return this.realDivide(u,l)},t.prototype.log=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.log(n);if(H().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,`
  vec4 result = log(x);
  vec4 isNaN = vec4(lessThan(x, vec4(0.0)));
  result.r = isNaN.r == 1.0 ? NAN : result.r;
  result.g = isNaN.g == 1.0 ? NAN : result.g;
  result.b = isNaN.b == 1.0 ? NAN : result.b;
  result.a = isNaN.a == 1.0 ? NAN : result.a;

  return result;
`,n.dtype);var r=new be(n.shape,`if (x < 0.0) return NAN;
  return log(x);`);return this.compileAndRun(r,[n])},t.prototype.log1p=function(n){var r=new be(n.shape,"return log(1.0 + x);");return this.compileAndRun(r,[n])},t.prototype.sqrt=function(n){var r=new be(n.shape,"return sqrt(x);");return this.compileAndRun(r,[n])},t.prototype.rsqrt=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.rsqrt(n);var r=new be(n.shape,"return inversesqrt(x);");return this.compileAndRun(r,[n])},t.prototype.reciprocal=function(n){var r=new be(n.shape,"return 1.0 / x;");return this.compileAndRun(r,[n])},t.prototype.relu=function(n){var r;return r=H().getBool("WEBGL_PACK")?new ms(n.shape,b2):new be(n.shape,y2),this.compileAndRun(r,[n])},t.prototype.relu6=function(n){var r;return r=H().getBool("WEBGL_PACK")?new ms(n.shape,C2):new be(n.shape,x2),this.compileAndRun(r,[n])},t.prototype.prelu=function(n,r){var o=H().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Wr(g2,n.shape,r.shape):new Ze(m2,n.shape,r.shape);return this.compileAndRun(o,[n,r])},t.prototype.elu=function(n){if(H().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,E2,n.dtype);var r=new be(n.shape,w2);return this.compileAndRun(r,[n])},t.prototype.eluDer=function(n,r){var o=H().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Wr(`
  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));
  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));
`,n.shape,r.shape):new Ze("return (b >= 1.0) ? a : a * (b + 1.0);",n.shape,r.shape);return this.compileAndRun(o,[n,r])},t.prototype.selu=function(n){var r=new be(n.shape,C3);return this.compileAndRun(r,[n])},t.prototype.int=function(n){var r=new be(n.shape,"return float(int(x));");return this.compileAndRun(r,[n],"int32")},t.prototype.clip=function(n,r,o){var i,a=(i=H().getBool("WEBGL_PACK_CLIP")?new rD(n.shape):new nD(n.shape)).getCustomSetupFunc(r,o);return this.compileAndRun(i,[n],null,a)},t.prototype.abs=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.abs(n);if(H().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,qy,n.dtype);var r=new be(n.shape,qy);return this.compileAndRun(r,[n])},t.prototype.complexAbs=function(n){var r=this.texData.get(n.dataId),o=new oD(n.shape),i=[this.makeComplexComponentTensorInfo(n,r.complexTensors.real),this.makeComplexComponentTensorInfo(n,r.complexTensors.imag)];return this.compileAndRun(o,i)},t.prototype.sigmoid=function(n){var r=new be(n.shape,"return 1.0 / (1.0 + exp(-1.0 * x));");return this.compileAndRun(r,[n])},t.prototype.softplus=function(n){var r=new be(n.shape,`
  float epsilon = 1.1920928955078125e-7;
  float threshold = log(epsilon) + 2.0;

  bool too_large = x > -threshold;
  bool too_small = x < threshold;

  float result;
  float exp_x = exp(x);

  if (too_large){
    result = x;
  }
  else if (too_small){
    result = exp_x;
  }
  else{
    result = log(exp_x + 1.0);
  }
  return result;
`);return this.compileAndRun(r,[n])},t.prototype.sin=function(n){var r=new be(n.shape,E3);return this.compileAndRun(r,[n])},t.prototype.cos=function(n){var r=new be(n.shape,_3);return this.compileAndRun(r,[n])},t.prototype.tan=function(n){var r=new be(n.shape,"return tan(x);");return this.compileAndRun(r,[n])},t.prototype.asin=function(n){var r=new be(n.shape,S3);return this.compileAndRun(r,[n])},t.prototype.acos=function(n){var r=new be(n.shape,k3);return this.compileAndRun(r,[n])},t.prototype.atan=function(n){var r=new be(n.shape,R3);return this.compileAndRun(r,[n])},t.prototype.atan2=function(n,r){var o=H().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Wr(`
  vec4 result = atan(a, b);
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,n.shape,r.shape):new Ze(`
  if (isnan(a)) return a;
  if (isnan(b)) return b;

  return atan(a, b);
`,n.shape,r.shape);return this.compileAndRun(o,[n,r])},t.prototype.sinh=function(n){var r=new be(n.shape,`
  float e2x = exp(x);
  return (e2x - 1.0 / e2x) / 2.0;
`);return this.compileAndRun(r,[n])},t.prototype.cosh=function(n){var r=new be(n.shape,`
  float e2x = exp(-x);
  return (e2x + 1.0 / e2x) / 2.0;
`);return this.compileAndRun(r,[n])},t.prototype.tanh=function(n){var r=new be(n.shape,`
  float e2x = exp(-2.0 * abs(x));
  return sign(x) * (1.0 - e2x) / (1.0 + e2x);
`);return this.compileAndRun(r,[n])},t.prototype.asinh=function(n){var r=new be(n.shape,N3);return this.compileAndRun(r,[n])},t.prototype.acosh=function(n){var r=new be(n.shape,I3);return this.compileAndRun(r,[n])},t.prototype.atanh=function(n){var r=new be(n.shape,T3);return this.compileAndRun(r,[n])},t.prototype.erf=function(n){var r=new be(n.shape,`
  // Error function is calculated approximately with elementary function.
  // See "Handbook of Mathematical Functions with Formulas,
  // Graphs, and Mathematical Tables", Abramowitz and Stegun.
  float p = 0.3275911;
  float a1 = 0.254829592;
  float a2 = -0.284496736;
  float a3 = 1.421413741;
  float a4 = -1.453152027;
  float a5 = 1.061405429;

  float sign = sign(x);
  x = abs(x);
  float t = 1.0 / (1.0 + p * x);
  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));
`);return this.compileAndRun(r,[n])},t.prototype.step=function(n,r){var o=new be(n.shape,function(i){return i===void 0&&(i=0),ur+`
    return x > 0.0 ? 1.0 : float(`+i+`);
  `}(r));return this.compileAndRun(o,[n])},t.prototype.conv2dByMatMul=function(n,r,o,i,a,s){var u=n.shape,l=this.texData.get(n.dataId),c=o.inChannels,d=u[0]*u[1]*u[2],f=o.outChannels,h=o.dataFormat==="channelsLast",v=(d===1||f===1)&&c>1e3,m=u[2]%2!=0&&!!l.isPacked;if(v||!H().getBool("WEBGL_LAZILY_UNPACK")||!H().getBool("WEBGL_PACK_BINARY_OPERATIONS")||!m){var g=h?u[0]*u[1]*u[2]:u[0]*u[2]*u[3],p=this.reshape(n,[1,g,o.inChannels]),y=this.reshape(r,[1,o.inChannels,o.outChannels]);return this.reshape(this.fusedBatchMatMul({a:p,b:y,transposeA:!1,transposeB:!1,bias:i,activation:a,preluActivationWeights:s}),o.outShape)}var x=h?u[0]*u[1]*(u[2]+1):u[0]*u[2]*(u[3]+1),w={dataId:n.dataId,shape:[1,x,o.inChannels],dtype:n.dtype},b=l.shape;l.shape=l.shape.slice(),l.shape[l.shape.length-2]++,I(nl(l.shape,w.shape),function(){return"packed reshape "+l.shape+" to "+w.shape+" isn't free"});var C=this.reshape(r,[1,o.inChannels,o.outChannels]),E=this.fusedBatchMatMul({a:w,b:C,transposeA:!1,transposeB:!1,bias:i,activation:a,preluActivationWeights:s}),S=this.texData.get(E.dataId);return I(S.isPacked,function(){return"batchMatMul result is expected to be packed"}),l.shape=b,S.shape=o.outShape,L.makeTensorFromDataId(E.dataId,o.outShape,E.dtype)},t.prototype.conv2dWithIm2Row=function(n,r,o,i,a,s){var u=o.filterWidth,l=o.filterHeight,c=o.inChannels,d=o.outWidth,f=o.outHeight,h=o.dataFormat==="channelsLast",v=u*l*c,m=f*d,g=[v,m],p=n.squeeze([0]),y=r.reshape([1,v,-1]),x=new GD(g,p.shape,o),w=this.compileAndRun(x,[p]).reshape([1,g[0],g[1]]),b=i!=null,C=s!=null,E=a?al(a,!0):null,S=new yf(w.shape,[1,m,o.outChannels],!0,!1,b,E,C),R=[w,y];i&&R.push(i),C&&R.push(s);var k=this.compileAndRun(S,R);return h?k.reshape([1,f,d,o.outChannels]):k.reshape([1,o.outChannels,f,d])},t.prototype.fusedConv2d=function(n){var r=n.input,o=n.filter,i=n.convInfo,a=n.bias,s=n.activation,u=n.preluActivationWeights;if(i.filterHeight===1&&i.filterWidth===1&&i.dilationHeight===1&&i.dilationWidth===1&&i.strideHeight===1&&i.strideWidth===1&&(i.padInfo.type==="SAME"||i.padInfo.type==="VALID"))return this.conv2dByMatMul(r,o,i,a,s,u);if(H().getBool("WEBGL_CONV_IM2COL")&&r.shape[0]===1)return this.conv2dWithIm2Row(r,o,i,a,s,u);var l=a!=null,c=u!=null,d=s?al(s,!1):null,f=new By(i,l,d,c),h=[r,o];return a&&h.push(a),u&&h.push(u),this.compileAndRun(f,h)},t.prototype.conv2d=function(n,r,o){if(o.filterHeight===1&&o.filterWidth===1&&o.dilationHeight===1&&o.dilationWidth===1&&o.strideHeight===1&&o.strideWidth===1&&(o.padInfo.type==="SAME"||o.padInfo.type==="VALID"))return this.conv2dByMatMul(n,r,o);if(H().getBool("WEBGL_CONV_IM2COL")&&n.shape[0]===1)return this.conv2dWithIm2Row(n,r,o);var i=new By(o);return this.compileAndRun(i,[n,r])},t.prototype.conv2dDerInput=function(n,r,o){var i=new uD(o);return this.compileAndRun(i,[n,r])},t.prototype.conv2dDerFilter=function(n,r,o){var i=new sD(o);return this.compileAndRun(i,[n,r])},t.prototype.fusedDepthwiseConv2D=function(n){var r,o=n.input,i=n.filter,a=n.convInfo,s=n.bias,u=n.activation,l=n.preluActivationWeights,c=H().getBool("WEBGL_PACK_DEPTHWISECONV")&&a.strideWidth<=2&&a.outChannels/a.inChannels==1,d=u?al(u,c):null,f=[o,i],h=s!=null,v=l!=null;return h&&f.push(s),v&&f.push(l),c?(r=new Wy(a,h,d,v),this.compileAndRun(r,f)):(r=new jy(a,h,d,v),this.compileAndRun(r,f))},t.prototype.depthwiseConv2D=function(n,r,o){var i;return H().getBool("WEBGL_PACK_DEPTHWISECONV")&&o.strideWidth<=2&&o.outChannels/o.inChannels==1?(i=new Wy(o),this.compileAndRun(i,[n,r])):(i=new jy(o),this.compileAndRun(i,[n,r]))},t.prototype.depthwiseConv2DDerInput=function(n,r,o){var i=new fD(o);return this.compileAndRun(i,[n,r])},t.prototype.depthwiseConv2DDerFilter=function(n,r,o){var i=new dD(o);return this.compileAndRun(i,[n,r])},t.prototype.conv3d=function(n,r,o){var i=new hD(o);return this.compileAndRun(i,[n,r])},t.prototype.conv3dDerInput=function(n,r,o){var i=new cD(o);return this.compileAndRun(i,[n,r])},t.prototype.conv3dDerFilter=function(n,r,o){var i=new lD(o);return this.compileAndRun(i,[n,r])},t.prototype.maxPool=function(n,r){var o=new xf(r,"max",!1);return this.compileAndRun(o,[n])},t.prototype.avgPool=function(n,r){var o=new xf(r,"avg",!1);return this.compileAndRun(o,[n],"float32")},t.prototype.maxPoolBackprop=function(n,r,o,i){var a=new xf(i,"max",!0),s=this.compileAndRun(a,[r]),u=new YD(i),l=this.compileAndRun(u,[n,s],r.dtype);return s.dispose(),l},t.prototype.avgPoolBackprop=function(n,r,o){var i=new YP(o);return this.compileAndRun(i,[n],r.dtype)},t.prototype.cast=function(n,r){return s2(n,r,this)},t.prototype.unstack=function(n,r){for(var o=n.shape[r],i=new Array(n.rank-1),a=0,s=0;s<n.rank;s++)s!==r&&(i[a++]=n.shape[s]);var u=new Array(n.rank).fill(0),l=n.shape.slice();l[r]=1;var c=new Array(o);for(s=0;s<c.length;s++)u[r]=s,c[s]=this.slice(n,u,l).reshape(i);return c},t.prototype.avgPool3d=function(n,r){var o=new wf(r,"avg",!1);return this.compileAndRun(o,[n],"float32")},t.prototype.avgPool3dBackprop=function(n,r,o){var i=new QP(o);return this.compileAndRun(i,[n],r.dtype)},t.prototype.maxPool3d=function(n,r){var o=new wf(r,"max",!1);return this.compileAndRun(o,[n],"float32")},t.prototype.maxPool3dBackprop=function(n,r,o,i){var a=new wf(i,"max",!0),s=this.compileAndRun(a,[r]),u=new QD(i),l=this.compileAndRun(u,[n,s],r.dtype);return s.dispose(),l},t.prototype.reshape=function(n,r){var o=this.texData.get(n.dataId);if(o.isPacked&&!nl(n.shape,r)&&(o.texture===null||!nl(o.shape,r))){var i=this.packedReshape(n,r);return L.makeTensorFromDataId(i.dataId,i.shape,i.dtype)}return Zh(n,r)},t.prototype.resizeBilinear=function(n,r,o,i){var a=H().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new s3(n.shape,r,o,i):new a3(n.shape,r,o,i);return this.compileAndRun(a,[n],"float32")},t.prototype.resizeBilinearBackprop=function(n,r,o){var i=new i3(n,r,o);return this.compileAndRun(i,[n])},t.prototype.resizeNearestNeighbor=function(n,r,o,i){var a=new l3(n.shape,r,o,i);return this.compileAndRun(a,[n])},t.prototype.resizeNearestNeighborBackprop=function(n,r,o){var i=new u3(n,r,o);return this.compileAndRun(i,[n])},t.prototype.multinomial=function(n,r,o,i){var a=r?n:no(n),s=a.shape[0],u=a.shape[1],l=new JD(s,u,o),c=l.getCustomSetupFunc(i);return this.compileAndRun(l,[a],"int32",c)},t.prototype.oneHot=function(n,r,o,i){var a=new ZD(n.size,r,o,i);return this.compileAndRun(a,[n])},t.prototype.diag=function(n){var r=new xD(n.size);return this.compileAndRun(r,[n])},t.prototype.nonMaxSuppression=function(n,r,o,i,a){return vc("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead"),Tv(n.dataSync(),r.dataSync(),o,i,a)},t.prototype.cropAndResize=function(n,r,o,i,a,s){var u=new pD(n.shape,r.shape,i,a,s);return this.compileAndRun(u,[n,r,o],"float32")},t.prototype.depthToSpace=function(n,r,o){I(r>1,function(){return"blockSize should be > 1 for depthToSpace, but was: "+r});var i=n.shape[0],a=o==="NHWC"?n.shape[1]:n.shape[2],s=o==="NHWC"?n.shape[2]:n.shape[3],u=o==="NHWC"?n.shape[3]:n.shape[1],l=a*r,c=s*r,d=u/(r*r),f=new yD(o==="NHWC"?[i,l,c,d]:[i,d,l,c],r,o);return this.compileAndRun(f,[n])},t.prototype.split=function(n,r,o){return c2(n,r,o)},t.prototype.scatterND=function(n,r,o){var i=bc(0,n,o),a=i.sliceRank,s=i.numUpdates,u=i.sliceSize,l=i.strides,c=i.outputSize,d=[c/u,u],f=n.reshape([s,a]),h=r.reshape([s,u]);if(c===0)return Zh(St([]),o);var v=ee(0),m=new Vy(s,a,f.rank,h.rank,l,d);return this.compileAndRun(m,[h,f,v]).reshape(o)},t.prototype.sparseToDense=function(n,r,o,i){var a=bc(0,n,o),s=a.sliceRank,u=a.numUpdates,l=a.strides,c=a.outputSize,d=new Vy(u,s,n.rank,r.rank,l,[c,1]);return this.compileAndRun(d,[r,n,i]).reshape(o)},t.prototype.fft=function(n){return this.fftImpl(n,!1)},t.prototype.ifft=function(n){return this.fftImpl(n,!0)},t.prototype.fftImpl=function(n,r){var o=this.texData.get(n.dataId),i=new Uy(_D,n.shape,r),a=new Uy(SD,n.shape,r),s=[this.makeComplexComponentTensorInfo(n,o.complexTensors.real),this.makeComplexComponentTensorInfo(n,o.complexTensors.imag)],u=this.compileAndRun(i,s),l=this.compileAndRun(a,s),c=this.complex(u,l).as2D(n.shape[0],n.shape[1]);return u.dispose(),l.dispose(),c},t.prototype.gatherND=function(n,r){var o=r.shape,i=o[o.length-1],a=e2(n,r),s=a[0],u=a[1],l=a[2],c=a[3],d=r.reshape([u,i]),f=n.reshape([n.size/l,l]),h=new ND(i,c,[u,l]);return this.compileAndRun(h,[f,d]).reshape(s)},t.prototype.fill=function(n,r,o){if((o=o||yu(r))==="string"){var i=dc(o,ae(n));return i.fill(r),L.makeTensor(i,n,o,this)}var a=new kD(n,r),s=a.getCustomSetupFunc(r);return this.compileAndRun(a,[],o,s)},t.prototype.onesLike=function(n){if(n.dtype==="string")throw new Error("onesLike is not supported under string dtype");return this.fill(n.shape,1,n.dtype)},t.prototype.zerosLike=function(n){return this.fill(n.shape,n.dtype==="string"?"":0,n.dtype)},t.prototype.linspace=function(n,r,o){return u2(n,r,o)},t.prototype.makeTensorInfo=function(n,r){var o=this.write(null,n,r);return this.texData.get(o).usage=null,{dataId:o,shape:n,dtype:r}},t.prototype.makeOutput=function(n,r){var o=this.makeTensorInfo(n,r).dataId;return L.makeTensorFromDataId(o,n,r,this)},t.prototype.unpackTensor=function(n){var r=new P3(n.shape);return this.runWebGLProgram(r,[n],n.dtype)},t.prototype.packTensor=function(n){var r=new e3(n.shape);return this.runWebGLProgram(r,[n],n.dtype,null,!0)},t.prototype.packedReshape=function(n,r){var o=[hc(n.shape)].concat(pc(n.shape)),i={dtype:n.dtype,shape:o,dataId:n.dataId},a=[hc(r)].concat(pc(r)),s=new o3(a,o),u=this.runWebGLProgram(s,[i],n.dtype,null,!0);return{dataId:u.dataId,shape:r,dtype:u.dtype}},t.prototype.decode=function(n){var r,o=this.texData.get(n),i=o.isPacked,a=o.shape,s=o.dtype,u=pf(a);return r=i?new gD(u):new mD(u),{dtype:s,shape:a,dataId:this.runWebGLProgram(r,[{shape:u,dtype:s,dataId:n}],s,null,!0).dataId}},t.prototype.runWebGLProgram=function(n,r,o,i,a){var s=this;a===void 0&&(a=!1);var u=this.makeTensorInfo(n.outputShape,o),l=this.texData.get(u.dataId);if(n.packedOutput&&(l.isPacked=!0),n.outPackingScheme===ru.DENSE){var c=As(n.outputShape);l.texShape=c.map(function(x){return 2*x})}if(n.outTexUsage!=null&&(l.usage=n.outTexUsage),ae(u.shape)===0)return l.values=tu(u.dtype,0),u;var d=[],f=r.map(function(x){if(x.dtype==="complex64")throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");var w=s.texData.get(x.dataId);if(w.texture==null){if(!n.packedInputs&&ae(x.shape)<=H().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:x.shape,texData:null,isUniform:!0,uniformValues:w.values};n.packedInputs&&(w.isPacked=!0,w.shape=x.shape)}else if(!!w.isPacked!=!!n.packedInputs)x=w.isPacked?s.unpackTensor(x):s.packTensor(x),d.push(x),w=s.texData.get(x.dataId);else if(w.isPacked&&!nl(w.shape,x.shape)){var b=x,C=x.shape;x.shape=w.shape,x=s.packedReshape(x,C),d.push(x),w=s.texData.get(x.dataId),b.shape=C}return s.uploadToGPU(x.dataId),{shape:x.shape,texData:w,isUniform:!1}});this.uploadToGPU(u.dataId);var h,v={shape:u.shape,texData:l,isUniform:!1},m=function(x,w,b){var C="";w.concat(b).forEach(function(R){var k=R.texData!=null&&R.texData.slice!=null&&R.texData.slice.flatOffset>0,P=R.isUniform?"uniform":R.texData.texShape;C+=R.shape+"_"+P+"_"+k});var E=x.userCode,S=x.constructor.name;return S+="_"+C+"_"+E}(n,f,v),g=this.getAndSaveBinary(m,function(){return function(x,w,b,C){var E=w.userCode,S=b.map(function(D,M){var B={logicalShape:D.shape,texShape:D.isUniform?null:D.texData.texShape,isUniform:D.isUniform,isPacked:!D.isUniform&&D.texData.isPacked,flatOffset:null};return D.texData!=null&&D.texData.slice!=null&&D.texData.slice.flatOffset>0&&(B.flatOffset=D.texData.slice.flatOffset),{name:w.variableNames[M],shapeInfo:B}}),R=S.map(function(D){return D.shapeInfo}),k={logicalShape:C.shape,texShape:C.texData.texShape,isUniform:!1,isPacked:C.texData.isPacked,flatOffset:null},P=VP(S,k,E,w.packedInputs),T=x.createProgram(P),j=null,O=x.getUniformLocation(T,"NAN",!1);H().getNumber("WEBGL_VERSION")===1&&(j=x.getUniformLocation(T,"INFINITY",!1));for(var W={},U=0;U<w.variableNames.length;U++){var z=w.variableNames[U];W[z]=x.getUniformLocation(T,z,!1),W["offset"+z]=x.getUniformLocation(T,"offset"+z,!1)}return{program:w,source:P,webGLProgram:T,uniformLocations:W,inShapeInfos:R,outShapeInfo:k,infLoc:j,nanLoc:O}}(s.gpgpu,n,f,v)}),p=this.activeTimers!=null;if(p&&(h=this.startTimer()),function(x,w,b,C,E){$y(w.inShapeInfos,b),$y([w.outShapeInfo],[C]);var S=C.texData.texture,R=C.texData.texShape;C.texData.isPacked?x.setOutputPackedMatrixTexture(S,R[0],R[1]):x.setOutputMatrixTexture(S,R[0],R[1]),x.setProgram(w.webGLProgram),H().getNumber("WEBGL_VERSION")===1&&w.infLoc!==null&&x.gl.uniform1f(w.infLoc,1/0),w.nanLoc!==null&&x.gl.uniform1f(w.nanLoc,NaN),b.forEach(function(k,P){var T=w.program.variableNames[P],j=w.uniformLocations[T],O=w.uniformLocations["offset"+T];if(j!=null)if(k.isUniform)if(ae(k.shape)<2)x.gl.uniform1f(j,k.uniformValues[0]);else{var W=k.uniformValues;W instanceof Float32Array||(W=new Float32Array(W)),x.gl.uniform1fv(j,W)}else k.texData.slice!=null&&O!=null&&x.gl.uniform1i(O,k.texData.slice.flatOffset),x.setInputMatrixTexture(k.texData.texture,j,P)}),E!=null&&E(x,w.webGLProgram),x.executeProgram()}(this.gpgpu,g,f,v,i),d.forEach(function(x){return s.disposeData(x.dataId)}),p&&(h=this.endTimer(h),this.activeTimers.push({name:n.constructor.name,query:this.getQueryTime(h)})),!H().getBool("WEBGL_LAZILY_UNPACK")&&l.isPacked&&a===!1){var y=this.unpackTensor(u);return this.disposeData(u.dataId),y}return u},t.prototype.compileAndRun=function(n,r,o,i,a){a===void 0&&(a=!1),o=o||r[0].dtype;var s=this.runWebGLProgram(n,r,o,i,a);return L.makeTensorFromDataId(s.dataId,s.shape,s.dtype)},t.prototype.getAndSaveBinary=function(n,r){return n in this.binaryCache||(this.binaryCache[n]=r()),this.binaryCache[n]},t.prototype.getTextureManager=function(){return this.textureManager},t.prototype.dispose=function(){var n=this;this.disposed||(H().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach(function(r){n.gpgpu.deleteProgram(n.binaryCache[r].webGLProgram),delete n.binaryCache[r]}),this.textureManager.dispose(),this.canvas!=null&&typeof HTMLCanvasElement<"u"&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)},t.prototype.floatPrecision=function(){var n=this;return this.floatPrecisionValue==null&&(this.floatPrecisionValue=te(function(){if(!H().get("WEBGL_RENDER_FLOAT32_ENABLED")){var r=H().getBool("DEBUG");H().set("DEBUG",!1);var o=n.abs(ee(1e-8)).dataSync()[0];if(H().set("DEBUG",r),o>0)return 32}return 16})),this.floatPrecisionValue},t.prototype.epsilon=function(){return this.floatPrecision()===32?1e-7:1e-4},t.prototype.uploadToGPU=function(n){var r,o=this.texData.get(n),i=o.shape,a=o.dtype,s=o.values,u=o.texture,l=o.usage,c=o.isPacked;if(u==null){var d,f=this.activeTimers!=null;f&&(d=gr());var h=o.texShape;if(h==null&&(h=WA(i,c),o.texShape=h),s!=null){var v=pf(i),m=void 0,g=h[1],p=h[0],y=s instanceof Uint8Array;c?(g=(r=wu(h[0],h[1]))[0],p=r[1],m=new ED(v,[p,g],y)):m=new CD(v,[p,g],y);var x=this.makeTensorInfo([p,g],a);this.texData.get(x.dataId).usage=y?gn.PIXELS:gn.UPLOAD,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(x.dataId),g,p,s);var w=this.runWebGLProgram(m,[x],a,null,!0),b=this.texData.get(w.dataId);o.texture=b.texture,o.texShape=b.texShape,o.isPacked=b.isPacked,o.usage=b.usage,this.disposeData(x.dataId),this.texData.delete(w.dataId),o.values=null,f&&(this.uploadWaitMs+=gr()-d)}else{var C=this.acquireTexture(h,l,a,c);o.texture=C}}},t.prototype.convertAndCacheOnCPU=function(n,r){var o=this.texData.get(n),i=o.dtype;return this.releaseGPUData(n),r!=null&&(o.values=function(a,s){if(s==="float32"||s==="complex64")return a;if(s==="int32"||s==="bool"){for(var u=s==="int32"?new Int32Array(a.length):new Uint8Array(a.length),l=0;l<u.length;++l)u[l]=Math.round(a[l]);return u}throw new Error("Unknown dtype "+s)}(r,i)),o.values},t.prototype.acquireTexture=function(n,r,o,i){if(this.numBytesInGPU+=this.computeBytes(n,o),!this.warnedAboutMemory&&this.numBytesInGPU>1024*this.numMBBeforeWarning*1024){var a=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn("High memory usage in GPU: "+a+" MB, most likely due to a memory leak")}return this.textureManager.acquireTexture(n,r,i)},t.prototype.computeBytes=function(n,r){return n[0]*n[1]*Ob(r)},t}(i2);$b()&&L.registerBackend("webgl",function(){return new F3},2);var M3=F({square_:function(e){var t=N(e,"x","square"),n=[t];return L.runKernelFunc(function(r,o){return o([t]),r.square(t)},{x:t},null,"Square",{},n,[])}}),iu="SquaredDifference",_2=F({squaredDifference_:function(e,t){var n,r=N(e,"a","squaredDifference"),o=N(t,"b","squaredDifference");n=Qe(r,o),r=n[0],o=n[1],_e(r.shape,o.shape);var i={a:r,b:o},a=[r,o];return L.runKernelFunc(function(s,u){var l=s.squaredDifference(r,o);return u([r,o]),l},i,function(s,u){var l=u[0],c=u[1],d=ee(2);return{a:function(){return s.mul(l.sub(c).mul(d))},b:function(){return s.mul(c.sub(l).mul(d))}}},iu,{},a,[])}}),O3=F({abs_:function(e){var t=N(e,"x","abs");return t.dtype==="complex64"?L.runKernelFunc(function(n){return n.complexAbs(t)},{$x:t}):L.runKernelFunc(function(n,r){var o=n.abs(t);return r([t]),o},{x:t},function(n,r){var o=r[0];return{x:function(){return n.mul(o.toFloat().step(-1))}}},"Abs")}}),L3=F({acos_:function(e){var t=N(e,"x","acos");return L.runKernelFunc(function(n,r){var o=n.acos(t);return r([t]),o},{$x:t},function(n,r){var o=r[0];return{$x:function(){return n.divStrict(ee(1).sub(o.toFloat().square()).sqrt()).neg()}}})}}),B3=F({acosh_:function(e){var t=N(e,"x","acosh");return L.runKernelFunc(function(n,r){var o=n.acosh(t);return r([t]),o},{$x:t},function(n,r){var o=r[0];return{$x:function(){return n.divStrict(o.toFloat().square().sub(1).sqrt())}}})}}),j3=F({asin_:function(e){var t=N(e,"x","asin");return L.runKernelFunc(function(n,r){var o=n.asin(t);return r([t]),o},{$x:t},function(n,r){var o=r[0];return{$x:function(){return n.divStrict(ee(1).sub(o.toFloat().square()).sqrt())}}})}}),W3=F({asinh_:function(e){var t=N(e,"x","asinh");return L.runKernelFunc(function(n,r){var o=n.asinh(t);return r([t]),o},{$x:t},function(n,r){var o=r[0];return{$x:function(){return n.divStrict(ee(1).add(o.toFloat().square()).sqrt())}}})}}),z3=F({atan_:function(e){var t=N(e,"x","atan");return L.runKernelFunc(function(n,r){var o=n.atan(t);return r([t]),o},{$x:t},function(n,r){var o=r[0];return{$x:function(){return n.div(o.toFloat().square().add(1))}}})}}),U3=F({atanh_:function(e){var t=N(e,"x","atanh");return L.runKernelFunc(function(n,r){var o=n.atanh(t);return r([t]),o},{$x:t},function(n,r){var o=r[0];return{$x:function(){return n.div(ee(1).sub(o.toFloat().square()))}}})}}),$3=F({ceil_:function(e){var t=N(e,"x","ceil");return L.runKernelFunc(function(n){return n.ceil(t)},{$x:t},function(n){return{$x:function(){return Re(n)}}})}}),Ov=F({clipByValue_:function(e,t,n){var r=N(e,"x","clipByValue");I(t<=n,function(){return"Error in clip: min ("+t+") must be less than or equal to max ("+n+")."});var o=[r],i={min:t,max:n};return L.runKernelFunc(function(a,s){var u=a.clip(r,t,n);return s([r]),u},{x:r},function(a,s){var u=s[0];return{x:function(){return a.where(u.greaterEqual(t).logicalAnd(u.lessEqual(n)),Re(a))}}},"ClipByValue",i,o)}}),V3=F({cos_:function(e){var t=N(e,"x","cos"),n=[t];return L.runKernelFunc(function(r,o){var i=r.cos(t);return o([t]),i},{x:t},function(r,o){var i=o[0];return{x:function(){return i.toFloat().sin().neg().mul(r)}}},"Cos",{},n)}}),H3=F({cosh_:function(e){var t=N(e,"x","cosh");return L.runKernelFunc(function(n,r){var o=n.cosh(t);return r([t]),o},{$x:t},function(n,r){var o=r[0];return{$x:function(){return o.toFloat().sinh().mulStrict(n)}}})}}),G3=F({erf_:function(e){var t=N(e,"x","erf");return I(t.dtype==="int32"||t.dtype==="float32",function(){return"Input dtype must be `int32` or `float32`."}),t.dtype==="int32"&&(t=t.toFloat()),L.runKernelFunc(function(n,r){var o=n.erf(t);return r([t]),o},{$x:t},function(n,r){var o=r[0];return{$x:function(){return n.mul(o.square().neg().exp().mul(2/Math.sqrt(Math.PI)))}}})}}),tp=F({exp_:function(e){var t=N(e,"x","exp");return L.runKernelFunc(function(n,r){var o=n.exp(t);return r([o]),o},{x:t},function(n,r){return{x:function(){return n.mulStrict(r[0])}}},"Exp",{},[],[!0])}}),q3=F({expm1_:function(e){var t=N(e,"x","expm1");return L.runKernelFunc(function(n,r){var o=n.expm1(t);return r([t]),o},{$x:t},function(n,r){var o=r[0];return{$x:function(){return n.mul(o.exp())}}})}}),K3=F({floor_:function(e){var t=N(e,"x","floor");return L.runKernelFunc(function(n){return n.floor(t)},{$x:t},function(n){return{$x:function(){return Re(n)}}})}}),X3=F({log_:function(e){var t=N(e,"x","log"),n=[t];return L.runKernelFunc(function(r,o){var i=r.log(t);return o([t]),i},{x:t},function(r,o){var i=o[0];return{x:function(){return r.div(i.toFloat())}}},"Log",{},n)}}),Y3=F({log1p_:function(e){var t=N(e,"x","log1p");return L.runKernelFunc(function(n,r){var o=n.log1p(t);return r([t]),o},{$x:t},function(n,r){var o=r[0];return{$x:function(){return n.div(o.add(1))}}})}}),Q3=F({logSigmoid_:function(e){var t=N(e,"x","logSigmoid");return L.runKernelFunc(function(n,r){var o=n.softplus(t.neg()).neg();return r([t]),o},{$x:t},function(n,r){var o=r[0];return{$x:function(){return n.mul(o.neg().sigmoid())}}})}}),Sc=F({neg_:function(e){var t=N(e,"x","neg"),n=[t];return L.runKernelFunc(function(r){return r.neg(t)},{x:t},function(r){return{x:function(){return r.neg()}}},"Neg",{},n)}}),J3=F({reciprocal_:function(e){var t=N(e,"x","reciprocal");return L.runKernelFunc(function(n,r){var o=n.reciprocal(t);return r([t]),o},{$x:t},function(n,r){var o=r[0];return{$x:function(){return n.div(o.square().neg())}}})}}),Z3=F({round_:function(e){var t=N(e,"x","round");return L.runKernelFunc(function(n){return n.round(t)},{$x:t},function(n){return{$x:function(){return Re(n)}}})}}),S2=F({rsqrt_:function(e){var t=N(e,"x","rsqrt"),n=[t];return L.runKernelFunc(function(r,o){var i=r.rsqrt(t);return o([t]),i},{x:t},function(r,o){var i=o[0];return{x:function(){return r.div(i.pow(1.5).mul(2)).neg()}}},"Rsqrt",{},n)}}),k2=F({sigmoid_:function(e){var t=N(e,"x","sigmoid");return L.runKernelFunc(function(n,r){var o=n.sigmoid(t);return r([o]),o},{x:t},function(n,r){var o=r[0];return{x:function(){return n.mul(o.mul(ee(1).sub(o)))}}},"Sigmoid")}}),e4=F({sign_:function(e){var t=N(e,"x","sign");return L.runKernelFunc(function(n){return n.sign(t)},{$x:t},function(n){return{$x:function(){return Re(n)}}})}}),t4=F({isNaN_:function(e){var t=N(e,"x","isNaN");return L.runKernelFunc(function(n){return n.isNaN(t)},{$x:t},function(n){return{$x:function(){return Re(n)}}})}}),n4=F({isInf_:function(e){var t=N(e,"x","isInf");return L.runKernelFunc(function(n){return n.isInf(t)},{$x:t},function(n){return{$x:function(){return Re(n)}}})}}),r4=F({isFinite_:function(e){var t=N(e,"x","isFinite");return L.runKernelFunc(function(n){return n.isFinite(t)},{$x:t},function(n){return{$x:function(){return Re(n)}}})}}),o4=F({sin_:function(e){var t=N(e,"x","sin"),n=[t];return L.runKernelFunc(function(r,o){var i=r.sin(t);return o([t]),i},{x:t},function(r,o){var i=o[0];return{x:function(){return i.toFloat().cos().mul(r)}}},"Sin",{},n)}}),i4=F({sinh_:function(e){var t=N(e,"x","sinh");return L.runKernelFunc(function(n,r){var o=n.sinh(t);return r([t]),o},{$x:t},function(n,r){var o=r[0];return{$x:function(){return o.toFloat().cosh().mulStrict(n)}}})}}),a4=F({softplus_:function(e){var t=N(e,"x","softplus");return L.runKernelFunc(function(n,r){var o=n.softplus(t);return r([t]),o},{$x:t},function(n,r){var o=r[0];return{$x:function(){return n.mul(o.sigmoid())}}})}}),s4=F({sqrt_:function(e){var t=N(e,"x","sqrt");return L.runKernelFunc(function(n,r){var o=n.sqrt(t);return r([t]),o},{$x:t},function(n,r){var o=r[0];return{$x:function(){return n.div(o.toFloat().sqrt().mul(2))}}})}}),u4=F({step_:function(e,t){t===void 0&&(t=0);var n=N(e,"x","step");return L.runKernelFunc(function(r){return r.step(n,t)},{$x:n},function(r){return{$x:function(){return Re(r)}}})}}),l4=F({tan_:function(e){var t=N(e,"x","tan");return L.runKernelFunc(function(n,r){var o=n.tan(t);return r([t]),o},{$x:t},function(n,r){var o=r[0];return{$x:function(){return n.div(o.cos().square())}}})}}),c4=F({tanh_:function(e){var t=N(e,"x","tanh");return L.runKernelFunc(function(n,r){var o=n.tanh(t);return r([o]),o},{x:t},function(n,r){var o=r[0];return{x:function(){return ee(1).sub(o.square()).mulStrict(n)}}},"Tanh",{},null,[!0])}});function R2(e,t,n,r,o,i){var a,s,u=N(e,"x","batchNorm"),l=N(t,"mean","batchNorm"),c=N(n,"variance","batchNorm");return o!=null&&(a=N(o,"scale","batchNorm")),r!=null&&(s=N(r,"offset","batchNorm")),I(u.rank===2,function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+u.rank+"."}),I(l.rank===2||l.rank===1,function(){return"Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank "+l.rank+"."}),I(c.rank===2||c.rank===1,function(){return"Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank "+c.rank+"."}),a!=null&&I(a.rank===2||a.rank===1,function(){return"Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank "+a.rank+"."}),s!=null&&I(s.rank===2||s.rank===1,function(){return"Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank "+s.rank+"."}),Cu(u,l,c,s,a,i)}function N2(e,t,n,r,o,i){var a,s,u=N(e,"x","batchNorm"),l=N(t,"mean","batchNorm"),c=N(n,"variance","batchNorm");return o!=null&&(a=N(o,"scale","batchNorm")),r!=null&&(s=N(r,"offset","batchNorm")),I(u.rank===3,function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+u.rank+"."}),I(l.rank===3||l.rank===1,function(){return"Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank "+l.rank+"."}),I(c.rank===3||c.rank===1,function(){return"Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank "+c.rank+"."}),a!=null&&I(a.rank===3||a.rank===1,function(){return"Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank "+a.rank+"."}),s!=null&&I(s.rank===3||s.rank===1,function(){return"Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank "+s.rank+"."}),Cu(u,l,c,s,a,i)}function I2(e,t,n,r,o,i){var a,s,u=N(e,"x","batchNorm"),l=N(t,"mean","batchNorm"),c=N(n,"variance","batchNorm");return o!=null&&(a=N(o,"scale","batchNorm")),r!=null&&(s=N(r,"offset","batchNorm")),I(u.rank===4,function(){return"Error in batchNorm4D: x must be rank 4 but got rank "+u.rank+"."}),I(l.rank===4||l.rank===1,function(){return"Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank "+l.rank+"."}),I(c.rank===4||c.rank===1,function(){return"Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank "+c.rank+"."}),a!=null&&I(a.rank===4||a.rank===1,function(){return"Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank "+a.rank+"."}),s!=null&&I(s.rank===4||s.rank===1,function(){return"Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank "+s.rank+"."}),Cu(u,l,c,s,a,i)}function Cu(e,t,n,r,o,i){i==null&&(i=.001);var a,s,u,l=N(e,"x","batchNorm"),c=N(t,"mean","batchNorm"),d=N(n,"variance","batchNorm");o!=null&&(a=N(o,"scale","batchNorm")),r!=null&&(s=N(r,"offset","batchNorm")),I(c.rank===d.rank,function(){return"Batch normalization gradient requires mean and variance to have equal ranks."}),I(s==null||c.rank===s.rank,function(){return"Batch normalization gradient requires mean and offset to have equal ranks."}),I(a==null||c.rank===a.rank,function(){return"Batch normalization gradient requires mean and scale to have equal ranks."}),u=l.rank===0||l.rank===1?l.as4D(1,1,1,l.size):l.rank===2?l.as4D(1,1,l.shape[0],l.shape[1]):l.rank===3?l.as4D(1,l.shape[0],l.shape[1],l.shape[2]):l;var f=[l,c,d,a];return L.runKernelFunc(function(h,v){var m=h.batchNormalization(u,sl(c),sl(d),i,sl(a),sl(s));return v([l,c,d,a]),m},{x:l,mean:c,variance:d,scale:a,offset:s},function(h,v){var m=v,g=m[0],p=m[1],y=m[2],x=m[3],w=x??ee(1),b=ht(p.shape,u.shape),C=[];if(p.rank===1){for(var E=0;E<u.shape.length-1;++E)C.push(u.shape[E]);C.push(1)}var S=g.sub(p),R=h.mul(w),k=S2(y.add(ee(i))),P=k.mul(k).mul(k).mul(ee(-.5));return{x:function(){return p.rank===1?h.mul(wa(k.as4D(1,1,1,p.shape[0]),C)).mul(w).reshape(g.shape):h.mul(k).mul(w).reshape(g.shape)},mean:function(){var T=k.mul(ee(-1)).mul(R);return p.rank===1&&(T=T.sum(b)),T.reshape(p.shape)},variance:function(){var T=P.mul(S).mul(R);return p.rank===1&&(T=T.sum(b)),T.reshape(p.shape)},scale:function(){var T=S.mul(k),j=h.mul(T);return p.rank===1&&(j=j.sum(b)),j.reshape(p.shape)},offset:function(){var T=h;return p.rank===1&&(T=T.sum(b)),T.reshape(p.shape)}}},"BatchNormalization",{varianceEpsilon:i},f).reshape(l.shape)}function sl(e){return e==null?null:e.rank===0?e.as1D():e.rank===1?e:e.rank===2?e.as4D(1,1,e.shape[0],e.shape[1]):e.rank===3?e.as4D(1,e.shape[0],e.shape[1],e.shape[2]):e}function dd(){Vb("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon")}var d4=F({batchNormalization2d_:function(e,t,n,r,o,i){return r===void 0&&(r=.001),dd(),R2(e,t,n,i,o,r)}}),f4=F({batchNormalization3d_:function(e,t,n,r,o,i){return r===void 0&&(r=.001),dd(),N2(e,t,n,i,o,r)}}),h4=F({batchNormalization4d_:function(e,t,n,r,o,i){return r===void 0&&(r=.001),dd(),I2(e,t,n,i,o,r)}}),p4=F({batchNormalization_:function(e,t,n,r,o,i){return r===void 0&&(r=.001),dd(),Cu(e,t,n,i,o,r)}}),T2=F({batchNorm_:Cu}),v4=F({batchNorm2d_:R2}),m4=F({batchNorm3d_:N2}),g4=F({batchNorm4d_:I2}),fd=F({logicalAnd_:function(e,t){var n=N(e,"a","logicalAnd","bool"),r=N(t,"b","logicalAnd","bool");return _e(n.shape,r.shape),L.runKernelFunc(function(o){return o.logicalAnd(n,r)},{a:n,b:r},null,"LogicalAnd")}}),y4=F({logicalNot_:function(e){var t=N(e,"x","logicalNot","bool");return L.runKernelFunc(function(n){return n.logicalNot(t)},{$x:t})}}),A2=F({logicalOr_:function(e,t){var n=N(e,"a","logicalOr","bool"),r=N(t,"b","logicalOr","bool");return _e(n.shape,r.shape),L.runKernelFunc(function(o){return o.logicalOr(n,r)},{$a:n,$b:r})}}),x4=F({logicalXor_:function(e,t){var n=N(e,"a","logicalXor","bool"),r=N(t,"b","logicalXor","bool");return _e(n.shape,r.shape),A2(e,t).logicalAnd(fd(e,t).logicalNot())}}),Ai=F({where_:function(e,t,n){var r=N(t,"a","where"),o=N(n,"b","where"),i=N(e,"condition","where","bool");return Ae(r.shape,o.shape,"Error in where: "),i.rank===1?I(i.shape[0]===r.shape[0],function(){return"The first dimension of `a` must match the size of `condition`."}):Ae(i.shape,o.shape,"Error in where: "),L.runKernelFunc(function(a,s){var u=a.select(i,r,o);return s([i]),u},{$condition:i,$a:r,$b:o},function(a,s){var u=s[0];return{$condition:function(){return Re(u).toFloat()},$a:function(){return a.mul(u.cast(a.dtype))},$b:function(){return a.mul(u.logicalNot().cast(a.dtype))}}})}}),P2=function(e){return oe(this,void 0,void 0,function(){var t,n,r;return ie(this,function(o){switch(o.label){case 0:return[4,(t=N(e,"condition","whereAsync","bool")).data()];case 1:return n=o.sent(),r=Pv(t.shape,n),e!==t&&t.dispose(),[2,r]}})})},Ee=F({add_:function(e,t){var n,r=N(e,"a","add"),o=N(t,"b","add");n=Qe(r,o),r=n[0],o=n[1];var i=_e(r.shape,o.shape);return L.runKernelFunc(function(a){return a.add(r,o)},{a:r,b:o},function(a){return{a:function(){var s=a,u=ht(r.shape,i);return u.length>0&&(s=s.sum(u)),s.reshape(r.shape)},b:function(){var s=a,u=ht(o.shape,i);return u.length>0&&(s=s.sum(u)),s.reshape(o.shape)}}},"Add")}}),w4=F({addN_:function(e){I(Array.isArray(e),function(){return"The argument passed to tf.addN() must be a list of tensors"}),I(e.length>=1,function(){return"Must pass at least one tensor to tf.addN(), but got "+e.length});var t=e.map(function(o,i){return N(o,"tensors"+i,"addN")}),n=t[0];t.forEach(function(o){if(o.dtype!==n.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")}),t.forEach(function(o){if(!xt(o.shape,n.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")});var r=t;return L.runKernelFunc(function(o){return o.addN(t)},r,function(o){var i={};return t.forEach(function(a,s){i[s]=function(){return o.clone()}}),i},"AddN")}}),b4=F({addStrict_:function(e,t){var n=N(e,"a","addStrict"),r=N(t,"b","addStrict");return Ae(n.shape,r.shape,"Error in addStrict: "),n.add(r)}}),C4=F({atan2_:function(e,t){var n,r=N(e,"a","atan2"),o=N(t,"b","atan2");n=Qe(r,o),r=n[0],o=n[1];var i=_e(r.shape,o.shape);return L.runKernelFunc(function(a,s){var u=a.atan2(r,o);return s([r,o]),u},{$a:r,$b:o},function(a,s){var u=s[0],l=s[1];return{$a:function(){var c=Ee(u.square(),l.square()),d=a.mul(l.div(c)),f=ht(u.shape,i);return f.length>0&&(d=d.sum(f)),d.reshape(u.shape)},$b:function(){var c=Ee(u.square(),l.square()),d=Sc(a.mul(u.div(c))),f=ht(l.shape,i);return f.length>0&&(d=d.sum(f)),d.reshape(l.shape)}}})}}),Jn=F({div_:function(e,t){var n,r=N(e,"a","div"),o=N(t,"b","div");if(n=Qe(r,o),r=n[0],o=n[1],r.dtype==="int32"&&o.dtype==="int32")return D2(r,o);var i=_e(r.shape,o.shape);return L.runKernelFunc(function(a,s){var u=a.realDivide(r,o);return s([r,o]),u},{a:r,b:o},function(a,s){var u=s[0],l=s[1];return{a:function(){var c=a.div(l.toFloat()),d=ht(u.shape,i);return d.length>0?c.sum(d).reshape(u.shape):c},b:function(){var c=a.mul(u.toFloat()),d=ht(l.shape,i);d.length>0&&(c=c.sum(d).reshape(l.shape));var f=l.square();return c.div(f.toFloat()).neg()}}},"Div")}}),E4=F({divNoNan_:function(e,t){var n,r=N(e,"a","div"),o=N(t,"b","div");r=(n=Qe(r,o))[0],o=n[1];var i=Jn(r,o),a=Re(i),s=o.equal(a);return Ai(s,a,i)}}),_4=F({divStrict_:function(e,t){var n=N(e,"a","div"),r=N(t,"b","div");return Ae(n.shape,r.shape,"Error in divideStrict: "),n.div(r)}}),D2=F({floorDiv_:function(e,t){var n,r=N(e,"a","floorDiv"),o=N(t,"b","floorDiv");n=Qe(r,o),r=n[0],o=n[1];var i=_e(r.shape,o.shape);return L.runKernelFunc(function(a,s){var u=a.floorDiv(r,o);return s([r,o]),u},{a:r,b:o},function(a,s){var u=s[0],l=s[1];return{a:function(){var c=a.div(l.toFloat()),d=ht(u.shape,i);return d.length>0?c.sum(d).reshape(u.shape):c},b:function(){var c=a.mul(u.toFloat()),d=ht(l.shape,i);d.length>0&&(c=c.sum(d).reshape(l.shape));var f=l.square();return c.div(f.toFloat()).neg()}}},"FloorDiv")}}),Lv=F({maximum_:function(e,t){var n,r=N(e,"a","maximum"),o=N(t,"b","maximum");return n=Qe(r,o),r=n[0],o=n[1],r.dtype==="bool"&&(r=r.toInt(),o=o.toInt()),_e(r.shape,o.shape),L.runKernelFunc(function(i,a){var s=i.maximum(r,o);return a([r,o]),s},{a:r,b:o},function(i,a){var s=a[0],u=a[1];return{a:function(){return i.mul(s.greaterEqual(u).toFloat())},b:function(){return i.mul(s.less(u).toFloat())}}},"Maximum")}}),S4=F({maximumStrict_:function(e,t){var n=N(e,"a","maximumStrict"),r=N(t,"b","maximumStrict");return Ae(n.shape,r.shape,"Error in maximumStrict: "),n.maximum(r)}}),F2=F({minimum_:function(e,t){var n,r=N(e,"a","minimum"),o=N(t,"b","minimum");return n=Qe(r,o),r=n[0],o=n[1],r.dtype==="bool"&&(r=r.toInt(),o=o.toInt()),_e(r.shape,o.shape),L.runKernelFunc(function(i,a){var s=i.minimum(r,o);return a([r,o]),s},{a:r,b:o},function(i,a){var s=a[0],u=a[1];return{a:function(){return i.mul(s.lessEqual(u).toFloat())},b:function(){return i.mul(s.greater(u).toFloat())}}},"Minimum")}}),k4=F({minimumStrict_:function(e,t){var n=N(e,"a","minimumStrict"),r=N(t,"b","minimumStrict");return Ae(n.shape,r.shape,"Error in minimumStrict: "),n.minimum(r)}}),R4=F({mod_:function(e,t){var n,r=N(e,"a","mod"),o=N(t,"b","mod");n=Qe(r,o),r=n[0],o=n[1];var i=_e(r.shape,o.shape);return L.runKernelFunc(function(a,s){var u=a.mod(r,o);return s([r,o]),u},{$a:r,$b:o},function(a,s){var u=s[0],l=s[1];return{$a:function(){var c=ht(u.shape,i);return c.length>0?a.sum(c).reshape(u.shape):a},$b:function(){var c=a.mul(u.div(l).floor().neg()),d=ht(l.shape,i);return d.length>0?c.sum(d).reshape(l.shape):c}}})}}),N4=F({modStrict_:function(e,t){var n=N(e,"a","modStrict"),r=N(t,"b","modStrict");return Ae(n.shape,r.shape,"Error in modStrict: "),n.mod(r)}}),jt=F({mul_:function(e,t){var n,r=N(e,"a","mul"),o=N(t,"b","mul");n=Qe(r,o),r=n[0],o=n[1];var i=_e(r.shape,o.shape);return L.runKernelFunc(function(a,s){var u=a.multiply(r,o);return s([r,o]),u},{a:r,b:o},function(a,s){var u=s[0],l=s[1];return{a:function(){var c=a.mul(l.toFloat()),d=ht(u.shape,i);return d.length>0?c.sum(d).reshape(u.shape):c},b:function(){var c=a.mul(u.toFloat()),d=ht(l.shape,i);return d.length>0?c.sum(d).reshape(l.shape):c}}},"Mul")}}),I4=F({mulStrict_:function(e,t){var n=N(e,"a","mul"),r=N(t,"b","mul");return Ae(n.shape,r.shape,"Error in multiplyStrict: "),n.mul(r)}}),kc=F({pow_:function(e,t){var n,r=N(e,"base","pow"),o=N(t,"exp","pow");n=Qe(r,o),r=n[0],o=n[1];var i=_e(r.shape,o.shape),a=[r,o];return L.runKernelFunc(function(s,u){var l=s.pow(r,o);return u([r,o,l]),l},{a:r,b:o},function(s,u){var l=u[0],c=u[1],d=u[2];return{a:function(){var f=c.toFloat(),h=s.mul(f.mul(l.pow(f.sub(ee(1))))),v=ht(l.shape,i);return v.length>0&&(h=h.sum(v)),h.reshape(l.shape)},b:function(){var f=l.greater(0),h=l.log().where(f,Re(l)),v=s.mul(d.mul(h)),m=ht(c.shape,i);return m.length>0&&(v=v.sum(m)),v.reshape(c.shape)}}},"Pow",{},a,[!0])}}),T4=F({powStrict_:function(e,t){return Ae(e.shape,t.shape,"Error in powStrict: "),e.pow(t)}}),A4=F({squaredDifferenceStrict_:function(e,t){var n=N(e,"a","squaredDifferenceStrict"),r=N(t,"b","squaredDifferenceStrict");return Ae(n.shape,r.shape,"Error in squaredDifferenceStrict: "),n.squaredDifference(r)}}),pt=F({sub_:function(e,t){var n,r=N(e,"a","sub"),o=N(t,"b","sub");n=Qe(r,o),r=n[0],o=n[1];var i=_e(r.shape,o.shape);return L.runKernelFunc(function(a){return a.subtract(r,o)},{a:r,b:o},function(a){return{a:function(){var s=a,u=ht(r.shape,i);return u.length>0&&(s=s.sum(u)),s.reshape(r.shape)},b:function(){var s=a,u=ht(o.shape,i);return u.length>0&&(s=s.sum(u)),s.neg().reshape(o.shape)}}},"Sub")}}),P4=F({subStrict_:function(e,t){var n=N(e,"a","subStrict"),r=N(t,"b","subStrict");return Ae(n.shape,r.shape,"Error in subStrict: "),n.sub(r)}}),M2=F({equal_:function(e,t){var n,r=N(e,"a","equal"),o=N(t,"b","equal");return n=Qe(r,o),r=n[0],o=n[1],_e(r.shape,o.shape),L.runKernelFunc(function(i){return i.equal(r,o)},{$a:r,$b:o})}}),D4=F({equalStrict_:function(e,t){var n=N(e,"a","equalStrict"),r=N(t,"b","equalStrict");return Ae(n.shape,r.shape,"Error in equalStrict: "),n.equal(r)}}),F4=F({greater_:function(e,t){var n,r=N(e,"a","greater"),o=N(t,"b","greater");return n=Qe(r,o),r=n[0],o=n[1],_e(r.shape,o.shape),L.runKernelFunc(function(i){return i.greater(r,o)},{a:r,b:o},null,"Greater")}}),O2=F({greaterEqual_:function(e,t){var n,r=N(e,"a","greaterEqual"),o=N(t,"b","greaterEqual");return n=Qe(r,o),r=n[0],o=n[1],_e(r.shape,o.shape),L.runKernelFunc(function(i,a){var s=i.greaterEqual(r,o);return a([r,o]),s},{a:r,b:o},function(i,a){var s=a[0],u=a[1];return{a:function(){return Re(s)},b:function(){return Re(u)}}},"GreaterEqual")}}),M4=F({greaterEqualStrict_:function(e,t){var n=N(e,"a","greaterEqualStrict"),r=N(t,"b","greaterEqualStrict");return Ae(n.shape,r.shape,"Error in greaterEqualStrict: "),n.greaterEqual(r)}}),O4=F({greaterStrict_:function(e,t){var n=N(e,"a","greaterStrict"),r=N(t,"b","greaterStrict");return Ae(n.shape,r.shape,"Error in greaterStrict: "),n.greater(r)}}),L4=F({less_:function(e,t){var n,r=N(e,"a","less"),o=N(t,"b","less");return n=Qe(r,o),r=n[0],o=n[1],_e(r.shape,o.shape),L.runKernelFunc(function(i){return i.less(r,o)},{a:r,b:o},null,"Less")}}),B4=F({lessEqual_:function(e,t){var n,r=N(e,"a","lessEqual"),o=N(t,"b","lessEqual");return n=Qe(r,o),r=n[0],o=n[1],_e(r.shape,o.shape),L.runKernelFunc(function(i,a){var s=i.lessEqual(r,o);return a([r,o]),s},{a:r,b:o},null,"LessEqual")}}),j4=F({lessEqualStrict_:function(e,t){var n=N(e,"a","lessEqualStrict"),r=N(t,"b","lessEqualStrict");return Ae(n.shape,r.shape,"Error in lessEqualStrict: "),n.lessEqual(r)}}),W4=F({lessStrict_:function(e,t){var n=N(e,"a","lessStrict"),r=N(t,"b","lessStrict");return Ae(n.shape,r.shape,"Error in lessStrict: "),n.less(r)}}),z4=F({notEqual_:function(e,t){var n,r=N(e,"a","notEqual"),o=N(t,"b","notEqual");return n=Qe(r,o),r=n[0],o=n[1],_e(r.shape,o.shape),L.runKernelFunc(function(i){return i.notEqual(r,o)},{a:r,b:o},null,"NotEqual")}}),U4=F({notEqualStrict_:function(e,t){var n=N(e,"a","notEqualStrict"),r=N(t,"b","notEqualStrict");return Ae(n.shape,r.shape,"Error in notEqualStrict: "),n.notEqual(r)}});function Zy(e,t){for(var n=[],r=e;r<t;++r)n.push(r);return n}function e0(e){for(var t=[],n=0;n<e.length;++n)for(var r=0;r<e[n].length;++r)t.push(e[n][r]);return t}var Bv=F({gather_:function(e,t,n){n===void 0&&(n=0);var r=N(e,"x","gather"),o=N(t,"indices","gather","int32");n=vt(n,r.shape)[0];var i=function(a,s,u){for(var l=a.shape[u],c=[],d=1,f=1,h=0;h<u;h++)c.push(a.shape[h]),d*=a.shape[h];for(h=0;h<s.rank;h++)c.push(s.shape[h]);for(h=u+1;h<a.rank;h++)c.push(a.shape[h]),f*=a.shape[h];return{batchSize:d,sliceSize:f,dimSize:l,outputShape:c}}(r,o,n);return L.runKernelFunc(function(a,s){var u=a.gather(r,o.flatten(),n);return s([o]),u},{x:r,indices:o},function(a,s){var u=s[0];return{x:function(){var l=r.shape,c=u.size,d=l.slice(0,n),f=d.length,h=l.slice(n,l.length).slice(1),v=h.length,m=Zy(0,f),g=Zy(f+1,f+1+v),p=e0([d,[c],h]),y=a.reshape(p),x=u.reshape([c]),w=e0([[f],m,g]),b=y.transpose(w),C=L2(b,x,r.shape[n]),E=_v(w);return C=C.transpose(E)},indices:function(){return u}}},"Gather",{axis:n}).reshape(i.outputShape)}}),L2=F({unsortedSegmentSum_:function(e,t,n){var r=N(e,"x","unsortedSegmentSum"),o=N(t,"segmentIds","unsortedSegmentSum","int32");return I(rt(n),function(){return"numSegments must be of dtype int"}),L.runKernelFunc(function(i,a){var s=i.unsortedSegmentSum(r,o,n);return a([o]),s},{$x:r},function(i,a){var s=a[0];return{$x:function(){return function(u,l){for(var c=Lv(l,Re(l)),d=Bv(u,c),f=O2(l,ee(0,"int32")),h=d.rank-f.rank,v=0;v<h;++v)f=Tn(f,v+1);f=fd(f,ts(d.shape,"bool"));var m=Re(d);return Ai(f,d,m)}(i,s)}}})}}),$4=function(e,t,n){return oe(this,void 0,void 0,function(){var r,o,i,a,s,u,l,c,d,f,h,v,m;return ie(this,function(g){switch(g.label){case 0:for(r=N(e,"tensor","boolMask"),o=N(t,"mask","boolMask","bool"),i=n??0,a=o.rank,s=r.shape,I(a>0,function(){return"mask cannot be scalar"}),Ae(s.slice(i,i+a),o.shape,"mask's shape must match the first K dimensions of tensor's shape,"),u=1,l=i;l<i+a;l++)u*=s[l];return c=s.slice(0,i).concat([u],s.slice(i+a)),d=r.reshape(c),f=o.reshape([-1]),[4,P2(f)];case 1:return h=g.sent(),v=h.squeeze([1]),m=Bv(d,v,i),e!==r&&r.dispose(),t!==o&&o.dispose(),v.dispose(),d.dispose(),f.dispose(),h.dispose(),[2,m]}})})};function B2(e,t,n,r,o,i,a){i===void 0&&(i="NHWC"),I(e.length===t.rank,function(){return"Length of inShape ("+e.length+") and rank of dy ("+t.rank+") must match"});var s=e,u=t,l=!1;t.rank===3&&(l=!0,u=t.as4D(1,t.shape[0],t.shape[1],t.shape[2]),s=[1,e[0],e[1],e[2]]),I(s.length===4,function(){return"Error in conv2dDerInput: inShape must be length 4, but got length "+s.length+"."}),I(u.rank===4,function(){return"Error in conv2dDerInput: dy must be rank 4, but got rank "+u.rank}),I(n.rank===4,function(){return"Error in conv2dDerInput: filter must be rank 4, but got rank "+n.rank});var c=i==="NHWC"?s[3]:s[1],d=i==="NHWC"?u.shape[3]:u.shape[1];I(c===n.shape[2],function(){return"Error in conv2dDerInput: depth of input ("+c+") must match input depth for filter "+n.shape[2]+"."}),I(d===n.shape[3],function(){return"Error in conv2dDerInput: depth of output ("+d+") must match output depth for filter "+n.shape[3]+"."}),a!=null&&I(rt(o),function(){return"Error in conv2dDerInput: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+o+"."});var f=Iv(i),h=Li(s,n.shape,r,1,o,a,!1,f),v=L.runKernelFunc(function(m,g){var p=m.conv2dDerInput(u,n,h);return g([n,u]),p},{dy4D:u,filter:n},function(m,g){var p=g[0],y=g[1];return{dy4D:function(){return Bn(m,p,r,o,i,1,a)},filter:function(){return jv(m,y,p.shape,r,o,i,a)}}});return l?v.as3D(v.shape[1],v.shape[2],v.shape[3]):v}function Cf(e){var t=function(i){return typeof i=="number"?[i,i,i]:i.length===2?[i[0],i[1],1]:i}(e),n=t[0],r=t[1],o=t[2];return n===1&&r===1&&o===1}function j2(e,t,n,r,o){I(e.length===t.rank,function(){return"Length of inShape ("+e.length+") and rank of dy ("+t.rank+") must match"});var i=e,a=t,s=!1;t.rank===4&&(s=!0,a=t.as5D(1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]),i=[1,e[0],e[1],e[2],e[3]]);var u=i[4],l=a.shape[4];I(i.length===5,function(){return"Error in conv3dDerInput: inShape must be length 5, but got length "+i.length+"."}),I(a.rank===5,function(){return"Error in conv3dDerInput: dy must be rank 5, but got rank "+a.rank}),I(n.rank===5,function(){return"Error in conv3dDerInput: filter must be rank 5, but got rank "+n.rank}),I(u===n.shape[3],function(){return"Error in conv3dDerInput: depth of input ("+u+") must match input depth for filter "+n.shape[3]+"."}),I(l===n.shape[4],function(){return"Error in conv3dDerInput: depth of output ("+l+") must match output depth for filter "+n.shape[4]+"."});var c=Ec(i,n.shape,r,1,o),d=L.runKernelFunc(function(f){return f.conv3dDerInput(a,n,c)},{dy5D:a});return s?d.as4D(d.shape[1],d.shape[2],d.shape[3],d.shape[4]):d}var V4=F({conv1d_:function(e,t,n,r,o,i,a){o===void 0&&(o="NWC"),i===void 0&&(i=1);var s=N(e,"x","conv1d"),u=N(t,"filter","conv1d"),l=s,c=!1;s.rank===2&&(c=!0,l=s.as3D(1,s.shape[0],s.shape[1])),I(l.rank===3,function(){return"Error in conv1d: input must be rank 3, but got rank "+l.rank+"."}),I(u.rank===3,function(){return"Error in conv1d: filter must be rank 3, but got rank "+u.rank+"."}),a!=null&&I(rt(r),function(){return"Error in conv1d: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+r+"."}),I(l.shape[2]===u.shape[1],function(){return"Error in conv1d: depth of input ("+l.shape[2]+") must match input depth for filter "+u.shape[1]+"."}),I(ln(n,i),function(){return"Error in conv1D: Either stride or dilation must be 1. Got stride "+n+" and dilation '"+i+"'"}),I(o==="NWC",function(){return"Error in conv1d: got dataFormat of "+o+" but only NWC is currently supported."});var d=u.as4D(1,u.shape[0],u.shape[1],u.shape[2]),f=l.as4D(l.shape[0],1,l.shape[1],l.shape[2]),h=Bn(f,d,[1,n],r,"NHWC",[1,i],a);return c?h.as2D(h.shape[2],h.shape[3]):h.as3D(h.shape[0],h.shape[2],h.shape[3])}}),Bn=F({conv2d_:function(e,t,n,r,o,i,a){o===void 0&&(o="NHWC"),i===void 0&&(i=[1,1]);var s=N(e,"x","conv2d"),u=N(t,"filter","conv2d"),l=s,c=!1;s.rank===3&&(c=!0,l=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),I(l.rank===4,function(){return"Error in conv2d: input must be rank 4, but got rank "+l.rank+"."}),I(u.rank===4,function(){return"Error in conv2d: filter must be rank 4, but got rank "+u.rank+"."}),a!=null&&I(rt(r),function(){return"Error in conv2d: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+r+"."});var d=o==="NHWC"?l.shape[3]:l.shape[1];I(d===u.shape[2],function(){return"Error in conv2d: depth of input ("+d+") must match input depth for filter "+u.shape[2]+"."}),I(ln(n,i),function(){return"Error in conv2D: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+i+"'"});var f=Iv(o),h=Li(l.shape,u.shape,n,i,r,a,!1,f),v=[u,l],m=L.runKernelFunc(function(g,p){var y=g.conv2d(l,u,h);return p([u,l]),y},{x:l,filter:u},function(g,p){var y=p,x=y[0],w=y[1];return I(qa(i),function(){return"Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+i+"'"}),{x:function(){return W2(w.shape,g,x,n,r,o)},filter:function(){return jv(w,g,x.shape,n,r,o)}}},"Conv2D",h,v);return c?m.as3D(m.shape[1],m.shape[2],m.shape[3]):m}}),H4=F({conv3d_:function(e,t,n,r,o,i){o===void 0&&(o="NDHWC"),i===void 0&&(i=[1,1,1]);var a=N(e,"x","conv3d"),s=N(t,"filter","conv3d"),u=a,l=!1;a.rank===4&&(l=!0,u=a.as5D(1,a.shape[0],a.shape[1],a.shape[2],a.shape[3])),I(u.rank===5,function(){return"Error in conv3d: input must be rank 5, but got rank "+u.rank+"."}),I(s.rank===5,function(){return"Error in conv3d: filter must be rank 5, but got rank "+s.rank+"."}),I(u.shape[4]===s.shape[3],function(){return"Error in conv3d: depth of input ("+u.shape[4]+") must match input depth for filter "+s.shape[3]+"."}),I(function(f,h){return Cf(f)||Cf(h)}(n,i),function(){return"Error in conv3D: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+i+"'"}),I(o==="NDHWC",function(){return"Error in conv3d: got dataFormat of "+o+" but only NDHWC is currently supported."});var c=Ec(u.shape,s.shape,n,i,r),d=L.runKernelFunc(function(f,h){var v=f.conv3d(u,s,c);return h([u,s]),v},{x:u,$filter:s},function(f,h){I(Cf(i),function(){return"Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+i+"'"});var v=h[0],m=h[1];return{x:function(){return j2(v.shape,f,m,n,r)},$filter:function(){return function(g,p,y,x,w){var b=g;g.rank===4&&(b=g.as5D(1,g.shape[0],g.shape[1],g.shape[2],g.shape[3]));var C=p;C.rank===4&&(C=p.as5D(1,p.shape[0],p.shape[1],p.shape[2],p.shape[3])),I(b.rank===5,function(){return"Error in conv3dDerFilter: input must be rank 5, but got shape "+b.shape+"."}),I(C.rank===5,function(){return"Error in conv3dDerFilter: dy must be rank 5, but got shape "+C.shape+"."}),I(y.length===5,function(){return"Error in conv3dDerFilter: filterShape must be length 5, but got "+y+"."}),I(b.shape[4]===y[3],function(){return"Error in conv3dDerFilter: depth of input "+b.shape[4]+") must match input depth in filter ("+y[3]+"."}),I(C.shape[4]===y[4],function(){return"Error in conv3dDerFilter: depth of dy ("+C.shape[4]+") must match output depth for filter ("+y[4]+")."});var E=Ec(b.shape,y,x,1,w);return L.runKernelFunc(function(S){return S.conv3dDerFilter(b,C,E)},{x5D:b,dy5D:C})}(v,f,m.shape,n,r)}}});return l?d.as4D(d.shape[1],d.shape[2],d.shape[3],d.shape[4]):d}}),jv=F({conv2dDerFilter_:function(e,t,n,r,o,i,a){i===void 0&&(i="NHWC");var s=e;e.rank===3&&(s=e.as4D(1,e.shape[0],e.shape[1],e.shape[2]));var u=t;u.rank===3&&(u=t.as4D(1,t.shape[0],t.shape[1],t.shape[2])),I(s.rank===4,function(){return"Error in conv2dDerFilter: input must be rank 4, but got shape "+s.shape+"."}),I(u.rank===4,function(){return"Error in conv2dDerFilter: dy must be rank 4, but got shape "+u.shape+"."}),I(n.length===4,function(){return"Error in conv2dDerFilter: filterShape must be length 4, but got "+n+"."});var l=i==="NHWC"?s.shape[3]:s.shape[1],c=i==="NHWC"?u.shape[3]:u.shape[1];I(l===n[2],function(){return"Error in conv2dDerFilter: depth of input "+l+") must match input depth in filter ("+n[2]+"."}),I(c===n[3],function(){return"Error in conv2dDerFilter: depth of dy ("+c+") must match output depth for filter ("+n[3]+")."}),a!=null&&I(rt(o),function(){return"Error in conv2dDerFilter: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+o+"."});var d=Iv(i),f=Li(s.shape,n,r,1,o,a,!1,d);return L.runKernelFunc(function(h){return h.conv2dDerFilter(s,u,f)},{x4D:s,dy4D:u})}}),W2=F({conv2dDerInput_:B2}),hd=F({depthwiseConv2d_:function(e,t,n,r,o,i,a){i===void 0&&(i=[1,1]);var s=N(e,"x","depthwiseConv2d"),u=N(t,"filter","depthwiseConv2d"),l=s,c=!1;s.rank===3&&(c=!0,l=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),I(l.rank===4,function(){return"Error in depthwiseConv2d: input must be rank 4, but got rank "+l.rank+"."}),I(u.rank===4,function(){return"Error in depthwiseConv2d: filter must be rank 4, but got rank "+u.rank+"."}),I(l.shape[3]===u.shape[2],function(){return"Error in depthwiseConv2d: number of input channels ("+l.shape[3]+") must match the inChannels dimension in filter "+u.shape[2]+"."}),i==null&&(i=[1,1]),I(ln(n,i),function(){return"Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+i+"'"}),a!=null&&I(rt(r),function(){return"Error in depthwiseConv2d: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+r+"."});var d=Li(l.shape,u.shape,n,i,r,a,!0),f=[l,u],h=L.runKernelFunc(function(v,m){var g=v.depthwiseConv2D(l,u,d);return m([l,u]),g},{x:l,filter:u},function(v,m){I(qa(i),function(){return"Error in gradient of depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '"+i+"'"});var g=m[0],p=m[1];return{x:function(){return z2(g.shape,v,p,d)},filter:function(){return U2(g,v,p.shape,d)}}},"DepthwiseConv2dNative",d,f);return c?h.as3D(h.shape[1],h.shape[2],h.shape[3]):h}}),z2=F({depthwiseConv2dDerInput_:function(e,t,n,r){var o=t,i=!1;t.rank===3&&(i=!0,o=t.as4D(1,t.shape[0],t.shape[1],t.shape[2]));var a=L.runKernelFunc(function(s){return s.depthwiseConv2DDerInput(o,n,r)},{dy4D:o});return i?a.as3D(a.shape[1],a.shape[2],a.shape[3]):a}}),U2=F({depthwiseConv2dDerFilter_:function(e,t,n,r){var o=e;e.rank===3&&(o=e.as4D(1,e.shape[0],e.shape[1],e.shape[2]));var i=t;return i.rank===3&&(i=t.as4D(1,t.shape[0],t.shape[1],t.shape[2])),L.runKernelFunc(function(a){return a.depthwiseConv2DDerFilter(o,i,r)},{x4D:o,dy4D:i})}}),Wv=F({separableConv2d_:function(e,t,n,r,o,i,a){i===void 0&&(i=[1,1]),a===void 0&&(a="NHWC");var s=N(e,"x","separableConv2d"),u=N(t,"depthwiseFilter","separableConv2d"),l=N(n,"pointwiseFilter","separableConv2d"),c=s,d=!1;if(s.rank===3&&(d=!0,c=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),a==="NCHW")throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");I(c.rank===4,function(){return"Error in separableConv2d: input must be rank 4, but got rank "+c.rank+"."}),I(u.rank===4,function(){return"Error in separableConv2d: depthwise filter must be rank 4, but got rank "+u.rank+"."}),I(l.rank===4,function(){return"Error in separableConv2d: pointwise filter must be rank 4, but got rank "+u.rank+"."}),I(l.shape[0]===1,function(){return"Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got "+l.shape[0]+"."}),I(l.shape[1]===1,function(){return"Error in separableConv2d: the second dimension of pointwise filter must be 1, but got "+l.shape[1]+"."});var f=u.shape[2],h=u.shape[3];I(l.shape[2]===f*h,function(){return"Error in separableConv2d: the third dimension of pointwise filter must be "+f*h+", but got "+l.shape[2]+"."});var v=hd(c,u,r,o,a,i),m=Bn(v,l,1,"valid",a);return d?m.as3D(m.shape[1],m.shape[2],m.shape[3]):m}}),G4=F({conv2dTranspose_:function(e,t,n,r,o,i){return B2(n,N(e,"x","conv2dTranspose"),N(t,"filter","conv2dTranspose"),r,o,"NHWC",i)}}),q4=F({conv3dTranspose_:function(e,t,n,r,o){return j2(n,N(e,"x","conv3dTranspose"),N(t,"filter","conv3dTranspose"),r,o)}}),pd=F({matMul_:function(e,t,n,r){var o;n===void 0&&(n=!1),r===void 0&&(r=!1);var i=N(e,"a","matMul"),a=N(t,"b","matMul");o=Qe(i,a),i=o[0],a=o[1];var s=n?i.shape[i.rank-2]:i.shape[i.rank-1],u=r?a.shape[a.rank-1]:a.shape[a.rank-2],l=n?i.shape[i.rank-1]:i.shape[i.rank-2],c=r?a.shape[a.rank-2]:a.shape[a.rank-1],d=i.shape.slice(0,-2),f=a.shape.slice(0,-2),h=ae(d),v=ae(f);I(i.rank>=2&&a.rank>=2&&i.rank===a.rank,function(){return"Error in matMul: inputs must have the same rank of at least 2, got ranks "+i.rank+" and "+a.rank+"."}),I(xt(d,f),function(){return"Error in matMul: outer dimensions ("+d+") and ("+f+") of Tensors with shapes "+i.shape+" and "+a.shape+" must match."}),I(s===u,function(){return"Error in matMul: inner shapes ("+s+") and ("+u+") of Tensors with shapes "+i.shape+" and "+a.shape+" and transposeA="+n+" and transposeB="+r+" must match."});var m=i.shape.slice(0,-2).concat([l,c]),g=n?i.as3D(h,s,l):i.as3D(h,l,s),p=r?a.as3D(v,c,u):a.as3D(v,u,c),y={transposeA:n,transposeB:r};return L.runKernelFunc(function(x,w){var b=x.batchMatMul(g,p,n,r);return w([g,p]),b},{a:g,b:p},function(x,w){var b=w,C=b[0],E=b[1];return n||r?!n&&r?{a:function(){return x.matMul(E,!1,!1)},b:function(){return x.matMul(C,!0,!1)}}:n&&!r?{a:function(){return E.matMul(x,!1,!0)},b:function(){return C.matMul(x,!1,!1)}}:{a:function(){return E.matMul(x,!0,!0)},b:function(){return x.matMul(C,!0,!0)}}:{a:function(){return x.matMul(E,!1,!0)},b:function(){return C.matMul(x,!0,!1)}}},"BatchMatMul",y).reshape(m)}}),K4=F({dot_:function(e,t){var n=N(e,"t1","dot"),r=N(t,"t2","dot");I(!(n.rank!==1&&n.rank!==2||r.rank!==1&&r.rank!==2),function(){return"Error in dot: inputs must all be rank 1 or 2, but got ranks "+n.rank+" and "+r.rank+"."});var o=n.rank===1?n.size:n.shape[1],i=r.rank===1?r.size:r.shape[0];return I(o===i,function(){return"Error in dot: inner dimensions of inputs must match, but got "+o+" and "+i+"."}),n.rank===1&&r.rank===1?n.as2D(1,-1).matMul(r.as2D(-1,1)).asScalar():n.rank===1&&r.rank===2?n.as2D(1,-1).matMul(r.as2D(r.shape[0],r.shape[1])).as1D():n.rank===2&&r.rank===1?n.matMul(r.as2D(-1,1)).as1D():n.matMul(r.as2D(r.shape[0],r.shape[1]))}}),X4=F({outerProduct_:function(e,t){var n=N(e,"v1","outerProduct"),r=N(t,"v2","outerProduct");return I(n.rank===1&&r.rank===1,function(){return"Error in outerProduct: inputs must be rank 1, but got ranks "+n.rank+" and "+r.rank+"."}),n.as2D(-1,1).matMul(r.as2D(1,-1))}}),Eu=F({reverse_:function(e,t){var n=N(e,"x","reverse");if(n.rank===0)return n.clone();var r=vt(t,n.shape);return L.runKernelFunc(function(o){return o.reverse(n,r)},{$x:n},function(o){return{$x:function(){return o.reverse(r)}}}).reshapeAs(n)}}),Y4=F({reverse1d_:function(e){var t=N(e,"x","reverse");return I(t.rank===1,function(){return"Error in reverse1D: x must be rank 1 but got rank "+t.rank+"."}),Eu(t,0)}}),Q4=F({reverse2d_:function(e,t){var n=N(e,"x","reverse");return I(n.rank===2,function(){return"Error in reverse2D: x must be rank 2 but got rank "+n.rank+"."}),Eu(n,t)}}),J4=F({reverse3d_:function(e,t){var n=N(e,"x","reverse");return I(n.rank===3,function(){return"Error in reverse3D: x must be rank 3 but got rank "+n.rank+"."}),Eu(n,t)}}),Z4=F({reverse4d_:function(e,t){var n=N(e,"x","reverse");return I(n.rank===4,function(){return"Error in reverse4D: x must be rank 4 but got rank "+n.rank+"."}),Eu(n,t)}});function $2(e,t,n,r,o,i){var a=N(e,"x","maxPool"),s=a,u=!1;a.rank===3&&(u=!0,s=a.as4D(1,a.shape[0],a.shape[1],a.shape[2])),I(s.rank===4,function(){return"Error in maxPool: input must be rank 4 but got rank "+s.rank+"."}),I(ln(n,r),function(){return"Error in maxPool: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+r+"'"}),i!=null&&I(rt(o),function(){return"Error in maxPool: pad must be an integer when using, dimRoundingMode "+i+" but got pad "+o+"."});var l=ou(s.shape,t,n,r,o,i);if(l.filterWidth===1&&l.filterHeight===1&&xt(l.inShape,l.outShape))return a.clone();var c=[s],d=L.runKernelFunc(function(f,h){var v=f.maxPool(s,l);return h([s,v]),v},{x:s},function(f,h){var v=h[0],m=h[1];return{x:function(){return function(g,p,y,x,w,b,C,E){var S=N(g,"dy","maxPoolBackprop"),R=N(p,"input","maxPoolBackprop"),k=N(y,"output","maxPoolBackprop");I(R.rank===S.rank,function(){return"Rank of input ("+R.rank+") does not match rank of dy ("+S.rank+")"}),I(ln(w,b),function(){return"Error in maxPoolBackProp: Either strides or dilations must be 1. Got strides "+w+" and dilations '"+b+"'"}),I(S.rank===4,function(){return"Error in maxPoolBackprop: dy must be rank 4 but got rank "+S.rank+"."}),I(R.rank===4,function(){return"Error in maxPoolBackprop: input must be rank 4 but got rank "+R.rank+"."});var P=ou(R.shape,x,w,b,C,E);return L.runKernelFunc(function(T){return T.maxPoolBackprop(S,R,k,P)},{$dy:S,$input:R})}(f,v,m,t,n,r,o)}}},"MaxPool",l,c);return u?d.as3D(d.shape[1],d.shape[2],d.shape[3]):d}function V2(e,t,n,r,o,i){var a=N(e,"x","avgPool","float32");I(ln(n,r),function(){return"Error in avgPool: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+r+"'"});var s=a,u=!1;a.rank===3&&(u=!0,s=a.as4D(1,a.shape[0],a.shape[1],a.shape[2])),I(s.rank===4,function(){return"Error in avgPool: x must be rank 4 but got rank "+s.rank+"."}),i!=null&&I(rt(o),function(){return"Error in avgPool: pad must be an integer when using, dimRoundingMode "+i+" but got pad "+o+"."});var l=ou(s.shape,t,n,r,o,i);if(l.filterWidth===1&&l.filterHeight===1&&xt(l.inShape,l.outShape))return a.clone();var c=L.runKernelFunc(function(d){return d.avgPool(s,l)},{x:s},function(d){return{x:function(){return function(f,h,v,m,g,p){var y=N(f,"dy","avgPoolBackprop"),x=N(h,"input","avgPoolBackprop");I(x.rank===y.rank,function(){return"Rank of input ("+x.rank+") does not match rank of dy ("+y.rank+")"}),I(ln(m,g),function(){return"Error in avgPoolBackprop: Either strides or dilations must be 1. Got strides "+m+" and dilations '"+g+"'"});var w=x,b=y,C=!1;x.rank===3&&(C=!0,w=x.as4D(1,x.shape[0],x.shape[1],x.shape[2]),b=y.as4D(1,y.shape[0],y.shape[1],y.shape[2])),I(b.rank===4,function(){return"Error in avgPoolBackprop: dy must be rank 4 but got rank "+b.rank+"."}),I(w.rank===4,function(){return"Error in avgPoolBackprop: input must be rank 4 but got rank "+w.rank+"."});var E=ou(w.shape,v,m,g,p),S=L.runKernelFunc(function(R){return R.avgPoolBackprop(b,w,E)},{dy4D:b,input4D:w});return C?S.as3D(S.shape[1],S.shape[2],S.shape[3]):S}(d,s,t,n,r,o)}}},"AvgPool",l);return c=c.cast(a.dtype),u?c.as3D(c.shape[1],c.shape[2],c.shape[3]):c}var mt=F({maxPool_:function(e,t,n,r,o){return $2(e,t,n,1,r,o)}}),_u=F({avgPool_:function(e,t,n,r,o){return V2(e,t,n,1,r,o)}}),eF=F({pool_:function(e,t,n,r,o,i){o==null&&(o=[1,1]),i==null&&(i=1),r===0&&(r="valid");var a=N(e,"x","maxPool"),s=a,u=!1;a.rank===3&&(u=!0,s=a.as4D(1,a.shape[0],a.shape[1],a.shape[2])),I(ln(i,o),function(){return"Error in pool: Either strides or dilations must be 1. Got strides "+i+" and dilations '"+o+"'"});var l,c=ou(s.shape,t,i,o,r),d=[c.dilationHeight,c.dilationWidth];l=r==="same"?function(w,b){var C=w.map(function(R,k){return R+(R-1)*(b[k]-1)}).map(function(R){return R-1}),E=C.map(function(R){return Math.floor(R/2)}),S=C.map(function(R,k){return R-E[k]});return C.map(function(R,k){return[E[k],S[k]]})}([c.filterHeight,c.filterWidth],d):[[0,0],[0,0]];var f=d[0]===1&&d[1]===1,h=function(w,b,C){var E=C.map(function(O){return O[0]}),S=C.map(function(O){return O[1]}),R=w.concat(E,S),k=b.map(function(O,W){return(O-R[W]%O)%O}),P=S.map(function(O,W){return O+k[W]}),T=b.map(function(O,W){return[E[W],P[W]]}),j=b.map(function(O,W){return[0,k[W]]});return[T,j]}([c.inHeight,c.inWidth],d,l),v=h[0],m=h[1],g=f?r:"valid",p=f?s:Yb(s,d,v),y=(n==="avg"?function(){return V2(p,t,i,1,g)}:function(){return $2(p,t,i,1,g)})(),x=f?y:qb(y,d,m);return u?x.as3D(x.shape[1],x.shape[2],x.shape[3]):x}}),tF=F({maxPool3d_:function(e,t,n,r,o,i,a){i===void 0&&(i="NDHWC");var s=N(e,"x","maxPool3d"),u=s,l=!1;s.rank===4&&(l=!0,u=s.as5D(1,s.shape[0],s.shape[1],s.shape[2],s.shape[3])),a==null&&(a=[1,1,1]),I(u.rank===5,function(){return"Error in maxPool3d: x must be rank 5 but got rank "+u.rank+"."}),I(i==="NDHWC",function(){return"Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of "+i}),I(ln(n,a),function(){return"Error in maxPool3d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+a+"'"}),o!=null&&I(rt(r),function(){return"Error in maxPool3d: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+r+"."});var c=Cc(u.shape,t,n,a,r,o,i),d=L.runKernelFunc(function(f,h){var v=f.maxPool3d(u,c);return h([u,v]),v},{x:u},function(f,h){var v=h[0],m=h[1];return{x:function(){return function(g,p,y,x,w,b,C,E){var S=N(g,"dy","maxPool3dBackprop"),R=N(p,"input","maxPool3dBackprop"),k=N(y,"output","maxPool3dBackprop"),P=S,T=R,j=k,O=!1;R.rank===4&&(O=!0,P=S.as5D(1,S.shape[0],S.shape[1],S.shape[2],S.shape[3]),T=R.as5D(1,R.shape[0],R.shape[1],R.shape[2],R.shape[3]),j=k.as5D(1,k.shape[0],k.shape[1],k.shape[2],k.shape[3])),I(P.rank===5,function(){return"Error in maxPool3dBackprop: dy must be rank 5 but got rank "+P.rank+"."}),I(T.rank===5,function(){return"Error in maxPool3dBackprop: input must be rank 5 but got rank "+T.rank+"."}),I(j.rank===5,function(){return"Error in maxPool3dBackprop: output must be rank 5 but got rank "+j.rank+"."}),b==null&&(b=[1,1,1]),I(ln(w,b),function(){return"Error in maxPool3dBackprop: Either strides or dilations must be 1. Got strides "+w+" and dilations '"+b+"'"}),E!=null&&I(rt(C),function(){return"Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode "+E+" but got pad "+C+"."});var W=Cc(T.shape,x,w,b,C,E),U=L.runKernelFunc(function(z){return z.maxPool3dBackprop(P,T,j,W)},{dy5D:P,input5D:T});return O?U.as4D(U.shape[1],U.shape[2],U.shape[3],U.shape[4]):U}(f,v,m,t,n,a,r,o)}}});return l?d.as4D(d.shape[1],d.shape[2],d.shape[3],d.shape[4]):d}}),nF=F({avgPool3d_:function(e,t,n,r,o,i,a){i===void 0&&(i="NDHWC");var s=N(e,"x","avgPool3d","float32"),u=s,l=!1;s.rank===4&&(l=!0,u=s.as5D(1,s.shape[0],s.shape[1],s.shape[2],s.shape[3])),a==null&&(a=[1,1,1]),I(u.rank===5,function(){return"Error in avgPool3d: x must be rank 5 but got rank "+u.rank+"."}),I(i==="NDHWC",function(){return"Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of "+i}),I(ln(n,a),function(){return"Error in avgPool3d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+a+"'"}),o!=null&&I(rt(r),function(){return"Error in avgPool3d: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+r+"."});var c=Cc(u.shape,t,n,a,r,o,i),d=L.runKernelFunc(function(f){return f.avgPool3d(u,c)},{x:u},function(f){return{x:function(){return function(h,v,m,g,p,y,x){var w=N(h,"dy","avgPool3dBackprop"),b=N(v,"input","avgPool3dBackprop"),C=w,E=b,S=!1;b.rank===4&&(S=!0,C=w.as5D(1,w.shape[0],w.shape[1],w.shape[2],w.shape[3]),E=b.as5D(1,b.shape[0],b.shape[1],b.shape[2],b.shape[3])),I(C.rank===5,function(){return"Error in avgPool3dBackprop: dy must be rank 5 but got rank "+C.rank+"."}),I(E.rank===5,function(){return"Error in avgPool3dBackprop: input must be rank 5 but got rank "+E.rank+"."}),p==null&&(p=[1,1,1]),I(ln(g,p),function(){return"Error in avgPool3dBackprop: Either strides or dilations must be 1. Got strides "+g+" and dilations '"+p+"'"}),x!=null&&I(rt(y),function(){return"Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode "+x+" but got pad "+y+"."});var R=Cc(E.shape,m,g,p,y,x),k=L.runKernelFunc(function(P){return P.avgPool3dBackprop(C,E,R)},{dy5D:C,input5D:E});return S?k.as4D(k.shape[1],k.shape[2],k.shape[3],k.shape[4]):k}(f,u,t,n,a,r,o)}}});return d=d.cast(u.dtype),l?d.as4D(d.shape[1],d.shape[2],d.shape[3],d.shape[4]):d}}),Tr=F({slice_:function(e,t,n){var r,o,i=N(e,"x","slice");if(i.rank===0)throw new Error("Slicing scalar is not possible");(r=typeof t=="number"?[t].concat(new Array(i.rank-1).fill(0)):t.length<i.rank?t.concat(new Array(i.rank-t.length).fill(0)):t.slice()).forEach(function(u){I(u!==-1,function(){return"slice() does not support negative begin indexing."})}),o=(o=n==null?new Array(i.rank).fill(-1):typeof n=="number"?[n].concat(new Array(i.rank-1).fill(-1)):n.length<i.rank?n.concat(new Array(i.rank-n.length).fill(-1)):n).map(function(u,l){return u>=0?u:(I(u===-1,function(){return"Negative size values should be exactly -1 but got "+u+" for the slice() size at index "+l+"."}),i.shape[l]-r[l])}),TP(i,r,o);var a=i.shape,s={begin:r,size:o};return L.runKernelFunc(function(u){return u.slice(i,r,o)},{x:i},function(u){for(var l=[],c=0;c<u.rank;c++)l.push([r[c],a[c]-r[c]-o[c]]);return{x:function(){return u.pad(l)}}},"Slice",s)}}),rF=F({slice1d_:function(e,t,n){var r=N(e,"x","slice1d");return I(r.rank===1,function(){return"slice1d expects a rank-1 tensor, but got a rank-"+r.rank+" tensor"}),Tr(r,[t],[n])}}),oF=F({slice2d_:function(e,t,n){var r=N(e,"x","slice2d");return I(r.rank===2,function(){return"slice2d expects a rank-2 tensor, but got a rank-"+r.rank+" tensor"}),Tr(r,t,n)}}),H2=F({slice3d_:function(e,t,n){var r=N(e,"x","slice3d");return I(r.rank===3,function(){return"slice3d expects a rank-3 tensor, but got a rank-"+r.rank+" tensor"}),Tr(r,t,n)}}),iF=F({slice4d_:function(e,t,n){var r=N(e,"x","slice4d");return I(r.rank===4,function(){return"slice4d expects a rank-4 tensor, but got a rank-"+r.rank+" tensor"}),Tr(r,t,n)}});function G2(e,t,n,r,o){return t.rank<n.rank&&(t=t.reshape(un(t.shape,r))),e.rank<n.rank&&(e=e.reshape(un(e.shape,r))),{x:function(){var i=e.mul(n.equal(t).cast(e.dtype));return o==null?i:i.transpose(o)}}}var aF=F({all_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=N(e,"x","all","bool"),o=vt(t,r.shape),i=o,a=Dr(i,r.rank);a!=null&&(r=r.transpose(a),i=Fr(i.length,r.rank));var s=L.runKernelFunc(function(l){return l.all(r,i)},{$x:r});if(n){var u=un(s.shape,o);return s.reshape(u)}return s}}),sF=F({any_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=N(e,"x","any","bool"),o=vt(t,r.shape),i=o,a=Dr(i,r.rank);a!=null&&(r=r.transpose(a),i=Fr(i.length,r.rank));var s=L.runKernelFunc(function(l){return l.any(r,i)},{$x:r});if(n){var u=un(s.shape,o);return s.reshape(u)}return s}}),uF=F({argMax_:function(e,t){t===void 0&&(t=0);var n=N(e,"x","argMax");t==null&&(t=0);var r=vt(t,n.shape),o=Dr(r,n.rank);o!=null&&(n=n.transpose(o),r=Fr(r.length,n.rank));var i={axis:r[0]},a=[n];return L.runKernelFunc(function(s,u){var l=s.argMax(n,r[0]);return u([n]),l},{x:n},function(s,u){var l=u[0];return{x:function(){return Re(l)}}},"ArgMax",i,a)}}),lF=F({argMin_:function(e,t){t===void 0&&(t=0);var n=N(e,"x","argMin");t==null&&(t=0);var r=vt(t,n.shape),o=Dr(r,n.rank);return o!=null&&(n=n.transpose(o),r=Fr(r.length,n.rank)),L.runKernelFunc(function(i,a){var s=i.argMin(n,r[0]);return a([n]),s},{$x:n},function(i,a){var s=a[0];return{$x:function(){return Re(s)}}})}}),cF=F({logSumExp_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=N(e,"x","logSumExp"),o=vt(t,r.shape),i=r.max(o,!0),a=r.sub(i).exp().sum(o).log(),s=i.reshape(a.shape).add(a);if(n){var u=un(s.shape,o);return s.reshape(u)}return s}}),vd=F({max_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=N(e,"x","max"),o=r,i=vt(t,r.shape),a=i,s=Dr(a,r.rank);s!=null&&(r=r.transpose(s),a=Fr(a.length,r.rank));var u=[r],l=L.runKernelFunc(function(d,f){var h=d.max(r,a);return f([o,h]),h},{x:r},function(d,f){return G2(d,f[1],f[0],i,s)},"Max",{axes:a},u,[!0]);if(n){var c=un(l.shape,i);l=l.reshape(c)}return l}}),dF=F({mean_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=N(e,"x","mean"),o=vt(t,r.shape),i=ae(Ft(r.shape,o)[1]);return cd(function(a){var s=ee(i);return{value:(s.dtype===a.dtype?a:a.cast(s.dtype)).div(s).sum(t,n),gradFunc:function(u){var l=a.shape.slice();return o.forEach(function(c){l[c]=1}),u.reshape(l).mul(ts(a.shape,"float32")).div(i)}}})(r)}}),fF=F({min_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=N(e,"x","min"),o=r,i=vt(t,r.shape),a=i,s=Dr(a,r.rank);s!=null&&(r=r.transpose(s),a=Fr(a.length,r.rank));var u=[r],l=L.runKernelFunc(function(d,f){var h=d.min(r,a);return f([o,h]),h},{x:r},function(d,f){return G2(d,f[1],f[0],i,s)},"Min",{axes:a},u,[!0]);if(n){var c=un(l.shape,i);l=l.reshape(c)}return l}}),hF=F({moments_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=vt(t,(e=N(e,"x","moments")).shape),o=e.mean(r,n),i=o.shape;n||(i=un(o.shape,r));var a=e.toFloat().sub(o.reshape(i)).square();return{mean:o,variance:a.mean(r,n)}}}),q2=F({sum_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=N(e,"x","sum");r.dtype==="bool"&&(r=r.toInt());var o=vt(t,r.shape);return cd(function(i){var a=Dr(o,i.rank),s=o,u=i;a!=null&&(u=i.transpose(a),s=Fr(s.length,i.rank));var l=function(h){var v=i.shape.slice();return o.forEach(function(m){v[m]=1}),h.reshape(v).mul(ts(i.shape,"float32"))},c={axes:s},d=L.runKernelFunc(function(h){return h.sum(u,s)},{x:u},function(h){return{x:function(){return l(h)}}},"Sum",c);if(n){var f=un(d.shape,o);d=d.reshape(f)}return{value:d,gradFunc:l}})(r)}}),pF=F({prod_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=N(e,"x","prod");r.dtype==="bool"&&(r=r.toInt());var o=vt(t,r.shape),i=Dr(o,r.rank),a=o,s=r;i!=null&&(s=r.transpose(i),a=Fr(a.length,r.rank));var u=L.runKernelFunc(function(c){return c.prod(s,a)},{permutedX:s});if(n){var l=un(u.shape,o);u=u.reshape(l)}return u}}),K2=F({elu_:function(e){var t=N(e,"x","elu");return L.runKernelFunc(function(n,r){var o=n.elu(t);return r([o]),o},{$x:t},function(n,r){var o=r[0];return{$x:function(){return L.runKernelFunc(function(i){return i.eluDer(n,o)},{dy:n,y:o})}}})}}),vF=F({leakyRelu_:function(e,t){t===void 0&&(t=.2);var n=N(e,"x","leakyRelu");return Lv(ee(t).mul(n),n)}}),X2=F({prelu_:function(e,t){var n=N(e,"x","prelu"),r=N(t,"alpha","prelu");return L.runKernelFunc(function(o,i){var a=o.prelu(n,r);return i([n,r]),a},{x:n,alpha:r},function(o,i){var a=i[0],s=i[1],u=a.greater(0);return{x:function(){return Ai(u,o,o.mul(s))},alpha:function(){var l=Ai(u,Re(o),o.mul(a)),c=ht(s.shape,o.shape);return c.length>0&&(l=l.sum(c)),l.reshape(s.shape)}}},"Prelu")}}),Ke=F({relu_:function(e){var t=N(e,"x","relu");return t.dtype==="bool"?t.toInt():L.runKernelFunc(function(n,r){var o=n.relu(t);return r([t]),o},{x:t},function(n,r){var o=r[0];return{x:function(){return n.mulStrict(o.step().toFloat())}}},"Relu")}}),Y2=F({relu6_:function(e){var t=N(e,"x","relu6");return t.dtype==="bool"?t.toInt():L.runKernelFunc(function(n,r){var o=n.relu6(t);return r([t]),o},{x:t},function(n,r){var o=r[0],i=o.lessEqual(6).mul(o.step());return{x:function(){return n.mulStrict(i.toFloat())}}},"Relu6")}}),mF=F({selu_:function(e){var t=N(e,"x","selu");return L.runKernelFunc(function(n,r){var o=n.selu(t);return r([t]),o},{$x:t},function(n,r){var o=r[0];return{$x:function(){var i=o.greater(ee(0)),a=ee(Fv),s=ee(Mv),u=n.mul(s),l=n.mul(a).mul(o.toFloat().exp());return Ai(i,u,l)}}})}}),Xo=F({transpose_:function(e,t){var n=N(e,"x","transpose");if(t==null&&(t=n.shape.map(function(o,i){return i}).reverse()),I(n.rank===t.length,function(){return"Error in transpose: rank of input "+n.rank+" must match length of perm "+t+"."}),t.forEach(function(o){I(o>=0&&o<n.rank,function(){return"All entries in 'perm' must be between 0 and "+(n.rank-1)+" but got "+t})}),n.rank<=1)return n.clone();var r={perm:t};return L.runKernelFunc(function(o){return o.transpose(n,t)},{x:n},function(o){var i=_v(t);return{x:function(){return o.transpose(i)}}},"Transpose",r)}}),gF=F({localResponseNormalization_:function(e,t,n,r,o){t===void 0&&(t=5),n===void 0&&(n=1),r===void 0&&(r=1),o===void 0&&(o=.5);var i=N(e,"x","localResponseNormalization");I(i.rank===4||i.rank===3,function(){return`Error in localResponseNormalization: x must be rank 3 or 4 but got
               rank `+i.rank+"."}),I(rt(t),function(){return"Error in localResponseNormalization: depthRadius must be an integer but got depthRadius "+t+"."});var a=i,s=!1;i.rank===3&&(s=!0,a=i.as4D(1,i.shape[0],i.shape[1],i.shape[2]));var u=L.runKernelFunc(function(l,c){var d=l.localResponseNormalization4D(a,t,n,r,o);return c([a,d]),d},{x4D:a},function(l,c){var d=c[0],f=c[1];return{x4D:function(){return L.runKernelFunc(function(h){return h.LRNGrad(l,d,f,t,n,r,o)},{})}}});return s?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),Q2=F({norm_:function(e,t,n,r){t===void 0&&(t="euclidean"),n===void 0&&(n=null),r===void 0&&(r=!1);var o=function s(u,l,c){if(c===void 0&&(c=null),u.rank===0)return u.abs();if(u.rank!==1&&c===null)return s(u.reshape([-1]),l,c);if(u.rank===1||typeof c=="number"||Array.isArray(c)&&c.length===1){if(l===1)return u.abs().sum(c);if(l===1/0)return u.abs().max(c);if(l===-1/0)return u.abs().min(c);if(l==="euclidean"||l===2)return u.abs().pow(ee(2,"int32")).sum(c).sqrt();throw new Error("Error in norm: invalid ord value: "+l)}if(Array.isArray(c)&&c.length===2){if(l===1)return u.abs().sum(c[0]).max(c[1]-1);if(l===1/0)return u.abs().sum(c[1]).max(c[0]);if(l===-1/0)return u.abs().sum(c[1]).min(c[0]);if(l==="fro"||l==="euclidean")return u.square().sum(c).sqrt();throw new Error("Error in norm: invalid ord value: "+l)}throw new Error("Error in norm: invalid axis: "+c)}(e=N(e,"x","norm"),t,n),i=o.shape;if(r){var a=vt(n,e.shape);i=un(o.shape,a)}return o.reshape(i)}}),yF=F({basicLSTMCell_:function(e,t,n,r,o,i){var a=N(e,"forgetBias","basicLSTMCell"),s=N(t,"lstmKernel","basicLSTMCell"),u=N(n,"lstmBias","basicLSTMCell"),l=N(r,"data","basicLSTMCell"),c=N(o,"c","basicLSTMCell"),d=N(i,"h","basicLSTMCell"),f=l.concat(d,1).matMul(s).add(u),h=f.shape[0],v=f.shape[1]/4,m=[h,v],g=f.slice([0,0],m),p=f.slice([0,v],m),y=f.slice([0,2*v],m),x=f.slice([0,3*v],m),w=g.sigmoid().mulStrict(p.tanh()).addStrict(c.mulStrict(a.add(y).sigmoid())),b=w.tanh().mulStrict(x.sigmoid());return[w,b]}}),xF=F({multiRNNCell_:function(e,t,n,r){for(var o=N(t,"data","multiRNNCell"),i=mc(n,"c","multiRNNCell"),a=mc(r,"h","multiRNNCell"),s=o,u=[],l=0;l<e.length;l++){var c=e[l](s,i[l],a[l]);u.push(c[0]),u.push(c[1]),s=c[1]}var d=[],f=[];for(l=0;l<u.length;l+=2)d.push(u[l]),f.push(u[l+1]);return[d,f]}}),wF=F({movingAverage_:function(e,t,n,r,o){o===void 0&&(o=!0);var i=N(e,"v","movingAverage"),a=N(t,"x","movingAverage"),s=N(n,"decay","movingAverage");gA(i,a),I(xt(i.shape,a.shape),function(){return"Shape mismatch in v and x"});var u=ee(1),l=u.sub(s),c=a.sub(i).mul(l);if(o){I(r!=null,function(){return"When using zeroDebias: true, step is required."});var d=N(r,"step","movingAverage");c=c.div(u.sub(kc(s,d)))}return i.add(c)}}),bF=F({stridedSlice_:function(e,t,n,r,o,i,a,s,u){if(o===void 0&&(o=0),i===void 0&&(i=0),a===void 0&&(a=0),s===void 0&&(s=0),u===void 0&&(u=0),r==null&&(r=new Array(t.length)),a!==0)throw new Error("ellipsis mask is not yet supported");var l=N(e,"x","stridedSlice"),c=Dy(s),d=l.shape.slice();c.forEach(function(g){t[g]=0,n[g]=1,d.splice(g,0,1)}),l=l.reshape(d);for(var f=0;f<l.rank;f++)t[f]=AP(o,t,r,l.shape,f),n[f]=PP(i,n,r,l.shape,f),r[f]=r[f]||1;var h=Dy(u);h.forEach(function(g){n[g]=t[g]+1,r[g]=1});var v=Nv(t,n,r),m=v.filter(function(g,p){return h.indexOf(p)===-1});return r.every(function(g){return g===1})?Tr(l,t,v).reshape(m):L.runKernelFunc(function(g){return g.stridedSlice(l,t,n,r)},{$x:l}).reshape(m)}}),CF=F({topk_:function(e,t,n){t===void 0&&(t=1),n===void 0&&(n=!0);var r=N(e,"x","topk");if(r.rank===0)throw new Error("topk() expects the input to be of rank 1 or higher");var o=r.shape[r.shape.length-1];if(t>o)throw new Error("'k' passed to topk() must be <= the last dimension ("+o+") but got "+t);var i=L.runKernelFunc(function(a){return a.topk(r,t,n)},{$x:r});return{values:i[0],indices:i[1]}}}),EF=F({scatterND_:function(e,t,n){var r=N(e,"indices","scatterND","int32"),o=N(t,"updates","scatterND");return IP(o,r,n),L.runKernelFunc(function(i){return i.scatterND(r,o,n)},{indices:r,updates:o},null,"ScatterNd",{shape:n})}}),zv=F({fft_:function(e){I(e.dtype==="complex64",function(){return"The dtype for tf.spectral.fft() must be complex64 but got "+e.dtype+"."});var t=e.shape[e.shape.length-1],n=e.size/t,r=e.as2D(n,t);return L.runKernelFunc(function(o){return o.fft(r)},{input:e}).reshape(e.shape)}}),Rc=F({ifft_:function(e){I(e.dtype==="complex64",function(){return"The dtype for tf.spectral.ifft() must be complex64 but got "+e.dtype+"."});var t=e.shape[e.shape.length-1],n=e.size/t,r=e.as2D(n,t);return L.runKernelFunc(function(o){return o.ifft(r)},{input:e}).reshape(e.shape)}}),Uv=F({rfft_:function(e,t){I(e.dtype==="float32",function(){return"The dtype for rfft() must be real value but got "+e.dtype});var n,r=e.shape[e.shape.length-1],o=e.size/r;if(t!=null&&t<r){var i=e.shape.map(function(p){return 0}),a=e.shape.map(function(p){return p});a[e.shape.length-1]=t,n=e.slice(i,a),r=t}else if(t!=null&&t>r){var s=e.shape.map(function(p){return p});s[e.shape.length-1]=t-r,n=e.concat(Ue(s),e.shape.length-1),r=t}else n=e;var u=n.zerosLike(),l=Et(n,u).as2D(o,r),c=zv(l),d=Math.floor(r/2)+1,f=An(c),h=wr(c),v=f.split([d,r-d],f.shape.length-1),m=h.split([d,r-d],h.shape.length-1),g=n.shape.slice();return g[n.shape.length-1]=d,Et(v[0],m[0]).reshape(g)}}),J2=F({irfft_:function(e){var t=e.shape[e.shape.length-1],n=e.size/t;if(t<=2){var r=e.as2D(n,t),o=Rc(r);return An(o)}var i=[n,2*(t-1)],a=An(e).as2D(n,t),s=wr(e).as2D(n,t),u=a.slice([0,1],[n,t-2]).reverse(1),l=s.slice([0,1],[n,t-2]).reverse(1).mul(ee(-1)),c=a.concat(u,1),d=s.concat(l,1);return r=Et(c,d).as2D(i[0],i[1]),o=Rc(r),An(o)}}),_F=Object.freeze({fft:zv,ifft:Rc,rfft:Uv,irfft:J2}),SF=F({sparseToDense_:function(e,t,n,r){r===void 0&&(r=0);var o=N(e,"sparseIndices","sparseToDense","int32"),i=N(t,"sparseValues","sparseToDense"),a=N(r,"defaultValue","sparseToDense",i.dtype);return function(s,u,l,c){if(s.dtype!=="int32")throw new Error("tf.sparseToDense() expects the indices to be int32 type, but the dtype was "+s.dtype+".");if(s.rank>2)throw new Error("sparseIndices should be a scalar, vector, or matrix, but got shape "+s.shape+".");var d=s.rank>0?s.shape[0]:1,f=s.rank>1?s.shape[1]:1;if(l.length!==f)throw new Error("outputShape has incorrect number of elements:, "+l.length+", should be: "+f+".");var h=u.size;if(u.rank!==0&&(u.rank!==1||h!==d))throw new Error("sparseValues has incorrect shape "+u.shape+", should be [] or ["+d+"]");if(u.dtype!==c.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}(o,i,n,a),L.runKernelFunc(function(s){return s.sparseToDense(o,i,n,a)},{$sparseIndices:o,$sparseValues:i,$defaultValue:a})}}),kF=F({gatherND_:function(e,t){var n=N(t,"indices","gatherND","int32"),r=N(e,"x","gatherND");return L.runKernelFunc(function(o){return o.gatherND(r,n)},{x:r,indices:n},null,"GatherNd")}}),RF=F({diag_:function(e){var t=N(e,"x","diag").flatten(),n=e.shape.concat(e.shape);return L.runKernelFunc(function(r){return r.diag(t)},{$x:t}).reshape(n)}}),NF=F({dropout_:function(e,t,n,r){var o=N(e,"x","dropout");if(I(o.dtype==="float32",function(){return"x has to be a floating point tensor since it's going to be scaled, but got a "+o.dtype+" tensor instead."}),I(t>=0&&t<1,function(){return"rate must be a float in the range [0, 1), but got "+t+"."}),t===0)return e instanceof qe?o.clone():o;var i=function(u,l){if(l==null)return u.shape.slice();if(xt(u.shape,l))return l;if(u.shape.length===l.length){for(var c=[],d=0;d<u.shape.length;d++)l[d]==null&&u.shape[d]!=null?c.push(u.shape[d]):c.push(l[d]);return c}return l}(o,n),a=1-t,s=Xb(i,0,1,"float32",r).add(a).floor().div(a);return o.mul(s)}});function Z2(e,t,n){for(var r=1-e%2,o=new Float32Array(e),i=0;i<e;++i){var a=2*Math.PI*i/(e+r-1);o[i]=t-n*Math.cos(a)}return at(o,"float32")}var $v=F({hannWindow_:function(e){return Z2(e,.5,.5)}}),eC=F({hammingWindow_:function(e){return Z2(e,.54,.46)}}),Vv=F({frame_:function(e,t,n,r,o){r===void 0&&(r=!1),o===void 0&&(o=0);for(var i=0,a=[];i+t<=e.size;)a.push(Tr(e,i,t)),i+=n;if(r)for(;i<e.size;){var s=i+t-e.size,u=dt([Tr(e,i,t-s),Nr([s],o)]);a.push(u),i+=n}return a.length===0?Wo([],[0,t]):dt(a).as2D(a.length,t)}}),tC=F({stft_:function(e,t,n,r,o){var i;o===void 0&&(o=$v),r==null&&(i=t,r=Math.floor(Math.pow(2,Math.ceil(Math.log(i)/Math.log(2)))));for(var a=Vv(e,t,n),s=jt(a,o(t)),u=[],l=0;l<a.shape[0];l++)u.push(Uv(s.slice([l,0],[1,t]),r));return dt(u)}}),IF=Object.freeze({hannWindow:$v,hammingWindow:eC,frame:Vv,stft:tC}),Bt,TF=function(e,t,n){return n===void 0&&(n=1),oe(this,void 0,void 0,function(){var r,o,i,a,s,u,l,c,d,f,h,v,m,g;return ie(this,function(p){switch(p.label){case 0:return r=N(e,"predictions","inTopK"),o=N(t,"targets","inTopK"),I(r.rank>1,function(){return"inTopK() expects the predictions to be of rank 2 or higher, but got "+r.rank}),I(r.rank-1===o.rank,function(){return"predictions rank should be 1 larger than targets rank, but got predictions rank "+r.rank+" and targets rank "+o.rank}),Ae(r.shape.slice(0,r.shape.length-1),o.shape,"predictions's shape should be align with the targets' shape, except the last dimension."),i=r.shape[r.shape.length-1],I(n>0&&n<=i,function(){return"'k' passed to inTopK() must be > 0 && <= the predictions last dimension ("+i+"), but got "+n}),[4,r.data()];case 1:return a=p.sent(),[4,o.data()];case 2:for(s=p.sent(),u=[a.length/i,i],c=u[1],d=tu("bool",l=u[0]),f=0;f<l;f++){for(h=f*c,v=a.subarray(h,h+c),m=[],g=0;g<v.length;g++)m.push({value:v[g],index:g});for(m.sort(function(y,x){return x.value-y.value}),d[f]=0,g=0;g<n;g++)if(m[g].index===s[f]){d[f]=1;break}}return e!==r&&r.dispose(),t!==o&&o.dispose(),[2,St(d,o.shape,"bool")]}})})};(function(e){e[e.NONE=0]="NONE",e[e.MEAN=1]="MEAN",e[e.SUM=2]="SUM",e[e.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"})(Bt||(Bt={}));var AF=F({absoluteDifference_:function(e,t,n,r){r===void 0&&(r=Bt.SUM_BY_NONZERO_WEIGHTS);var o=N(e,"labels","absoluteDifference"),i=N(t,"predictions","absoluteDifference"),a=null;n!=null&&(a=N(n,"weights","absoluteDifference")),Ae(o.shape,i.shape,"Error in absoluteDifference: ");var s=o.sub(i).abs();return ro(s,a,r)}}),ro=F({computeWeightedLoss_:function(e,t,n){n===void 0&&(n=Bt.SUM_BY_NONZERO_WEIGHTS);var r=N(e,"losses","computeWeightedLoss"),o=null;t!=null&&(o=N(t,"weights","computeWeightedLoss"));var i=o==null?r:r.mul(o);if(n===Bt.NONE)return i;if(n===Bt.SUM)return i.sum();if(n===Bt.MEAN){if(o==null)return i.mean();var a=r.size/o.size,s=i.sum().div(o.sum());return a>1?s.div(ee(a)):s}if(n===Bt.SUM_BY_NONZERO_WEIGHTS){if(o==null)return i.sum().div(ee(r.size));var u=o.mul(ts(r.shape)).notEqual(ee(0)).sum().toFloat();return i.sum().div(u)}throw Error("Unknown reduction: "+n)}}),PF=F({cosineDistance_:function(e,t,n,r,o){o===void 0&&(o=Bt.SUM_BY_NONZERO_WEIGHTS);var i=N(e,"labels","cosineDistance"),a=N(t,"predictions","cosineDistance"),s=null;r!=null&&(s=N(r,"weights","cosineDistance")),Ae(i.shape,a.shape,"Error in cosineDistance: ");var u=ee(1).sub(i.mul(a).sum(n,!0));return ro(u,s,o)}}),DF=F({hingeLoss_:function(e,t,n,r){r===void 0&&(r=Bt.SUM_BY_NONZERO_WEIGHTS);var o=N(e,"labels","hingeLoss"),i=N(t,"predictions","hingeLoss"),a=null;n!=null&&(a=N(n,"weights","hingeLoss")),Ae(o.shape,i.shape,"Error in hingeLoss: ");var s=ee(1);o=ee(2).mul(o).sub(s);var u=s.sub(o.mul(i)).relu();return ro(u,a,r)}}),FF=F({huberLoss_:function(e,t,n,r,o){r===void 0&&(r=1),o===void 0&&(o=Bt.SUM_BY_NONZERO_WEIGHTS);var i=N(e,"labels","huberLoss"),a=N(t,"predictions","huberLoss"),s=null;n!=null&&(s=N(n,"weights","huberLoss")),Ae(i.shape,a.shape,"Error in huberLoss: ");var u=ee(r),l=a.sub(i).abs(),c=F2(l,u),d=l.sub(c),f=ee(.5).mul(c.square()).add(u.mul(d));return ro(f,s,o)}}),MF=F({logLoss_:function(e,t,n,r,o){r===void 0&&(r=1e-7),o===void 0&&(o=Bt.SUM_BY_NONZERO_WEIGHTS);var i=N(e,"labels","logLoss"),a=N(t,"predictions","logLoss"),s=null;n!=null&&(s=N(n,"weights","logLoss")),Ae(i.shape,a.shape,"Error in logLoss: ");var u=ee(1),l=ee(r),c=i.mul(a.add(l).log()).neg().sub(u.sub(i).mul(u.sub(a).add(l).log()));return ro(c,s,o)}}),OF=F({meanSquaredError_:function(e,t,n,r){r===void 0&&(r=Bt.SUM_BY_NONZERO_WEIGHTS);var o=N(e,"labels","meanSquaredError"),i=N(t,"predictions","meanSquaredError"),a=null;n!=null&&(a=N(n,"weights","meanSquaredError")),Ae(o.shape,i.shape,"Error in meanSquaredError: ");var s=o.squaredDifference(i);return ro(s,a,r)}}),LF=F({sigmoidCrossEntropy_:function(e,t,n,r,o){r===void 0&&(r=0),o===void 0&&(o=Bt.SUM_BY_NONZERO_WEIGHTS);var i=N(e,"multiClassLabels","sigmoidCrossEntropy"),a=N(t,"logits","sigmoidCrossEntropy"),s=null;if(n!=null&&(s=N(n,"weights","sigmoidCrossEntropy")),Ae(i.shape,a.shape,"Error in sigmoidCrossEntropy: "),r>0){var u=ee(r),l=ee(1),c=ee(.5);i=i.mul(l.sub(u)).add(c.mul(u))}var d=function(f,h){var v=N(f,"labels","sigmoidCrossEntropyWithLogits"),m=N(h,"logits","sigmoidCrossEntropyWithLogits");Ae(v.shape,m.shape,"Error in sigmoidCrossEntropyWithLogits: ");var g=m.relu(),p=m.mul(v),y=m.abs().neg().exp().log1p();return g.sub(p).add(y)}(i,a);return ro(d,s,o)}}),BF=F({softmaxCrossEntropy_:function(e,t,n,r,o){r===void 0&&(r=0),o===void 0&&(o=Bt.SUM_BY_NONZERO_WEIGHTS);var i=N(e,"onehotLabels","softmaxCrossEntropy"),a=N(t,"logits","softmaxCrossEntropy"),s=null;if(n!=null&&(s=N(n,"weights","softmaxCrossEntropy")),Ae(i.shape,a.shape,"Error in softmaxCrossEntropy: "),r>0){var u=ee(r),l=ee(1),c=ee(i.shape[1]);i=i.mul(l.sub(u)).add(u.div(c))}var d=function(f,h,v){if(v===void 0&&(v=-1),v===-1&&(v=h.rank-1),v!==h.rank-1)throw Error("Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank "+h.rank+" and dim was "+v);return cd(function(m,g,p){var y=g.logSumExp([v],!0),x=g.toFloat().sub(y);return p([m,x]),{value:x.mul(m).neg().sum([v]),gradFunc:function(w,b){var C=b[0],E=b[1],S=un(w.shape,[v]);return[w.reshape(S).mul(C.toFloat().sub(E.exp())),w.reshape(S).mul(E.exp().sub(C.toFloat()))]}}})(f,h)}(i,a);return ro(d,s,o)}}),jF=Object.freeze({get Reduction(){return Bt},absoluteDifference:AF,computeWeightedLoss:ro,cosineDistance:PF,hingeLoss:DF,huberLoss:FF,logLoss:MF,meanSquaredError:OF,sigmoidCrossEntropy:LF,softmaxCrossEntropy:BF});function t0(e,t){return t===void 0&&(t=!1),L.tidy(function(){if(e.shape.length!==2)throw new Error("qr2d() requires a 2D Tensor, but got a "+e.shape.length+"D Tensor.");for(var n=e.shape[0],r=e.shape[1],o=Kb(n),i=e.clone(),a=Wo([[1]],[1,1]),s=a.clone(),u=n>=r?r:n,l=function(d){var f,h=i,v=s,m=o;f=L.tidy(function(){var g=i.slice([d,d],[n-d,1]),p=g.norm(),y=i.slice([d,d],[1,1]),x=Wo([[-1]]).where(y.greater(0),Wo([[1]])),w=y.sub(x.mul(p)),b=g.div(w);s=b.shape[0]===1?a.clone():a.concat(b.slice([1,0],[b.shape[0]-1,b.shape[1]]),0);var C=x.matMul(w).div(p).neg(),E=i.slice([d,0],[n-d,r]),S=C.mul(s);if(d===0)i=E.sub(S.matMul(s.transpose().matMul(E)));else{var R=E.sub(S.matMul(s.transpose().matMul(E)));i=i.slice([0,0],[d,r]).concat(R,0)}var k=o.slice([0,d],[n,o.shape[1]-d]);if(d===0)o=k.sub(k.matMul(s).matMul(S.transpose()));else{var P=k.sub(k.matMul(s).matMul(S.transpose()));o=o.slice([0,0],[n,d]).concat(P,1)}return[s,i,o]}),s=f[0],i=f[1],o=f[2],an([h,v,m])},c=0;c<u;++c)l(c);return!t&&n>r&&(o=o.slice([0,0],[n,r]),i=i.slice([0,0],[r,r])),[o,i]})}var WF=F({bandPart_:function(e,t,n){if(t%1!=0)throw new Error("bandPart(): numLower must be an integer, got "+t+".");if(n%1!=0)throw new Error("bandPart(): numUpper must be an integer, got "+n+".");var r=N(e,"a","bandPart");if(r.rank<2)throw new Error("bandPart(): Rank must be at least 2, got "+r.rank+".");var o=r.shape,i=r.shape.slice(-2),a=i[0],s=i[1];if(!(t<=a))throw new Error("bandPart(): numLower ("+t+") must not be greater than the number of rows ("+a+").");if(!(n<=s))throw new Error("bandPart(): numUpper ("+n+") must not be greater than the number of columns ("+s+").");t<0&&(t=a),n<0&&(n=s);var u=gc(0,a,1,"int32").reshape([-1,1]),l=gc(0,s,1,"int32"),c=pt(u,l),d=fd(c.lessEqual(ee(+t,"int32")),c.greaterEqual(ee(-n,"int32"))),f=Ue([a,s],r.dtype);return Cn(ft(r.reshape([-1,a,s])).map(function(h){return Ai(d,h,f)})).reshape(o)}}),zF=F({gramSchmidt_:function(e){var t;if(Array.isArray(e)){t=!1,I(e!=null&&e.length>0,function(){return"Gram-Schmidt process: input must not be null, undefined, or empty"});for(var n=e[0].shape[0],r=function(u){I(e[u].shape[0]===n,function(){return"Gram-Schmidt: Non-unique lengths found in the input vectors: ("+e[u].shape[0]+" vs. "+n+")"})},o=1;o<e.length;++o)r(o)}else t=!0,e=kv(e,e.shape[0],0).map(function(u){return Qb(u,[0])});I(e.length<=e[0].shape[0],function(){return"Gram-Schmidt: Number of vectors ("+e.length+") exceeds number of dimensions ("+e[0].shape[0]+")."});var i=[],a=e,s=function(u){i.push(L.tidy(function(){var l=a[u];if(u>0)for(var c=0;c<u;++c){var d=q2(i[c].mulStrict(l)).mul(i[c]);l=l.sub(d)}return l.div(Q2(l,"euclidean"))}))};for(o=0;o<e.length;++o)s(o);return t?Cn(i,0):i}}),UF=F({qr_:function(e,t){if(t===void 0&&(t=!1),e.rank<2)throw new Error("qr() requires input tensor to have a rank >= 2, but got rank "+e.rank);if(e.rank===2)return t0(e,t);var n=e.shape.slice(0,e.shape.length-2).reduce(function(a,s){return a*s}),r=ft(e.reshape([n,e.shape[e.shape.length-2],e.shape[e.shape.length-1]]),0),o=[],i=[];return r.forEach(function(a){var s=t0(a,t),u=s[0],l=s[1];o.push(u),i.push(l)}),[Cn(o,0).reshape(e.shape),Cn(i,0).reshape(e.shape)]}}),$F=Object.freeze({bandPart:WF,gramSchmidt:zF,qr:UF});function md(e,t,n,r,o,i){r==null&&(r=.5),o==null&&(o=Number.NEGATIVE_INFINITY),i==null&&(i=0);var a=e.shape[0];return n=Math.min(n,a),I(0<=r&&r<=1,function(){return"iouThreshold must be in [0, 1], but was '"+r+"'"}),I(e.rank===2,function(){return"boxes must be a 2D tensor, but was of rank '"+e.rank+"'"}),I(e.shape[1]===4,function(){return"boxes must have 4 columns, but 2nd dimension was "+e.shape[1]}),I(t.rank===1,function(){return"scores must be a 1D tensor"}),I(t.shape[0]===a,function(){return"scores has incompatible shape with boxes. Expected "+a+", but was "+t.shape[0]}),I(0<=i&&i<=1,function(){return"softNmsSigma must be in [0, 1], but was '"+i+"'"}),{maxOutputSize:n,iouThreshold:r,scoreThreshold:o,softNmsSigma:i}}var VF=F({resizeBilinear_:function(e,t,n){n===void 0&&(n=!1);var r=N(e,"images","resizeBilinear");I(r.rank===3||r.rank===4,function(){return"Error in resizeBilinear: x must be rank 3 or 4, but got rank "+r.rank+"."}),I(t.length===2,function(){return"Error in resizeBilinear: new shape must 2D, but got shape "+t+"."});var o=r,i=!1;r.rank===3&&(i=!0,o=r.as4D(1,r.shape[0],r.shape[1],r.shape[2]));var a=t[0],s=t[1],u=L.runKernelFunc(function(l,c){return c([o]),l.resizeBilinear(o,a,s,n)},{x:o},function(l,c){return{x:function(){return L.runKernelFunc(function(d){return d.resizeBilinearBackprop(l,c[0],n)},{})}}},"ResizeBilinear",{alignCorners:n,newHeight:a,newWidth:s});return i?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),HF=F({resizeNearestNeighbor_:function(e,t,n){n===void 0&&(n=!1);var r=N(e,"images","resizeNearestNeighbor");I(r.rank===3||r.rank===4,function(){return"Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank "+r.rank+"."}),I(t.length===2,function(){return"Error in resizeNearestNeighbor: new shape must 2D, but got shape "+t+"."}),I(r.dtype==="float32"||r.dtype==="int32",function(){return"`images` must have `int32` or `float32` as dtype"});var o=r,i=!1;r.rank===3&&(i=!0,o=r.as4D(1,r.shape[0],r.shape[1],r.shape[2]));var a=t[0],s=t[1],u=L.runKernelFunc(function(l,c){return c([o]),l.resizeNearestNeighbor(o,a,s,n)},{batchImages:o},function(l,c){return{batchImages:function(){return L.runKernelFunc(function(d){return d.resizeNearestNeighborBackprop(l,c[0],n)},{})}}});return i?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),GF=F({nonMaxSuppression_:function(e,t,n,r,o){r===void 0&&(r=.5),o===void 0&&(o=Number.NEGATIVE_INFINITY);var i=N(e,"boxes","nonMaxSuppression"),a=N(t,"scores","nonMaxSuppression"),s=md(i,a,n,r,o);n=s.maxOutputSize,r=s.iouThreshold,o=s.scoreThreshold;var u={maxOutputSize:n,iouThreshold:r,scoreThreshold:o};return L.runKernelFunc(function(l){return l.nonMaxSuppression(i,a,n,r,o)},{boxes:i,scores:a},null,"NonMaxSuppressionV3",u)}}),qF=function(e,t,n,r,o){return r===void 0&&(r=.5),o===void 0&&(o=Number.NEGATIVE_INFINITY),oe(this,void 0,void 0,function(){var i,a,s,u,l,c,d;return ie(this,function(f){switch(f.label){case 0:return i=N(e,"boxes","nonMaxSuppressionAsync"),a=N(t,"scores","nonMaxSuppressionAsync"),s=md(i,a,n,r,o),n=s.maxOutputSize,r=s.iouThreshold,o=s.scoreThreshold,[4,Promise.all([i.data(),a.data()])];case 1:return u=f.sent(),l=u[0],c=u[1],d=Tv(l,c,n,r,o),i!==e&&i.dispose(),a!==t&&a.dispose(),[2,d]}})})},KF=F({nonMaxSuppressionWithScore_:function(e,t,n,r,o,i){r===void 0&&(r=.5),o===void 0&&(o=Number.NEGATIVE_INFINITY),i===void 0&&(i=0);var a=N(e,"boxes","nonMaxSuppression"),s=N(t,"scores","nonMaxSuppression"),u=md(a,s,n,r,o,i),l={maxOutputSize:n=u.maxOutputSize,iouThreshold:r=u.iouThreshold,scoreThreshold:o=u.scoreThreshold,softNmsSigma:i=u.softNmsSigma},c=L.runKernel("NonMaxSuppressionV5",{boxes:a,scores:s},l);return{selectedIndices:c[0],selectedScores:c[1]}}}),XF=function(e,t,n,r,o,i){return r===void 0&&(r=.5),o===void 0&&(o=Number.NEGATIVE_INFINITY),i===void 0&&(i=0),oe(this,void 0,void 0,function(){var a,s,u,l,c,d,f;return ie(this,function(h){switch(h.label){case 0:return a=N(e,"boxes","nonMaxSuppressionAsync"),s=N(t,"scores","nonMaxSuppressionAsync"),u=md(a,s,n,r,o,i),n=u.maxOutputSize,r=u.iouThreshold,o=u.scoreThreshold,i=u.softNmsSigma,[4,Promise.all([a.data(),s.data()])];case 1:return l=h.sent(),c=l[0],d=l[1],f=Av(c,d,n,r,o,i),a!==e&&a.dispose(),s!==t&&s.dispose(),[2,f]}})})},YF=F({cropAndResize_:function(e,t,n,r,o,i){var a=N(e,"image","cropAndResize"),s=N(t,"boxes","cropAndResize","float32"),u=N(n,"boxInd","cropAndResize","int32");o=o||"bilinear",i=i||0;var l=s.shape[0];return I(a.rank===4,function(){return"Error in cropAndResize: image must be rank 4,but got rank "+a.rank+"."}),I(s.rank===2&&s.shape[1]===4,function(){return"Error in cropAndResize: boxes must be have size ["+l+",4] but had shape "+s.shape+"."}),I(u.rank===1&&u.shape[0]===l,function(){return"Error in cropAndResize: boxInd must be have size ["+l+"] but had shape "+s.shape+"."}),I(r.length===2,function(){return"Error in cropAndResize: cropSize must be of length 2, but got length "+r.length+"."}),I(r[0]>=1&&r[1]>=1,function(){return"cropSize must be atleast [1,1], but was "+r}),I(o==="bilinear"||o==="nearest",function(){return"method must be bilinear or nearest, but was "+o}),L.runKernelFunc(function(c,d){return c.cropAndResize(a,s,u,r,o,i)},{images:a,boxes:s,boxInd:u},null,"CropAndResize",{method:o,extrapolationValue:i,cropSize:r})}}),Hv=Object.freeze({resizeBilinear:VF,resizeNearestNeighbor:HF,nonMaxSuppression:GF,nonMaxSuppressionAsync:qF,nonMaxSuppressionWithScore:KF,nonMaxSuppressionWithScoreAsync:XF,cropAndResize:YF}),Gv=function(e,t){return!(e>0)||t==="linear"},qv=function(e,t,n){if(n==null||n==="linear")return e;if(n==="relu")return e.mul(t.step());throw new Error("Gradient for activation "+n+" has not been implemented yet.")},Kv=function(e,t){var n=t,r=ht(e.shape,t.shape);return r.length>0&&(n=n.sum(r)),n.reshape(e.shape)},Xv=function(e,t,n){if(t==="linear")return e;if(t==="relu")return Ke(e);if(t==="elu")return K2(e);if(t==="relu6")return Y2(e);if(t==="prelu")return X2(e,n);throw new Error("Unknown fused activation "+t+".")},QF=F({fusedMatMul_:function(e){var t,n=e.a,r=e.b,o=e.transposeA,i=o!==void 0&&o,a=e.transposeB,s=a!==void 0&&a,u=e.bias,l=e.activation,c=l===void 0?"linear":l,d=e.preluActivationWeights;if(Gv(L.state.gradientDepth,c)===!1){var f=pd(n,r,i,s);return u!=null&&(f=Ee(f,u)),Xv(f,c,d)}var h=N(n,"a","fused matMul"),v=N(r,"b","fused matMul");t=Qe(h,v),h=t[0],v=t[1];var m=i?h.shape[h.rank-2]:h.shape[h.rank-1],g=s?v.shape[v.rank-1]:v.shape[v.rank-2],p=i?h.shape[h.rank-1]:h.shape[h.rank-2],y=s?v.shape[v.rank-2]:v.shape[v.rank-1],x=h.shape.slice(0,-2),w=v.shape.slice(0,-2),b=ae(x),C=ae(w);I(h.rank>=2&&v.rank>=2&&h.rank===v.rank,function(){return"Error in fused matMul: inputs must have the same rank of at least 2, got ranks "+h.rank+" and "+v.rank+"."}),I(xt(x,w),function(){return"Error in fused matMul: outer dimensions ("+x+") and ("+w+") of Tensors with shapes "+h.shape+" and "+v.shape+" must match."}),I(m===g,function(){return"Error in fused matMul: inner shapes ("+m+") and ("+g+") of Tensors with shapes "+h.shape+" and "+v.shape+" and transposeA="+i+" and transposeB="+s+" must match."});var E,S,R=h.shape.slice(0,-2).concat([p,y]),k=i?h.as3D(b,m,p):h.as3D(b,p,m),P=s?v.as3D(C,y,g):v.as3D(C,g,y);u!=null&&_e(R,(E=Qe(E=N(u,"bias","fused matMul"),h)[0]).shape),d!=null&&(S=N(d,"prelu weights","fused matMul"));var T={a:k,b:P};u!=null&&(T.bias=E),d!=null&&(T.preluActivationWeights=S);var j=[k,P];return L.runKernelFunc(function(O,W){var U=O.fusedBatchMatMul({a:k,b:P,transposeA:i,transposeB:s,bias:E,activation:c,preluActivationWeights:S});return W([k,P,U]),U},T,function(O,W){var U=W[0],z=W[1],D=W[2],M=qv(O,D,c),B={};return u!=null&&(B={bias:function(){return Kv(E,M)}}),Object.assign(i||s?!i&&s?{a:function(){return M.matMul(z,!1,!1)},b:function(){return M.matMul(U,!0,!1)}}:i&&!s?{a:function(){return z.matMul(M,!1,!0)},b:function(){return U.matMul(M,!1,!1)}}:{a:function(){return z.matMul(M,!0,!0)},b:function(){return M.matMul(U,!0,!0)}}:{a:function(){return M.matMul(z,!1,!0)},b:function(){return U.matMul(M,!0,!1)}},B)},"_FusedMatMul",{transposeA:i,transposeB:s,activation:c},j,[!0]).reshape(R)}}),JF=F({fusedConv2d_:function(e){var t=e.x,n=e.filter,r=e.strides,o=e.pad,i=e.dataFormat,a=i===void 0?"NHWC":i,s=e.dilations,u=s===void 0?[1,1]:s,l=e.dimRoundingMode,c=e.bias,d=e.activation,f=d===void 0?"linear":d,h=e.preluActivationWeights;if(f=f||"linear",Gv(L.state.gradientDepth,f)===!1){var v=Bn(t,n,r,o,a,u,l);return c!=null&&(v=Ee(v,c)),Xv(v,f,h)}var m=N(t,"x","conv2d"),g=N(n,"filter","conv2d"),p=m,y=!1;m.rank===3&&(y=!0,p=m.as4D(1,m.shape[0],m.shape[1],m.shape[2])),I(p.rank===4,function(){return"Error in fused conv2d: input must be rank 4, but got rank "+p.rank+"."}),I(g.rank===4,function(){return"Error in fused conv2d: filter must be rank 4, but got rank "+g.rank+"."}),l!=null&&I(rt(o),function(){return"Error in fused conv2d: pad must be an integer when using, dimRoundingMode "+l+" but got pad "+o+"."}),I(p.shape[3]===g.shape[2],function(){return"Error in conv2d: depth of input ("+p.shape[3]+") must match input depth for filter "+g.shape[2]+"."}),I(ln(r,u),function(){return"Error in conv2D: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+u+"'"}),I(a==="NHWC",function(){return"Error in conv2d: got dataFormat of "+a+" but only NHWC is currently supported."});var x,w,b=Li(p.shape,g.shape,r,u,o,l);c!=null&&(x=Qe(x=N(c,"bias","fused conv2d"),m)[0],_e(b.outShape,x.shape)),h!=null&&(w=N(h,"prelu weights","fused conv2d"));var C={x:p,filter:g};c!=null&&(C.bias=x),h!=null&&(C.preluActivationWeights=w);var E=[g,p],S=L.runKernelFunc(function(R,k){var P=R.fusedConv2d({input:p,filter:g,convInfo:b,bias:x,activation:f,preluActivationWeights:w});return k([g,p,P]),P},C,function(R,k){var P=k,T=P[0],j=P[1],O=P[2],W=qv(R,O,f);I(qa(u),function(){return"Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+u+"'"});var U={};return c!=null&&(U={bias:function(){return Kv(x,W)}}),Object.assign({x:function(){return W2(j.shape,W,T,r,o)},filter:function(){return jv(j,W,T.shape,r,o)}},U)},"FusedConv2D",{convInfo:b,activation:f},E,[!0]);return y?S.as3D(S.shape[1],S.shape[2],S.shape[3]):S}}),ZF=F({fusedDepthwiseConv2d_:function(e){var t=e.x,n=e.filter,r=e.strides,o=e.pad,i=e.dataFormat,a=i===void 0?"NHWC":i,s=e.dilations,u=s===void 0?[1,1]:s,l=e.dimRoundingMode,c=e.bias,d=e.activation,f=d===void 0?"linear":d,h=e.preluActivationWeights;if(Gv(L.state.gradientDepth,f)===!1){var v=hd(t,n,r,o,a,u,l);return c!=null&&(v=Ee(v,c)),Xv(v,f,h)}var m=N(t,"x","depthwiseConv2d"),g=N(n,"filter","depthwiseConv2d"),p=m,y=!1;m.rank===3&&(y=!0,p=m.as4D(1,m.shape[0],m.shape[1],m.shape[2])),I(p.rank===4,function(){return"Error in fused depthwiseConv2d: input must be rank 4, but got rank "+p.rank+"."}),I(g.rank===4,function(){return"Error in fused depthwiseConv2d: filter must be rank 4, but got rank "+g.rank+"."}),I(p.shape[3]===g.shape[2],function(){return"Error in fused depthwiseConv2d: number of input channels ("+p.shape[3]+") must match the inChannels dimension in filter "+g.shape[2]+"."}),u==null&&(u=[1,1]),I(ln(r,u),function(){return"Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+u+"'"}),l!=null&&I(rt(o),function(){return"Error in fused depthwiseConv2d: pad must be an integer when using dimRoundingMode "+l+" but got pad "+o+"."});var x,w,b=Li(p.shape,g.shape,r,u,o,l,!0);c!=null&&(x=Qe(x=N(c,"bias","fused conv2d"),m)[0],_e(b.outShape,x.shape)),h!=null&&(w=N(h,"prelu weights","fused depthwiseConv2d"));var C={x:p,filter:g};c!=null&&(C.bias=x),h!=null&&(C.preluActivationWeights=w);var E=[g,p],S=L.runKernelFunc(function(R,k){var P=R.fusedDepthwiseConv2D({input:p,filter:g,convInfo:b,bias:x,activation:f,preluActivationWeights:w});return k([g,p,P]),P},C,function(R,k){I(qa(u),function(){return"Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '"+u+"'"});var P=k[0],T=k[1],j=k[2],O=qv(R,j,f),W={};return c!=null&&(W={bias:function(){return Kv(x,O)}}),Object.assign({x:function(){return z2(T.shape,O,P,b)},filter:function(){return U2(T,O,P.shape,b)}},W)},"FusedDepthwiseConv2D",{convInfo:b,activation:f},E,[!0]);return y?S.as3D(S.shape[1],S.shape[2],S.shape[3]):S}}),eM=Object.freeze({matMul:QF,conv2d:JF,depthwiseConv2d:ZF}),tM=Object.freeze({image:Hv,linalg:$F,losses:jF,spectral:_F,fused:eM,signal:IF,square:M3,squaredDifference:_2,conv1d:V4,conv2d:Bn,conv3d:H4,depthwiseConv2d:hd,separableConv2d:Wv,conv2dTranspose:G4,conv3dTranspose:q4,op:F,batchNormalization2d:d4,batchNormalization3d:f4,batchNormalization4d:h4,batchNormalization:p4,batchNorm:T2,batchNorm2d:v4,batchNorm3d:m4,batchNorm4d:g4,booleanMaskAsync:$4,complex:Et,real:An,imag:wr,concat:dt,concat1d:eP,concat2d:tP,concat3d:nP,concat4d:rP,split:kv,matMul:pd,dot:K4,outerProduct:X4,reverse:Eu,reverse1d:Y4,reverse2d:Q4,reverse3d:J4,reverse4d:Z4,maxPool:mt,avgPool:_u,pool:eF,maxPool3d:tF,avgPool3d:nF,slice:Tr,slice1d:rF,slice2d:oF,slice3d:H2,slice4d:iF,abs:O3,acos:L3,acosh:B3,asin:j3,asinh:W3,atan:z3,atanh:U3,ceil:$3,clipByValue:Ov,cos:V3,cosh:H3,erf:G3,exp:tp,expm1:q3,floor:K3,log:X3,log1p:Y3,logSigmoid:Q3,neg:Sc,reciprocal:J3,round:Z3,rsqrt:S2,sigmoid:k2,sign:e4,isNaN:t4,isInf:n4,isFinite:r4,sin:o4,sinh:i4,softplus:a4,sqrt:s4,step:u4,tan:l4,tanh:c4,all:aF,any:sF,argMax:uF,argMin:lF,logSumExp:cF,max:vd,mean:dF,min:fF,moments:hF,sum:q2,prod:pF,equal:M2,equalStrict:D4,greater:F4,greaterEqual:O2,greaterEqualStrict:M4,greaterStrict:O4,less:L4,lessEqual:B4,lessEqualStrict:j4,lessStrict:W4,notEqual:z4,notEqualStrict:U4,add:Ee,addN:w4,addStrict:b4,atan2:C4,div:Jn,divNoNan:E4,divStrict:_4,floorDiv:D2,maximum:Lv,maximumStrict:S4,minimum:F2,minimumStrict:k4,mod:R4,modStrict:N4,mul:jt,mulStrict:I4,pow:kc,powStrict:T4,squaredDifferenceStrict:A4,sub:pt,subStrict:P4,elu:K2,leakyRelu:vF,prelu:X2,relu:Ke,relu6:Y2,selu:mF,logicalAnd:fd,logicalNot:y4,logicalOr:A2,logicalXor:x4,where:Ai,whereAsync:P2,buffer:ve,print:fP,batchToSpaceND:qb,broadcastTo:hP,cast:pP,clone:vP,cumsum:mP,depthToSpace:gP,expandDims:Tn,eye:Kb,multinomial:yP,oneHot:Qh,pad:Oi,pad1d:xP,pad2d:wP,pad3d:bP,pad4d:CP,rand:EP,randomNormal:_P,randomGamma:SP,randomUniform:Xb,reshape:Zn,spaceToBatchND:Yb,squeeze:Qb,stack:Cn,tile:wa,truncatedNormal:kP,unstack:ft,setdiff1dAsync:RP,fill:Nr,linspace:ZA,ones:ts,range:gc,scalar:ee,tensor:St,tensor1d:at,tensor2d:Wo,tensor3d:Sv,tensor4d:Zt,tensor5d:YA,tensor6d:QA,variable:JA,zeros:Ue,onesLike:Gb,zerosLike:Re,transpose:Xo,softmax:no,logSoftmax:FP,localResponseNormalization:gF,norm:Q2,gather:Bv,unsortedSegmentSum:L2,basicLSTMCell:yF,multiRNNCell:xF,movingAverage:wF,stridedSlice:bF,topk:CF,scatterND:EF,fft:zv,ifft:Rc,rfft:Uv,irfft:J2,sparseToDense:SF,gatherND:kF,diag:RF,dropout:NF,hannWindow:$v,hammingWindow:eC,frame:Vv,stft:tC,inTopKAsync:TF});function X(e,t){Array.isArray(e)||(e=[e]),e.forEach(function(n){n!=null&&I(n.dtype!=="complex64",function(){return t+" does not support complex64 tensors."})})}function Ef(e,t,n,r){if(n==="linear")return e.linear(t);if(n==="relu")return e.relu(t);if(n==="elu")return e.elu(t);if(n==="relu6")return e.relu6(t);if(n==="prelu")return e.prelu(t,r);throw new Error("Activation "+n+" has not been implemented for the CPU backend.")}var nM=function(e){function t(){var n=e.call(this)||this;return n.blockSize=48,n.firstUse=!0,n.data=new o2(n,L),n}return sr(t,e),t.prototype.write=function(n,r,o){this.firstUse&&(this.firstUse=!1,H().get("IS_NODE")&&vc(`
============================
Hi there . Looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, which binds to TensorFlow C++, by running npm i @tensorflow/tfjs-node, or npm i @tensorflow/tfjs-node-gpu if you have CUDA. Then call require('@tensorflow/tfjs-node'); (-gpu suffix for CUDA) at the start of your program. Visit https://github.com/tensorflow/tfjs-node for more details.
============================`));var i={};return this.data.set(i,{values:n,dtype:o}),i},t.prototype.move=function(n,r,o,i){this.data.set(n,{values:r,dtype:i})},t.prototype.numDataIds=function(){return this.data.numDataIds()},t.prototype.read=function(n){return oe(this,void 0,void 0,function(){return ie(this,function(r){return[2,this.readSync(n)]})})},t.prototype.readSync=function(n){var r=this.data.get(n),o=r.dtype,i=r.complexTensors;return o==="complex64"?ep(this.readSync(i.real.dataId),this.readSync(i.imag.dataId)):this.data.get(n).values},t.prototype.bufferSync=function(n){var r=this.readSync(n.dataId),o=r;if(n.dtype==="string")try{o=r.map(function(i){return fc(i)})}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return ve(n.shape,n.dtype,o)},t.prototype.makeOutput=function(n,r,o){var i=this.write(n,r,o);return L.makeTensorFromDataId(i,r,o,this)},t.prototype.disposeData=function(n){if(this.data.has(n)){var r=this.data.get(n).complexTensors;r!=null&&(r.real.dispose(),r.imag.dispose()),this.data.delete(n)}},t.prototype.time=function(n){return oe(this,void 0,void 0,function(){var r;return ie(this,function(o){return r=gr(),n(),[2,{kernelMs:gr()-r}]})})},t.prototype.memory=function(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}},t.prototype.complex=function(n,r){var o=this.makeOutput(null,n.shape,"complex64");return this.data.get(o.dataId).complexTensors={real:L.keep(n.clone()),imag:L.keep(r.clone())},o},t.prototype.real=function(n){return this.data.get(n.dataId).complexTensors.real.clone()},t.prototype.imag=function(n){return this.data.get(n.dataId).complexTensors.imag.clone()},t.prototype.slice=function(n,r,o){if(X(n,"slice"),n2(n.shape,r,o)){var i=r2(r,n.strides),a=ae(o);return St(this.readSync(n.dataId).subarray(i,i+a),o,n.dtype)}for(var s=ve(o,n.dtype),u=this.bufferSync(n),l=0;l<s.size;++l){var c=s.indexToLoc(l).map(function(d,f){return d+r[f]});s.values[l]=u.get.apply(u,c)}return s.toTensor()},t.prototype.stridedSlice=function(n,r,o,i){X(n,"stridedSlice");var a=Nv(r,o,i);if(a.some(function(h){return h===0}))return St([],a);for(var s=ve(a,n.dtype),u=this.bufferSync(n),l=0;l<s.size;l++){for(var c=s.indexToLoc(l),d=new Array(c.length),f=0;f<d.length;f++)d[f]=c[f]*i[f]+r[f];s.set.apply(s,[u.get.apply(u,d)].concat(c))}return s.toTensor()},t.prototype.diag=function(n){for(var r=this.readSync(n.dataId),o=ve([n.size,n.size],n.dtype),i=o.values,a=0;a<r.length;a++)i[a*n.size+a]=r[a];return o.toTensor()},t.prototype.unstack=function(n,r){for(var o=n.shape[r],i=new Array(n.rank-1),a=0,s=0;s<n.rank;s++)s!==r&&(i[a++]=n.shape[s]);var u=new Array(n.rank).fill(0),l=n.shape.slice();l[r]=1;var c=new Array(o);for(s=0;s<c.length;s++)u[r]=s,c[s]=this.slice(n,u,l).reshape(i);return c},t.prototype.reverse=function(n,r){X(n,"reverse");for(var o=ve(n.shape,n.dtype),i=this.bufferSync(n),a=function(u){var l=o.indexToLoc(u),c=l.slice();r.forEach(function(d){return c[d]=n.shape[d]-1-c[d]}),o.set.apply(o,[i.get.apply(i,c)].concat(l))},s=0;s<o.size;s++)a(s);return o.toTensor()},t.prototype.concat=function(n,r){var o=this;if(n[0].dtype==="complex64"){var i=n.map(function(h){return An(h)}),a=n.map(function(h){return wr(h)});return Et(this.concat(i,r),this.concat(a,r))}var s=n.map(function(h){var v=ae(h.shape.slice(r));return h.as2D(-1,v)}),u=Ga(s.map(function(h){return h.shape}),1),l=ve(u,n[0].dtype).values;if(s[0].shape[0]===1){var c=0;s.forEach(function(h){l.set(o.readSync(h.dataId),c),c+=h.size})}else{var d=0;s.forEach(function(h){for(var v=o.readSync(h.dataId),m=0,g=0;g<h.shape[0];++g)for(var p=g*u[1]+d,y=0;y<h.shape[1];++y)l[p+y]=v[m++];d+=h.shape[1]})}var f=Ga(n.map(function(h){return h.shape}),r);return St(l,f,n[0].dtype)},t.prototype.neg=function(n){return X(n,"neg"),this.multiply(ee(-1),n)},t.prototype.add=function(n,r){return n.dtype==="complex64"||r.dtype==="complex64"?this.broadcastedBinaryComplexOp(n.cast("complex64"),r.cast("complex64"),function(o,i,a,s){return{real:o+a,imag:i+s}}):this.broadcastedBinaryOp(n,r,_t(n.dtype,r.dtype),function(o,i){return o+i})},t.prototype.addN=function(n){var r=this;X(n,"addN");for(var o=n.map(function(c){return r.readSync(c.dataId)}),i=ve(n[0].shape,n[0].dtype),a=i.values,s=0;s<n.length;s++)for(var u=o[s],l=0;l<a.length;l++)a[l]+=u[l];return i.toTensor()},t.prototype.softmax=function(n,r){var o=vt([r],n.shape),i=this.max(n,o),a=un(i.shape,o),s=this.subtract(n,i.reshape(a)),u=this.exp(s),l=this.sum(u,o).reshape(a);return this.realDivide(u,l)},t.prototype.subtract=function(n,r){return n.dtype==="complex64"||r.dtype==="complex64"?this.broadcastedBinaryComplexOp(n.cast("complex64"),r.cast("complex64"),function(o,i,a,s){return{real:o-a,imag:i-s}}):this.broadcastedBinaryOp(n,r,_t(n.dtype,r.dtype),function(o,i){return o-i})},t.prototype.pow=function(n,r){return X([n,r],"pow"),this.broadcastedBinaryOp(n,r,n.dtype,function(o,i){return Math.pow(o,i)})},t.prototype.batchMatMul=function(n,r,o,i){X([n,r],"matMul");for(var a=o?n.shape[1]:n.shape[2],s=o?n.shape[2]:n.shape[1],u=i?r.shape[1]:r.shape[2],l=n.shape[0],c=this.readSync(n.dataId),d=this.readSync(r.dataId),f=o?[n.strides[0],1,n.strides[1]]:[n.strides[0],n.strides[1],1],h=f[0],v=f[1],m=f[2],g=i?[1,r.strides[1],r.strides[0]]:[r.strides[1],1,r.strides[0]],p=g[0],y=g[1],x=g[2],w=s*u,b=ve([l,s,u],n.dtype),C=b.values,E=this.blockSize,S=0;S<l;S++)for(var R=0;R<s;R+=E)for(var k=0;k<u;k+=E)for(var P=0;P<a;P+=E)for(var T=Math.min(R+E,s),j=Math.min(k+E,u),O=Math.min(P+E,a),W=R;W<T;W++)for(var U=k;U<j;U++){for(var z=0,D=P;D<O;D++)z+=c[S*h+W*v+D*m]*d[D*p+U*y+S*x];C[S*w+(W*u+U)]+=z}return b.toTensor()},t.prototype.fusedBatchMatMul=function(n){var r=n.a,o=n.b,i=n.transposeA,a=n.transposeB,s=n.bias,u=n.activation,l=n.preluActivationWeights,c=this.batchMatMul(r,o,i,a);return s&&(c=this.add(c,s)),u&&(c=Ef(this,c,u,l)),c},t.prototype.multiply=function(n,r){return n.dtype==="complex64"||r.dtype==="complex64"?this.broadcastedBinaryComplexOp(n.cast("complex64"),r.cast("complex64"),function(o,i,a,s){return{real:o*a-i*s,imag:o*s+i*a}}):this.broadcastedBinaryOp(n,r,_t(n.dtype,r.dtype),function(o,i){return o*i})},t.prototype.realDivide=function(n,r){return X([n,r],"realDivide"),this.broadcastedBinaryOp(n,r,"float32",function(o,i){return o/i})},t.prototype.floorDiv=function(n,r){return X([n,r],"floorDiv"),this.broadcastedBinaryOp(n,r,"int32",function(o,i){return Math.floor(o/i)})},t.prototype.sum=function(n,r){X(n,"sum"),hn("sum",r,n.rank);for(var o=Ft(n.shape,r),i=o[0],a=o[1],s=Ue(i,_t(n.dtype,"int32")),u=ae(a),l=this.readSync(s.dataId),c=this.readSync(n.dataId),d=0;d<l.length;++d){for(var f=d*u,h=0,v=0;v<u;++v)h+=c[f+v];l[d]=h}return s},t.prototype.prod=function(n,r){X(n,"sum");for(var o=Ft(n.shape,r),i=o[0],a=o[1],s=Ue(i,_t(n.dtype,"int32")),u=ae(a),l=this.readSync(s.dataId),c=this.readSync(n.dataId),d=0;d<l.length;++d){for(var f=d*u,h=1,v=0;v<u;++v)h*=c[f+v];l[d]=h}return s},t.prototype.unsortedSegmentSum=function(n,r,o){X(n,"unsortedSegmentSum");for(var i=[],a=n.rank-r.rank,s=0;s<a;++s)r=r.expandDims(s+1);for(s=0;s<o;++s){var u=ee(s,"int32"),l=M2(u,r).asType("float32").mul(n).sum(0);i.push(l)}return Cn(i)},t.prototype.argMin=function(n,r){X(n,"argMin");var o=[r];hn("argMin",o,n.rank);for(var i=Ft(n.shape,o),a=i[0],s=i[1],u=Ue(a,"int32"),l=ae(s),c=this.readSync(u.dataId),d=this.readSync(n.dataId),f=0;f<c.length;++f){for(var h=f*l,v=d[h],m=0,g=0;g<l;++g){var p=d[h+g];p<v&&(v=p,m=g)}c[f]=m}return u},t.prototype.argMax=function(n,r){X(n,"argMax");var o=[r];hn("argMax",o,n.rank);for(var i=Ft(n.shape,o),a=i[0],s=i[1],u=Ue(a,"int32"),l=ae(s),c=this.readSync(u.dataId),d=this.readSync(n.dataId),f=0;f<c.length;++f){for(var h=f*l,v=d[h],m=0,g=0;g<l;++g){var p=d[h+g];p>v&&(v=p,m=g)}c[f]=m}return u},t.prototype.cumsum=function(n,r,o,i){if(X(n,"cumsum"),r!==n.rank-1)throw new Error("backend.cumsum in CPU expects an inner-most axis="+(n.rank-1)+" but got axis="+r);for(var a=_t(n.dtype,"int32"),s=Ue(n.shape,a),u=this.readSync(s.dataId),l=this.readSync(n.dataId),c=n.shape[n.rank-1],d=i?function(g,p){return g+c-p-1}:function(g,p){return g+p},f=0;f<l.length;f+=c)for(var h=0;h<c;h++){var v=d(f,h);if(h===0)u[v]=o?0:l[v];else{var m=d(f,h-1);u[v]=o?l[m]+u[m]:l[v]+u[m]}}return s},t.prototype.equal=function(n,r){return X([n,r],"equal"),this.broadcastedBinaryOp(n,r,"bool",function(o,i){return o===i?1:0})},t.prototype.notEqual=function(n,r){return X([n,r],"notEqual"),this.broadcastedBinaryOp(n,r,"bool",function(o,i){return o!==i?1:0})},t.prototype.less=function(n,r){return X([n,r],"less"),this.broadcastedBinaryOp(n,r,"bool",function(o,i){return o<i?1:0})},t.prototype.lessEqual=function(n,r){return X([n,r],"lessEqual"),this.broadcastedBinaryOp(n,r,"bool",function(o,i){return o<=i?1:0})},t.prototype.greater=function(n,r){return X([n,r],"greater"),this.broadcastedBinaryOp(n,r,"bool",function(o,i){return o>i?1:0})},t.prototype.greaterEqual=function(n,r){return X([n,r],"greaterEqual"),this.broadcastedBinaryOp(n,r,"bool",function(o,i){return o>=i?1:0})},t.prototype.logicalNot=function(n){X(n,"logicalNot");for(var r=this.readSync(n.dataId),o=new Uint8Array(r.length),i=0;i<r.length;++i)o[i]=r[i]?0:1;return this.makeOutput(o,n.shape,"bool")},t.prototype.logicalAnd=function(n,r){return X([n,r],"logicalAnd"),this.broadcastedBinaryOp(n,r,"bool",function(o,i){return o&&i})},t.prototype.logicalOr=function(n,r){return X([n,r],"logicalOr"),this.broadcastedBinaryOp(n,r,"bool",function(o,i){return o||i})},t.prototype.select=function(n,r,o){X([n,r,o],"select");for(var i=this.readSync(n.dataId),a=this.readSync(r.dataId),s=this.readSync(o.dataId),u=Ue(r.shape,_t(r.dtype,o.dtype)),l=this.readSync(u.dataId),c=0,d=n.rank===0||n.rank>1||r.rank===1?1:ae(r.shape.slice(1)),f=0;f<i.length;f++)for(var h=0;h<d;h++)i[f]===1?l[c++]=a[f]:l[c++]=s[f];return u},t.prototype.where=function(n){X([n],"where");var r=this.readSync(n.dataId);return Pv(n.shape,r)},t.prototype.topk=function(n,r,o){return X(n,"topk"),f2(this.readSync(n.dataId),n.shape,n.dtype,r)},t.prototype.min=function(n,r){X(n,"min"),hn("min",r,n.rank);for(var o=Ft(n.shape,r),i=o[0],a=o[1],s=Ue(i,n.dtype),u=ae(a),l=this.readSync(s.dataId),c=this.readSync(n.dataId),d=0;d<l.length;++d){for(var f=d*u,h=c[f],v=0;v<u;++v){var m=c[f+v];m<h&&(h=m)}l[d]=h}return s},t.prototype.minimum=function(n,r){return X([n,r],"minimum"),this.broadcastedBinaryOp(n,r,n.dtype,function(o,i){return Math.min(o,i)})},t.prototype.mod=function(n,r){return X([n,r],"mod"),this.broadcastedBinaryOp(n,r,n.dtype,function(o,i){var a=o%i;return o<0&&i<0||o>=0&&i>=0?a:(a+i)%i})},t.prototype.max=function(n,r){X(n,"max"),hn("max",r,n.rank);for(var o=Ft(n.shape,r),i=o[0],a=o[1],s=Ue(i,n.dtype),u=ae(a),l=this.readSync(s.dataId),c=this.readSync(n.dataId),d=0;d<l.length;++d){for(var f=d*u,h=c[f],v=0;v<u;++v){var m=c[f+v];m>h&&(h=m)}l[d]=h}return s},t.prototype.maximum=function(n,r){return X([n,r],"maximum"),this.broadcastedBinaryOp(n,r,n.dtype,function(o,i){return Math.max(o,i)})},t.prototype.all=function(n,r){X(n,"all"),hn("all",r,n.rank);for(var o=Ft(n.shape,r),i=o[0],a=o[1],s=Ue(i,n.dtype),u=ae(a),l=this.readSync(s.dataId),c=this.readSync(n.dataId),d=0;d<l.length;++d){for(var f=d*u,h=c[f],v=0;v<u;++v){var m=c[f+v];h=h&&m}l[d]=h}return s},t.prototype.any=function(n,r){X(n,"any"),hn("any",r,n.rank);for(var o=Ft(n.shape,r),i=o[0],a=o[1],s=Ue(i,n.dtype),u=ae(a),l=this.readSync(s.dataId),c=this.readSync(n.dataId),d=0;d<l.length;++d){for(var f=d*u,h=c[f],v=0;v<u;++v){var m=c[f+v];h=h||m}l[d]=h}return s},t.prototype.squaredDifference=function(n,r){return X([n,r],"squaredDifference"),this.broadcastedBinaryOp(n,r,n.dtype,function(o,i){var a=o-i;return a*a})},t.prototype.ceil=function(n){X(n,"ceil");for(var r=this.readSync(n.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i)o[i]=Math.ceil(r[i]);return this.makeOutput(o,n.shape,"float32")},t.prototype.floor=function(n){X(n,"floor");for(var r=this.readSync(n.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i)o[i]=Math.floor(r[i]);return this.makeOutput(o,n.shape,"float32")},t.prototype.sign=function(n){X(n,"x");for(var r=this.readSync(n.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i)r[i]<0?o[i]=-1:r[i]>0?o[i]=1:o[i]=0;return this.makeOutput(o,n.shape,"float32")},t.prototype.isNaN=function(n){X(n,"x");for(var r=this.readSync(n.dataId),o=new Uint8Array(r.length),i=0;i<r.length;++i)Number.isNaN(r[i])&&(o[i]=1);return this.makeOutput(o,n.shape,"bool")},t.prototype.isInf=function(n){X(n,"x");for(var r=this.readSync(n.dataId),o=new Uint8Array(r.length),i=0;i<r.length;++i)Math.abs(r[i])===1/0&&(o[i]=1);return this.makeOutput(o,n.shape,"bool")},t.prototype.isFinite=function(n){X(n,"x");for(var r=this.readSync(n.dataId),o=new Uint8Array(r.length),i=0;i<r.length;++i)Number.isFinite(r[i])&&(o[i]=1);return this.makeOutput(o,n.shape,"bool")},t.prototype.round=function(n){X(n,"round");for(var r=this.readSync(n.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i){var a=Math.floor(r[i]);r[i]-a<.5?o[i]=Math.floor(r[i]):r[i]-a>.5?o[i]=Math.ceil(r[i]):o[i]=a%2==0?a:a+1}return this.makeOutput(o,n.shape,"float32")},t.prototype.exp=function(n){X(n,"exp");for(var r=this.readSync(n.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i)o[i]=Math.exp(r[i]);return this.makeOutput(o,n.shape,"float32")},t.prototype.expm1=function(n){X(n,"expm1");for(var r=this.readSync(n.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i)o[i]=Math.expm1(r[i]);return this.makeOutput(o,n.shape,"float32")},t.prototype.log=function(n){X(n,"log");for(var r=this.readSync(n.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i){var a=r[i];o[i]=Math.log(a)}return this.makeOutput(o,n.shape,"float32")},t.prototype.log1p=function(n){X(n,"log1p");for(var r=this.readSync(n.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i){var a=r[i];o[i]=Math.log1p(a)}return this.makeOutput(o,n.shape,"float32")},t.prototype.sqrt=function(n){X(n,"sqrt");for(var r=this.readSync(n.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i){var a=r[i];o[i]=Math.sqrt(a)}return this.makeOutput(o,n.shape,"float32")},t.prototype.rsqrt=function(n){X(n,"rsqrt");for(var r=this.readSync(n.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i){var a=r[i];o[i]=1/Math.sqrt(a)}return this.makeOutput(o,n.shape,"float32")},t.prototype.reciprocal=function(n){X(n,"reciprocal");for(var r=this.readSync(n.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i)o[i]=1/r[i];return this.makeOutput(o,n.shape,"float32")},t.prototype.linear=function(n){return n},t.prototype.relu=function(n){X(n,"relu");for(var r=Ue(n.shape,n.dtype),o=this.readSync(r.dataId),i=this.readSync(n.dataId),a=0;a<i.length;++a)o[a]=Math.max(0,i[a]);return r},t.prototype.relu6=function(n){X(n,"relu");for(var r=Ue(n.shape,n.dtype),o=this.readSync(r.dataId),i=this.readSync(n.dataId),a=0;a<i.length;++a)o[a]=Math.min(Math.max(0,i[a]),6);return r},t.prototype.prelu=function(n,r){return X([n,r],"prelu"),this.broadcastedBinaryOp(n,r,n.dtype,function(o,i){return o<0?i*o:o})},t.prototype.elu=function(n){X(n,"elu");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i){var a=o[i];r[i]=a>=0?a:Math.exp(a)-1}return this.makeOutput(r,n.shape,"float32")},t.prototype.eluDer=function(n,r){X([n,r],"eluDer");for(var o=new Float32Array(r.size),i=this.readSync(r.dataId),a=this.readSync(n.dataId),s=0;s<i.length;++s){var u=i[s];o[s]=u>=1?a[s]:a[s]*(u+1)}return this.makeOutput(o,r.shape,"float32")},t.prototype.selu=function(n){X(n,"selu");for(var r=Fv,o=Mv,i=new Float32Array(n.size),a=this.readSync(n.dataId),s=0;s<a.length;++s){var u=a[s];i[s]=u>=0?o*u:r*(Math.exp(u)-1)}return this.makeOutput(i,n.shape,"float32")},t.prototype.clip=function(n,r,o){X(n,"clip");for(var i=new Float32Array(n.size),a=this.readSync(n.dataId),s=0;s<a.length;++s){var u=a[s];i[s]=u>o?o:u<r?r:u}return this.makeOutput(i,n.shape,"float32")},t.prototype.abs=function(n){for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=Math.abs(o[i]);return this.makeOutput(r,n.shape,"float32")},t.prototype.complexAbs=function(n){for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<n.size;++i){var a=o[2*i],s=o[2*i+1];r[i]=Math.hypot(a,s)}return this.makeOutput(r,n.shape,"float32")},t.prototype.int=function(n){X(n,"int");for(var r=new Int32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=o[i];return this.makeOutput(r,n.shape,"int32")},t.prototype.sigmoid=function(n){X(n,"sigmoid");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=1/(1+Math.exp(-o[i]));return this.makeOutput(r,n.shape,"float32")},t.prototype.softplus=function(n){X(n,"softplus");for(var r=Math.log(11920928955078125e-23)+2,o=new Float32Array(n.size),i=this.readSync(n.dataId),a=0;a<i.length;++a){var s=i[a]>-r,u=i[a]<r,l=Math.exp(i[a]),c=void 0;c=u?l:s?i[a]:Math.log(1+l),o[a]=c}return this.makeOutput(o,n.shape,"float32")},t.prototype.sin=function(n){X(n,"sin");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=Math.sin(o[i]);return this.makeOutput(r,n.shape,"float32")},t.prototype.cos=function(n){X(n,"cos");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=Math.cos(o[i]);return this.makeOutput(r,n.shape,"float32")},t.prototype.tan=function(n){X(n,"tan");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=Math.tan(o[i]);return this.makeOutput(r,n.shape,"float32")},t.prototype.asin=function(n){X(n,"asin");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=Math.asin(o[i]);return this.makeOutput(r,n.shape,"float32")},t.prototype.acos=function(n){X(n,"acos");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=Math.acos(o[i]);return this.makeOutput(r,n.shape,"float32")},t.prototype.atan=function(n){X(n,"atan");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=Math.atan(o[i]);return this.makeOutput(r,n.shape,"float32")},t.prototype.atan2=function(n,r){return X([n,r],"atan2"),this.broadcastedBinaryOp(n,r,n.dtype,function(o,i){return Math.atan2(o,i)})},t.prototype.sinh=function(n){X(n,"sinh");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=Math.sinh(o[i]);return this.makeOutput(r,n.shape,"float32")},t.prototype.cosh=function(n){X(n,"cosh");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=Math.cosh(o[i]);return this.makeOutput(r,n.shape,"float32")},t.prototype.tanh=function(n){X(n,"tanh");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=rA(o[i]);return this.makeOutput(r,n.shape,"float32")},t.prototype.asinh=function(n){X(n,"asinh");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=Math.asinh(o[i]);return this.makeOutput(r,n.shape,"float32")},t.prototype.acosh=function(n){X(n,"acosh");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=Math.acosh(o[i]);return this.makeOutput(r,n.shape,"float32")},t.prototype.atanh=function(n){X(n,"atanh");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=Math.atanh(o[i]);return this.makeOutput(r,n.shape,"float32")},t.prototype.erf=function(n){X(n,"erf");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i){var a=Math.sign(o[i]),s=Math.abs(o[i]),u=1/(1+.3275911*s);r[i]=a*(1-((((1.061405429*u-1.453152027)*u+1.421413741)*u-.284496736)*u+.254829592)*u*Math.exp(-s*s))}return this.makeOutput(r,n.shape,"float32")},t.prototype.step=function(n,r){r===void 0&&(r=0),X(n,"step");for(var o=new Float32Array(n.size),i=this.readSync(n.dataId),a=0;a<i.length;++a){var s=i[a];isNaN(s)?o[a]=NaN:o[a]=s>0?1:r}return this.makeOutput(o,n.shape,"float32")},t.prototype.fusedConv2d=function(n){var r=n.input,o=n.filter,i=n.convInfo,a=n.bias,s=n.activation,u=n.preluActivationWeights,l=this.conv2d(r,o,i);return a&&(l=this.add(l,a)),s&&(l=Ef(this,l,s,u)),l},t.prototype.conv2d=function(n,r,o){X([n,r],"conv2d");for(var i=o.filterHeight,a=o.filterWidth,s=o.dilationHeight,u=o.dilationWidth,l=o.padInfo.left,c=o.padInfo.top,d=o.dataFormat==="channelsLast",f=ve(o.outShape,n.dtype),h=n.strides[0],v=d?n.strides[1]:n.strides[2],m=d?n.strides[2]:1,g=d?1:n.strides[1],p=f.strides[0],y=d?f.strides[1]:f.strides[2],x=d?f.strides[2]:1,w=d?1:f.strides[1],b=this.readSync(n.dataId),C=this.readSync(r.dataId),E=f.values,S=0;S<o.batchSize;++S)for(var R=S*h,k=S*p,P=0;P<o.outHeight;++P)for(var T=k+P*y,j=P*o.strideHeight-c,O=0;O<i;O++){var W=j+O*s;if(!(W<0||W>=o.inHeight))for(var U=O*r.strides[0],z=R+W*v,D=0;D<o.outWidth;++D)for(var M=T+D*x,B=D*o.strideWidth-l,q=0;q<a;q++){var K=B+q*u;if(!(K<0||K>=o.inWidth))for(var Q=z+K*m,Z=U+q*r.strides[1],se=0;se<o.inChannels;++se){for(var de=b[Q+se*g],re=0;re<o.outChannels;++re)E[M+re*w]+=de*C[Z+re];Z+=o.outChannels}}}return f.toTensor()},t.prototype.conv3d=function(n,r,o){for(var i=o.filterDepth,a=o.filterHeight,s=o.filterWidth,u=o.dilationDepth,l=o.dilationHeight,c=o.dilationWidth,d=o.padInfo.front,f=o.padInfo.left,h=o.padInfo.top,v=ve(o.outShape,n.dtype),m=this.readSync(n.dataId),g=this.readSync(r.dataId),p=v.values,y=0;y<o.batchSize;++y)for(var x=y*n.strides[0],w=y*v.strides[0],b=0;b<o.outDepth;++b)for(var C=w+b*v.strides[1],E=b*o.strideDepth-d,S=0;S<i;S++){var R=E+S*u;if(!(R<0||R>=o.inDepth))for(var k=S*r.strides[0],P=x+R*n.strides[1],T=0;T<o.outHeight;++T)for(var j=C+T*v.strides[2],O=T*o.strideHeight-h,W=0;W<a;W++){var U=O+W*l;if(!(U<0||U>=o.inHeight))for(var z=k+W*r.strides[1],D=P+U*n.strides[2],M=0;M<o.outWidth;++M)for(var B=j+M*o.outChannels,q=M*o.strideWidth-f,K=0;K<s;K++){var Q=q+K*c;if(!(Q<0||Q>=o.inWidth))for(var Z=z+K*r.strides[2],se=D+Q*o.inChannels,de=Z,re=0;re<o.inChannels;++re){for(var xe=m[se+re],me=0;me<o.outChannels;++me)p[B+me]+=xe*g[de+me];de+=o.outChannels}}}}return v.toTensor()},t.prototype.conv2dDerInput=function(n,r,o){X([n,r],"conv2dDerInput");for(var i=ve(o.inShape,"float32"),a=i.values,s=this.readSync(n.dataId),u=this.readSync(r.dataId),l=r.strides,c=l[0],d=l[1],f=l[2],h=o.batchSize,v=o.filterHeight,m=o.filterWidth,g=o.inChannels,p=o.inHeight,y=o.inWidth,x=o.outChannels,w=o.outHeight,b=o.outWidth,C=o.strideHeight,E=o.strideWidth,S=o.dataFormat,R=v-1-o.padInfo.top,k=m-1-o.padInfo.left,P=S==="channelsLast",T=i.strides[0],j=P?i.strides[1]:i.strides[2],O=P?i.strides[2]:1,W=P?1:i.strides[1],U=n.strides[0],z=P?n.strides[1]:n.strides[2],D=P?n.strides[2]:1,M=P?1:n.strides[1],B=0;B<h;++B)for(var q=0;q<g;++q)for(var K=0;K<p;++K)for(var Q=K-R,Z=Math.max(0,Math.ceil(Q/C)),se=Math.min(w,(v+Q)/C),de=0;de<y;++de){for(var re=de-k,xe=Math.max(0,Math.ceil(re/E)),me=Math.min(b,(m+re)/E),Pe=0,pe=Z;pe<se;++pe)for(var ke=pe*C-Q,Ce=xe;Ce<me;++Ce)for(var Oe=U*B+z*pe+D*Ce,Le=c*(v-1-ke)+d*(m-1-(Ce*E-re))+f*q,Fe=0;Fe<x;++Fe)Pe+=s[Oe+M*Fe]*u[Le+Fe];a[T*B+j*K+O*de+W*q]=Pe}return i.toTensor()},t.prototype.conv3dDerInput=function(n,r,o){for(var i=ve(o.inShape,"float32"),a=i.values,s=i.strides,u=s[0],l=s[1],c=s[2],d=s[3],f=this.readSync(n.dataId),h=n.strides,v=h[0],m=h[1],g=h[2],p=h[3],y=this.readSync(r.dataId),x=r.strides,w=x[0],b=x[1],C=x[2],E=x[3],S=o.batchSize,R=o.filterDepth,k=o.filterHeight,P=o.filterWidth,T=o.inChannels,j=o.inDepth,O=o.inHeight,W=o.inWidth,U=o.outChannels,z=o.outDepth,D=o.outHeight,M=o.outWidth,B=o.strideDepth,q=o.strideHeight,K=o.strideWidth,Q=R-1-o.padInfo.front,Z=k-1-o.padInfo.top,se=P-1-o.padInfo.left,de=0;de<S;++de)for(var re=0;re<T;++re)for(var xe=0;xe<j;++xe)for(var me=xe-Q,Pe=Math.max(0,Math.ceil(me/B)),pe=Math.min(z,(R+me)/B),ke=0;ke<O;++ke)for(var Ce=ke-Z,Oe=Math.max(0,Math.ceil(Ce/q)),Le=Math.min(D,(k+Ce)/q),Fe=0;Fe<W;++Fe){for(var Yt=Fe-se,Nt=Math.max(0,Math.ceil(Yt/K)),ot=Math.min(M,(P+Yt)/K),Or=0,Ut=Pe;Ut<pe;++Ut)for(var jn=Ut*B-me,bt=Oe;bt<Le;++bt)for(var so=bt*q-Ce,Wn=Nt;Wn<ot;++Wn)for(var It=v*de+m*Ut+g*bt+p*Wn,dn=w*(R-1-jn)+b*(k-1-so)+C*(P-1-(Wn*K-Yt))+E*re,kn=0;kn<U;++kn)Or+=f[It+kn]*y[dn+kn];a[u*de+l*xe+c*ke+d*Fe+re]=Or}return i.toTensor()},t.prototype.conv2dDerFilter=function(n,r,o){X([n,r],"conv2dDerFilter");for(var i=o.strideHeight,a=o.strideWidth,s=o.filterHeight,u=o.filterWidth,l=o.dataFormat==="channelsLast",c=ve(o.filterShape,"float32"),d=o.padInfo.left,f=o.padInfo.top,h=this.bufferSync(n),v=this.bufferSync(r),m=0;m<s;++m)for(var g=Math.max(0,Math.ceil((f-m)/i)),p=Math.min(o.outHeight,(o.inHeight+f-m)/i),y=0;y<u;++y)for(var x=Math.max(0,Math.ceil((d-y)/a)),w=Math.min(o.outWidth,(o.inWidth+d-y)/a),b=0;b<o.inChannels;++b)for(var C=0;C<o.outChannels;++C){for(var E=0,S=0;S<o.batchSize;++S)for(var R=g;R<p;++R)for(var k=m+R*i-f,P=x;P<w;++P){var T=y+P*a-d;E+=l?h.get(S,k,T,b)*v.get(S,R,P,C):h.get(S,b,k,T)*v.get(S,C,R,P)}c.set(E,m,y,b,C)}return c.toTensor()},t.prototype.conv3dDerFilter=function(n,r,o){for(var i=o.strideDepth,a=o.strideHeight,s=o.strideWidth,u=o.filterDepth,l=o.filterHeight,c=o.filterWidth,d=ve(o.filterShape,"float32"),f=d.values,h=d.strides,v=h[0],m=h[1],g=h[2],p=h[3],y=this.readSync(r.dataId),x=r.strides,w=x[0],b=x[1],C=x[2],E=x[3],S=this.readSync(n.dataId),R=n.strides,k=R[0],P=R[1],T=R[2],j=R[3],O=o.padInfo.front,W=o.padInfo.left,U=o.padInfo.top,z=0;z<u;++z)for(var D=Math.max(0,Math.ceil((O-z)/i)),M=Math.min(o.outDepth,(o.inDepth+O-z)/i),B=z*v,q=0;q<l;++q)for(var K=Math.max(0,Math.ceil((U-q)/a)),Q=Math.min(o.outHeight,(o.inHeight+U-q)/a),Z=q*m+B,se=0;se<c;++se)for(var de=Math.max(0,Math.ceil((W-se)/s)),re=Math.min(o.outWidth,(o.inWidth+W-se)/s),xe=se*g+Z,me=0;me<o.inChannels;++me)for(var Pe=me*p+xe,pe=0;pe<o.outChannels;++pe){for(var ke=0,Ce=0;Ce<o.batchSize;++Ce)for(var Oe=Ce*k,Le=Ce*w,Fe=D;Fe<M;++Fe)for(var Yt=(z+Fe*i-O)*P+Oe,Nt=Fe*b+Le,ot=K;ot<Q;++ot)for(var Or=(q+ot*a-U)*T+Yt,Ut=ot*C+Nt,jn=de;jn<re;++jn){var bt=jn*E+Ut;ke+=S[(se+jn*s-W)*j+Or+me]*y[bt+pe]}f[Pe+pe]=ke}return d.toTensor()},t.prototype.fusedDepthwiseConv2D=function(n){var r=n.input,o=n.filter,i=n.convInfo,a=n.bias,s=n.activation,u=n.preluActivationWeights,l=this.depthwiseConv2D(r,o,i);return a&&(l=this.add(l,a)),s&&(l=Ef(this,l,s,u)),l},t.prototype.depthwiseConv2D=function(n,r,o){X([n,r],"depthwiseConv2D");for(var i=o.filterHeight,a=o.filterWidth,s=o.dilationHeight,u=o.dilationWidth,l=o.padInfo.left,c=o.padInfo.top,d=o.outChannels/o.inChannels,f=ve(o.outShape,n.dtype),h=this.readSync(n.dataId),v=this.readSync(r.dataId),m=f.values,g=0;g<o.batchSize;++g)for(var p=g*n.strides[0],y=g*f.strides[0],x=0;x<o.outHeight;++x)for(var w=y+x*f.strides[1],b=x*o.strideHeight-l,C=0;C<i;++C){var E=b+C*s;if(!(E<0||E>=o.inHeight))for(var S=C*r.strides[0],R=p+E*n.strides[1],k=0;k<o.outWidth;++k)for(var P=w+k*f.strides[2],T=k*o.strideWidth-c,j=0;j<a;++j){var O=T+j*u;if(!(O<0||O>=o.inWidth))for(var W=S+j*r.strides[1],U=R+O*o.inChannels,z=P,D=W,M=0;M<o.inChannels;++M){for(var B=h[U+M],q=0;q<d;++q)m[z+q]+=B*v[D+q];z+=d,D+=d}}}return f.toTensor()},t.prototype.depthwiseConv2DDerInput=function(n,r,o){X([n,r],"depthwiseConv2DDerInput");for(var i=ve(o.inShape,"float32"),a=i.values,s=i.strides,u=s[0],l=s[1],c=s[2],d=this.readSync(n.dataId),f=n.strides,h=f[0],v=f[1],m=f[2],g=this.readSync(r.dataId),p=r.strides,y=p[0],x=p[1],w=p[2],b=o.batchSize,C=o.filterHeight,E=o.filterWidth,S=o.inChannels,R=o.inHeight,k=o.inWidth,P=o.outChannels,T=o.outHeight,j=o.outWidth,O=o.strideHeight,W=o.strideWidth,U=C-1-o.padInfo.top,z=E-1-o.padInfo.left,D=P/S,M=0;M<b;++M)for(var B=0;B<S;++B)for(var q=0;q<R;++q)for(var K=q-U,Q=Math.max(0,Math.ceil(K/O)),Z=Math.min(T,(C+K)/O),se=0;se<k;++se){for(var de=se-z,re=Math.max(0,Math.ceil(de/W)),xe=Math.min(j,(E+de)/W),me=0,Pe=Q;Pe<Z;++Pe)for(var pe=Pe*O-K,ke=re;ke<xe;++ke)for(var Ce=h*M+v*Pe+m*ke,Oe=y*(C-1-pe)+x*(E-1-(ke*W-de))+w*B,Le=0;Le<D;++Le)me+=d[Ce+(B*D+Le)]*g[Oe+Le];a[u*M+l*q+c*se+B]=me}return i.toTensor()},t.prototype.depthwiseConv2DDerFilter=function(n,r,o){X([n,r],"depthwiseConv2DDerFilter");for(var i=o.strideHeight,a=o.strideWidth,s=o.filterHeight,u=o.filterWidth,l=ve(o.filterShape,"float32"),c=o.padInfo.left,d=o.padInfo.top,f=o.outChannels/o.inChannels,h=this.bufferSync(n),v=this.bufferSync(r),m=0;m<s;++m)for(var g=Math.max(0,Math.ceil((d-m)/i)),p=Math.min(o.outHeight,(o.inHeight+d-m)/i),y=0;y<u;++y)for(var x=Math.max(0,Math.ceil((c-y)/a)),w=Math.min(o.outWidth,(o.inWidth+c-y)/a),b=0;b<o.outChannels;++b){for(var C=Math.trunc(b/f),E=b%f,S=0,R=0;R<o.batchSize;++R)for(var k=g;k<p;++k)for(var P=m+k*i-d,T=x;T<w;++T){var j=y+T*a-c;S+=h.get(R,P,j,C)*v.get(R,k,T,b)}l.set(S,m,y,C,E)}return l.toTensor()},t.prototype.tile=function(n,r){return X(n,"tile"),d2(this.bufferSync(n),r)},t.prototype.pad=function(n,r,o){X(n,"pad");var i=r.map(function(f,h){return f[0]+n.shape[h]+f[1]}),a=r.map(function(f){return f[0]}),s=this.bufferSync(n),u=ve(i,n.dtype);o!==0&&u.values.fill(o);for(var l=0;l<n.size;l++){var c=s.indexToLoc(l),d=c.map(function(f,h){return f+a[h]});u.set.apply(u,[s.get.apply(s,c)].concat(d))}return u.toTensor()},t.prototype.transpose=function(n,r){X(n,"transpose");for(var o=new Array(n.rank),i=0;i<o.length;i++)o[i]=n.shape[r[i]];var a=this.readSync(n.dataId),s=ve(o,n.dtype),u=this.bufferSync(n);for(i=0;i<n.size;++i){for(var l=u.indexToLoc(i),c=new Array(l.length),d=0;d<c.length;d++)c[d]=l[r[d]];var f=s.locToIndex(c);s.values[f]=a[i]}return s.toTensor()},t.prototype.gather=function(n,r,o){X([n,r],"gather");var i=n.shape.slice(),a=this.readSync(r.dataId);i[o]=a.length;for(var s=ve(i,n.dtype),u=this.bufferSync(n),l=0;l<s.size;++l){var c=s.indexToLoc(l),d=c.slice();d[o]=a[c[o]];var f=u.locToIndex(d);s.values[l]=u.values[f]}return s.toTensor()},t.prototype.batchToSpaceND=function(n,r,o){X([n],"batchToSpaceND");var i=r.reduce(function(d,f){return d*f}),a=yc(n.shape,r,i),s=xc(a.length,r.length),u=wc(n.shape,r,i),l=Jb(o,r.length),c=Zb(u,o,r.length);return n.reshape(a).transpose(s).reshape(u).slice(l,c)},t.prototype.spaceToBatchND=function(n,r,o){X([n],"spaceToBatchND");var i=r.reduce(function(f,h){return f*h}),a=[[0,0]];a.push.apply(a,o);for(var s=1+r.length;s<n.shape.length;++s)a.push([0,0]);var u=n.pad(a),l=yc(u.shape,r,i,!1),c=xc(l.length,r.length,!1),d=wc(u.shape,r,i,!1);return u.reshape(l).transpose(c).reshape(d)},t.prototype.pool=function(n,r,o){X(n,"pool");for(var i=r.strideHeight,a=r.strideWidth,s=r.dilationHeight,u=r.dilationWidth,l=r.effectiveFilterHeight,c=r.effectiveFilterWidth,d=r.padInfo.top,f=r.padInfo.left,h=o==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,v=this.readSync(n.dataId),m=ve(r.outShape,n.dtype),g=m.values,p=r.outShape[1]*r.outShape[2]*r.outShape[3],y=r.outShape[2]*r.outShape[3],x=r.outShape[3],w=0;w<r.batchSize;++w)for(var b=w*p,C=w*n.strides[0],E=0;E<r.inChannels;++E)for(var S=0;S<r.outHeight;++S)for(var R=S*i-d,k=Math.max(0,R),P=Math.min(r.inHeight,l+R),T=b+S*y,j=0;j<r.outWidth;++j){for(var O=j*a-f,W=Math.max(0,O),U=Math.min(r.inWidth,c+O),z=h,D=0,M=0,B=k;B<P;B+=s){for(var q=C+B*n.strides[1],K=W;K<U;K+=u){var Q=v[q+K*n.strides[2]+E];o==="max"&&Q>z?z=Q:o==="avg"&&(D+=Q,M++)}if(isNaN(z))break}g[T+j*x+E]=o==="avg"?D/M:z}return m.toTensor()},t.prototype.maxPool=function(n,r){return this.pool(n,r,"max")},t.prototype.maxPoolPositions=function(n,r){for(var o=ve(r.outShape,"int32"),i=r.strideHeight,a=r.strideWidth,s=r.dilationHeight,u=r.dilationWidth,l=r.effectiveFilterHeight,c=r.effectiveFilterWidth,d=r.padInfo.top,f=r.padInfo.left,h=this.bufferSync(n),v=0;v<r.batchSize;++v)for(var m=0;m<r.inChannels;++m)for(var g=0;g<r.outHeight;++g){for(var p=g*i-d,y=p;y<0;)y+=s;for(var x=Math.min(r.inHeight,l+p),w=0;w<r.outWidth;++w){for(var b=w*a-f,C=b;C<0;)C+=u;for(var E=Math.min(r.inWidth,c+b),S=Number.NEGATIVE_INFINITY,R=-1,k=y;k<x;k+=s)for(var P=k-p,T=C;T<E;T+=u){var j=T-b,O=h.get(v,k,T,m);O>S&&(S=O,R=P*c+j)}o.set(R,v,g,w,m)}}return o.toTensor()},t.prototype.maxPoolBackprop=function(n,r,o,i){X([r,o],"maxPoolBackprop");for(var a=this.maxPoolPositions(r,i),s=i.strideHeight,u=i.strideWidth,l=i.dilationHeight,c=i.dilationWidth,d=i.effectiveFilterHeight,f=i.effectiveFilterWidth,h=f-1-i.padInfo.left,v=d-1-i.padInfo.top,m=ve(r.shape,"float32"),g=this.bufferSync(a),p=this.bufferSync(n),y=0;y<i.batchSize;++y)for(var x=0;x<i.inChannels;++x)for(var w=0;w<i.inHeight;++w)for(var b=0;b<i.inWidth;++b){for(var C=w-v,E=b-h,S=0,R=0;R<d;R+=l){var k=(C+R)/s;if(!(k<0||k>=i.outHeight||Math.floor(k)!==k))for(var P=0;P<f;P+=c){var T=(E+P)/u;if(!(T<0||T>=i.outWidth||Math.floor(T)!==T)){var j=d*f-1-g.get(y,k,T,x)===R*f+P?1:0;j!==0&&(S+=p.get(y,k,T,x)*j)}}}m.set(S,y,w,b,x)}return m.toTensor()},t.prototype.avgPoolBackprop=function(n,r,o){X([n,r],"avgPoolBackprop");for(var i=o.strideHeight,a=o.strideWidth,s=o.filterHeight,u=o.filterWidth,l=o.dilationHeight,c=o.dilationWidth,d=o.effectiveFilterHeight,f=o.effectiveFilterWidth,h=f-1-o.padInfo.left,v=d-1-o.padInfo.top,m=ve(r.shape,"float32"),g=1/(s*u),p=this.bufferSync(n),y=0;y<o.batchSize;++y)for(var x=0;x<o.inChannels;++x)for(var w=0;w<o.inHeight;++w)for(var b=0;b<o.inWidth;++b){for(var C=w-v,E=b-h,S=0,R=0;R<d;R+=l){var k=(C+R)/i;if(!(k<0||k>=o.outHeight||Math.floor(k)!==k))for(var P=0;P<f;P+=c){var T=(E+P)/a;T<0||T>=o.outWidth||Math.floor(T)!==T||(S+=p.get(y,k,T,x))}}m.set(S*g,y,w,b,x)}return m.toTensor()},t.prototype.pool3d=function(n,r,o){X(n,"pool3d");for(var i=r.strideDepth,a=r.strideHeight,s=r.strideWidth,u=r.dilationDepth,l=r.dilationHeight,c=r.dilationWidth,d=r.effectiveFilterDepth,f=r.effectiveFilterHeight,h=r.effectiveFilterWidth,v=r.padInfo.front,m=r.padInfo.top,g=r.padInfo.left,p=o==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,y=this.readSync(n.dataId),x=ve(r.outShape,n.dtype),w=x.values,b=r.outShape[1]*r.outShape[2]*r.outShape[3]*r.outShape[4],C=r.outShape[2]*r.outShape[3]*r.outShape[4],E=r.outShape[3]*r.outShape[4],S=r.outShape[4],R=0;R<r.batchSize;++R)for(var k=R*b,P=R*n.strides[0],T=0;T<r.inChannels;++T)for(var j=0;j<r.outDepth;++j){for(var O=j*i-v,W=O;W<0;)W+=u;for(var U=Math.min(r.inDepth,d+O),z=k+j*C,D=0;D<r.outHeight;++D){for(var M=D*a-m,B=M;B<0;)B+=l;for(var q=Math.min(r.inHeight,f+M),K=z+D*E,Q=0;Q<r.outWidth;++Q){for(var Z=Q*s-g,se=Z;se<0;)se+=c;for(var de=Math.min(r.inWidth,h+Z),re=K+Q*S,xe=p,me=0,Pe=0,pe=W;pe<U;pe+=u){for(var ke=P+pe*n.strides[1],Ce=B;Ce<q;Ce+=l){for(var Oe=ke+Ce*n.strides[2],Le=se;Le<de;Le+=c){var Fe=y[Oe+Le*n.strides[3]+T];if(o==="max"&&Fe>xe?xe=Fe:o==="avg"&&(me+=Fe,Pe++),isNaN(xe))break}if(isNaN(xe))break}if(isNaN(xe))break}w[re+T]=o==="avg"?me/Pe:xe}}}return x.toTensor()},t.prototype.avgPool3d=function(n,r){return X(n,"avgPool3d"),this.pool3d(n,r,"avg").toFloat()},t.prototype.avgPool3dBackprop=function(n,r,o){X([n,r],"avgPool3dBackprop");for(var i=o.strideDepth,a=o.strideHeight,s=o.strideWidth,u=o.filterDepth,l=o.filterHeight,c=o.filterWidth,d=o.dilationDepth,f=o.dilationHeight,h=o.dilationWidth,v=o.effectiveFilterDepth,m=o.effectiveFilterHeight,g=o.effectiveFilterWidth,p=v-1-o.padInfo.front,y=g-1-o.padInfo.left,x=m-1-o.padInfo.top,w=ve(r.shape,"float32"),b=1/(u*l*c),C=this.bufferSync(n),E=0;E<o.batchSize;++E)for(var S=0;S<o.inChannels;++S)for(var R=0;R<o.inDepth;++R)for(var k=0;k<o.inHeight;++k)for(var P=0;P<o.inWidth;++P){for(var T=R-p,j=k-x,O=P-y,W=0,U=0;U<v;U+=d){var z=(T+U)/i;if(!(z<0||z>=o.outDepth||Math.floor(z)!==z))for(var D=0;D<m;D+=f){var M=(j+D)/a;if(!(M<0||M>=o.outHeight||Math.floor(M)!==M))for(var B=0;B<g;B+=h){var q=(O+B)/s;q<0||q>=o.outWidth||Math.floor(q)!==q||(W+=C.get(E,z,M,q,S))}}}w.set(W*b,E,R,k,P,S)}return w.toTensor()},t.prototype.maxPool3d=function(n,r){return X(n,"maxPool3d"),this.pool3d(n,r,"max").toFloat()},t.prototype.maxPool3dPositions=function(n,r){for(var o=ve(r.outShape,"int32"),i=r.strideDepth,a=r.strideHeight,s=r.strideWidth,u=r.dilationDepth,l=r.dilationHeight,c=r.dilationWidth,d=r.effectiveFilterDepth,f=r.effectiveFilterHeight,h=r.effectiveFilterWidth,v=r.padInfo.front,m=r.padInfo.top,g=r.padInfo.left,p=this.bufferSync(n),y=0;y<r.batchSize;++y)for(var x=0;x<r.inChannels;++x)for(var w=0;w<r.outDepth;++w){for(var b=w*i-v,C=b;C<0;)C+=u;for(var E=Math.min(r.inDepth,d+b),S=0;S<r.outHeight;++S){for(var R=S*a-m,k=R;k<0;)k+=l;for(var P=Math.min(r.inHeight,f+R),T=0;T<r.outWidth;++T){for(var j=T*s-g,O=j;O<0;)O+=c;for(var W=Math.min(r.inWidth,h+j),U=Number.NEGATIVE_INFINITY,z=-1,D=C;D<E;D+=u)for(var M=D-b,B=k;B<P;B+=l)for(var q=B-R,K=O;K<W;K+=c){var Q=K-j,Z=p.get(y,D,B,K,x);Z>=U&&(U=Z,z=M*f*h+q*f+Q)}o.set(z,y,w,S,T,x)}}}return o.toTensor()},t.prototype.maxPool3dBackprop=function(n,r,o,i){X([r,o],"maxPool3dBackprop");for(var a=this.maxPool3dPositions(r,i),s=i.strideDepth,u=i.strideHeight,l=i.strideWidth,c=i.dilationDepth,d=i.dilationHeight,f=i.dilationWidth,h=i.effectiveFilterDepth,v=i.effectiveFilterHeight,m=i.effectiveFilterWidth,g=h-1-i.padInfo.front,p=m-1-i.padInfo.left,y=v-1-i.padInfo.top,x=ve(r.shape,"float32"),w=this.bufferSync(a),b=this.bufferSync(n),C=0;C<i.batchSize;++C)for(var E=0;E<i.inChannels;++E)for(var S=0;S<i.inDepth;++S)for(var R=0;R<i.inHeight;++R)for(var k=0;k<i.inWidth;++k){for(var P=S-g,T=R-y,j=k-p,O=0,W=0;W<h;W+=c){var U=(P+W)/s;if(!(U<0||U>=i.outDepth||Math.floor(U)!==U))for(var z=0;z<v;z+=d){var D=(T+z)/u;if(!(D<0||D>=i.outHeight||Math.floor(D)!==D))for(var M=0;M<m;M+=f){var B=(j+M)/l;if(!(B<0||B>=i.outWidth||Math.floor(B)!==B)){var q=h*v*m-1-w.get(C,U,D,B,E)===W*v*m+z*m+M?1:0;q!==0&&(O+=b.get(C,U,D,B,E)*q)}}}}x.set(O,C,S,R,k,E)}return x.toTensor()},t.prototype.cast=function(n,r){return s2(n,r,this)},t.prototype.reshape=function(n,r){return Zh(n,r)},t.prototype.avgPool=function(n,r){return X(n,"avgPool"),this.pool(n,r,"avg").toFloat()},t.prototype.resizeBilinear=function(n,r,o,i){X(n,"resizeBilinear");for(var a=n.shape,s=a[0],u=a[1],l=a[2],c=a[3],d=this.readSync(n.dataId),f=new Float32Array(ae([s,r,o,c])),h=[i&&r>1?u-1:u,i&&o>1?l-1:l],v=[i&&r>1?r-1:r,i&&o>1?o-1:o],m=0,g=h[0]/v[0],p=h[1]/v[1],y=0;y<s;y++)for(var x=0;x<r;x++)for(var w=g*x,b=Math.floor(w),C=w-b,E=Math.min(u-1,Math.ceil(w)),S=y*n.strides[0]+b*n.strides[1],R=y*n.strides[0]+E*n.strides[1],k=0;k<o;k++)for(var P=p*k,T=Math.floor(P),j=P-T,O=Math.min(l-1,Math.ceil(P)),W=S+T*n.strides[2],U=R+T*n.strides[2],z=S+O*n.strides[2],D=R+O*n.strides[2],M=0;M<c;M++){var B=d[W+M],q=d[U+M],K=B+(d[z+M]-B)*j,Q=K+(q+(d[D+M]-q)*j-K)*C;f[m++]=Q}return St(f,[s,r,o,c])},t.prototype.resizeBilinearBackprop=function(n,r,o){X([n,r],"resizeBilinearBackprop");for(var i=r.shape,a=i[0],s=i[1],u=i[2],l=i[3],c=n.shape,d=c[1],f=c[2],h=new Float32Array(a*s*u*l),v=[o&&d>1?s-1:s,o&&f>1?u-1:u],m=[o&&d>1?d-1:d,o&&f>1?f-1:f],g=v[0]/m[0],p=v[1]/m[1],y=this.readSync(n.dataId),x=0,w=0;w<a;w++)for(var b=w*r.strides[0],C=0;C<d;C++)for(var E=C*g,S=Math.floor(E),R=Math.min(Math.ceil(E),s-1),k=b+S*r.strides[1],P=b+R*r.strides[1],T=E-S,j=1-T,O=0;O<f;O++)for(var W=O*p,U=Math.floor(W),z=Math.min(Math.ceil(W),u-1),D=W-U,M=1-D,B=k+U*r.strides[2],q=k+z*r.strides[2],K=P+U*r.strides[2],Q=P+z*r.strides[2],Z=j*M,se=j*D,de=T*M,re=T*D,xe=0;xe<l;xe++){var me=y[x++];h[B+xe]+=me*Z,h[q+xe]+=me*se,h[K+xe]+=me*de,h[Q+xe]+=me*re}return Zt(h,[a,u,s,l],r.dtype)},t.prototype.resizeNearestNeighbor=function(n,r,o,i){X(n,"resizeNearestNeighbor");for(var a=n.shape,s=a[0],u=a[1],l=a[2],c=a[3],d=this.readSync(n.dataId),f=new Float32Array(s*r*o*c),h=[i&&r>1?u-1:u,i&&o>1?l-1:l],v=[i&&r>1?r-1:r,i&&o>1?o-1:o],m=h[0]/v[0],g=h[1]/v[1],p=0,y=0;y<s;y++)for(var x=y*n.strides[0],w=0;w<r;w++)for(var b=m*w,C=x+Math.min(u-1,i?Math.round(b):Math.floor(b))*n.strides[1],E=0;E<o;E++)for(var S=g*E,R=C+Math.min(l-1,i?Math.round(S):Math.floor(S))*n.strides[2],k=0;k<c;k++){var P=d[R+k];f[p++]=P}return St(f,[s,r,o,c],n.dtype)},t.prototype.resizeNearestNeighborBackprop=function(n,r,o){X([n,r],"resizeNearestNeighborBackprop");for(var i=r.shape,a=i[0],s=i[1],u=i[2],l=i[3],c=n.shape,d=c[1],f=c[2],h=new Float32Array(a*s*u*l),v=this.readSync(n.dataId),m=[o&&d>1?s-1:s,o&&f>1?u-1:u],g=[o&&d>1?d-1:d,o&&f>1?f-1:f],p=m[0]/g[0],y=m[1]/g[1],x=1/p,w=1/y,b=2*Math.ceil(x)+2,C=2*Math.ceil(w)+2,E=0;E<a;E++)for(var S=E*r.strides[0],R=0;R<s;R++)for(var k=S+R*r.strides[1],P=Math.floor(R*x),T=Math.floor(P-b/2),j=0;j<u;j++)for(var O=k+j*r.strides[2],W=Math.floor(j*w),U=Math.floor(W-C/2),z=0;z<l;z++){for(var D=0,M=0;M<b;M++){var B=M+T;if(!(B<0||B>=d)){var q=S+B*n.strides[1],K=B*p;if(R===Math.min(s-1,o?Math.round(K):Math.floor(K)))for(var Q=0;Q<C;Q++){var Z=Q+U;if(!(Z<0||Z>=f)){var se=q+Z*n.strides[2],de=Z*y;j===Math.min(u-1,o?Math.round(de):Math.floor(de))&&(D+=v[se+z])}}}}h[O+z]=D}return Zt(h,r.shape,r.dtype)},t.prototype.batchNormalization=function(n,r,o,i,a,s){X([n,r,o,a,s],"batchNorm");for(var u=this.readSync(n.dataId),l=this.readSync(r.dataId),c=this.readSync(o.dataId),d=a?this.readSync(a.dataId):new Float32Array([1]),f=s?this.readSync(s.dataId):new Float32Array([0]),h=new Float32Array(u.length),v=f.length,m=d.length,g=c.length,p=l.length,y=0,x=0,w=0,b=0,C=0;C<u.length;++C)h[C]=f[y++]+(u[C]-l[x++])*d[w++]/Math.sqrt(c[b++]+i),y>=v&&(y=0),x>=p&&(x=0),w>=m&&(w=0),b>=g&&(b=0);return Zt(h,n.shape)},t.prototype.localResponseNormalization4D=function(n,r,o,i,a){X(n,"localResponseNormalization4D");var s=n.shape[3],u=s-1,l=this.readSync(n.dataId),c=n.size,d=new Float32Array(c);function f(g){for(var p=g%s,y=g-p+Math.max(0,p-r),x=g-p+Math.min(p+r,u),w=0;y<=x;y++){var b=l[y];w+=b*b}return w}for(var h=0;h<c;h++){var v=f(h),m=l[h]*Math.pow(o+i*v,-a);d[h]=m}return Zt(d,n.shape)},t.prototype.LRNGrad=function(n,r,o,i,a,s,u){X(n,"LRNGrad");for(var l=n.shape[3],c=this.readSync(n.dataId),d=this.readSync(r.dataId),f=this.readSync(o.dataId),h=new Float32Array(n.size),v=n.size,m=0;m<v;m++){for(var g=m%l,p=m-g+Math.max(0,g-i),y=m-g+Math.min(l,g+i+1),x=0,w=p;w<y;w++)x+=Math.pow(d[w],2);for(x=s*x+a,w=p;w<y;w++){var b=-2*s*u*d[w]*f[m]/x;m===w&&(b+=Math.pow(x,-u)),b*=c[m],h[w]+=b}}return Zt(h,n.shape)},t.prototype.multinomial=function(n,r,o,i){X(n,"multinomial");for(var a=r?n:no(n),s=a.shape[0],u=a.shape[1],l=Ue([s,o],"int32"),c=this.readSync(l.dataId),d=this.readSync(a.dataId),f=0;f<s;++f){var h=f*u,v=new Float32Array(u-1);v[0]=d[h];for(var m=1;m<v.length;++m)v[m]=v[m-1]+d[h+m];for(var g=ld(i.toString()),p=f*o,y=0;y<o;++y){var x=g();c[p+y]=v.length;for(var w=0;w<v.length;w++)if(x<v[w]){c[p+y]=w;break}}}return l},t.prototype.oneHot=function(n,r,o,i){X(n,"oneHot");var a=new Float32Array(n.size*r);a.fill(i);for(var s=this.readSync(n.dataId),u=0;u<n.size;++u)s[u]>=0&&s[u]<r&&(a[u*r+s[u]]=o);return Wo(a,[n.size,r],"int32")},t.prototype.nonMaxSuppression=function(n,r,o,i,a){return X(n,"nonMaxSuppression"),Tv(this.readSync(n.dataId),this.readSync(r.dataId),o,i,a)},t.prototype.fft=function(n){return this.fftBatch(n,!1)},t.prototype.ifft=function(n){return this.fftBatch(n,!0)},t.prototype.fftBatch=function(n,r){for(var o=n.shape[0],i=n.shape[1],a=ve(n.shape,"float32"),s=ve(n.shape,"float32"),u=An(n).as2D(o,i),l=wr(n).as2D(o,i),c=0;c<o;c++)for(var d=u.slice([c,0],[1,i]),f=l.slice([c,0],[1,i]),h=Et(d,f),v=this.readSync(this.fftImpl(h,r).dataId),m=0;m<i;m++){var g=Fy(v,m);a.values[c*i+m]=g.real,s.values[c*i+m]=g.imag}return Et(a.toTensor(),s.toTensor()).as2D(o,i)},t.prototype.fftImpl=function(n,r){var o=n.as1D(),i=o.size;if(this.isExponentOf2(i)){var a=this.fftRadix2(o,i,r).as2D(n.shape[0],n.shape[1]);return r&&(a=Et(An(a).div(ee(i)),wr(a).div(ee(i)))),a}var s=this.readSync(n.dataId),u=function(l){for(var c=new Float32Array(l.length/2),d=new Float32Array(l.length/2),f=0;f<l.length;f+=2)c[f/2]=l[f],d[f/2]=l[f+1];return{real:c,imag:d}}(this.fourierTransformByMatmul(s,i,r));return Et(u.real,u.imag).as2D(n.shape[0],n.shape[1])},t.prototype.isExponentOf2=function(n){return(n&n-1)==0},t.prototype.fftRadix2=function(n,r,o){if(r===1)return n;var i=this.readSync(n.dataId),a=r/2,s=function(p){for(var y=Math.ceil(p.length/4),x=new Float32Array(y),w=new Float32Array(y),b=0;b<p.length;b+=4)x[Math.floor(b/4)]=p[b],w[Math.floor(b/4)]=p[b+1];return{real:x,imag:w}}(i),u=Et(s.real,s.imag).as1D(),l=function(p){for(var y=Math.floor(p.length/4),x=new Float32Array(y),w=new Float32Array(y),b=2;b<p.length;b+=4)x[Math.floor(b/4)]=p[b],w[Math.floor(b/4)]=p[b+1];return{real:x,imag:w}}(i),c=Et(l.real,l.imag).as1D();u=this.fftRadix2(u,a,o),c=this.fftRadix2(c,a,o);var d=function(p,y){for(var x=new Float32Array(p/2),w=new Float32Array(p/2),b=0;b<Math.ceil(p/2);b++){var C=(y?2:-2)*Math.PI*(b/p);x[b]=Math.cos(C),w[b]=Math.sin(C)}return{real:x,imag:w}}(r,o),f=Et(d.real,d.imag).mul(c),h=u.add(f),v=u.sub(f),m=An(h).concat(An(v)),g=wr(h).concat(wr(v));return Et(m,g).as1D()},t.prototype.fourierTransformByMatmul=function(n,r,o){for(var i=new Float32Array(2*r),a=0;a<r;a++){for(var s=0,u=0,l=0;l<r;l++){var c=OP(a*l,r,o),d=Fy(n,l);s+=d.real*c.real-d.imag*c.imag,u+=d.real*c.imag+d.imag*c.real}o&&(s/=r,u/=r),MP(i,s,u,a)}return i},t.prototype.depthToSpace=function(n,r,o){I(o==="NHWC",function(){return"Only NHWC dataFormat supported on CPU for depthToSpace. Got "+o}),I(r>1,function(){return"blockSize should be > 1 for depthToSpace, but was: "+r});for(var i=n.shape[0],a=n.shape[1],s=n.shape[2],u=n.shape[3],l=a*r,c=s*r,d=u/(r*r),f=this.readSync(n.dataId),h=new Float32Array(i*l*c*d),v=0,m=0;m<i;++m)for(var g=0;g<l;++g)for(var p=Math.floor(g/r),y=g%r,x=0;x<c;++x)for(var w=Math.floor(x/r),b=(y*r+x%r)*d,C=0;C<d;++C){var E=C+b+u*(w+s*(p+a*m));h[v++]=f[E]}return Zt(h,[i,l,c,d])},t.prototype.broadcastedBinaryOp=function(n,r,o,i){var a=_e(n.shape,r.shape),s=ve(a,o),u=this.readSync(n.dataId),l=this.readSync(r.dataId),c=To(n.shape,a),d=To(r.shape,a),f=s.values;if(c.length+d.length===0)for(var h=0;h<f.length;++h)f[h]=i(u[h%u.length],l[h%l.length]);else{var v=this.bufferSync(n),m=this.bufferSync(r),g=function(p){var y=s.indexToLoc(p),x=y.slice(-n.rank);c.forEach(function(E){return x[E]=0});var w=v.locToIndex(x),b=y.slice(-r.rank);d.forEach(function(E){return b[E]=0});var C=m.locToIndex(b);f[p]=i(u[w],l[C])};for(h=0;h<f.length;++h)g(h)}return s.toTensor()},t.prototype.broadcastedBinaryComplexOp=function(n,r,o){var i=_e(n.shape,r.shape),a=ve(i,"float32"),s=ve(i,"float32"),u=this.readSync(n.dataId),l=this.readSync(r.dataId),c=To(n.shape,i),d=To(r.shape,i),f=a.values,h=s.values;if(c.length+d.length===0)for(var v=0;v<f.length;v++){var m=v%u.length,g=v%l.length,p=o(u[2*m],u[2*m+1],l[2*g],l[2*g+1]);f[v]=p.real,h[v]=p.imag}else{var y=this.bufferSync(this.data.get(n.dataId).complexTensors.real),x=this.bufferSync(this.data.get(r.dataId).complexTensors.real),w=function(b){var C=a.indexToLoc(b),E=C.slice(-n.rank);c.forEach(function(T){return E[T]=0});var S=y.locToIndex(E),R=C.slice(-r.rank);d.forEach(function(T){return R[T]=0});var k=x.locToIndex(R),P=o(u[2*S],u[2*S+1],l[2*k],l[2*k+1]);f[b]=P.real,h[b]=P.imag};for(v=0;v<f.length;v++)w(v)}return this.complex(a.toTensor(),s.toTensor())},t.prototype.split=function(n,r,o){return c2(n,r,o)},t.prototype.dispose=function(){},t.prototype.floatPrecision=function(){return 32},t.prototype.epsilon=function(){return 1e-7},t.prototype.cropAndResize=function(n,r,o,i,a,s){for(var u=n.shape,l=u[0],c=u[1],d=u[2],f=u[3],h=r.shape[0],v=i[0],m=i[1],g=ve([h,v,m,f],"float32"),p=this.readSync(r.dataId),y=this.readSync(o.dataId),x=this.readSync(n.dataId),w=n.strides,b=g.strides,C=0;C<h;C++){var E=4*C,S=p[E],R=p[E+1],k=p[E+2],P=p[E+3],T=y[C];if(!(T>=l))for(var j=v>1?(k-S)*(c-1)/(v-1):0,O=m>1?(P-R)*(d-1)/(m-1):0,W=0;W<v;W++){var U=v>1?S*(c-1)+W*j:.5*(S+k)*(c-1);if(U<0||U>c-1)for(var z=0;z<m;z++)for(var D=0;D<f;D++){var M=D+z*b[2]+W*b[1]+C*b[0];g.values[M]=s}else if(a==="bilinear"){var B=Math.floor(U),q=Math.ceil(U),K=U-B;for(z=0;z<m;z++)if((pe=m>1?R*(d-1)+z*O:.5*(R+P)*(d-1))<0||pe>d-1)for(D=0;D<f;D++)M=D+z*b[2]+W*b[1]+C*b[0],g.values[M]=s;else{var Q=Math.floor(pe),Z=Math.ceil(pe),se=pe-Q;for(D=0;D<f;D++){var de=x[M=D+Q*w[2]+B*w[1]+T*w[0]],re=x[M=D+Z*w[2]+B*w[1]+T*w[0]],xe=x[M=D+Q*w[2]+q*w[1]+T*w[0]],me=de+(re-de)*se,Pe=xe+(x[M=D+Z*w[2]+q*w[1]+T*w[0]]-xe)*se;M=D+z*b[2]+W*b[1]+C*b[0],g.values[M]=me+(Pe-me)*K}}}else for(z=0;z<m;++z){var pe;if((pe=m>1?R*(d-1)+z*O:.5*(R+P)*(d-1))<0||pe>d-1)for(D=0;D<f;D++)M=D+z*b[2]+W*b[1]+C*b[0],g.values[M]=s;else{var ke=Math.round(pe),Ce=Math.round(U);for(D=0;D<f;D++){var Oe=D+ke*w[2]+Ce*w[1]+T*w[0],Le=D+z*b[2]+W*b[1]+C*b[0];g.values[Le]=x[Oe]}}}}}return g.toTensor()},t.prototype.sparseToDense=function(n,r,o,i){var a=bc(0,n,o),s=a.sliceRank,u=a.numUpdates,l=a.sliceSize,c=a.strides,d=a.outputSize;return this.scatter(n,r,o,d,l,u,s,c,i,!1)},t.prototype.gatherND=function(n,r){var o=r.shape,i=o[o.length-1],a=e2(n,r),s=a[0],u=a[1],l=a[2],c=a[3];if(u===0)return St([],s,n.dtype);for(var d=new nu([u,l],n.dtype),f=this.readSync(r.dataId),h=this.readSync(n.dataId),v=0;v<u;v++){for(var m=[],g=0,p=0;p<i;p++){var y=f[v*i+p];g+=y*c[p],m.push(y)}if(g<0||g>=n.size/l)throw new Error("Invalid indices: "+m+" does not index into "+n.shape);for(var x=0;x<l;x++)d.values[v*l+x]=h[g*l+x]}return d.toTensor().reshape(s)},t.prototype.scatterND=function(n,r,o){var i=bc(0,n,o),a=i.sliceRank,s=i.numUpdates,u=i.sliceSize,l=i.strides,c=i.outputSize,d=ee(0);return this.scatter(n,r,o,c,u,s,a,l,d,!0)},t.prototype.fill=function(n,r,o){var i=dc(o=o||yu(r),ae(n));return i.fill(r),L.makeTensor(i,n,o,this)},t.prototype.onesLike=function(n){if(n.dtype==="string")throw new Error("onesLike is not supported for string tensors");return this.fill(n.shape,1,n.dtype)},t.prototype.zerosLike=function(n){var r=dc(n.dtype,ae(n.shape));return this.makeOutput(r,n.shape,n.dtype)},t.prototype.linspace=function(n,r,o){return u2(n,r,o)},t.prototype.scatter=function(n,r,o,i,a,s,u,l,c,d){var f=[i/a,a],h=this.readSync(n.dataId),v=this.readSync(r.dataId);if(i===0)return St([],o,r.dtype);var m=new nu(f,r.dtype);m.values.fill(this.readSync(c.dataId)[0]);for(var g=0;g<s;g++){for(var p=[],y=0,x=0;x<u;x++){var w=h[g*u+x];p.push(w),y+=w*l[x]}if(y<0||y>=i/a)throw new Error("Invalid indices: "+p+" does not index into "+o);for(var b=0;b<a;b++)d?m.values[y*a+b]+=v[g*a+b]:m.values[y*a+b]=r.rank===0?v[0]:v[g*a+b]}return m.toTensor().reshape(o)},t}(i2);L.registerBackend("cpu",function(){return new nM},1);for(var _f=0,n0=[{kernelName:"NonMaxSuppressionV5",backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,o=t,i=o.boxes,a=o.scores,s=r,u=s.maxOutputSize,l=s.iouThreshold,c=s.scoreThreshold,d=s.softNmsSigma,f=n;X(i,"NonMaxSuppressionWithScore");var h=Av(f.data.get(i.dataId).values,f.data.get(a.dataId).values,u,l,c,d);return[h.selectedIndices,h.selectedScores]}},{kernelName:"Square",backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.x,o=n;X(r,"square");for(var i=o.data.get(r.dataId).values,a=new Float32Array(i.length),s=0;s<i.length;++s){var u=i[s];a[s]=u*u}return{dataId:o.write(a,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}},{kernelName:iu,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t,o=r.a,i=r.b,a=n;X([o,i],iu);var s=a.data.get(o.dataId).values,u=a.data.get(i.dataId).values,l=function(f,h,v,m,g,p){var y=_e(f,h),x=y.length,w=Rr(y),b=tu(g,ae(y)),C=f.length,E=h.length,S=Rr(f),R=Rr(h),k=To(f,y),P=To(h,y);if(k.length+P.length===0)for(var T=0;T<b.length;++T)b[T]=p(v[T%v.length],m[T%m.length]);else{var j=function(O){var W=fA(O,x,w),U=W.slice(-C);k.forEach(function(B){return U[B]=0});var z=Sy(U,C,S),D=W.slice(-E);P.forEach(function(B){return D[B]=0});var M=Sy(D,E,R);b[O]=p(v[z],m[M])};for(T=0;T<b.length;++T)j(T)}return[b,y]}(o.shape,i.shape,s,u,o.dtype,function(f,h){var v=f-h;return v*v}),c=l[0],d=l[1];return{dataId:a.write(c,d,o.dtype),shape:d,dtype:o.dtype}}}];_f<n0.length;_f++)Db(n0[_f]);var Hi,rM=function(e){this.variableNames=["A"];var t=Lt(),n=e[0],r=e[1];this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(`+r+".0, "+n+`.0);

        vec4 values = `+t.texture2D+`(A, uv);
        float value;
        if (depth == 0) {
          value = values.r;
        } else if (depth == 1) {
          value = values.g;
        } else if (depth == 2) {
          value = values.b;
        } else if (depth == 3) {
          value = values.a;
        }

        setOutput(floor(value * 255.0 + 0.5));
      }
    `},oM=function(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var t=Lt(),n=e[0],r=e[1];this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];

        vec4 result = vec4(0.);

        for(int row=0; row<=1; row++) {
          for(int col=0; col<=1; col++) {
            texC = coords[1] + row;
            depth = coords[2] + col;

            vec2 uv = (vec2(texC, texR) + halfCR) /
                       vec2(`+r+".0, "+n+`.0);
            vec4 values = `+t.texture2D+`(A, uv);
            float value;
            if (depth == 0) {
              value = values.r;
            } else if (depth == 1) {
              value = values.g;
            } else if (depth == 2) {
              value = values.b;
            } else if (depth == 3) {
              value = values.a;
            }

            result[row * 2 + col] = floor(value * 255.0 + 0.5);
          }
        }

        `+t.output+` = result;
      }
    `};for(var Sf=0,r0=[{kernelName:"FromPixels",backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,o=t.pixels,i=r.numChannels,a=typeof HTMLVideoElement<"u"&&o instanceof HTMLVideoElement,s=typeof HTMLImageElement<"u"&&o instanceof HTMLImageElement,u=a?[o.videoWidth,o.videoHeight]:[o.width,o.height],l=u[0],c=u[1],d=[c,l],f=[c,l,i];(s||a)&&(Hi==null&&(Hi=document.createElement("canvas").getContext("2d")),Hi.canvas.width=l,Hi.canvas.height=c,Hi.drawImage(o,0,0,l,c),o=Hi.canvas);var h=n.makeTensorInfo(d,"int32");n.texData.get(h.dataId).usage=gn.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(h.dataId),o);var v=H().getBool("WEBGL_PACK")?new oM(f):new rM(f),m=n.runWebGLProgram(v,[h],"int32");return n.disposeData(h.dataId),m}},{kernelName:"NonMaxSuppressionV5",backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs;vc("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");var o=t,i=o.boxes,a=o.scores,s=r,u=s.maxOutputSize,l=s.iouThreshold,c=s.scoreThreshold,d=s.softNmsSigma,f=n,h=Av(f.readSync(i.dataId),f.readSync(a.dataId),u,l,c,d);return[h.selectedIndices,h.selectedScores]}},{kernelName:"Square",backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.x,o=n,i=new be(r.shape,"return x * x;");return o.runWebGLProgram(i,[r],r.dtype)}},{kernelName:iu,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t,o=r.a,i=r.b,a=n,s=H().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Wr("return (a - b) * (a - b);",o.shape,i.shape):new Ze("return (a - b) * (a - b);",o.shape,i.shape);return a.compileAndRun(s,[o,i])}}];Sf<r0.length;Sf++)Db(r0[Sf]);for(var kf=0,o0=[{kernelName:"Square",gradFunc:function(e,t){var n=t[0];return{x:function(){return e.mul(n.toFloat().mul(2))}}}},{kernelName:iu,gradFunc:function(e,t){var n=t[0],r=t[1],o=ee(2);return{a:function(){return jt(e,jt(o,pt(n,r)))},b:function(){return jt(e,jt(o,pt(r,n)))}}}}];kf<o0.length;kf++)tA(o0[kf]);var iM=function(){function e(){}return e.prototype.fetch=function(t,n){return fetch(t,n)},e.prototype.now=function(){return performance.now()},e.prototype.encode=function(t,n){if(n!=="utf-8"&&n!=="utf8")throw new Error("Browser's encoder only supports utf-8, but got "+n);return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(t)},e.prototype.decode=function(t,n){return new TextDecoder(n).decode(t)},e}();H().get("IS_BROWSER")&&H().setPlatform("browser",new iM);var Rf,aM=function(){return require("node-fetch")},sM=function(){function e(){this.util=require("util"),this.textEncoder=new this.util.TextEncoder}return e.prototype.fetch=function(t,n){return H().global.fetch!=null?H().global.fetch(t,n):(Rf==null&&(Rf=aM()),Rf(t,n))},e.prototype.now=function(){var t=process.hrtime();return 1e3*t[0]+t[1]/1e6},e.prototype.encode=function(t,n){if(n!=="utf-8"&&n!=="utf8")throw new Error("Node built-in encoder only supports utf-8, but got "+n);return this.textEncoder.encode(t)},e.prototype.decode=function(t,n){return t.length===0?"":new this.util.TextDecoder(n).decode(t)},e}();H().get("IS_NODE")&&H().setPlatform("node",new sM);var np={float32:4,int32:4,uint16:2,uint8:1,bool:1},Nc=4;function nC(e,t){for(var n={},r=0,o=function(s){var u=s.name,l=s.dtype,c=s.shape,d=ae(c),f=void 0;if("quantization"in s){var h=s.quantization;if(h.dtype!=="uint8"&&h.dtype!=="uint16")throw new Error("Weight "+s.name+" has unknown quantization dtype "+h.dtype+". Supported quantization dtypes are: 'uint8' and 'uint16'.");var v=np[h.dtype],m=e.slice(r,r+d*v),g=h.dtype==="uint8"?new Uint8Array(m):new Uint16Array(m);if(l==="float32")f=Float32Array.from(g,function(C){return C*h.scale+h.min});else{if(l!=="int32")throw new Error("Unsupported dtype in weight '"+u+"': "+l);f=Int32Array.from(g,function(C){return Math.round(C*h.scale+h.min)})}r+=d*v}else if(l==="string"){var p=ae(s.shape);f=[];for(var y=0;y<p;y++){var x=new Uint32Array(e.slice(r,r+Nc))[0];r+=Nc;var w=new Uint8Array(e.slice(r,r+x));f.push(w),r+=x}}else{var b=np[l];if(m=e.slice(r,r+d*b),l==="float32")f=new Float32Array(m);else if(l==="int32")f=new Int32Array(m);else{if(l!=="bool")throw new Error("Unsupported dtype in weight '"+u+"': "+l);f=new Uint8Array(m)}r+=d*b}n[u]=St(f,c,l)},i=0,a=t;i<a.length;i++)o(a[i]);return n}function uM(e){if(e===null)throw new Error("Invalid input value: "+JSON.stringify(e));var t=0,n=[];e.forEach(function(i){if(t+=i.byteLength,n.push(i.byteLength===i.buffer.byteLength?i:new i.constructor(i)),!(i instanceof Float32Array||i instanceof Int32Array||i instanceof Uint8Array))throw new Error("Unsupported TypedArray subtype: "+i.constructor.name)});var r=new Uint8Array(t),o=0;return n.forEach(function(i){r.set(new Uint8Array(i.buffer),o),o+=i.byteLength}),r.buffer}var rp=typeof Buffer<"u"&&(typeof Blob>"u"||typeof atob>"u"||typeof btoa>"u");function i0(e){return rp?Buffer.byteLength(e):new Blob([e]).size}function Yv(e){var t=0;e.forEach(function(o){t+=o.byteLength});var n=new Uint8Array(t),r=0;return e.forEach(function(o){n.set(new Uint8Array(o),r),r+=o.byteLength}),n.buffer}function a0(e){for(e=e.trim();e.endsWith("/");)e=e.slice(0,e.length-1);var t=e.split("/");return t[t.length-1]}function Su(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:e.modelTopology==null?0:i0(JSON.stringify(e.modelTopology)),weightSpecsBytes:e.weightSpecs==null?0:i0(JSON.stringify(e.weightSpecs)),weightDataBytes:e.weightData==null?0:e.weightData.byteLength}}var yn=function(){function e(){this.saveRouters=[],this.loadRouters=[]}return e.getInstance=function(){return e.instance==null&&(e.instance=new e),e.instance},e.registerSaveRouter=function(t){e.getInstance().saveRouters.push(t)},e.registerLoadRouter=function(t){e.getInstance().loadRouters.push(t)},e.getSaveHandlers=function(t){return e.getHandlers(t,"save")},e.getLoadHandlers=function(t,n){return e.getHandlers(t,"load",n)},e.getHandlers=function(t,n,r){var o=[];return(n==="load"?e.getInstance().loadRouters:e.getInstance().saveRouters).forEach(function(i){var a=i(t,r);a!==null&&o.push(a)}),o},e}(),Ca="://",zo=function(){function e(){this.managers={}}return e.getInstance=function(){return e.instance==null&&(e.instance=new e),e.instance},e.registerManager=function(t,n){I(t!=null,function(){return"scheme must not be undefined or null."}),t.endsWith(Ca)&&(t=t.slice(0,t.indexOf(Ca))),I(t.length>0,function(){return"scheme must not be an empty string."});var r=e.getInstance();I(r.managers[t]==null,function(){return"A model store manager is already registered for scheme '"+t+"'."}),r.managers[t]=n},e.getManager=function(t){var n=this.getInstance().managers[t];if(n==null)throw new Error("Cannot find model manager for scheme '"+t+"'");return n},e.getSchemes=function(){return Object.keys(this.getInstance().managers)},e}();function Al(e){if(e.indexOf(Ca)===-1)throw new Error("The url string provided does not contain a scheme. Supported schemes are: "+zo.getSchemes().join(","));return{scheme:e.split(Ca)[0],path:e.split(Ca)[1]}}function s0(e,t,n){return n===void 0&&(n=!1),oe(this,void 0,void 0,function(){var r,o,i,a,s,u,l,c,d;return ie(this,function(f){switch(f.label){case 0:return I(e!==t,function(){return"Old path and new path are the same: '"+e+"'"}),I((r=yn.getLoadHandlers(e)).length>0,function(){return"Copying failed because no load handler is found for source URL "+e+"."}),I(r.length<2,function(){return"Copying failed because more than one ("+r.length+") load handlers for source URL "+e+"."}),o=r[0],I((i=yn.getSaveHandlers(t)).length>0,function(){return"Copying failed because no save handler is found for destination URL "+t+"."}),I(i.length<2,function(){return"Copying failed because more than one ("+r.length+") save handlers for destination URL "+t+"."}),a=i[0],s=Al(e).scheme,u=Al(e).path,l=s===Al(e).scheme,[4,o.load()];case 1:return c=f.sent(),n&&l?[4,zo.getManager(s).removeModel(u)]:[3,3];case 2:f.sent(),f.label=3;case 3:return[4,a.save(c)];case 4:return d=f.sent(),!n||l?[3,6]:[4,zo.getManager(s).removeModel(u)];case 5:f.sent(),f.label=6;case 6:return[2,d.modelArtifactsInfo]}})})}var vi="models_store",Ao="model_info_store";function rC(){if(!H().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");var e=window||self,t=e.indexedDB||e.mozIndexedDB||e.webkitIndexedDB||e.msIndexedDB||e.shimIndexedDB;if(t==null)throw new Error("The current browser does not appear to support IndexedDB.");return t}function op(e){var t=e.result;t.createObjectStore(vi,{keyPath:"modelPath"}),t.createObjectStore(Ao,{keyPath:"modelPath"})}var Ea=function(){function e(t){if(this.indexedDB=rC(),t==null||!t)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=t}return e.prototype.save=function(t){return oe(this,void 0,void 0,function(){return ie(this,function(n){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return[2,this.databaseAction(this.modelPath,t)]})})},e.prototype.load=function(){return oe(this,void 0,void 0,function(){return ie(this,function(t){return[2,this.databaseAction(this.modelPath)]})})},e.prototype.databaseAction=function(t,n){var r=this;return new Promise(function(o,i){var a=r.indexedDB.open("tensorflowjs",1);a.onupgradeneeded=function(){return op(a)},a.onsuccess=function(){var s=a.result;if(n==null){var u=s.transaction(vi,"readonly"),l=u.objectStore(vi).get(r.modelPath);l.onsuccess=function(){if(l.result==null)return s.close(),i(new Error("Cannot find model with path '"+r.modelPath+"' in IndexedDB."));o(l.result.modelArtifacts)},l.onerror=function(m){return s.close(),i(l.error)},u.oncomplete=function(){return s.close()}}else{var c,d=Su(n),f=s.transaction(Ao,"readwrite"),h=f.objectStore(Ao),v=h.put({modelPath:r.modelPath,modelArtifactsInfo:d});v.onsuccess=function(){var m=(c=s.transaction(vi,"readwrite")).objectStore(vi).put({modelPath:r.modelPath,modelArtifacts:n,modelArtifactsInfo:d});m.onsuccess=function(){return o({modelArtifactsInfo:d})},m.onerror=function(g){var p=(h=f.objectStore(Ao)).delete(r.modelPath);p.onsuccess=function(){return s.close(),i(m.error)},p.onerror=function(y){return s.close(),i(m.error)}}},v.onerror=function(m){return s.close(),i(v.error)},f.oncomplete=function(){c==null?s.close():c.oncomplete=function(){return s.close()}}}},a.onerror=function(s){return i(a.error)}})},e.URL_SCHEME="indexeddb://",e}(),u0=function(e){return H().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(Ea.URL_SCHEME)?(t=e.slice(Ea.URL_SCHEME.length),new Ea(t)):null;var t};yn.registerSaveRouter(u0),yn.registerLoadRouter(u0);var lM=function(){function e(){this.indexedDB=rC()}return e.prototype.listModels=function(){return oe(this,void 0,void 0,function(){var t=this;return ie(this,function(n){return[2,new Promise(function(r,o){var i=t.indexedDB.open("tensorflowjs",1);i.onupgradeneeded=function(){return op(i)},i.onsuccess=function(){var a=i.result,s=a.transaction(Ao,"readonly"),u=s.objectStore(Ao).getAll();u.onsuccess=function(){for(var l={},c=0,d=u.result;c<d.length;c++){var f=d[c];l[f.modelPath]=f.modelArtifactsInfo}r(l)},u.onerror=function(l){return a.close(),o(u.error)},s.oncomplete=function(){return a.close()}},i.onerror=function(a){return o(i.error)}})]})})},e.prototype.removeModel=function(t){return oe(this,void 0,void 0,function(){var n=this;return ie(this,function(r){var o;return t=(o=t).startsWith(Ea.URL_SCHEME)?o.slice(Ea.URL_SCHEME.length):o,[2,new Promise(function(i,a){var s=n.indexedDB.open("tensorflowjs",1);s.onupgradeneeded=function(){return op(s)},s.onsuccess=function(){var u,l=s.result,c=l.transaction(Ao,"readwrite"),d=c.objectStore(Ao),f=d.get(t);f.onsuccess=function(){if(f.result==null)return l.close(),a(new Error("Cannot find model with path '"+t+"' in IndexedDB."));var h=d.delete(t),v=function(){var m=(u=l.transaction(vi,"readwrite")).objectStore(vi).delete(t);m.onsuccess=function(){return i(f.result.modelArtifactsInfo)},m.onerror=function(g){return a(f.error)}};h.onsuccess=v,h.onerror=function(m){return v(),l.close(),a(f.error)}},f.onerror=function(h){return l.close(),a(f.error)},c.oncomplete=function(){u==null?l.close():u.oncomplete=function(){return l.close()}}},s.onerror=function(u){return a(s.error)}})]})})},e}();if(H().getBool("IS_BROWSER"))try{zo.registerManager(Ea.URL_SCHEME,new lM)}catch{}var Vr="/",Qi="tensorflowjs_models",oC="info",cM="model_topology",dM="weight_specs",fM="weight_data",hM="model_metadata";function iC(e){return{info:[Qi,e,oC].join(Vr),topology:[Qi,e,cM].join(Vr),weightSpecs:[Qi,e,dM].join(Vr),weightData:[Qi,e,fM].join(Vr),modelMetadata:[Qi,e,hM].join(Vr)}}function pM(e){var t=e.split(Vr);if(t.length<3)throw new Error("Invalid key format: "+e);return t.slice(1,t.length-1).join(Vr)}var _a=function(){function e(t){if(!H().getBool("IS_BROWSER")||typeof window>"u"||window.localStorage===void 0)throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,t==null||!t)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=t,this.keys=iC(this.modelPath)}return e.prototype.save=function(t){return oe(this,void 0,void 0,function(){var n,r,o;return ie(this,function(i){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");n=JSON.stringify(t.modelTopology),r=JSON.stringify(t.weightSpecs),o=Su(t);try{return this.LS.setItem(this.keys.info,JSON.stringify(o)),this.LS.setItem(this.keys.topology,n),this.LS.setItem(this.keys.weightSpecs,r),this.LS.setItem(this.keys.weightData,function(a){if(rp)return Buffer.from(a).toString("base64");for(var s=new Uint8Array(a),u="",l=0,c=s.length;l<c;l++)u+=String.fromCharCode(s[l]);return btoa(u)}(t.weightData)),this.LS.setItem(this.keys.modelMetadata,JSON.stringify({format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,userDefinedMetadata:t.userDefinedMetadata})),[2,{modelArtifactsInfo:o}]}catch{throw this.LS.removeItem(this.keys.info),this.LS.removeItem(this.keys.topology),this.LS.removeItem(this.keys.weightSpecs),this.LS.removeItem(this.keys.weightData),this.LS.removeItem(this.keys.modelMetadata),new Error("Failed to save model '"+this.modelPath+"' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes="+o.modelTopologyBytes+", weightSpecsBytes="+o.weightSpecsBytes+", weightDataBytes="+o.weightDataBytes+".")}return[2]})})},e.prototype.load=function(){return oe(this,void 0,void 0,function(){var t,n,r,o,i,a,s;return ie(this,function(u){if((t=JSON.parse(this.LS.getItem(this.keys.info)))==null)throw new Error("In local storage, there is no model with name '"+this.modelPath+"'");if(t.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");if(n={},(r=JSON.parse(this.LS.getItem(this.keys.topology)))==null)throw new Error("In local storage, the topology of model '"+this.modelPath+"' is missing.");if(n.modelTopology=r,(o=JSON.parse(this.LS.getItem(this.keys.weightSpecs)))==null)throw new Error("In local storage, the weight specs of model '"+this.modelPath+"' are missing.");if(n.weightSpecs=o,(i=this.LS.getItem(this.keys.modelMetadata))!=null&&(a=JSON.parse(i),n.format=a.format,n.generatedBy=a.generatedBy,n.convertedBy=a.convertedBy,n.userDefinedMetadata=a.userDefinedMetadata),(s=this.LS.getItem(this.keys.weightData))==null)throw new Error("In local storage, the binary weight values of model '"+this.modelPath+"' are missing.");return n.weightData=function(l){if(rp){var c=Buffer.from(l,"base64");return c.buffer.slice(c.byteOffset,c.byteOffset+c.byteLength)}for(var d=atob(l),f=new Uint8Array(d.length),h=0;h<d.length;++h)f.set([d.charCodeAt(h)],h);return f.buffer}(s),[2,n]})})},e.URL_SCHEME="localstorage://",e}(),l0=function(e){return H().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(_a.URL_SCHEME)?(t=e.slice(_a.URL_SCHEME.length),new _a(t)):null;var t};yn.registerSaveRouter(l0),yn.registerLoadRouter(l0);var vM=function(){function e(){I(H().getBool("IS_BROWSER"),function(){return"Current environment is not a web browser"}),I(typeof window>"u"||window.localStorage!==void 0,function(){return"Current browser does not appear to support localStorage"}),this.LS=window.localStorage}return e.prototype.listModels=function(){return oe(this,void 0,void 0,function(){var t,n,r,o,i,a;return ie(this,function(s){for(t={},n=Qi+Vr,r=Vr+oC,o=0;o<this.LS.length;++o)(i=this.LS.key(o)).startsWith(n)&&i.endsWith(r)&&(a=pM(i),t[a]=JSON.parse(this.LS.getItem(i)));return[2,t]})})},e.prototype.removeModel=function(t){return oe(this,void 0,void 0,function(){var n,r;return ie(this,function(o){var i;if(t=(i=t).startsWith(_a.URL_SCHEME)?i.slice(_a.URL_SCHEME.length):i,n=iC(t),this.LS.getItem(n.info)==null)throw new Error("Cannot find model at path '"+t+"'");return r=JSON.parse(this.LS.getItem(n.info)),this.LS.removeItem(n.info),this.LS.removeItem(n.topology),this.LS.removeItem(n.weightSpecs),this.LS.removeItem(n.weightData),[2,r]})})},e}();if(H().getBool("IS_BROWSER"))try{zo.registerManager(_a.URL_SCHEME,new vM)}catch{}var mM="model",gM=".json",yM=".weights.bin";function c0(e){return new Promise(function(t){return setTimeout(t)}).then(e)}var Nf=function(){function e(t){if(!H().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");t.startsWith(e.URL_SCHEME)&&(t=t.slice(e.URL_SCHEME.length)),t!=null&&t.length!==0||(t=mM),this.modelTopologyFileName=t+gM,this.weightDataFileName=t+yM}return e.prototype.save=function(t){return oe(this,void 0,void 0,function(){var n,r,o,i,a,s;return ie(this,function(u){switch(u.label){case 0:if(typeof document>"u")throw new Error("Browser downloads are not supported in this environment since `document` is not present");if(n=window.URL.createObjectURL(new Blob([t.weightData],{type:"application/octet-stream"})),!(t.modelTopology instanceof ArrayBuffer))return[3,1];throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");case 1:return r=[{paths:["./"+this.weightDataFileName],weights:t.weightSpecs}],o={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,weightsManifest:r},i=window.URL.createObjectURL(new Blob([JSON.stringify(o)],{type:"application/json"})),(a=this.jsonAnchor==null?document.createElement("a"):this.jsonAnchor).download=this.modelTopologyFileName,a.href=i,[4,c0(function(){return a.dispatchEvent(new MouseEvent("click"))})];case 2:return u.sent(),t.weightData==null?[3,4]:((s=this.weightDataAnchor==null?document.createElement("a"):this.weightDataAnchor).download=this.weightDataFileName,s.href=n,[4,c0(function(){return s.dispatchEvent(new MouseEvent("click"))})]);case 3:u.sent(),u.label=4;case 4:return[2,{modelArtifactsInfo:Su(t)}]}})})},e.URL_SCHEME="downloads://",e}(),xM=function(){function e(t){if(t==null||t.length<1)throw new Error("When calling browserFiles, at least 1 file is required, but received "+t);this.files=t}return e.prototype.load=function(){return oe(this,void 0,void 0,function(){var t,n,r=this;return ie(this,function(o){return t=this.files[0],n=this.files.slice(1),[2,new Promise(function(i,a){var s=new FileReader;s.onload=function(u){var l=JSON.parse(u.target.result),c=l.modelTopology;if(c!=null){n.length===0&&i({modelTopology:c});var d=l.weightsManifest;if(d!=null){var f;try{f=r.checkManifestAndWeightFiles(d,n)}catch(g){return void a(g)}var h=[],v=[],m=[];d.forEach(function(g){g.paths.forEach(function(p){v.push(p),m.push(null)}),h.push.apply(h,g.weights)}),d.forEach(function(g){g.paths.forEach(function(p){var y=new FileReader;y.onload=function(x){var w=x.target.result,b=v.indexOf(p);m[b]=w,m.indexOf(null)===-1&&i({modelTopology:c,weightSpecs:h,weightData:Yv(m),format:l.format,generatedBy:l.generatedBy,convertedBy:l.convertedBy,userDefinedMetadata:l.userDefinedMetadata})},y.onerror=function(x){return a("Failed to weights data from file of path '"+p+"'.")},y.readAsArrayBuffer(f[p])})})}else a(new Error("weightManifest field is missing from file "+t.name))}else a(new Error("modelTopology field is missing from file "+t.name))},s.onerror=function(u){return a("Failed to read model topology and weights manifest JSON from file '"+t.name+"'. BrowserFiles supports loading Keras-style tf.Model artifacts only.")},s.readAsText(t)})]})})},e.prototype.checkManifestAndWeightFiles=function(t,n){for(var r=[],o=n.map(function(u){return a0(u.name)}),i={},a=0,s=t;a<s.length;a++)s[a].paths.forEach(function(u){var l=a0(u);if(r.indexOf(l)!==-1)throw new Error("Duplicate file basename found in weights manifest: '"+l+"'");if(r.push(l),o.indexOf(l)===-1)throw new Error("Weight file with basename '"+l+"' is not provided.");i[u]=n[o.indexOf(l)]});if(r.length!==n.length)throw new Error("Mismatch in the number of files in weights manifest ("+r.length+") and the number of weight files provided ("+n.length+").");return i},e}();function d0(e,t,n,r){(function(i){I(i!=null&&Array.isArray(i)&&i.length>0,function(){return"promises must be a none empty array"})})(e),function(i,a){I(i>=0&&i<=1,function(){return"Progress fraction must be in range [0, 1], but got startFraction "+i}),I(a>=0&&a<=1,function(){return"Progress fraction must be in range [0, 1], but got endFraction "+a}),I(a>=i,function(){return"startFraction must be no more than endFraction, but got startFraction "+i+" and endFraction "+a})}(n=n??0,r=r??1);var o=0;return Promise.all(e.map(function(i){return i.then(function(a){var s=n+ ++o/e.length*(r-n);return t(s),a}),i}))}function aC(e,t){return oe(this,void 0,void 0,function(){var n,r,o,i,a,s,u,l,c;return ie(this,function(d){switch(d.label){case 0:return t==null&&(t={}),n=t.fetchFunc==null?H().platform.fetch:t.fetchFunc,r=e.map(function(f){return n(f,t.requestInit,{isBinary:!0})}),o=0,i=.5,t.onProgress!=null?[3,2]:[4,Promise.all(r)];case 1:return a=d.sent(),[3,4];case 2:return[4,d0(r,t.onProgress,o,i)];case 3:a=d.sent(),d.label=4;case 4:return s=a.map(function(f){return f.arrayBuffer()}),u=.5,l=1,t.onProgress!=null?[3,6]:[4,Promise.all(s)];case 5:return c=d.sent(),[3,8];case 6:return[4,d0(s,t.onProgress,u,l)];case 7:c=d.sent(),d.label=8;case 8:return[2,c]}})})}function f0(e){var t=this;return function(n,r,o){return r===void 0&&(r=""),oe(t,void 0,void 0,function(){var i,a,s,u,l,c,d,f,h,v;return ie(this,function(m){switch(m.label){case 0:if(i=n.map(function(){return!1}),a={},s=o!=null?o.map(function(){return!1}):[],u=[],n.forEach(function(g,p){var y=0;g.weights.forEach(function(x){var w="quantization"in x?x.quantization.dtype:x.dtype,b=np[w]*ae(x.shape),C=function(){i[p]=!0,a[p]==null&&(a[p]=[]),a[p].push({manifestEntry:x,groupOffset:y,sizeBytes:b})};o!=null?o.forEach(function(E,S){E===x.name&&(C(),s[S]=!0)}):C(),u.push(x.name),y+=b})}),!s.every(function(g){return g}))throw l=o.filter(function(g,p){return!s[p]}),new Error("Could not find weights in manifest with names: "+l.join(", ")+`. 
Manifest JSON has weights with names: `+u.join(", ")+".");return c=i.reduce(function(g,p,y){return p&&g.push(y),g},[]),d=[],c.forEach(function(g){n[g].paths.forEach(function(p){var y=r+(r.endsWith("/")?"":"/")+p;d.push(y)})}),[4,e(d)];case 1:return f=m.sent(),h={},v=0,c.forEach(function(g){for(var p=n[g].paths.length,y=0,x=0;x<p;x++)y+=f[v+x].byteLength;for(var w=new ArrayBuffer(y),b=new Uint8Array(w),C=0,E=0;E<p;E++){var S=new Uint8Array(f[v+E]);b.set(S,C),C+=S.byteLength}a[g].forEach(function(R){var k=nC(w.slice(R.groupOffset,R.groupOffset+R.sizeBytes),[R.manifestEntry]);for(var P in k)h[P]=k[P]}),v+=p}),[2,h]}})})}}yn.registerSaveRouter(function(e){return H().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(Nf.URL_SCHEME)?function(t){return t===void 0&&(t="model"),new Nf(t)}(e.slice(Nf.URL_SCHEME.length)):null});var sC=function(){function e(t,n){if(this.DEFAULT_METHOD="POST",n==null&&(n={}),this.weightPathPrefix=n.weightPathPrefix,this.onProgress=n.onProgress,n.fetchFunc!=null?(I(typeof n.fetchFunc=="function",function(){return"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"}),this.fetch=n.fetchFunc):this.fetch=H().platform.fetch,I(t!=null&&t.length>0,function(){return"URL path for http must not be null, undefined or empty."}),Array.isArray(t)&&I(t.length===2,function(){return"URL paths for http must have a length of 2, (actual length is "+t.length+")."}),this.path=t,n.requestInit!=null&&n.requestInit.body!=null)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=n.requestInit||{}}return e.prototype.save=function(t){return oe(this,void 0,void 0,function(){var n,r,o,i;return ie(this,function(a){switch(a.label){case 0:if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");return(n=Object.assign({method:this.DEFAULT_METHOD},this.requestInit)).body=new FormData,r=[{paths:["./model.weights.bin"],weights:t.weightSpecs}],o={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,userDefinedMetadata:t.userDefinedMetadata,weightsManifest:r},n.body.append("model.json",new Blob([JSON.stringify(o)],{type:"application/json"}),"model.json"),t.weightData!=null&&n.body.append("model.weights.bin",new Blob([t.weightData],{type:"application/octet-stream"}),"model.weights.bin"),[4,this.fetch(this.path,n)];case 1:if((i=a.sent()).ok)return[2,{modelArtifactsInfo:Su(t),responses:[i]}];throw new Error("BrowserHTTPRequest.save() failed due to HTTP response status "+i.status+".")}})})},e.prototype.load=function(){return oe(this,void 0,void 0,function(){var t,n,r,o,i,a,s,u,l,c,d,f;return ie(this,function(h){switch(h.label){case 0:return[4,this.fetch(this.path,this.requestInit)];case 1:if(!(t=h.sent()).ok)throw new Error("Request to "+this.path+" failed with status code "+t.status+". Please verify this URL points to the model JSON of the model to load.");h.label=2;case 2:return h.trys.push([2,4,,5]),[4,t.json()];case 3:return n=h.sent(),[3,5];case 4:throw h.sent(),r="Failed to parse model JSON of response from "+this.path+".",this.path.endsWith(".pb")?r+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":r+=" Please make sure the server is serving valid JSON for this request.",new Error(r);case 5:if(o=n.modelTopology,i=n.weightsManifest,a=n.generatedBy,s=n.convertedBy,u=n.format,l=n.userDefinedMetadata,o==null&&i==null)throw new Error("The JSON from HTTP path "+this.path+" contains neither model topology or manifest for weights.");return i==null?[3,7]:[4,this.loadWeights(i)];case 6:f=h.sent(),c=f[0],d=f[1],h.label=7;case 7:return[2,{modelTopology:o,weightSpecs:c,weightData:d,userDefinedMetadata:l,generatedBy:a,convertedBy:s,format:u}]}})})},e.prototype.loadWeights=function(t){return oe(this,void 0,void 0,function(){var n,r,o,i,a,s,u,l,c,d,f;return ie(this,function(h){switch(h.label){case 0:for(n=Array.isArray(this.path)?this.path[1]:this.path,r=function(v){var m=v.lastIndexOf("/"),g=v.lastIndexOf("?"),p=v.substring(0,m),y=g>m?v.substring(g):"";return[p+"/",y]}(n),o=r[0],i=r[1],a=this.weightPathPrefix||o,s=[],u=0,l=t;u<l.length;u++)c=l[u],s.push.apply(s,c.weights);return d=[],t.forEach(function(v){v.paths.forEach(function(m){d.push(a+m+i)})}),[4,aC(d,{requestInit:this.requestInit,fetchFunc:this.fetch,onProgress:this.onProgress})];case 1:return f=h.sent(),[2,[s,Yv(f)]]}})})},e.URL_SCHEME_REGEX=/^https?:\/\//,e}();function ip(e){return e.match(sC.URL_SCHEME_REGEX)!=null}var h0=function(e,t){return typeof fetch>"u"?null:(Array.isArray(e)?e.every(function(n){return ip(n)}):ip(e))?ap(e,{onProgress:t}):null};function ap(e,t){return new sC(e,t)}yn.registerSaveRouter(h0),yn.registerLoadRouter(h0);var If=function(){function e(t){this.modelArtifacts=t}return e.prototype.load=function(){return oe(this,void 0,void 0,function(){return ie(this,function(t){return[2,this.modelArtifacts]})})},e}(),wM=function(){function e(t){this.saveHandler=t}return e.prototype.save=function(t){return oe(this,void 0,void 0,function(){return ie(this,function(n){return[2,this.saveHandler(t)]})})},e}(),uC=Object.freeze({browserFiles:function(e){return new xM(e)},browserHTTPRequest:function(e,t){return ap(e,t)},concatenateArrayBuffers:Yv,decodeWeights:nC,encodeWeights:function(e,t){return oe(this,void 0,void 0,function(){var n,r,o,i,a,s=this;return ie(this,function(u){switch(u.label){case 0:for(n=[],r=[],o=Array.isArray(e)?e.map(function(l){return l.name}):Object.keys(e),i=function(l){var c=o[l],d=Array.isArray(e)?e[l].tensor:e[c];if(d.dtype!=="float32"&&d.dtype!=="int32"&&d.dtype!=="bool"&&d.dtype!=="string")throw new Error("Unsupported dtype in weight '"+c+"': "+d.dtype);var f={name:c,shape:d.shape,dtype:d.dtype};if(d.dtype==="string"){var h=new Promise(function(v){return oe(s,void 0,void 0,function(){var m,g,p,y,x,w,b;return ie(this,function(C){switch(C.label){case 0:return[4,d.bytes()];case 1:for(m=C.sent(),g=m.reduce(function(E,S){return E+S.length},0)+Nc*m.length,p=new Uint8Array(g),y=0,x=0;x<m.length;x++)w=m[x],b=new Uint8Array(new Uint32Array([w.length]).buffer),p.set(b,y),y+=Nc,p.set(w,y),y+=w.length;return v(p),[2]}})})});r.push(h)}else r.push(d.data());t!=null&&(f.group=t),n.push(f)},a=0;a<o.length;++a)i(a);return[4,Promise.all(r)];case 1:return[2,{data:uM(u.sent()),specs:n}]}})})},fromMemory:function(e,t,n,r){return arguments.length===1?e.modelTopology!=null||e.weightSpecs!=null?new If(e):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new If({modelTopology:e})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new If({modelTopology:e,weightSpecs:t,weightData:n,trainingConfig:r}))},getLoadHandlers:function(e,t){return yn.getLoadHandlers(e,t)},getModelArtifactsInfoForJSON:Su,getSaveHandlers:function(e){return yn.getSaveHandlers(e)},http:ap,isHTTPScheme:ip,loadWeights:function(e,t,n,r){return t===void 0&&(t=""),oe(this,void 0,void 0,function(){return ie(this,function(o){return[2,f0(function(i){return aC(i,{requestInit:r})})(e,t,n)]})})},registerLoadRouter:function(e){return yn.registerLoadRouter(e)},registerSaveRouter:function(e){return yn.registerSaveRouter(e)},weightsLoaderFactory:f0,withSaveHandler:function(e){return new wM(e)},copyModel:function(e,t){return oe(this,void 0,void 0,function(){return ie(this,function(n){return[2,s0(e,t,!1)]})})},listModels:function(){return oe(this,void 0,void 0,function(){var e,t,n,r,o,i,a;return ie(this,function(s){switch(s.label){case 0:e=zo.getSchemes(),t={},n=0,r=e,s.label=1;case 1:return n<r.length?(o=r[n],[4,zo.getManager(o).listModels()]):[3,4];case 2:for(a in i=s.sent())t[o+Ca+a]=i[a];s.label=3;case 3:return n++,[3,1];case 4:return[2,t]}})})},moveModel:function(e,t){return oe(this,void 0,void 0,function(){return ie(this,function(n){return[2,s0(e,t,!0)]})})},removeModel:function(e){return oe(this,void 0,void 0,function(){var t;return ie(this,function(n){return t=Al(e),[2,zo.getManager(t.scheme).removeModel(t.path)]})})}}),Gi;F({confusionMatrix_:function(e,t,n){var r=N(e,"labels","confusionMatrix"),o=N(t,"predictions","confusionMatrix");I(n==null||n>0&&Number.isInteger(n),function(){return"If provided, numClasses must be a positive integer, but got "+n}),I(r.rank===1,function(){return"Expected the rank of labels to be 1, but got "+r.rank}),I(o.rank===1,function(){return"Expected the rank of predictions to be 1, but got "+o.rank}),I(r.shape[0]===o.shape[0],function(){return"Mismatch in the number of examples: "+r.shape[0]+" vs. "+o.shape[0]+". Labels and predictions should have the same number of elements."}),I(n>0&&Number.isInteger(n),function(){return"numClasses is required to be a positive integer, but got "+n});var i=Qh(r.asType("int32"),n),a=Qh(o.asType("int32"),n);return i.transpose().matMul(a).asType("int32")}});var bM=F({fromPixels_:function(e,t){if(t===void 0&&(t=3),t>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(e==null)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");var n=!1,r=!1,o=!1,i=!1,a=!1;if(e.data instanceof Uint8Array)n=!0;else if(typeof ImageData<"u"&&e instanceof ImageData)r=!0;else if(typeof HTMLVideoElement<"u"&&e instanceof HTMLVideoElement)o=!0;else if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement)i=!0;else{if(e.getContext==null)throw new Error("pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was "+e.constructor.name);a=!0}if(o&&o&&e.readyState<2)throw new Error("The video element has not loaded data yet. Please wait for `loadeddata` event on the <video> element.");if(Pb("FromPixels",L.backendName)!=null)return L.runKernel("FromPixels",{pixels:e},{numChannels:t});var s,u,l=o?[e.videoWidth,e.videoHeight]:[e.width,e.height],c=l[0],d=l[1];if(a?s=e.getContext("2d").getImageData(0,0,c,d).data:r||n?s=e.data:(i||o)&&(Gi==null&&(Gi=document.createElement("canvas").getContext("2d")),Gi.canvas.width=c,Gi.canvas.height=d,Gi.drawImage(e,0,0,c,d),s=Gi.getImageData(0,0,c,d).data),t===4)u=new Int32Array(s);else{var f=c*d;u=new Int32Array(f*t);for(var h=0;h<f;h++)for(var v=0;v<t;++v)u[h*t+v]=s[4*h+v]}return Sv(u,[d,c,t],"int32")}}),Qv=Object.freeze({toPixels:function(e,t){return oe(this,void 0,void 0,function(){var n,r,o,i,a,s,u,l,c,d,f,h,v,m,g,p,y,x,w,b,C,E,S;return ie(this,function(R){switch(R.label){case 0:if(n=N(e,"img","toPixels"),e instanceof qe||(n=n.toInt()),n.rank!==2&&n.rank!==3)throw new Error("toPixels only supports rank 2 or 3 tensors, got rank "+n.rank+".");if(r=n.shape.slice(0,2),o=r[0],i=r[1],(a=n.rank===2?1:n.shape[2])>4||a===2)throw new Error("toPixels only supports depth of size 1, 3 or 4 but got "+a);return[4,n.data()];case 1:return s=R.sent(),u=n.min(),l=n.max(),[4,Promise.all([u.data(),l.data()])];case 2:if(c=R.sent(),d=c[0],f=c[1],h=d[0],v=f[0],u.dispose(),l.dispose(),n.dtype==="float32"){if(h<0||v>1)throw new Error("Tensor values for a float32 Tensor must be in the range [0 - 1] but got range ["+h+" - "+v+"].")}else{if(n.dtype!=="int32")throw new Error("Unsupported type for toPixels: "+n.dtype+". Please use float32 or int32 tensors.");if(h<0||v>255)throw new Error("Tensor values for a int32 Tensor must be in the range [0 - 255] but got range ["+h+" - "+v+"].")}for(m=n.dtype==="float32"?255:1,g=new Uint8ClampedArray(i*o*4),p=0;p<o*i;++p)y=void 0,x=void 0,w=void 0,b=void 0,a===1?(y=s[p]*m,x=s[p]*m,w=s[p]*m,b=255):a===3?(y=s[3*p]*m,x=s[3*p+1]*m,w=s[3*p+2]*m,b=255):a===4&&(y=s[4*p]*m,x=s[4*p+1]*m,w=s[4*p+2]*m,b=s[4*p+3]*m),g[(C=4*p)+0]=Math.round(y),g[C+1]=Math.round(x),g[C+2]=Math.round(w),g[C+3]=Math.round(b);return t!=null&&(t.width=i,t.height=o,E=t.getContext("2d"),S=new ImageData(g,i,o),E.putImageData(S,0,0)),n!==e&&n.dispose(),[2,g]}})})},fromPixels:bM}),CM=function(){function e(){}return e.prototype.getClassName=function(){return this.constructor.className},e.fromConfig=function(t,n){return new t(n)},e}(),EM=function(){function e(){this.classNameMap={}}return e.getMap=function(){return e.instance==null&&(e.instance=new e),e.instance},e.register=function(t){e.getMap().classNameMap[t.className]=[t,t.fromConfig]},e}();function Bi(e){I(e.className!=null,function(){return"Class being registered does not have the static className property defined."}),I(typeof e.className=="string",function(){return"className is required to be a string, but got type "+typeof e.className}),I(e.className.length>0,function(){return"Class being registered has an empty-string as its className, which is disallowed."}),EM.register(e)}var ji=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return sr(t,e),t.prototype.minimize=function(n,r,o){r===void 0&&(r=!1);var i=this.computeGradients(n,o),a=i.value,s=i.grads;if(o!=null){var u=o.map(function(l){return{name:l.name,tensor:s[l.name]}});this.applyGradients(u)}else this.applyGradients(s);return an(s),r?a:(a.dispose(),null)},Object.defineProperty(t.prototype,"iterations",{get:function(){return this.iterations_==null&&(this.iterations_=0),this.iterations_},enumerable:!0,configurable:!0}),t.prototype.incrementIterations=function(){this.iterations_=this.iterations+1},t.prototype.computeGradients=function(n,r){return DP(n,r)},t.prototype.dispose=function(){this.iterations_!=null&&an(this.iterations_)},t.prototype.saveIterations=function(){return oe(this,void 0,void 0,function(){return ie(this,function(n){return this.iterations_==null&&(this.iterations_=0),[2,{name:"iter",tensor:ee(this.iterations_,"int32")}]})})},t.prototype.getWeights=function(){return oe(this,void 0,void 0,function(){return ie(this,function(n){throw new Error("getWeights() is not implemented for this optimizer yet.")})})},t.prototype.setWeights=function(n){return oe(this,void 0,void 0,function(){return ie(this,function(r){throw new Error("setWeights() is not implemented for this optimizer class "+this.getClassName())})})},t.prototype.extractIterations=function(n){return oe(this,void 0,void 0,function(){var r;return ie(this,function(o){switch(o.label){case 0:return r=this,[4,n[0].tensor.data()];case 1:return r.iterations_=o.sent()[0],[2,n.slice(1)]}})})},t}(CM);Object.defineProperty(ji,Symbol.hasInstance,{value:function(e){return e.minimize!=null&&e.computeGradients!=null&&e.applyGradients!=null}});var _M=function(e){function t(n,r,o){o===void 0&&(o=null);var i=e.call(this)||this;return i.learningRate=n,i.rho=r,i.epsilon=o,i.accumulatedGrads=[],i.accumulatedUpdates=[],o==null&&(i.epsilon=L.backend.epsilon()),i}return sr(t,e),t.prototype.applyGradients=function(n){var r=this;(Array.isArray(n)?n.map(function(o){return o.name}):Object.keys(n)).forEach(function(o,i){var a=L.registeredVariables[o];r.accumulatedGrads[i]==null&&(r.accumulatedGrads[i]={originalName:o+"/accum_grad",variable:te(function(){return Re(a).variable(!1)})}),r.accumulatedUpdates[i]==null&&(r.accumulatedUpdates[i]={originalName:o+"/accum_var",variable:te(function(){return Re(a).variable(!1)})});var s=Array.isArray(n)?n[i].tensor:n[o];if(s!=null){var u=r.accumulatedGrads[i].variable,l=r.accumulatedUpdates[i].variable;te(function(){var c=u.mul(r.rho).add(s.square().mul(1-r.rho)),d=l.add(r.epsilon).sqrt().div(u.add(r.epsilon).sqrt()).mul(s),f=l.mul(r.rho).add(d.square().mul(1-r.rho));u.assign(c),l.assign(f);var h=d.mul(-r.learningRate).add(a);a.assign(h)})}}),this.incrementIterations()},t.prototype.dispose=function(){this.accumulatedUpdates!=null&&(an(this.accumulatedGrads.map(function(n){return n.variable})),an(this.accumulatedUpdates.map(function(n){return n.variable})))},t.prototype.getWeights=function(){return oe(this,void 0,void 0,function(){var n;return ie(this,function(r){switch(r.label){case 0:return n=this.accumulatedGrads.concat(this.accumulatedUpdates),[4,this.saveIterations()];case 1:return[2,[r.sent()].concat(n.map(function(o){return{name:o.originalName,tensor:o.variable}}))]}})})},t.prototype.setWeights=function(n){return oe(this,void 0,void 0,function(){var r;return ie(this,function(o){switch(o.label){case 0:return[4,this.extractIterations(n)];case 1:return n=o.sent(),r=n.length/2,this.accumulatedGrads=n.slice(0,r).map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}}),this.accumulatedUpdates=n.slice(r,2*r).map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}}),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}},t.fromConfig=function(n,r){return new n(r.learningRate,r.rho,r.epsilon)},t.className="Adadelta",t}(ji);Bi(_M);var SM=function(e){function t(n,r){r===void 0&&(r=.1);var o=e.call(this)||this;return o.learningRate=n,o.initialAccumulatorValue=r,o.accumulatedGrads=[],o}return sr(t,e),t.prototype.applyGradients=function(n){var r=this;(Array.isArray(n)?n.map(function(o){return o.name}):Object.keys(n)).forEach(function(o,i){var a=L.registeredVariables[o];r.accumulatedGrads[i]==null&&(r.accumulatedGrads[i]={originalName:o+"/accumulator",variable:te(function(){return Nr(a.shape,r.initialAccumulatorValue).variable(!1)})});var s=Array.isArray(n)?n[i].tensor:n[o];if(s!=null){var u=r.accumulatedGrads[i].variable;te(function(){var l=u.add(s.square());u.assign(l);var c=s.div(l.add(L.backend.epsilon()).sqrt()).mul(-r.learningRate).add(a);a.assign(c)})}}),this.incrementIterations()},t.prototype.dispose=function(){this.accumulatedGrads!=null&&an(this.accumulatedGrads.map(function(n){return n.variable}))},t.prototype.getWeights=function(){return oe(this,void 0,void 0,function(){return ie(this,function(n){switch(n.label){case 0:return[4,this.saveIterations()];case 1:return[2,[n.sent()].concat(this.accumulatedGrads.map(function(r){return{name:r.originalName,tensor:r.variable}}))]}})})},t.prototype.setWeights=function(n){return oe(this,void 0,void 0,function(){return ie(this,function(r){switch(r.label){case 0:return[4,this.extractIterations(n)];case 1:return n=r.sent(),this.accumulatedGrads=n.map(function(o){return{originalName:o.name,variable:o.tensor.variable(!1)}}),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}},t.fromConfig=function(n,r){return new n(r.learningRate,r.initialAccumulatorValue)},t.className="Adagrad",t}(ji);Bi(SM);var kM=function(e){function t(n,r,o,i){i===void 0&&(i=null);var a=e.call(this)||this;return a.learningRate=n,a.beta1=r,a.beta2=o,a.epsilon=i,a.accumulatedFirstMoment=[],a.accumulatedSecondMoment=[],te(function(){a.accBeta1=ee(r).variable(),a.accBeta2=ee(o).variable()}),i==null&&(a.epsilon=L.backend.epsilon()),a}return sr(t,e),t.prototype.applyGradients=function(n){var r=this,o=Array.isArray(n)?n.map(function(i){return i.name}):Object.keys(n);te(function(){var i=pt(1,r.accBeta1),a=pt(1,r.accBeta2);o.forEach(function(s,u){var l=L.registeredVariables[s];r.accumulatedFirstMoment[u]==null&&(r.accumulatedFirstMoment[u]={originalName:s+"/m",variable:te(function(){return Re(l).variable(!1)})}),r.accumulatedSecondMoment[u]==null&&(r.accumulatedSecondMoment[u]={originalName:s+"/v",variable:te(function(){return Re(l).variable(!1)})});var c=Array.isArray(n)?n[u].tensor:n[s];if(c!=null){var d=r.accumulatedFirstMoment[u].variable,f=r.accumulatedSecondMoment[u].variable,h=d.mul(r.beta1).add(c.mul(1-r.beta1)),v=f.mul(r.beta2).add(c.square().mul(1-r.beta2)),m=h.div(i),g=v.div(a);d.assign(h),f.assign(v);var p=m.div(g.sqrt().add(r.epsilon)).mul(-r.learningRate).add(l);l.assign(p)}}),r.accBeta1.assign(r.accBeta1.mul(r.beta1)),r.accBeta2.assign(r.accBeta2.mul(r.beta2))}),this.incrementIterations()},t.prototype.dispose=function(){this.accBeta1.dispose(),this.accBeta2.dispose(),this.accumulatedFirstMoment!=null&&an(this.accumulatedFirstMoment.map(function(n){return n.variable})),this.accumulatedSecondMoment!=null&&an(this.accumulatedSecondMoment.map(function(n){return n.variable}))},t.prototype.getWeights=function(){return oe(this,void 0,void 0,function(){var n;return ie(this,function(r){switch(r.label){case 0:return n=this.accumulatedFirstMoment.concat(this.accumulatedSecondMoment),[4,this.saveIterations()];case 1:return[2,[r.sent()].concat(n.map(function(o){return{name:o.originalName,tensor:o.variable}}))]}})})},t.prototype.setWeights=function(n){return oe(this,void 0,void 0,function(){var r,o=this;return ie(this,function(i){switch(i.label){case 0:return[4,this.extractIterations(n)];case 1:return n=i.sent(),te(function(){o.accBeta1.assign(kc(o.beta1,o.iterations_+1)),o.accBeta2.assign(kc(o.beta2,o.iterations_+1))}),r=n.length/2,this.accumulatedFirstMoment=n.slice(0,r).map(function(a){return{originalName:a.name,variable:a.tensor.variable(!1)}}),this.accumulatedSecondMoment=n.slice(r,2*r).map(function(a){return{originalName:a.name,variable:a.tensor.variable(!1)}}),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}},t.fromConfig=function(n,r){return new n(r.learningRate,r.beta1,r.beta2,r.epsilon)},t.className="Adam",t}(ji);Bi(kM);var RM=function(e){function t(n,r,o,i,a){i===void 0&&(i=null),a===void 0&&(a=0);var s=e.call(this)||this;return s.learningRate=n,s.beta1=r,s.beta2=o,s.epsilon=i,s.decay=a,s.accumulatedFirstMoment=[],s.accumulatedWeightedInfNorm=[],te(function(){s.iteration=ee(0).variable(),s.accBeta1=ee(r).variable()}),i==null&&(s.epsilon=L.backend.epsilon()),s}return sr(t,e),t.prototype.applyGradients=function(n){var r=this,o=Array.isArray(n)?n.map(function(i){return i.name}):Object.keys(n);te(function(){var i=pt(1,r.accBeta1),a=Jn(-r.learningRate,r.iteration.mul(r.decay).add(1));o.forEach(function(s,u){var l=L.registeredVariables[s];r.accumulatedFirstMoment[u]==null&&(r.accumulatedFirstMoment[u]={originalName:s+"/m",variable:Re(l).variable(!1)}),r.accumulatedWeightedInfNorm[u]==null&&(r.accumulatedWeightedInfNorm[u]={originalName:s+"/v",variable:Re(l).variable(!1)});var c=Array.isArray(n)?n[u].tensor:n[s];if(c!=null){var d=r.accumulatedFirstMoment[u].variable,f=r.accumulatedWeightedInfNorm[u].variable,h=d.mul(r.beta1).add(c.mul(1-r.beta1)),v=f.mul(r.beta2),m=c.abs(),g=v.maximum(m);d.assign(h),f.assign(g);var p=a.div(i).mul(h.div(g.add(r.epsilon))).add(l);l.assign(p)}}),r.iteration.assign(r.iteration.add(1)),r.accBeta1.assign(r.accBeta1.mul(r.beta1))}),this.incrementIterations()},t.prototype.dispose=function(){this.accBeta1.dispose(),this.iteration.dispose(),this.accumulatedFirstMoment!=null&&an(this.accumulatedFirstMoment.map(function(n){return n.variable})),this.accumulatedWeightedInfNorm!=null&&an(this.accumulatedWeightedInfNorm.map(function(n){return n.variable}))},t.prototype.getWeights=function(){return oe(this,void 0,void 0,function(){return ie(this,function(n){throw new Error("getWeights() is not implemented for Adamax yet.")})})},t.prototype.setWeights=function(n){return oe(this,void 0,void 0,function(){return ie(this,function(r){throw new Error("setWeights() is not implemented for Adamax yet.")})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}},t.fromConfig=function(n,r){return new n(r.learningRate,r.beta1,r.beta2,r.epsilon,r.decay)},t.className="Adamax",t}(ji);Bi(RM);var lC=function(e){function t(n){var r=e.call(this)||this;return r.learningRate=n,r.setLearningRate(n),r}return sr(t,e),t.prototype.applyGradients=function(n){var r=this;(Array.isArray(n)?n.map(function(o){return o.name}):Object.keys(n)).forEach(function(o,i){var a=Array.isArray(n)?n[i].tensor:n[o];if(a!=null){var s=L.registeredVariables[o];te(function(){var u=r.c.mul(a).add(s);s.assign(u)})}}),this.incrementIterations()},t.prototype.setLearningRate=function(n){this.learningRate=n,this.c!=null&&this.c.dispose(),this.c=qA(ee(-n))},t.prototype.dispose=function(){this.c.dispose()},t.prototype.getWeights=function(){return oe(this,void 0,void 0,function(){return ie(this,function(n){switch(n.label){case 0:return[4,this.saveIterations()];case 1:return[2,[n.sent()]]}})})},t.prototype.setWeights=function(n){return oe(this,void 0,void 0,function(){return ie(this,function(r){switch(r.label){case 0:return[4,this.extractIterations(n)];case 1:if((n=r.sent()).length!==0)throw new Error("SGD optimizer does not have settable weights.");return[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate}},t.fromConfig=function(n,r){return new n(r.learningRate)},t.className="SGD",t}(ji);Bi(lC);var NM=function(e){function t(n,r,o){o===void 0&&(o=!1);var i=e.call(this,n)||this;return i.learningRate=n,i.momentum=r,i.useNesterov=o,i.accumulations=[],i.m=ee(i.momentum),i}return sr(t,e),t.prototype.applyGradients=function(n){var r=this;(Array.isArray(n)?n.map(function(o){return o.name}):Object.keys(n)).forEach(function(o,i){var a=L.registeredVariables[o];r.accumulations[i]==null&&(r.accumulations[i]={originalName:o+"/momentum",variable:te(function(){return Re(a).variable(!1)})});var s=r.accumulations[i].variable,u=Array.isArray(n)?n[i].tensor:n[o];u!=null&&te(function(){var l,c=r.m.mul(s).add(u);l=r.useNesterov?r.c.mul(u.add(c.mul(r.m))).add(a):r.c.mul(c).add(a),s.assign(c),a.assign(l)})}),this.incrementIterations()},t.prototype.dispose=function(){this.m.dispose(),this.accumulations!=null&&an(this.accumulations.map(function(n){return n.variable}))},t.prototype.setMomentum=function(n){this.momentum=n},t.prototype.getWeights=function(){return oe(this,void 0,void 0,function(){return ie(this,function(n){switch(n.label){case 0:return[4,this.saveIterations()];case 1:return[2,[n.sent()].concat(this.accumulations.map(function(r){return{name:r.originalName,tensor:r.variable}}))]}})})},t.prototype.setWeights=function(n){return oe(this,void 0,void 0,function(){return ie(this,function(r){switch(r.label){case 0:return[4,this.extractIterations(n)];case 1:return n=r.sent(),this.accumulations=n.map(function(o){return{originalName:o.name,variable:o.tensor.variable(!1)}}),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}},t.fromConfig=function(n,r){return new n(r.learningRate,r.momentum,r.useNesterov)},t.className="Momentum",t}(lC);Bi(NM);var IM=function(e){function t(n,r,o,i,a){r===void 0&&(r=.9),o===void 0&&(o=0),i===void 0&&(i=null),a===void 0&&(a=!1);var s=e.call(this)||this;if(s.learningRate=n,s.decay=r,s.momentum=o,s.epsilon=i,s.accumulatedMeanSquares=[],s.accumulatedMoments=[],s.accumulatedMeanGrads=[],s.centered=a,i==null&&(s.epsilon=L.backend.epsilon()),n==null)throw new Error("learningRate for RMSPropOptimizer must be defined.");return s}return sr(t,e),t.prototype.applyGradients=function(n){var r=this;(Array.isArray(n)?n.map(function(o){return o.name}):Object.keys(n)).forEach(function(o,i){var a=L.registeredVariables[o];r.accumulatedMeanSquares[i]==null&&(r.accumulatedMeanSquares[i]={originalName:o+"/rms",variable:te(function(){return Re(a).variable(!1)})}),r.accumulatedMoments[i]==null&&(r.accumulatedMoments[i]={originalName:o+"/momentum",variable:te(function(){return Re(a).variable(!1)})}),r.accumulatedMeanGrads[i]==null&&r.centered&&(r.accumulatedMeanGrads[i]={originalName:o+"/mg",variable:te(function(){return Re(a).variable(!1)})});var s=Array.isArray(n)?n[i].tensor:n[o];if(s!=null){var u=r.accumulatedMeanSquares[i].variable,l=r.accumulatedMoments[i].variable;te(function(){var c=u.mul(r.decay).add(s.square().mul(1-r.decay));if(r.centered){var d=r.accumulatedMeanGrads[i].variable,f=d.mul(r.decay).add(s.mul(1-r.decay)),h=l.mul(r.momentum).add(s.mul(r.learningRate).div(c.sub(f.square().add(r.epsilon)).sqrt()));u.assign(c),d.assign(f),l.assign(h);var v=a.sub(h);a.assign(v)}else{var m=u.mul(r.decay).add(s.square().mul(1-r.decay));h=l.mul(r.momentum).add(s.mul(r.learningRate).div(m.add(r.epsilon).sqrt())),u.assign(m),l.assign(h),v=a.sub(h),a.assign(v)}})}}),this.incrementIterations()},t.prototype.dispose=function(){this.accumulatedMeanSquares!=null&&an(this.accumulatedMeanSquares.map(function(n){return n.variable})),this.accumulatedMeanGrads!=null&&this.centered&&an(this.accumulatedMeanGrads.map(function(n){return n.variable})),this.accumulatedMoments!=null&&an(this.accumulatedMoments.map(function(n){return n.variable}))},t.prototype.getWeights=function(){return oe(this,void 0,void 0,function(){var n;return ie(this,function(r){switch(r.label){case 0:return n=this.accumulatedMeanSquares.concat(this.accumulatedMoments),this.centered&&n.push.apply(n,this.accumulatedMeanGrads),[4,this.saveIterations()];case 1:return[2,[r.sent()].concat(n.map(function(o){return{name:o.originalName,tensor:o.variable}}))]}})})},t.prototype.setWeights=function(n){return oe(this,void 0,void 0,function(){var r;return ie(this,function(o){switch(o.label){case 0:return[4,this.extractIterations(n)];case 1:return n=o.sent(),r=this.centered?n.length/3:n.length/2,this.accumulatedMeanSquares=n.slice(0,r).map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}}),this.accumulatedMoments=n.slice(r,2*r).map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}}),this.centered&&(this.accumulatedMeanGrads=n.slice(2*r,3*r).map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}})),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}},t.fromConfig=function(n,r){return new n(r.learningRate,r.decay,r.momentum,r.epsilon,r.centered)},t.className="RMSProp",t}(ji);Bi(IM);qe.prototype.squaredDifference=function(e){return _2(this,e)},V=tM;/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var sp=function(e,t){return sp=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var o in r)r.hasOwnProperty(o)&&(n[o]=r[o])},sp(e,t)};function he(e,t){sp(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}var Ot=function(){return Ot=Object.assign||function(t){for(var n,r=1,o=arguments.length;r<o;r++){n=arguments[r];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},Ot.apply(this,arguments)};function le(e,t,n,r){function o(i){return i instanceof n?i:new n(function(a){a(i)})}return new(n||(n=Promise))(function(i,a){function s(c){try{l(r.next(c))}catch(d){a(d)}}function u(c){try{l(r.throw(c))}catch(d){a(d)}}function l(c){c.done?i(c.value):o(c.value).then(s,u)}l((r=r.apply(e,[])).next())})}function ce(e,t){var n={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},r,o,i,a;return a={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function s(l){return function(c){return u([l,c])}}function u(l){if(r)throw new TypeError("Generator is already executing.");for(;n;)try{if(r=1,o&&(i=l[0]&2?o.return:l[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,l[1])).done)return i;switch(o=0,i&&(l=[l[0]&2,i.value]),l[0]){case 0:case 1:i=l;break;case 4:return n.label++,{value:l[1],done:!1};case 5:n.label++,o=l[1],l=[0];continue;case 7:l=n.ops.pop(),n.trys.pop();continue;default:if(i=n.trys,!(i=i.length>0&&i[i.length-1])&&(l[0]===6||l[0]===2)){n=0;continue}if(l[0]===3&&(!i||l[1]>i[0]&&l[1]<i[3])){n.label=l[1];break}if(l[0]===6&&n.label<i[1]){n.label=i[1],i=l;break}if(i&&n.label<i[2]){n.label=i[2],n.ops.push(l);break}i[2]&&n.ops.pop(),n.trys.pop();continue}l=t.call(e,n)}catch(c){l=[6,c],o=0}finally{r=i=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}function Ds(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;for(var r=Array(e),o=0,t=0;t<n;t++)for(var i=arguments[t],a=0,s=i.length;a<s;a++,o++)r[o]=i[a];return r}var Sa=function(){function e(t,n){if(!_i(t)||!_i(n))throw new Error("Dimensions.constructor - expected width and height to be valid numbers, instead have "+JSON.stringify({width:t,height:n}));this._width=t,this._height=n}return Object.defineProperty(e.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),e.prototype.reverse=function(){return new e(1/this.width,1/this.height)},e}();function gd(e,t){return e instanceof qe&&e.shape.length===t}function TM(e){return gd(e,2)}function yd(e){return gd(e,3)}function Uo(e){return gd(e,4)}function AM(e){return e%1!==0}function p0(e){return e%2===0}function PM(e,t){t===void 0&&(t=2);var n=Math.pow(10,t);return Math.floor(e*n)/n}function v0(e){return e&&e.width&&e.height}function DM(e,t){var n=e.width,r=e.height,o=t/Math.max(r,n);return new Sa(Math.round(n*o),Math.round(r*o))}function Jv(e){return e.reduce(function(t,n){return t.add(n)},new Te(0,0)).div(new Te(e.length,e.length))}function au(e,t,n){return Array(e).fill(0).map(function(r,o){return t+o*n})}function _i(e){return!!e&&e!==1/0&&e!==-1/0&&!isNaN(e)||e===0}function m0(e){return _i(e)&&0<=e&&e<=1}var Te=function(){function e(t,n){this._x=t,this._y=n}return Object.defineProperty(e.prototype,"x",{get:function(){return this._x},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this._y},enumerable:!0,configurable:!0}),e.prototype.add=function(t){return new e(this.x+t.x,this.y+t.y)},e.prototype.sub=function(t){return new e(this.x-t.x,this.y-t.y)},e.prototype.mul=function(t){return new e(this.x*t.x,this.y*t.y)},e.prototype.div=function(t){return new e(this.x/t.x,this.y/t.y)},e.prototype.abs=function(){return new e(Math.abs(this.x),Math.abs(this.y))},e.prototype.magnitude=function(){return Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2))},e.prototype.floor=function(){return new e(Math.floor(this.x),Math.floor(this.y))},e}(),Yo=function(){function e(t,n){n===void 0&&(n=!0);var r=t||{},o=[r.left,r.top,r.right,r.bottom].every(_i),i=[r.x,r.y,r.width,r.height].every(_i);if(!i&&!o)throw new Error("Box.constructor - expected box to be IBoundingBox | IRect, instead have "+JSON.stringify(r));var a=i?[r.x,r.y,r.width,r.height]:[r.left,r.top,r.right-r.left,r.bottom-r.top],s=a[0],u=a[1],l=a[2],c=a[3];e.assertIsValidBox({x:s,y:u,width:l,height:c},"Box.constructor",n),this._x=s,this._y=u,this._width=l,this._height=c}return e.isRect=function(t){return!!t&&[t.x,t.y,t.width,t.height].every(_i)},e.assertIsValidBox=function(t,n,r){if(r===void 0&&(r=!1),!e.isRect(t))throw new Error(n+" - invalid box: "+JSON.stringify(t)+", expected object with properties x, y, width, height");if(!r&&(t.width<0||t.height<0))throw new Error(n+" - width ("+t.width+") and height ("+t.height+") must be positive numbers")},Object.defineProperty(e.prototype,"x",{get:function(){return this._x},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this._y},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"left",{get:function(){return this.x},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"top",{get:function(){return this.y},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"right",{get:function(){return this.x+this.width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"area",{get:function(){return this.width*this.height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"topLeft",{get:function(){return new Te(this.left,this.top)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"topRight",{get:function(){return new Te(this.right,this.top)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottomLeft",{get:function(){return new Te(this.left,this.bottom)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottomRight",{get:function(){return new Te(this.right,this.bottom)},enumerable:!0,configurable:!0}),e.prototype.round=function(){var t=[this.x,this.y,this.width,this.height].map(function(a){return Math.round(a)}),n=t[0],r=t[1],o=t[2],i=t[3];return new e({x:n,y:r,width:o,height:i})},e.prototype.floor=function(){var t=[this.x,this.y,this.width,this.height].map(function(a){return Math.floor(a)}),n=t[0],r=t[1],o=t[2],i=t[3];return new e({x:n,y:r,width:o,height:i})},e.prototype.toSquare=function(){var t=this,n=t.x,r=t.y,o=t.width,i=t.height,a=Math.abs(o-i);return o<i&&(n-=a/2,o+=a),i<o&&(r-=a/2,i+=a),new e({x:n,y:r,width:o,height:i})},e.prototype.rescale=function(t){var n=v0(t)?t.width:t,r=v0(t)?t.height:t;return new e({x:this.x*n,y:this.y*r,width:this.width*n,height:this.height*r})},e.prototype.pad=function(t,n){var r=[this.x-t/2,this.y-n/2,this.width+t,this.height+n],o=r[0],i=r[1],a=r[2],s=r[3];return new e({x:o,y:i,width:a,height:s})},e.prototype.clipAtImageBorders=function(t,n){var r=this,o=r.x,i=r.y,a=r.right,s=r.bottom,u=Math.max(o,0),l=Math.max(i,0),c=a-u,d=s-l,f=Math.min(c,t-u),h=Math.min(d,n-l);return new e({x:u,y:l,width:f,height:h}).floor()},e.prototype.shift=function(t,n){var r=this,o=r.width,i=r.height,a=this.x+t,s=this.y+n;return new e({x:a,y:s,width:o,height:i})},e.prototype.padAtBorders=function(t,n){var r=this.width+1,o=this.height+1,i=1,a=1,s=r,u=o,l=this.left,c=this.top,d=this.right,f=this.bottom;return d>n&&(s=-d+n+r,d=n),f>t&&(u=-f+t+o,f=t),l<1&&(u=2-l,l=1),c<1&&(u=2-c,c=1),{dy:a,edy:u,dx:i,edx:s,y:c,ey:f,x:l,ex:d,w:r,h:o}},e.prototype.calibrate=function(t){return new e({left:this.left+t.left*this.width,top:this.top+t.top*this.height,right:this.right+t.right*this.width,bottom:this.bottom+t.bottom*this.height}).toSquare().round()},e}(),xd=function(e){he(t,e);function t(n,r,o,i,a){return a===void 0&&(a=!1),e.call(this,{left:n,top:r,right:o,bottom:i},a)||this}return t}(Yo),cC=function(){function e(t,n,r,o,i){this._imageDims=new Sa(i.width,i.height),this._score=t,this._classScore=n,this._className=r,this._box=new Yo(o).rescale(this._imageDims)}return Object.defineProperty(e.prototype,"score",{get:function(){return this._score},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"classScore",{get:function(){return this._classScore},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"className",{get:function(){return this._className},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"box",{get:function(){return this._box},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"imageDims",{get:function(){return this._imageDims},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"imageWidth",{get:function(){return this.imageDims.width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"imageHeight",{get:function(){return this.imageDims.height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"relativeBox",{get:function(){return new Yo(this._box).rescale(this.imageDims.reverse())},enumerable:!0,configurable:!0}),e.prototype.forSize=function(t,n){return new e(this.score,this.classScore,this.className,this.relativeBox,{width:t,height:n})},e}(),Mr=function(e){he(t,e);function t(n,r,o){return e.call(this,n,n,"",r,o)||this}return t.prototype.forSize=function(n,r){var o=e.prototype.forSize.call(this,n,r),i=o.score,a=o.relativeBox,s=o.imageDims;return new t(i,a,s)},t}(cC);function FM(e,t,n){n===void 0&&(n=!0);var r=Math.max(0,Math.min(e.right,t.right)-Math.max(e.left,t.left)),o=Math.max(0,Math.min(e.bottom,t.bottom)-Math.max(e.top,t.top)),i=r*o;return n?i/(e.area+t.area-i):i/Math.min(e.area,t.area)}function MM(e){var t=e.map(function(s){return s.x}),n=e.map(function(s){return s.y}),r=t.reduce(function(s,u){return u<s?u:s},1/0),o=n.reduce(function(s,u){return u<s?u:s},1/0),i=t.reduce(function(s,u){return s<u?u:s},0),a=n.reduce(function(s,u){return s<u?u:s},0);return new xd(r,o,i,a)}function su(e,t,n,r){r===void 0&&(r=!0);for(var o=t.map(function(s,u){return{score:s,boxIndex:u}}).sort(function(s,u){return s.score-u.score}).map(function(s){return s.boxIndex}),i=[],a=function(){var s=o.pop();i.push(s);for(var u=o,l=[],c=0;c<u.length;c++){var d=u[c],f=e[s],h=e[d];l.push(FM(f,h,r))}o=o.filter(function(v,m){return l[m]<=n})};o.length>0;)a();return i}function ku(e,t){return te(function(){var n=t[0],r=t[1],o=t[2],i=Nr(Ds(e.shape.slice(0,3),[1]),n),a=Nr(Ds(e.shape.slice(0,3),[1]),r),s=Nr(Ds(e.shape.slice(0,3),[1]),o),u=dt([i,a,s],3);return pt(e,u)})}function OM(e,t){return t===void 0&&(t=!1),te(function(){var n=e.shape.slice(1),r=n[0],o=n[1];if(r===o)return e;var i=Math.abs(r-o),a=Math.round(i*(t?.5:1)),s=r>o?2:1,u=function(h){var v=e.shape.slice();return v[s]=h,Nr(v,0)},l=u(a),c=i-l.shape[s],d=t&&c?u(c):null,f=[d,e,l].filter(function(h){return!!h}).map(function(h){return h.toFloat()});return dt(f,s)})}function Tf(e){return 1/(1+Math.exp(-e))}var Zv=function(e){he(t,e);function t(n,r,o,i,a){return a===void 0&&(a=!1),e.call(this,{x:n,y:r,width:o,height:i},a)||this}return t}(Yo),LM=.5,BM=.43,jM=.45,Ic=function(){function e(t,n,r){r===void 0&&(r=new Te(0,0));var o=n.width,i=n.height;this._imgDims=new Sa(o,i),this._shift=r,this._positions=t.map(function(a){return a.mul(new Te(o,i)).add(r)})}return Object.defineProperty(e.prototype,"shift",{get:function(){return new Te(this._shift.x,this._shift.y)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"imageWidth",{get:function(){return this._imgDims.width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"imageHeight",{get:function(){return this._imgDims.height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"positions",{get:function(){return this._positions},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"relativePositions",{get:function(){var t=this;return this._positions.map(function(n){return n.sub(t._shift).div(new Te(t.imageWidth,t.imageHeight))})},enumerable:!0,configurable:!0}),e.prototype.forSize=function(t,n){return new this.constructor(this.relativePositions,{width:t,height:n})},e.prototype.shiftBy=function(t,n){return new this.constructor(this.relativePositions,this._imgDims,new Te(t,n))},e.prototype.shiftByPoint=function(t){return this.shiftBy(t.x,t.y)},e.prototype.align=function(t,n){if(n===void 0&&(n={}),t){var r=t instanceof Mr?t.box.floor():new Yo(t);return this.shiftBy(r.x,r.y).align(null,n)}var o=Object.assign({},{useDlibAlignment:!1,minBoxPadding:.2},n),i=o.useDlibAlignment,a=o.minBoxPadding;return i?this.alignDlib():this.alignMinBbox(a)},e.prototype.alignDlib=function(){var t=this.getRefPointsForAlignment(),n=t[0],r=t[1],o=t[2],i=function(d){return o.sub(d).magnitude()},a=(i(n)+i(r))/2,s=Math.floor(a/jM),u=Jv(t),l=Math.floor(Math.max(0,u.x-LM*s)),c=Math.floor(Math.max(0,u.y-BM*s));return new Zv(l,c,Math.min(s,this.imageWidth+l),Math.min(s,this.imageHeight+c))},e.prototype.alignMinBbox=function(t){var n=MM(this.positions);return n.pad(n.width*t,n.height*t)},e.prototype.getRefPointsForAlignment=function(){throw new Error("getRefPointsForAlignment not implemented by base class")},e}(),WM=function(e){he(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.getRefPointsForAlignment=function(){var n=this.positions;return[n[0],n[1],Jv([n[3],n[4]])]},t}(Ic),zM=function(e){he(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.getJawOutline=function(){return this.positions.slice(0,17)},t.prototype.getLeftEyeBrow=function(){return this.positions.slice(17,22)},t.prototype.getRightEyeBrow=function(){return this.positions.slice(22,27)},t.prototype.getNose=function(){return this.positions.slice(27,36)},t.prototype.getLeftEye=function(){return this.positions.slice(36,42)},t.prototype.getRightEye=function(){return this.positions.slice(42,48)},t.prototype.getMouth=function(){return this.positions.slice(48,68)},t.prototype.getRefPointsForAlignment=function(){return[this.getLeftEye(),this.getRightEye(),this.getMouth()].map(Jv)},t}(Ic),g0=function(){function e(t,n){this._label=t,this._distance=n}return Object.defineProperty(e.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"distance",{get:function(){return this._distance},enumerable:!0,configurable:!0}),e.prototype.toString=function(t){return t===void 0&&(t=!0),""+this.label+(t?" ("+PM(this.distance)+")":"")},e}(),y0=function(e){he(t,e);function t(n,r){var o=e.call(this,n)||this;return o._label=r,o}return t.assertIsValidLabeledBox=function(n,r){if(Yo.assertIsValidBox(n,r),!_i(n.label))throw new Error(r+" - expected property label ("+n.label+") to be a number")},Object.defineProperty(t.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),t}(Yo),ul=function(){function e(t,n){if(typeof t!="string")throw new Error("LabeledFaceDescriptors - constructor expected label to be a string");if(!Array.isArray(n)||n.some(function(r){return!(r instanceof Float32Array)}))throw new Error("LabeledFaceDescriptors - constructor expected descriptors to be an array of Float32Array");this._label=t,this._descriptors=n}return Object.defineProperty(e.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"descriptors",{get:function(){return this._descriptors},enumerable:!0,configurable:!0}),e.prototype.toJSON=function(){return{label:this.label,descriptors:this.descriptors.map(function(t){return Array.from(t)})}},e.fromJSON=function(t){var n=t.descriptors.map(function(r){return new Float32Array(r)});return new e(t.label,n)},e}();(function(e){he(t,e);function t(n,r,o,i){var a=e.call(this,n,r)||this;return a._score=o,a._classScore=i,a}return t.assertIsValidPredictedBox=function(n,r){if(y0.assertIsValidLabeledBox(n,r),!m0(n.score)||!m0(n.classScore))throw new Error(r+" - expected properties score ("+n.score+") and ("+n.classScore+") to be a number between [0, 1]")},Object.defineProperty(t.prototype,"score",{get:function(){return this._score},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"classScore",{get:function(){return this._classScore},enumerable:!0,configurable:!0}),t})(y0);function UM(e){return e.detection instanceof Mr}function em(e,t){var n={detection:t};return Object.assign({},e,n)}function dC(){var e=window.fetch||function(){throw new Error("fetch - missing fetch implementation for browser environment")},t=function(){throw new Error("readFile - filesystem not available for browser environment")};return{Canvas:HTMLCanvasElement,CanvasRenderingContext2D,Image:HTMLImageElement,ImageData,Video:HTMLVideoElement,createCanvasElement:function(){return document.createElement("canvas")},createImageElement:function(){return document.createElement("img")},fetch:e,readFile:t}}function fC(e){var t="";if(!e)try{e=require("fs")}catch(r){t=r.toString()}var n=e?function(r){return new Promise(function(o,i){e.readFile(r,function(a,s){return a?i(a):o(s)})})}:function(){throw new Error("readFile - failed to require fs in nodejs environment with error: "+t)};return{readFile:n}}function hC(){var e=global.Canvas||global.HTMLCanvasElement,t=global.Image||global.HTMLImageElement,n=function(){if(e)return new e;throw new Error("createCanvasElement - missing Canvas implementation for nodejs environment")},r=function(){if(t)return new t;throw new Error("createImageElement - missing Image implementation for nodejs environment")},o=global.fetch||function(){throw new Error("fetch - missing fetch implementation for nodejs environment")},i=fC();return Ot({Canvas:e||function(){function a(){}return a}(),CanvasRenderingContext2D:global.CanvasRenderingContext2D||function(){function a(){}return a}(),Image:t||function(){function a(){}return a}(),ImageData:global.ImageData||function(){function a(){}return a}(),Video:global.HTMLVideoElement||function(){function a(){}return a}(),createCanvasElement:n,createImageElement:r,fetch:o},i)}function pC(){return typeof window=="object"&&typeof document<"u"&&typeof HTMLImageElement<"u"&&typeof HTMLCanvasElement<"u"&&typeof HTMLVideoElement<"u"&&typeof ImageData<"u"&&typeof CanvasRenderingContext2D<"u"}function vC(){return typeof global=="object"&&typeof require=="function"&&typeof GC<"u"&&typeof process<"u"&&!!process.version}var st;function $M(){if(!st)throw new Error("getEnv - environment is not defined, check isNodejs() and isBrowser()");return st}function up(e){st=e}function tm(){pC()&&up(dC()),vC()&&up(hC())}function VM(e){if(st||tm(),!st)throw new Error("monkeyPatch - environment is not defined, check isNodejs() and isBrowser()");var t=e.Canvas,n=t===void 0?st.Canvas:t,r=e.Image,o=r===void 0?st.Image:r;st.Canvas=n,st.Image=o,st.createCanvasElement=e.createCanvasElement||function(){return new n},st.createImageElement=e.createImageElement||function(){return new o},st.ImageData=e.ImageData||st.ImageData,st.Video=e.Video||st.Video,st.fetch=e.fetch||st.fetch,st.readFile=e.readFile||st.readFile}var zt={getEnv:$M,setEnv:up,initialize:tm,createBrowserEnv:dC,createFileSystem:fC,createNodejsEnv:hC,monkeyPatch:VM,isBrowser:pC,isNodejs:vC};tm();function mC(e){return!zt.isNodejs()&&typeof e=="string"?document.getElementById(e):e}function Pi(e){var t=zt.getEnv(),n=t.Canvas,r=t.CanvasRenderingContext2D;if(e instanceof r)return e;var o=mC(e);if(!(o instanceof n))throw new Error("resolveContext2d - expected canvas to be of instance of Canvas");var i=o.getContext("2d");if(!i)throw new Error("resolveContext2d - canvas 2d context is null");return i}var x0;(function(e){e.TOP_LEFT="TOP_LEFT",e.TOP_RIGHT="TOP_RIGHT",e.BOTTOM_LEFT="BOTTOM_LEFT",e.BOTTOM_RIGHT="BOTTOM_RIGHT"})(x0||(x0={}));function gC(e){var t=zt.getEnv(),n=t.Image,r=t.Video;return e instanceof n&&e.complete||e instanceof r&&e.readyState>=3}function HM(e){return new Promise(function(t,n){if(e instanceof zt.getEnv().Canvas||gC(e))return t();function r(i){i.currentTarget&&(i.currentTarget.removeEventListener("load",r),i.currentTarget.removeEventListener("error",o),t(i))}function o(i){i.currentTarget&&(i.currentTarget.removeEventListener("load",r),i.currentTarget.removeEventListener("error",o),n(i))}e.addEventListener("load",r),e.addEventListener("error",o)})}function yC(e){var t=zt.getEnv(),n=t.Image,r=t.Video;return e instanceof n?new Sa(e.naturalWidth,e.naturalHeight):e instanceof r?new Sa(e.videoWidth,e.videoHeight):new Sa(e.width,e.height)}function wd(e){var t=e.width,n=e.height,r=zt.getEnv().createCanvasElement,o=r();return o.width=t,o.height=n,o}function nm(e,t){var n=zt.getEnv().ImageData;if(!(e instanceof n)&&!gC(e))throw new Error("createCanvasFromMedia - media has not finished loading yet");var r=yC(e),o=r.width,i=r.height,a=wd({width:o,height:i});return e instanceof n?Pi(a).putImageData(e,0,0):Pi(a).drawImage(e,0,0,o,i),a}function GM(e,t){return le(this,void 0,void 0,function(){var n,r,o,i,a,s;return ce(this,function(u){switch(u.label){case 0:return n=zt.getEnv().createCanvasElement(),r=e.shape.slice(Uo(e)?1:0),o=r[0],i=r[1],a=r[2],s=te(function(){return e.as3D(o,i,a).toInt()}),[4,Qv.toPixels(s,n)];case 1:return u.sent(),s.dispose(),[2,n]}})})}function w0(e){var t=zt.getEnv(),n=t.Image,r=t.Canvas,o=t.Video;return e instanceof n||e instanceof r||e instanceof o}function qM(e,t,n){n===void 0&&(n=!1);var r=zt.getEnv(),o=r.Image,i=r.Canvas;if(!(e instanceof o||e instanceof i))throw new Error("imageToSquare - expected arg0 to be HTMLImageElement | HTMLCanvasElement");var a=yC(e),s=t/Math.max(a.height,a.width),u=s*a.width,l=s*a.height,c=wd({width:t,height:t}),d=e instanceof i?e:nm(e),f=Math.abs(u-l)/2,h=n&&u<l?f:0,v=n&&l<u?f:0;return Pi(c).drawImage(d,h,v,u,l),c}var Tc=function(){function e(t,n){var r=this;if(n===void 0&&(n=!1),this._imageTensors=[],this._canvases=[],this._treatAsBatchInput=!1,this._inputDimensions=[],!Array.isArray(t))throw new Error("NetInput.constructor - expected inputs to be an Array of TResolvedNetInput or to be instanceof tf.Tensor4D, instead have "+t);this._treatAsBatchInput=n,this._batchSize=t.length,t.forEach(function(o,i){if(yd(o)){r._imageTensors[i]=o,r._inputDimensions[i]=o.shape;return}if(Uo(o)){var a=o.shape[0];if(a!==1)throw new Error("NetInput - tf.Tensor4D with batchSize "+a+" passed, but not supported in input array");r._imageTensors[i]=o,r._inputDimensions[i]=o.shape.slice(1);return}var s=o instanceof zt.getEnv().Canvas?o:nm(o);r._canvases[i]=s,r._inputDimensions[i]=[s.height,s.width,3]})}return Object.defineProperty(e.prototype,"imageTensors",{get:function(){return this._imageTensors},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"canvases",{get:function(){return this._canvases},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isBatchInput",{get:function(){return this.batchSize>1||this._treatAsBatchInput},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"batchSize",{get:function(){return this._batchSize},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"inputDimensions",{get:function(){return this._inputDimensions},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"inputSize",{get:function(){return this._inputSize},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"reshapedInputDimensions",{get:function(){var t=this;return au(this.batchSize,0,1).map(function(n,r){return t.getReshapedInputDimensions(r)})},enumerable:!0,configurable:!0}),e.prototype.getInput=function(t){return this.canvases[t]||this.imageTensors[t]},e.prototype.getInputDimensions=function(t){return this._inputDimensions[t]},e.prototype.getInputHeight=function(t){return this._inputDimensions[t][0]},e.prototype.getInputWidth=function(t){return this._inputDimensions[t][1]},e.prototype.getReshapedInputDimensions=function(t){if(typeof this.inputSize!="number")throw new Error("getReshapedInputDimensions - inputSize not set, toBatchTensor has not been called yet");var n=this.getInputWidth(t),r=this.getInputHeight(t);return DM({width:n,height:r},this.inputSize)},e.prototype.toBatchTensor=function(t,n){var r=this;return n===void 0&&(n=!0),this._inputSize=t,te(function(){var o=au(r.batchSize,0,1).map(function(a){var s=r.getInput(a);if(s instanceof qe){var u=Uo(s)?s:s.expandDims();return u=OM(u,n),(u.shape[1]!==t||u.shape[2]!==t)&&(u=Hv.resizeBilinear(u,[t,t])),u.as3D(t,t,3)}if(s instanceof zt.getEnv().Canvas)return Qv.fromPixels(qM(s,t,n));throw new Error("toBatchTensor - at batchIdx "+a+", expected input to be instanceof tf.Tensor or instanceof HTMLCanvasElement, instead have "+s)}),i=Cn(o.map(function(a){return a.toFloat()})).as4D(r.batchSize,t,t,3);return i})},e}();function wt(e){return le(this,void 0,void 0,function(){var t,n,r;return ce(this,function(o){switch(o.label){case 0:if(e instanceof Tc)return[2,e];if(t=Array.isArray(e)?e:[e],!t.length)throw new Error("toNetInput - empty array passed as input");return n=function(i){return Array.isArray(e)?" at input index "+i+":":""},r=t.map(mC),r.forEach(function(i,a){if(!w0(i)&&!yd(i)&&!Uo(i))throw typeof t[a]=="string"?new Error("toNetInput -"+n(a)+" string passed, but could not resolve HTMLElement for element id "+t[a]):new Error("toNetInput -"+n(a)+" expected media to be of type HTMLImageElement | HTMLVideoElement | HTMLCanvasElement | tf.Tensor3D, or to be an element id");if(Uo(i)){var s=i.shape[0];if(s!==1)throw new Error("toNetInput -"+n(a)+" tf.Tensor4D with batchSize "+s+" passed, but not supported in input array")}}),[4,Promise.all(r.map(function(i){return w0(i)&&HM(i)}))];case 1:return o.sent(),[2,new Tc(r,Array.isArray(e))]}})})}function rm(e,t){return le(this,void 0,void 0,function(){var n,r,o,i,a,s,u;return ce(this,function(l){switch(l.label){case 0:return n=zt.getEnv().Canvas,r=e,e instanceof n?[3,5]:[4,wt(e)];case 1:if(o=l.sent(),o.batchSize>1)throw new Error("extractFaces - batchSize > 1 not supported");return i=o.getInput(0),i instanceof n?(a=i,[3,4]):[3,2];case 2:return[4,GM(i)];case 3:a=l.sent(),l.label=4;case 4:r=a,l.label=5;case 5:return s=Pi(r),u=t.map(function(c){return c instanceof Mr?c.forSize(r.width,r.height).box.floor():c}).map(function(c){return c.clipAtImageBorders(r.width,r.height)}),[2,u.map(function(c){var d=c.x,f=c.y,h=c.width,v=c.height,m=wd({width:h,height:v});return Pi(m).putImageData(s.getImageData(d,f,h,v),0,0),m})]}})})}function om(e,t){return le(this,void 0,void 0,function(){return ce(this,function(n){if(!yd(e)&&!Uo(e))throw new Error("extractFaceTensors - expected image tensor to be 3D or 4D");if(Uo(e)&&e.shape[0]>1)throw new Error("extractFaceTensors - batchSize > 1 not supported");return[2,te(function(){var r=e.shape.slice(Uo(e)?1:0),o=r[0],i=r[1],a=r[2],s=t.map(function(l){return l instanceof Mr?l.forSize(i,o).box:l}).map(function(l){return l.clipAtImageBorders(i,o)}),u=s.map(function(l){var c=l.x,d=l.y,f=l.width,h=l.height;return H2(e.as3D(o,i,a),[d,c,0],[h,f,a])});return u})]})})}function KM(e,t){return le(this,void 0,void 0,function(){var n,r;return ce(this,function(o){switch(o.label){case 0:return n=zt.getEnv().fetch,[4,n(e,t)];case 1:if(r=o.sent(),!(r.status<400))throw new Error("failed to fetch: ("+r.status+") "+r.statusText+", from url: "+r.url);return[2,r]}})})}function XM(e){return le(this,void 0,void 0,function(){return ce(this,function(t){switch(t.label){case 0:return[4,KM(e)];case 1:return[2,t.sent().json()]}})})}function xC(e,t){var n=t+"-weights_manifest.json";if(!e)return{modelBaseUri:"",manifestUri:n};if(e==="/")return{modelBaseUri:"/",manifestUri:"/"+n};var r=e.startsWith("http://")?"http://":e.startsWith("https://")?"https://":"";e=e.replace(r,"");var o=e.split("/").filter(function(s){return s}),i=e.endsWith(".json")?o[o.length-1]:n,a=r+(e.endsWith(".json")?o.slice(0,o.length-1):o).join("/");return a=e.startsWith("/")?"/"+a:a,{modelBaseUri:a,manifestUri:a==="/"?"/"+i:a+"/"+i}}function YM(e,t){return le(this,void 0,void 0,function(){var n,r,o,i;return ce(this,function(a){switch(a.label){case 0:return n=xC(e,t),r=n.manifestUri,o=n.modelBaseUri,[4,XM(r)];case 1:return i=a.sent(),[2,uC.loadWeights(i,o)]}})})}var oo=function(){function e(t){this._name=t,this._params=void 0,this._paramMappings=[]}return Object.defineProperty(e.prototype,"params",{get:function(){return this._params},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"paramMappings",{get:function(){return this._paramMappings},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isLoaded",{get:function(){return!!this.params},enumerable:!0,configurable:!0}),e.prototype.getParamFromPath=function(t){var n=this.traversePropertyPath(t),r=n.obj,o=n.objProp;return r[o]},e.prototype.reassignParamFromPath=function(t,n){var r=this.traversePropertyPath(t),o=r.obj,i=r.objProp;o[i].dispose(),o[i]=n},e.prototype.getParamList=function(){var t=this;return this._paramMappings.map(function(n){var r=n.paramPath;return{path:r,tensor:t.getParamFromPath(r)}})},e.prototype.getTrainableParams=function(){return this.getParamList().filter(function(t){return t.tensor instanceof Ha})},e.prototype.getFrozenParams=function(){return this.getParamList().filter(function(t){return!(t.tensor instanceof Ha)})},e.prototype.variable=function(){var t=this;this.getFrozenParams().forEach(function(n){var r=n.path,o=n.tensor;t.reassignParamFromPath(r,o.variable())})},e.prototype.freeze=function(){var t=this;this.getTrainableParams().forEach(function(n){var r=n.path,o=n.tensor,i=St(o.dataSync());o.dispose(),t.reassignParamFromPath(r,i)})},e.prototype.dispose=function(t){t===void 0&&(t=!0),this.getParamList().forEach(function(n){if(t&&n.tensor.isDisposed)throw new Error("param tensor has already been disposed for path "+n.path);n.tensor.dispose()}),this._params=void 0},e.prototype.serializeParams=function(){return new Float32Array(this.getParamList().map(function(t){var n=t.tensor;return Array.from(n.dataSync())}).reduce(function(t,n){return t.concat(n)}))},e.prototype.load=function(t){return le(this,void 0,void 0,function(){return ce(this,function(n){switch(n.label){case 0:return t instanceof Float32Array?(this.extractWeights(t),[2]):[4,this.loadFromUri(t)];case 1:return n.sent(),[2]}})})},e.prototype.loadFromUri=function(t){return le(this,void 0,void 0,function(){var n;return ce(this,function(r){switch(r.label){case 0:if(t&&typeof t!="string")throw new Error(this._name+".loadFromUri - expected model uri");return[4,YM(t,this.getDefaultModelName())];case 1:return n=r.sent(),this.loadFromWeightMap(n),[2]}})})},e.prototype.loadFromDisk=function(t){return le(this,void 0,void 0,function(){var n,r,o,i,a,s,u,l,c,d;return ce(this,function(f){switch(f.label){case 0:if(t&&typeof t!="string")throw new Error(this._name+".loadFromDisk - expected model file path");return n=zt.getEnv().readFile,r=xC(t,this.getDefaultModelName()),o=r.manifestUri,i=r.modelBaseUri,a=function(h){return Promise.all(h.map(function(v){return n(v).then(function(m){return m.buffer})}))},s=uC.weightsLoaderFactory(a),c=(l=JSON).parse,[4,n(o)];case 1:return u=c.apply(l,[f.sent().toString()]),[4,s(u,i)];case 2:return d=f.sent(),this.loadFromWeightMap(d),[2]}})})},e.prototype.loadFromWeightMap=function(t){var n=this.extractParamsFromWeigthMap(t),r=n.paramMappings,o=n.params;this._paramMappings=r,this._params=o},e.prototype.extractWeights=function(t){var n=this.extractParams(t),r=n.paramMappings,o=n.params;this._paramMappings=r,this._params=o},e.prototype.traversePropertyPath=function(t){if(!this.params)throw new Error("traversePropertyPath - model has no loaded params");var n=t.split("/").reduce(function(i,a){if(!i.nextObj.hasOwnProperty(a))throw new Error("traversePropertyPath - object does not have property "+a+", for path "+t);return{obj:i.nextObj,objProp:a,nextObj:i.nextObj[a]}},{nextObj:this.params}),r=n.obj,o=n.objProp;if(!r||!o||!(r[o]instanceof qe))throw new Error("traversePropertyPath - parameter is not a tensor, for path "+t);return{obj:r,objProp:o}},e}();function xn(e,t,n){return te(function(){var r=Wv(e,t.depthwise_filter,t.pointwise_filter,n,"same");return r=Ee(r,t.bias),r})}function Af(e,t,n){return n===void 0&&(n=!1),te(function(){var r=Ke(n?Ee(Bn(e,t.conv0.filters,[2,2],"same"),t.conv0.bias):xn(e,t.conv0,[2,2])),o=xn(r,t.conv1,[1,1]),i=Ke(Ee(r,o)),a=xn(i,t.conv2,[1,1]);return Ke(Ee(r,Ee(o,a)))})}function ll(e,t,n,r){return n===void 0&&(n=!1),r===void 0&&(r=!0),te(function(){var o=Ke(n?Ee(Bn(e,t.conv0.filters,r?[2,2]:[1,1],"same"),t.conv0.bias):xn(e,t.conv0,r?[2,2]:[1,1])),i=xn(o,t.conv1,[1,1]),a=Ke(Ee(o,i)),s=xn(a,t.conv2,[1,1]),u=Ke(Ee(o,Ee(i,s))),l=xn(u,t.conv3,[1,1]);return Ke(Ee(o,Ee(i,Ee(s,l))))})}function nr(e,t,n,r){return n===void 0&&(n="same"),r===void 0&&(r=!1),te(function(){var o=Ee(Bn(e,t.filters,[1,1],n),t.bias);return r?Ke(o):o})}function io(e,t){Object.keys(e).forEach(function(n){t.some(function(r){return r.originalPath===n})||e[n].dispose()})}function bd(e,t){return function(n,r,o,i){var a=Zt(e(n*r*o*o),[o,o,n,r]),s=at(e(r));return t.push({paramPath:i+"/filters"},{paramPath:i+"/bias"}),{filters:a,bias:s}}}function im(e,t){return function(n,r,o){var i=Wo(e(n*r),[n,r]),a=at(e(r));return t.push({paramPath:o+"/weights"},{paramPath:o+"/bias"}),{weights:i,bias:a}}}var wC=function(){function e(t,n,r){this.depthwise_filter=t,this.pointwise_filter=n,this.bias=r}return e}();function am(e,t){return function(n,r,o){var i=Zt(e(9*n),[3,3,n,1]),a=Zt(e(n*r),[1,1,n,r]),s=at(e(r));return t.push({paramPath:o+"/depthwise_filter"},{paramPath:o+"/pointwise_filter"},{paramPath:o+"/bias"}),new wC(i,a,s)}}function sm(e){return function(t){var n=e(t+"/depthwise_filter",4),r=e(t+"/pointwise_filter",4),o=e(t+"/bias",1);return new wC(n,r,o)}}function ni(e,t){return function(n,r,o){var i=e[n];if(!gd(i,r))throw new Error("expected weightMap["+n+"] to be a Tensor"+r+"D, instead have "+i);return t.push({originalPath:n,paramPath:o||n}),i}}function ao(e){var t=e;function n(o){var i=t.slice(0,o);return t=t.slice(o),i}function r(){return t}return{extractWeights:n,getRemainingWeights:r}}function bC(e,t){var n=bd(e,t),r=am(e,t);function o(a,s,u,l){l===void 0&&(l=!1);var c=l?n(a,s,3,u+"/conv0"):r(a,s,u+"/conv0"),d=r(s,s,u+"/conv1"),f=r(s,s,u+"/conv2");return{conv0:c,conv1:d,conv2:f}}function i(a,s,u,l){l===void 0&&(l=!1);var c=o(a,s,u,l),d=c.conv0,f=c.conv1,h=c.conv2,v=r(s,s,u+"/conv3");return{conv0:d,conv1:f,conv2:h,conv3:v}}return{extractDenseBlock3Params:o,extractDenseBlock4Params:i}}function QM(e){var t=[],n=ao(e),r=n.extractWeights,o=n.getRemainingWeights,i=bC(r,t).extractDenseBlock4Params,a=i(3,32,"dense0",!0),s=i(32,64,"dense1"),u=i(64,128,"dense2"),l=i(128,256,"dense3");if(o().length!==0)throw new Error("weights remaing after extract: "+o().length);return{paramMappings:t,params:{dense0:a,dense1:s,dense2:u,dense3:l}}}function CC(e){return function(t){var n=e(t+"/filters",4),r=e(t+"/bias",1);return{filters:n,bias:r}}}function EC(e,t){var n=ni(e,t),r=CC(n),o=sm(n);function i(s,u){u===void 0&&(u=!1);var l=u?r(s+"/conv0"):o(s+"/conv0"),c=o(s+"/conv1"),d=o(s+"/conv2");return{conv0:l,conv1:c,conv2:d}}function a(s,u){u===void 0&&(u=!1);var l=u?r(s+"/conv0"):o(s+"/conv0"),c=o(s+"/conv1"),d=o(s+"/conv2"),f=o(s+"/conv3");return{conv0:l,conv1:c,conv2:d,conv3:f}}return{extractDenseBlock3Params:i,extractDenseBlock4Params:a}}function JM(e){var t=[],n=EC(e,t).extractDenseBlock4Params,r={dense0:n("dense0",!0),dense1:n("dense1"),dense2:n("dense2"),dense3:n("dense3")};return io(e,t),{params:r,paramMappings:t}}var _C=function(e){he(t,e);function t(){return e.call(this,"FaceFeatureExtractor")||this}return t.prototype.forwardInput=function(n){var r=this.params;if(!r)throw new Error("FaceFeatureExtractor - load model before inference");return te(function(){var o=n.toBatchTensor(112,!0),i=[122.782,117.001,104.298],a=ku(o,i).div(ee(255)),s=ll(a,r.dense0,!0);return s=ll(s,r.dense1),s=ll(s,r.dense2),s=ll(s,r.dense3),s=_u(s,[7,7],[2,2],"valid"),s})},t.prototype.forward=function(n){return le(this,void 0,void 0,function(){var r;return ce(this,function(o){switch(o.label){case 0:return r=this.forwardInput,[4,wt(n)];case 1:return[2,r.apply(this,[o.sent()])]}})})},t.prototype.getDefaultModelName=function(){return"face_feature_extractor_model"},t.prototype.extractParamsFromWeigthMap=function(n){return JM(n)},t.prototype.extractParams=function(n){return QM(n)},t}(oo);function Cr(e,t){return te(function(){return Ee(pd(e,t.weights),t.bias)})}function ZM(e,t,n){var r=[],o=ao(e),i=o.extractWeights,a=o.getRemainingWeights,s=im(i,r),u=s(t,n,"fc");if(a().length!==0)throw new Error("weights remaing after extract: "+a().length);return{paramMappings:r,params:{fc:u}}}function eO(e){var t=[],n=ni(e,t);function r(i){var a=n(i+"/weights",2),s=n(i+"/bias",1);return{weights:a,bias:s}}var o={fc:r("fc")};return io(e,t),{params:o,paramMappings:t}}function SC(e){var t={},n={};return Object.keys(e).forEach(function(r){var o=r.startsWith("fc")?n:t;o[r]=e[r]}),{featureExtractorMap:t,classifierMap:n}}var kC=function(e){he(t,e);function t(n,r){var o=e.call(this,n)||this;return o._faceFeatureExtractor=r,o}return Object.defineProperty(t.prototype,"faceFeatureExtractor",{get:function(){return this._faceFeatureExtractor},enumerable:!0,configurable:!0}),t.prototype.runNet=function(n){var r=this,o=this.params;if(!o)throw new Error(this._name+" - load model before inference");return te(function(){var i=n instanceof Tc?r.faceFeatureExtractor.forwardInput(n):n;return Cr(i.as2D(i.shape[0],-1),o.fc)})},t.prototype.dispose=function(n){n===void 0&&(n=!0),this.faceFeatureExtractor.dispose(n),e.prototype.dispose.call(this,n)},t.prototype.loadClassifierParams=function(n){var r=this.extractClassifierParams(n),o=r.params,i=r.paramMappings;this._params=o,this._paramMappings=i},t.prototype.extractClassifierParams=function(n){return ZM(n,this.getClassifierChannelsIn(),this.getClassifierChannelsOut())},t.prototype.extractParamsFromWeigthMap=function(n){var r=SC(n),o=r.featureExtractorMap,i=r.classifierMap;return this.faceFeatureExtractor.loadFromWeightMap(o),eO(i)},t.prototype.extractParams=function(n){var r=this.getClassifierChannelsIn(),o=this.getClassifierChannelsOut(),i=o*r+o,a=n.slice(0,n.length-i),s=n.slice(n.length-i);return this.faceFeatureExtractor.extractWeights(a),this.extractClassifierParams(s)},t}(oo),b0=["neutral","happy","sad","angry","fearful","disgusted","surprised"],tO=function(){function e(t){var n=this;if(t.length!==7)throw new Error("FaceExpressions.constructor - expected probabilities.length to be 7, have: "+t.length);b0.forEach(function(r,o){n[r]=t[o]})}return e.prototype.asSortedArray=function(){var t=this;return b0.map(function(n){return{expression:n,probability:t[n]}}).sort(function(n,r){return r.probability-n.probability})},e}(),nO=function(e){he(t,e);function t(n){return n===void 0&&(n=new _C),e.call(this,"FaceExpressionNet",n)||this}return t.prototype.forwardInput=function(n){var r=this;return te(function(){return no(r.runNet(n))})},t.prototype.forward=function(n){return le(this,void 0,void 0,function(){var r;return ce(this,function(o){switch(o.label){case 0:return r=this.forwardInput,[4,wt(n)];case 1:return[2,r.apply(this,[o.sent()])]}})})},t.prototype.predictExpressions=function(n){return le(this,void 0,void 0,function(){var r,o,i,a,s=this;return ce(this,function(u){switch(u.label){case 0:return[4,wt(n)];case 1:return r=u.sent(),[4,this.forwardInput(r)];case 2:return o=u.sent(),[4,Promise.all(ft(o).map(function(l){return le(s,void 0,void 0,function(){var c;return ce(this,function(d){switch(d.label){case 0:return[4,l.data()];case 1:return c=d.sent(),l.dispose(),[2,c]}})})}))];case 3:return i=u.sent(),o.dispose(),a=i.map(function(l){return new tO(l)}),[2,r.isBatchInput?a:a[0]]}})})},t.prototype.getDefaultModelName=function(){return"face_expression_model"},t.prototype.getClassifierChannelsIn=function(){return 256},t.prototype.getClassifierChannelsOut=function(){return 7},t}(kC);function RC(e,t){var n={expressions:t};return Object.assign({},e,n)}function rO(e){return UM(e)&&e.landmarks instanceof Ic&&e.unshiftedLandmarks instanceof Ic&&e.alignedRect instanceof Mr}function um(e,t){var n=e.detection.box,r=t.shiftBy(n.x,n.y),o=r.align(),i=e.detection.imageDims,a=new Mr(e.detection.score,o.rescale(i.reverse()),i),s={landmarks:r,unshiftedLandmarks:t,alignedRect:a};return Object.assign({},e,s)}function oO(e,t){var n=bd(e,t),r=am(e,t);function o(a,s,u){var l=r(a,s,u+"/separable_conv0"),c=r(s,s,u+"/separable_conv1"),d=n(a,s,1,u+"/expansion_conv");return{separable_conv0:l,separable_conv1:c,expansion_conv:d}}function i(a,s){var u=r(a,a,s+"/separable_conv0"),l=r(a,a,s+"/separable_conv1"),c=r(a,a,s+"/separable_conv2");return{separable_conv0:u,separable_conv1:l,separable_conv2:c}}return{extractConvParams:n,extractSeparableConvParams:r,extractReductionBlockParams:o,extractMainBlockParams:i}}function iO(e,t){var n=[],r=ao(e),o=r.extractWeights,i=r.getRemainingWeights,a=oO(o,n),s=a.extractConvParams,u=a.extractSeparableConvParams,l=a.extractReductionBlockParams,c=a.extractMainBlockParams,d=s(3,32,3,"entry_flow/conv_in"),f=l(32,64,"entry_flow/reduction_block_0"),h=l(64,128,"entry_flow/reduction_block_1"),v={conv_in:d,reduction_block_0:f,reduction_block_1:h},m={};au(t,0,1).forEach(function(x){m["main_block_"+x]=c(128,"middle_flow/main_block_"+x)});var g=l(128,256,"exit_flow/reduction_block"),p=u(256,512,"exit_flow/separable_conv"),y={reduction_block:g,separable_conv:p};if(i().length!==0)throw new Error("weights remaing after extract: "+i().length);return{paramMappings:n,params:{entry_flow:v,middle_flow:m,exit_flow:y}}}function aO(e,t){var n=ni(e,t),r=CC(n),o=sm(n);function i(s){var u=o(s+"/separable_conv0"),l=o(s+"/separable_conv1"),c=r(s+"/expansion_conv");return{separable_conv0:u,separable_conv1:l,expansion_conv:c}}function a(s){var u=o(s+"/separable_conv0"),l=o(s+"/separable_conv1"),c=o(s+"/separable_conv2");return{separable_conv0:u,separable_conv1:l,separable_conv2:c}}return{extractConvParams:r,extractSeparableConvParams:o,extractReductionBlockParams:i,extractMainBlockParams:a}}function sO(e,t){var n=[],r=aO(e,n),o=r.extractConvParams,i=r.extractSeparableConvParams,a=r.extractReductionBlockParams,s=r.extractMainBlockParams,u=o("entry_flow/conv_in"),l=a("entry_flow/reduction_block_0"),c=a("entry_flow/reduction_block_1"),d={conv_in:u,reduction_block_0:l,reduction_block_1:c},f={};au(t,0,1).forEach(function(g){f["main_block_"+g]=s("middle_flow/main_block_"+g)});var h=a("exit_flow/reduction_block"),v=i("exit_flow/separable_conv"),m={reduction_block:h,separable_conv:v};return io(e,n),{params:{entry_flow:d,middle_flow:f,exit_flow:m},paramMappings:n}}function NC(e,t,n){return Ee(Bn(e,t.filters,n,"same"),t.bias)}function Pf(e,t,n){n===void 0&&(n=!0);var r=n?Ke(e):e;return r=xn(r,t.separable_conv0,[1,1]),r=xn(Ke(r),t.separable_conv1,[1,1]),r=mt(r,[3,3],[2,2],"same"),r=Ee(r,NC(e,t.expansion_conv,[2,2])),r}function uO(e,t){var n=xn(Ke(e),t.separable_conv0,[1,1]);return n=xn(Ke(n),t.separable_conv1,[1,1]),n=xn(Ke(n),t.separable_conv2,[1,1]),n=Ee(n,e),n}var lO=function(e){he(t,e);function t(n){var r=e.call(this,"TinyXception")||this;return r._numMainBlocks=n,r}return t.prototype.forwardInput=function(n){var r=this,o=this.params;if(!o)throw new Error("TinyXception - load model before inference");return te(function(){var i=n.toBatchTensor(112,!0),a=[122.782,117.001,104.298],s=ku(i,a).div(ee(256)),u=Ke(NC(s,o.entry_flow.conv_in,[2,2]));return u=Pf(u,o.entry_flow.reduction_block_0,!1),u=Pf(u,o.entry_flow.reduction_block_1),au(r._numMainBlocks,0,1).forEach(function(l){u=uO(u,o.middle_flow["main_block_"+l])}),u=Pf(u,o.exit_flow.reduction_block),u=Ke(xn(u,o.exit_flow.separable_conv,[1,1])),u})},t.prototype.forward=function(n){return le(this,void 0,void 0,function(){var r;return ce(this,function(o){switch(o.label){case 0:return r=this.forwardInput,[4,wt(n)];case 1:return[2,r.apply(this,[o.sent()])]}})})},t.prototype.getDefaultModelName=function(){return"tiny_xception_model"},t.prototype.extractParamsFromWeigthMap=function(n){return sO(n,this._numMainBlocks)},t.prototype.extractParams=function(n){return iO(n,this._numMainBlocks)},t}(oo);function cO(e){var t=[],n=ao(e),r=n.extractWeights,o=n.getRemainingWeights,i=im(r,t),a=i(512,1,"fc/age"),s=i(512,2,"fc/gender");if(o().length!==0)throw new Error("weights remaing after extract: "+o().length);return{paramMappings:t,params:{fc:{age:a,gender:s}}}}function dO(e){var t=[],n=ni(e,t);function r(i){var a=n(i+"/weights",2),s=n(i+"/bias",1);return{weights:a,bias:s}}var o={fc:{age:r("fc/age"),gender:r("fc/gender")}};return io(e,t),{params:o,paramMappings:t}}var Ac;(function(e){e.FEMALE="female",e.MALE="male"})(Ac||(Ac={}));var fO=function(e){he(t,e);function t(n){n===void 0&&(n=new lO(2));var r=e.call(this,"AgeGenderNet")||this;return r._faceFeatureExtractor=n,r}return Object.defineProperty(t.prototype,"faceFeatureExtractor",{get:function(){return this._faceFeatureExtractor},enumerable:!0,configurable:!0}),t.prototype.runNet=function(n){var r=this,o=this.params;if(!o)throw new Error(this._name+" - load model before inference");return te(function(){var i=n instanceof Tc?r.faceFeatureExtractor.forwardInput(n):n,a=_u(i,[7,7],[2,2],"valid").as2D(i.shape[0],-1),s=Cr(a,o.fc.age).as1D(),u=Cr(a,o.fc.gender);return{age:s,gender:u}})},t.prototype.forwardInput=function(n){var r=this;return te(function(){var o=r.runNet(n),i=o.age,a=o.gender;return{age:i,gender:no(a)}})},t.prototype.forward=function(n){return le(this,void 0,void 0,function(){var r;return ce(this,function(o){switch(o.label){case 0:return r=this.forwardInput,[4,wt(n)];case 1:return[2,r.apply(this,[o.sent()])]}})})},t.prototype.predictAgeAndGender=function(n){return le(this,void 0,void 0,function(){var r,o,i,a,s,u,l=this;return ce(this,function(c){switch(c.label){case 0:return[4,wt(n)];case 1:return r=c.sent(),[4,this.forwardInput(r)];case 2:return o=c.sent(),i=ft(o.age),a=ft(o.gender),s=i.map(function(d,f){return{ageTensor:d,genderTensor:a[f]}}),[4,Promise.all(s.map(function(d){var f=d.ageTensor,h=d.genderTensor;return le(l,void 0,void 0,function(){var v,m,g,p,y;return ce(this,function(x){switch(x.label){case 0:return[4,f.data()];case 1:return v=x.sent()[0],[4,h.data()];case 2:return m=x.sent()[0],g=m>.5,p=g?Ac.MALE:Ac.FEMALE,y=g?m:1-m,f.dispose(),h.dispose(),[2,{age:v,gender:p,genderProbability:y}]}})})}))];case 3:return u=c.sent(),o.age.dispose(),o.gender.dispose(),[2,r.isBatchInput?u:u[0]]}})})},t.prototype.getDefaultModelName=function(){return"age_gender_model"},t.prototype.dispose=function(n){n===void 0&&(n=!0),this.faceFeatureExtractor.dispose(n),e.prototype.dispose.call(this,n)},t.prototype.loadClassifierParams=function(n){var r=this.extractClassifierParams(n),o=r.params,i=r.paramMappings;this._params=o,this._paramMappings=i},t.prototype.extractClassifierParams=function(n){return cO(n)},t.prototype.extractParamsFromWeigthMap=function(n){var r=SC(n),o=r.featureExtractorMap,i=r.classifierMap;return this.faceFeatureExtractor.loadFromWeightMap(o),dO(i)},t.prototype.extractParams=function(n){var r=1539,o=n.slice(0,n.length-r),i=n.slice(n.length-r);return this.faceFeatureExtractor.extractWeights(o),this.extractClassifierParams(i)},t}(oo),IC=function(e){he(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.postProcess=function(n,r,o){var i=o.map(function(s){var u=s.width,l=s.height,c=r/Math.max(l,u);return{width:u*c,height:l*c}}),a=i.length;return te(function(){var s=function(f,h){return Cn([Nr([68],f),Nr([68],h)],1).as2D(1,136).as1D()},u=function(f,h){var v=i[f],m=v.width,g=v.height;return h(m,g)?Math.abs(m-g)/2:0},l=function(f){return u(f,function(h,v){return h<v})},c=function(f){return u(f,function(h,v){return v<h})},d=n.mul(Nr([a,136],r)).sub(Cn(Array.from(Array(a),function(f,h){return s(l(h),c(h))}))).div(Cn(Array.from(Array(a),function(f,h){return s(i[h].width,i[h].height)})));return d})},t.prototype.forwardInput=function(n){var r=this;return te(function(){var o=r.runNet(n);return r.postProcess(o,n.inputSize,n.inputDimensions.map(function(i){var a=i[0],s=i[1];return{height:a,width:s}}))})},t.prototype.forward=function(n){return le(this,void 0,void 0,function(){var r;return ce(this,function(o){switch(o.label){case 0:return r=this.forwardInput,[4,wt(n)];case 1:return[2,r.apply(this,[o.sent()])]}})})},t.prototype.detectLandmarks=function(n){return le(this,void 0,void 0,function(){var r,o,i,a=this;return ce(this,function(s){switch(s.label){case 0:return[4,wt(n)];case 1:return r=s.sent(),o=te(function(){return ft(a.forwardInput(r))}),[4,Promise.all(o.map(function(u,l){return le(a,void 0,void 0,function(){var c,d,f,h,v;return ce(this,function(m){switch(m.label){case 0:return f=(d=Array).from,[4,u.data()];case 1:return c=f.apply(d,[m.sent()]),h=c.filter(function(g,p){return p0(p)}),v=c.filter(function(g,p){return!p0(p)}),[2,new zM(Array(68).fill(0).map(function(g,p){return new Te(h[p],v[p])}),{height:r.getInputHeight(l),width:r.getInputWidth(l)})]}})})}))];case 2:return i=s.sent(),o.forEach(function(u){return u.dispose()}),[2,r.isBatchInput?i:i[0]]}})})},t.prototype.getClassifierChannelsOut=function(){return 136},t}(kC),TC=function(e){he(t,e);function t(n){return n===void 0&&(n=new _C),e.call(this,"FaceLandmark68Net",n)||this}return t.prototype.getDefaultModelName=function(){return"face_landmark_68_model"},t.prototype.getClassifierChannelsIn=function(){return 256},t}(IC);function hO(e){var t=[],n=EC(e,t).extractDenseBlock3Params,r={dense0:n("dense0",!0),dense1:n("dense1"),dense2:n("dense2")};return io(e,t),{params:r,paramMappings:t}}function pO(e){var t=[],n=ao(e),r=n.extractWeights,o=n.getRemainingWeights,i=bC(r,t).extractDenseBlock3Params,a=i(3,32,"dense0",!0),s=i(32,64,"dense1"),u=i(64,128,"dense2");if(o().length!==0)throw new Error("weights remaing after extract: "+o().length);return{paramMappings:t,params:{dense0:a,dense1:s,dense2:u}}}var vO=function(e){he(t,e);function t(){return e.call(this,"TinyFaceFeatureExtractor")||this}return t.prototype.forwardInput=function(n){var r=this.params;if(!r)throw new Error("TinyFaceFeatureExtractor - load model before inference");return te(function(){var o=n.toBatchTensor(112,!0),i=[122.782,117.001,104.298],a=ku(o,i).div(ee(255)),s=Af(a,r.dense0,!0);return s=Af(s,r.dense1),s=Af(s,r.dense2),s=_u(s,[14,14],[2,2],"valid"),s})},t.prototype.forward=function(n){return le(this,void 0,void 0,function(){var r;return ce(this,function(o){switch(o.label){case 0:return r=this.forwardInput,[4,wt(n)];case 1:return[2,r.apply(this,[o.sent()])]}})})},t.prototype.getDefaultModelName=function(){return"face_feature_extractor_tiny_model"},t.prototype.extractParamsFromWeigthMap=function(n){return hO(n)},t.prototype.extractParams=function(n){return pO(n)},t}(oo),mO=function(e){he(t,e);function t(n){return n===void 0&&(n=new vO),e.call(this,"FaceLandmark68TinyNet",n)||this}return t.prototype.getDefaultModelName=function(){return"face_landmark_68_tiny_model"},t.prototype.getClassifierChannelsIn=function(){return 128},t}(IC);(function(e){he(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t})(TC);function gO(e,t){return Ee(jt(e,t.weights),t.biases)}function lm(e,t,n,r,o){o===void 0&&(o="same");var i=t.conv,a=i.filters,s=i.bias,u=Bn(e,a,n,o);return u=Ee(u,s),u=gO(u,t.scale),r?Ke(u):u}function yO(e,t){return lm(e,t,[1,1],!0)}function AC(e,t){return lm(e,t,[1,1],!1)}function PC(e,t){return lm(e,t,[2,2],!0,"valid")}function xO(e,t){function n(s,u,l){var c=e(s),d=c.length/(u*l*l);if(AM(d))throw new Error("depth has to be an integer: "+d+", weights.length: "+c.length+", numFilters: "+u+", filterSize: "+l);return te(function(){return Xo(Zt(c,[u,d,l,l]),[2,3,1,0])})}function r(s,u,l,c){var d=n(s,u,l),f=at(e(u));return t.push({paramPath:c+"/filters"},{paramPath:c+"/bias"}),{filters:d,bias:f}}function o(s,u){var l=at(e(s)),c=at(e(s));return t.push({paramPath:u+"/weights"},{paramPath:u+"/biases"}),{weights:l,biases:c}}function i(s,u,l,c){var d=r(s,u,l,c+"/conv"),f=o(u,c+"/scale");return{conv:d,scale:f}}function a(s,u,l,c,d){d===void 0&&(d=!1);var f=i((d?.5:1)*s,u,l,c+"/conv1"),h=i(s,u,l,c+"/conv2");return{conv1:f,conv2:h}}return{extractConvLayerParams:i,extractResidualLayerParams:a}}function wO(e){var t=ao(e),n=t.extractWeights,r=t.getRemainingWeights,o=[],i=xO(n,o),a=i.extractConvLayerParams,s=i.extractResidualLayerParams,u=a(4704,32,7,"conv32_down"),l=s(9216,32,3,"conv32_1"),c=s(9216,32,3,"conv32_2"),d=s(9216,32,3,"conv32_3"),f=s(36864,64,3,"conv64_down",!0),h=s(36864,64,3,"conv64_1"),v=s(36864,64,3,"conv64_2"),m=s(36864,64,3,"conv64_3"),g=s(147456,128,3,"conv128_down",!0),p=s(147456,128,3,"conv128_1"),y=s(147456,128,3,"conv128_2"),x=s(589824,256,3,"conv256_down",!0),w=s(589824,256,3,"conv256_1"),b=s(589824,256,3,"conv256_2"),C=s(589824,256,3,"conv256_down_out"),E=te(function(){return Xo(Wo(n(256*128),[128,256]),[1,0])});if(o.push({paramPath:"fc"}),r().length!==0)throw new Error("weights remaing after extract: "+r().length);var S={conv32_down:u,conv32_1:l,conv32_2:c,conv32_3:d,conv64_down:f,conv64_1:h,conv64_2:v,conv64_3:m,conv128_down:g,conv128_1:p,conv128_2:y,conv256_down:x,conv256_1:w,conv256_2:b,conv256_down_out:C,fc:E};return{params:S,paramMappings:o}}function bO(e,t){var n=ni(e,t);function r(a){var s=n(a+"/scale/weights",1),u=n(a+"/scale/biases",1);return{weights:s,biases:u}}function o(a){var s=n(a+"/conv/filters",4),u=n(a+"/conv/bias",1),l=r(a);return{conv:{filters:s,bias:u},scale:l}}function i(a){return{conv1:o(a+"/conv1"),conv2:o(a+"/conv2")}}return{extractConvLayerParams:o,extractResidualLayerParams:i}}function CO(e){var t=[],n=bO(e,t),r=n.extractConvLayerParams,o=n.extractResidualLayerParams,i=r("conv32_down"),a=o("conv32_1"),s=o("conv32_2"),u=o("conv32_3"),l=o("conv64_down"),c=o("conv64_1"),d=o("conv64_2"),f=o("conv64_3"),h=o("conv128_down"),v=o("conv128_1"),m=o("conv128_2"),g=o("conv256_down"),p=o("conv256_1"),y=o("conv256_2"),x=o("conv256_down_out"),w=e.fc;if(t.push({originalPath:"fc",paramPath:"fc"}),!TM(w))throw new Error("expected weightMap[fc] to be a Tensor2D, instead have "+w);var b={conv32_down:i,conv32_1:a,conv32_2:s,conv32_3:u,conv64_down:l,conv64_1:c,conv64_2:d,conv64_3:f,conv128_down:h,conv128_1:v,conv128_2:m,conv256_down:g,conv256_1:p,conv256_2:y,conv256_down_out:x,fc:w};return io(e,t),{params:b,paramMappings:t}}function dr(e,t){var n=yO(e,t.conv1);return n=AC(n,t.conv2),n=Ee(n,e),n=Ke(n),n}function cl(e,t){var n=PC(e,t.conv1);n=AC(n,t.conv2);var r=_u(e,2,2,"valid"),o=Ue(r.shape),i=r.shape[3]!==n.shape[3],a=r.shape[1]!==n.shape[1]||r.shape[2]!==n.shape[2];if(a){var s=Ds(n.shape);s[1]=1;var u=Ue(s);n=dt([n,u],1);var l=Ds(n.shape);l[2]=1;var c=Ue(l);n=dt([n,c],2)}return r=i?dt([r,o],3):r,n=Ee(r,n),n=Ke(n),n}var EO=function(e){he(t,e);function t(){return e.call(this,"FaceRecognitionNet")||this}return t.prototype.forwardInput=function(n){var r=this.params;if(!r)throw new Error("FaceRecognitionNet - load model before inference");return te(function(){var o=n.toBatchTensor(150,!0).toFloat(),i=[122.782,117.001,104.298],a=ku(o,i).div(ee(256)),s=PC(a,r.conv32_down);s=mt(s,3,2,"valid"),s=dr(s,r.conv32_1),s=dr(s,r.conv32_2),s=dr(s,r.conv32_3),s=cl(s,r.conv64_down),s=dr(s,r.conv64_1),s=dr(s,r.conv64_2),s=dr(s,r.conv64_3),s=cl(s,r.conv128_down),s=dr(s,r.conv128_1),s=dr(s,r.conv128_2),s=cl(s,r.conv256_down),s=dr(s,r.conv256_1),s=dr(s,r.conv256_2),s=cl(s,r.conv256_down_out);var u=s.mean([1,2]),l=pd(u,r.fc);return l})},t.prototype.forward=function(n){return le(this,void 0,void 0,function(){var r;return ce(this,function(o){switch(o.label){case 0:return r=this.forwardInput,[4,wt(n)];case 1:return[2,r.apply(this,[o.sent()])]}})})},t.prototype.computeFaceDescriptor=function(n){return le(this,void 0,void 0,function(){var r,o,i,a=this;return ce(this,function(s){switch(s.label){case 0:return[4,wt(n)];case 1:return r=s.sent(),o=te(function(){return ft(a.forwardInput(r))}),[4,Promise.all(o.map(function(u){return u.data()}))];case 2:return i=s.sent(),o.forEach(function(u){return u.dispose()}),[2,r.isBatchInput?i:i[0]]}})})},t.prototype.getDefaultModelName=function(){return"face_recognition_model"},t.prototype.extractParamsFromWeigthMap=function(n){return CO(n)},t.prototype.extractParams=function(n){return wO(n)},t}(oo);function DC(e,t){var n={descriptor:t};return Object.assign({},e,n)}function FC(e,t){var n={age:t};return Object.assign({},e,n)}function MC(e,t,n){var r={gender:t,genderProbability:n};return Object.assign({},e,r)}var OC=function(){function e(t){var n=t===void 0?{}:t,r=n.minFaceSize,o=n.scaleFactor,i=n.maxNumScales,a=n.scoreThresholds,s=n.scaleSteps;if(this._name="MtcnnOptions",this._minFaceSize=r||20,this._scaleFactor=o||.709,this._maxNumScales=i||10,this._scoreThresholds=a||[.6,.7,.7],this._scaleSteps=s,typeof this._minFaceSize!="number"||this._minFaceSize<0)throw new Error(this._name+" - expected minFaceSize to be a number > 0");if(typeof this._scaleFactor!="number"||this._scaleFactor<=0||this._scaleFactor>=1)throw new Error(this._name+" - expected scaleFactor to be a number between 0 and 1");if(typeof this._maxNumScales!="number"||this._maxNumScales<0)throw new Error(this._name+" - expected maxNumScales to be a number > 0");if(!Array.isArray(this._scoreThresholds)||this._scoreThresholds.length!==3||this._scoreThresholds.some(function(u){return typeof u!="number"}))throw new Error(this._name+" - expected scoreThresholds to be an array of numbers of length 3");if(this._scaleSteps&&(!Array.isArray(this._scaleSteps)||this._scaleSteps.some(function(u){return typeof u!="number"})))throw new Error(this._name+" - expected scaleSteps to be an array of numbers")}return Object.defineProperty(e.prototype,"minFaceSize",{get:function(){return this._minFaceSize},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scaleFactor",{get:function(){return this._scaleFactor},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maxNumScales",{get:function(){return this._maxNumScales},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scoreThresholds",{get:function(){return this._scoreThresholds},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scaleSteps",{get:function(){return this._scaleSteps},enumerable:!0,configurable:!0}),e}();function _O(e,t){function n(u,l){var c=Zt(e(9*u),[3,3,u,1]),d=at(e(u)),f=at(e(u)),h=at(e(u)),v=at(e(u));return t.push({paramPath:l+"/filters"},{paramPath:l+"/batch_norm_scale"},{paramPath:l+"/batch_norm_offset"},{paramPath:l+"/batch_norm_mean"},{paramPath:l+"/batch_norm_variance"}),{filters:c,batch_norm_scale:d,batch_norm_offset:f,batch_norm_mean:h,batch_norm_variance:v}}function r(u,l,c,d,f){var h=Zt(e(u*l*c*c),[c,c,u,l]),v=at(e(l));return t.push({paramPath:d+"/filters"},{paramPath:d+"/"+(f?"batch_norm_offset":"bias")}),{filters:h,bias:v}}function o(u,l,c,d){var f=r(u,l,c,d,!0),h=f.filters,v=f.bias;return{filters:h,batch_norm_offset:v}}function i(u,l,c){var d=n(u,c+"/depthwise_conv"),f=o(u,l,1,c+"/pointwise_conv");return{depthwise_conv:d,pointwise_conv:f}}function a(){var u=o(3,32,3,"mobilenetv1/conv_0"),l=i(32,64,"mobilenetv1/conv_1"),c=i(64,128,"mobilenetv1/conv_2"),d=i(128,128,"mobilenetv1/conv_3"),f=i(128,256,"mobilenetv1/conv_4"),h=i(256,256,"mobilenetv1/conv_5"),v=i(256,512,"mobilenetv1/conv_6"),m=i(512,512,"mobilenetv1/conv_7"),g=i(512,512,"mobilenetv1/conv_8"),p=i(512,512,"mobilenetv1/conv_9"),y=i(512,512,"mobilenetv1/conv_10"),x=i(512,512,"mobilenetv1/conv_11"),w=i(512,1024,"mobilenetv1/conv_12"),b=i(1024,1024,"mobilenetv1/conv_13");return{conv_0:u,conv_1:l,conv_2:c,conv_3:d,conv_4:f,conv_5:h,conv_6:v,conv_7:m,conv_8:g,conv_9:p,conv_10:y,conv_11:x,conv_12:w,conv_13:b}}function s(){var u=o(1024,256,1,"prediction_layer/conv_0"),l=o(256,512,3,"prediction_layer/conv_1"),c=o(512,128,1,"prediction_layer/conv_2"),d=o(128,256,3,"prediction_layer/conv_3"),f=o(256,128,1,"prediction_layer/conv_4"),h=o(128,256,3,"prediction_layer/conv_5"),v=o(256,64,1,"prediction_layer/conv_6"),m=o(64,128,3,"prediction_layer/conv_7"),g=r(512,12,1,"prediction_layer/box_predictor_0/box_encoding_predictor"),p=r(512,9,1,"prediction_layer/box_predictor_0/class_predictor"),y=r(1024,24,1,"prediction_layer/box_predictor_1/box_encoding_predictor"),x=r(1024,18,1,"prediction_layer/box_predictor_1/class_predictor"),w=r(512,24,1,"prediction_layer/box_predictor_2/box_encoding_predictor"),b=r(512,18,1,"prediction_layer/box_predictor_2/class_predictor"),C=r(256,24,1,"prediction_layer/box_predictor_3/box_encoding_predictor"),E=r(256,18,1,"prediction_layer/box_predictor_3/class_predictor"),S=r(256,24,1,"prediction_layer/box_predictor_4/box_encoding_predictor"),R=r(256,18,1,"prediction_layer/box_predictor_4/class_predictor"),k=r(128,24,1,"prediction_layer/box_predictor_5/box_encoding_predictor"),P=r(128,18,1,"prediction_layer/box_predictor_5/class_predictor"),T={box_encoding_predictor:g,class_predictor:p},j={box_encoding_predictor:y,class_predictor:x},O={box_encoding_predictor:w,class_predictor:b},W={box_encoding_predictor:C,class_predictor:E},U={box_encoding_predictor:S,class_predictor:R},z={box_encoding_predictor:k,class_predictor:P};return{conv_0:u,conv_1:l,conv_2:c,conv_3:d,conv_4:f,conv_5:h,conv_6:v,conv_7:m,box_predictor_0:T,box_predictor_1:j,box_predictor_2:O,box_predictor_3:W,box_predictor_4:U,box_predictor_5:z}}return{extractMobilenetV1Params:a,extractPredictionLayerParams:s}}function SO(e){var t=[],n=ao(e),r=n.extractWeights,o=n.getRemainingWeights,i=_O(r,t),a=i.extractMobilenetV1Params,s=i.extractPredictionLayerParams,u=a(),l=s(),c=Sv(r(5118*4),[1,5118,4]),d={extra_dim:c};if(t.push({paramPath:"output_layer/extra_dim"}),o().length!==0)throw new Error("weights remaing after extract: "+o().length);return{params:{mobilenetv1:u,prediction_layer:l,output_layer:d},paramMappings:t}}function kO(e,t){var n=ni(e,t);function r(l,c,d){var f=n(l+"/Conv2d_"+c+"_pointwise/weights",4,d+"/filters"),h=n(l+"/Conv2d_"+c+"_pointwise/convolution_bn_offset",1,d+"/batch_norm_offset");return{filters:f,batch_norm_offset:h}}function o(l){var c="mobilenetv1/conv_"+l,d="MobilenetV1/Conv2d_"+l+"_depthwise",f=c+"/depthwise_conv",h=c+"/pointwise_conv",v=n(d+"/depthwise_weights",4,f+"/filters"),m=n(d+"/BatchNorm/gamma",1,f+"/batch_norm_scale"),g=n(d+"/BatchNorm/beta",1,f+"/batch_norm_offset"),p=n(d+"/BatchNorm/moving_mean",1,f+"/batch_norm_mean"),y=n(d+"/BatchNorm/moving_variance",1,f+"/batch_norm_variance");return{depthwise_conv:{filters:v,batch_norm_scale:m,batch_norm_offset:g,batch_norm_mean:p,batch_norm_variance:y},pointwise_conv:r("MobilenetV1",l,h)}}function i(){return{conv_0:r("MobilenetV1",0,"mobilenetv1/conv_0"),conv_1:o(1),conv_2:o(2),conv_3:o(3),conv_4:o(4),conv_5:o(5),conv_6:o(6),conv_7:o(7),conv_8:o(8),conv_9:o(9),conv_10:o(10),conv_11:o(11),conv_12:o(12),conv_13:o(13)}}function a(l,c){var d=n(l+"/weights",4,c+"/filters"),f=n(l+"/biases",1,c+"/bias");return{filters:d,bias:f}}function s(l){var c=a("Prediction/BoxPredictor_"+l+"/BoxEncodingPredictor","prediction_layer/box_predictor_"+l+"/box_encoding_predictor"),d=a("Prediction/BoxPredictor_"+l+"/ClassPredictor","prediction_layer/box_predictor_"+l+"/class_predictor");return{box_encoding_predictor:c,class_predictor:d}}function u(){return{conv_0:r("Prediction",0,"prediction_layer/conv_0"),conv_1:r("Prediction",1,"prediction_layer/conv_1"),conv_2:r("Prediction",2,"prediction_layer/conv_2"),conv_3:r("Prediction",3,"prediction_layer/conv_3"),conv_4:r("Prediction",4,"prediction_layer/conv_4"),conv_5:r("Prediction",5,"prediction_layer/conv_5"),conv_6:r("Prediction",6,"prediction_layer/conv_6"),conv_7:r("Prediction",7,"prediction_layer/conv_7"),box_predictor_0:s(0),box_predictor_1:s(1),box_predictor_2:s(2),box_predictor_3:s(3),box_predictor_4:s(4),box_predictor_5:s(5)}}return{extractMobilenetV1Params:i,extractPredictionLayerParams:u}}function RO(e){var t=[],n=kO(e,t),r=n.extractMobilenetV1Params,o=n.extractPredictionLayerParams,i=e["Output/extra_dim"];if(t.push({originalPath:"Output/extra_dim",paramPath:"output_layer/extra_dim"}),!yd(i))throw new Error("expected weightMap['Output/extra_dim'] to be a Tensor3D, instead have "+i);var a={mobilenetv1:r(),prediction_layer:o(),output_layer:{extra_dim:i}};return io(e,t),{params:a,paramMappings:t}}function hr(e,t,n){return te(function(){var r=Bn(e,t.filters,n,"same");return r=Ee(r,t.batch_norm_offset),Ov(r,0,6)})}var NO=.0010000000474974513;function IO(e,t,n){return te(function(){var r=hd(e,t.filters,n,"same");return r=T2(r,t.batch_norm_mean,t.batch_norm_variance,t.batch_norm_offset,t.batch_norm_scale,NO),Ov(r,0,6)})}function TO(e){return[2,4,6,12].some(function(t){return t===e})?[2,2]:[1,1]}function AO(e,t){return te(function(){var n=null,r=hr(e,t.conv_0,[2,2]),o=[t.conv_1,t.conv_2,t.conv_3,t.conv_4,t.conv_5,t.conv_6,t.conv_7,t.conv_8,t.conv_9,t.conv_10,t.conv_11,t.conv_12,t.conv_13];if(o.forEach(function(i,a){var s=a+1,u=TO(s);r=IO(r,i.depthwise_conv,u),r=hr(r,i.pointwise_conv,[1,1]),s===11&&(n=r)}),n===null)throw new Error("mobileNetV1 - output of conv layer 11 is null");return{out:r,conv11:n}})}function PO(e,t,n,r,o){var i=e.shape[0],a=Math.min(n,i),s=t.map(function(c,d){return{score:c,boxIndex:d}}).filter(function(c){return c.score>o}).sort(function(c,d){return d.score-c.score}),u=function(c){return c<=r?1:0},l=[];return s.forEach(function(c){if(!(l.length>=a)){for(var d=c.score,f=l.length-1;f>=0;--f){var h=DO(e,c.boxIndex,l[f]);if(h!==0&&(c.score*=u(h),c.score<=o))break}d===c.score&&l.push(c.boxIndex)}}),l}function DO(e,t,n){var r=e.arraySync(),o=Math.min(r[t][0],r[t][2]),i=Math.min(r[t][1],r[t][3]),a=Math.max(r[t][0],r[t][2]),s=Math.max(r[t][1],r[t][3]),u=Math.min(r[n][0],r[n][2]),l=Math.min(r[n][1],r[n][3]),c=Math.max(r[n][0],r[n][2]),d=Math.max(r[n][1],r[n][3]),f=(a-o)*(s-i),h=(c-u)*(d-l);if(f<=0||h<=0)return 0;var v=Math.max(o,u),m=Math.max(i,l),g=Math.min(a,c),p=Math.min(s,d),y=Math.max(g-v,0)*Math.max(p-m,0);return y/(f+h-y)}function FO(e){var t=ft(Xo(e,[1,0])),n=[pt(t[2],t[0]),pt(t[3],t[1])],r=[Ee(t[0],Jn(n[0],ee(2))),Ee(t[1],Jn(n[1],ee(2)))];return{sizes:n,centers:r}}function MO(e,t){var n=FO(e),r=n.sizes,o=n.centers,i=ft(Xo(t,[1,0])),a=Jn(jt(tp(Jn(i[2],ee(5))),r[0]),ee(2)),s=Ee(jt(Jn(i[0],ee(10)),r[0]),o[0]),u=Jn(jt(tp(Jn(i[3],ee(5))),r[1]),ee(2)),l=Ee(jt(Jn(i[1],ee(10)),r[1]),o[1]);return Xo(Cn([pt(s,a),pt(l,u),Ee(s,a),Ee(l,u)]),[1,0])}function OO(e,t,n){return te(function(){var r=e.shape[0],o=MO(Zn(wa(n.extra_dim,[r,1,1]),[-1,4]),Zn(e,[-1,4]));o=Zn(o,[r,o.shape[0]/r,4]);var i=k2(Tr(t,[0,0,1],[-1,-1,-1])),a=Tr(i,[0,0,0],[-1,-1,1]);a=Zn(a,[r,a.shape[1]]);var s=ft(o),u=ft(a);return{boxes:s,scores:u}})}function qi(e,t){return te(function(){var n=e.shape[0],r=Zn(nr(e,t.box_encoding_predictor),[n,-1,1,4]),o=Zn(nr(e,t.class_predictor),[n,-1,3]);return{boxPredictionEncoding:r,classPrediction:o}})}function LO(e,t,n){return te(function(){var r=hr(e,n.conv_0,[1,1]),o=hr(r,n.conv_1,[2,2]),i=hr(o,n.conv_2,[1,1]),a=hr(i,n.conv_3,[2,2]),s=hr(a,n.conv_4,[1,1]),u=hr(s,n.conv_5,[2,2]),l=hr(u,n.conv_6,[1,1]),c=hr(l,n.conv_7,[2,2]),d=qi(t,n.box_predictor_0),f=qi(e,n.box_predictor_1),h=qi(o,n.box_predictor_2),v=qi(a,n.box_predictor_3),m=qi(u,n.box_predictor_4),g=qi(c,n.box_predictor_5),p=dt([d.boxPredictionEncoding,f.boxPredictionEncoding,h.boxPredictionEncoding,v.boxPredictionEncoding,m.boxPredictionEncoding,g.boxPredictionEncoding],1),y=dt([d.classPrediction,f.classPrediction,h.classPrediction,v.classPrediction,m.classPrediction,g.classPrediction],1);return{boxPredictions:p,classPredictions:y}})}var cm=function(){function e(t){var n=t===void 0?{}:t,r=n.minConfidence,o=n.maxResults;if(this._name="SsdMobilenetv1Options",this._minConfidence=r||.5,this._maxResults=o||100,typeof this._minConfidence!="number"||this._minConfidence<=0||this._minConfidence>=1)throw new Error(this._name+" - expected minConfidence to be a number between 0 and 1");if(typeof this._maxResults!="number")throw new Error(this._name+" - expected maxResults to be a number")}return Object.defineProperty(e.prototype,"minConfidence",{get:function(){return this._minConfidence},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maxResults",{get:function(){return this._maxResults},enumerable:!0,configurable:!0}),e}(),LC=function(e){he(t,e);function t(){return e.call(this,"SsdMobilenetv1")||this}return t.prototype.forwardInput=function(n){var r=this.params;if(!r)throw new Error("SsdMobilenetv1 - load model before inference");return te(function(){var o=n.toBatchTensor(512,!1).toFloat(),i=pt(jt(o,ee(.007843137718737125)),ee(1)),a=AO(i,r.mobilenetv1),s=LO(a.out,a.conv11,r.prediction_layer),u=s.boxPredictions,l=s.classPredictions;return OO(u,l,r.output_layer)})},t.prototype.forward=function(n){return le(this,void 0,void 0,function(){var r;return ce(this,function(o){switch(o.label){case 0:return r=this.forwardInput,[4,wt(n)];case 1:return[2,r.apply(this,[o.sent()])]}})})},t.prototype.locateFaces=function(n,r){return r===void 0&&(r={}),le(this,void 0,void 0,function(){var o,i,a,s,u,l,c,d,f,h,v,m,g,p,y,x,w,b,C,E,S;return ce(this,function(R){switch(R.label){case 0:return o=new cm(r),i=o.maxResults,a=o.minConfidence,[4,wt(n)];case 1:for(s=R.sent(),u=this.forwardInput(s),l=u.boxes,c=u.scores,d=l[0],f=c[0],h=1;h<l.length;h++)l[h].dispose(),c[h].dispose();return g=(m=Array).from,[4,f.data()];case 2:return v=g.apply(m,[R.sent()]),p=.5,y=PO(d,v,i,p,a),x=s.getReshapedInputDimensions(0),w=s.inputSize,b=w/x.width,C=w/x.height,E=d.arraySync(),S=y.map(function(k){var P=[Math.max(0,E[k][0]),Math.min(1,E[k][2])].map(function(z){return z*C}),T=P[0],j=P[1],O=[Math.max(0,E[k][1]),Math.min(1,E[k][3])].map(function(z){return z*b}),W=O[0],U=O[1];return new Mr(v[k],new Zv(W,T,U-W,j-T),{height:s.getInputHeight(0),width:s.getInputWidth(0)})}),d.dispose(),f.dispose(),[2,S]}})})},t.prototype.getDefaultModelName=function(){return"ssd_mobilenetv1_model"},t.prototype.extractParamsFromWeigthMap=function(n){return RO(n)},t.prototype.extractParams=function(n){return SO(n)},t}(oo);(function(e){he(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t})(LC);var BO=.4,jO=[new Te(.738768,.874946),new Te(2.42204,2.65704),new Te(4.30971,7.04493),new Te(10.246,4.59428),new Te(12.6868,11.8741)],WO=[new Te(1.603231,2.094468),new Te(6.041143,7.080126),new Te(2.882459,3.518061),new Te(4.266906,5.178857),new Te(9.041765,10.66308)],zO=[117.001,114.697,97.404],UO="tiny_yolov2_model",$O="tiny_yolov2_separable_conv_model",dl=function(e){return typeof e=="number"};function VO(e){if(!e)throw new Error("invalid config: "+e);if(typeof e.withSeparableConvs!="boolean")throw new Error("config.withSeparableConvs has to be a boolean, have: "+e.withSeparableConvs);if(!dl(e.iouThreshold)||e.iouThreshold<0||e.iouThreshold>1)throw new Error("config.iouThreshold has to be a number between [0, 1], have: "+e.iouThreshold);if(!Array.isArray(e.classes)||!e.classes.length||!e.classes.every(function(t){return typeof t=="string"}))throw new Error("config.classes has to be an array class names: string[], have: "+JSON.stringify(e.classes));if(!Array.isArray(e.anchors)||!e.anchors.length||!e.anchors.map(function(t){return t||{}}).every(function(t){return dl(t.x)&&dl(t.y)}))throw new Error("config.anchors has to be an array of { x: number, y: number }, have: "+JSON.stringify(e.anchors));if(e.meanRgb&&(!Array.isArray(e.meanRgb)||e.meanRgb.length!==3||!e.meanRgb.every(dl)))throw new Error("config.meanRgb has to be an array of shape [number, number, number], have: "+JSON.stringify(e.meanRgb))}function dm(e){return te(function(){var t=jt(e,ee(.10000000149011612));return Ee(Ke(pt(e,t)),t)})}function vo(e,t){return te(function(){var n=Oi(e,[[0,0],[1,1],[1,1],[0,0]]);return n=Bn(n,t.conv.filters,[1,1],"valid"),n=pt(n,t.bn.sub),n=jt(n,t.bn.truediv),n=Ee(n,t.conv.bias),dm(n)})}function mo(e,t){return te(function(){var n=Oi(e,[[0,0],[1,1],[1,1],[0,0]]);return n=Wv(n,t.depthwise_filter,t.pointwise_filter,[1,1],"valid"),n=Ee(n,t.bias),dm(n)})}function HO(e,t){var n=bd(e,t);function r(a,s){var u=at(e(a)),l=at(e(a));return t.push({paramPath:s+"/sub"},{paramPath:s+"/truediv"}),{sub:u,truediv:l}}function o(a,s,u){var l=n(a,s,3,u+"/conv"),c=r(s,u+"/bn");return{conv:l,bn:c}}var i=am(e,t);return{extractConvParams:n,extractConvWithBatchNormParams:o,extractSeparableConvParams:i}}function GO(e,t,n,r){var o=ao(e),i=o.extractWeights,a=o.getRemainingWeights,s=[],u=HO(i,s),l=u.extractConvParams,c=u.extractConvWithBatchNormParams,d=u.extractSeparableConvParams,f;if(t.withSeparableConvs){var h=r[0],v=r[1],m=r[2],g=r[3],p=r[4],y=r[5],x=r[6],w=r[7],b=r[8],C=t.isFirstLayerConv2d?l(h,v,3,"conv0"):d(h,v,"conv0"),E=d(v,m,"conv1"),S=d(m,g,"conv2"),R=d(g,p,"conv3"),k=d(p,y,"conv4"),P=d(y,x,"conv5"),T=w?d(x,w,"conv6"):void 0,j=b?d(w,b,"conv7"):void 0,O=l(b||w||x,5*n,1,"conv8");f={conv0:C,conv1:E,conv2:S,conv3:R,conv4:k,conv5:P,conv6:T,conv7:j,conv8:O}}else{var h=r[0],v=r[1],m=r[2],g=r[3],p=r[4],y=r[5],x=r[6],w=r[7],b=r[8],C=c(h,v,"conv0"),E=c(v,m,"conv1"),S=c(m,g,"conv2"),R=c(g,p,"conv3"),k=c(p,y,"conv4"),P=c(y,x,"conv5"),T=c(x,w,"conv6"),j=c(w,b,"conv7"),O=l(b,5*n,1,"conv8");f={conv0:C,conv1:E,conv2:S,conv3:R,conv4:k,conv5:P,conv6:T,conv7:j,conv8:O}}if(a().length!==0)throw new Error("weights remaing after extract: "+a().length);return{params:f,paramMappings:s}}function qO(e,t){var n=ni(e,t);function r(s){var u=n(s+"/sub",1),l=n(s+"/truediv",1);return{sub:u,truediv:l}}function o(s){var u=n(s+"/filters",4),l=n(s+"/bias",1);return{filters:u,bias:l}}function i(s){var u=o(s+"/conv"),l=r(s+"/bn");return{conv:u,bn:l}}var a=sm(n);return{extractConvParams:o,extractConvWithBatchNormParams:i,extractSeparableConvParams:a}}function KO(e,t){var n=[],r=qO(e,n),o=r.extractConvParams,i=r.extractConvWithBatchNormParams,a=r.extractSeparableConvParams,s;if(t.withSeparableConvs){var u=t.filterSizes&&t.filterSizes.length||9;s={conv0:t.isFirstLayerConv2d?o("conv0"):a("conv0"),conv1:a("conv1"),conv2:a("conv2"),conv3:a("conv3"),conv4:a("conv4"),conv5:a("conv5"),conv6:u>7?a("conv6"):void 0,conv7:u>8?a("conv7"):void 0,conv8:o("conv8")}}else s={conv0:i("conv0"),conv1:i("conv1"),conv2:i("conv2"),conv3:i("conv3"),conv4:i("conv4"),conv5:i("conv5"),conv6:i("conv6"),conv7:i("conv7"),conv8:o("conv8")};return io(e,n),{params:s,paramMappings:n}}var C0;(function(e){e[e.XS=224]="XS",e[e.SM=320]="SM",e[e.MD=416]="MD",e[e.LG=608]="LG"})(C0||(C0={}));var fm=function(){function e(t){var n=t===void 0?{}:t,r=n.inputSize,o=n.scoreThreshold;if(this._name="TinyYolov2Options",this._inputSize=r||416,this._scoreThreshold=o||.5,typeof this._inputSize!="number"||this._inputSize%32!==0)throw new Error(this._name+" - expected inputSize to be a number divisible by 32");if(typeof this._scoreThreshold!="number"||this._scoreThreshold<=0||this._scoreThreshold>=1)throw new Error(this._name+" - expected scoreThreshold to be a number between 0 and 1")}return Object.defineProperty(e.prototype,"inputSize",{get:function(){return this._inputSize},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scoreThreshold",{get:function(){return this._scoreThreshold},enumerable:!0,configurable:!0}),e}(),BC=function(e){he(t,e);function t(n){var r=e.call(this,"TinyYolov2")||this;return VO(n),r._config=n,r}return Object.defineProperty(t.prototype,"config",{get:function(){return this._config},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"withClassScores",{get:function(){return this.config.withClassScores||this.config.classes.length>1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"boxEncodingSize",{get:function(){return 5+(this.withClassScores?this.config.classes.length:0)},enumerable:!0,configurable:!0}),t.prototype.runTinyYolov2=function(n,r){var o=vo(n,r.conv0);return o=mt(o,[2,2],[2,2],"same"),o=vo(o,r.conv1),o=mt(o,[2,2],[2,2],"same"),o=vo(o,r.conv2),o=mt(o,[2,2],[2,2],"same"),o=vo(o,r.conv3),o=mt(o,[2,2],[2,2],"same"),o=vo(o,r.conv4),o=mt(o,[2,2],[2,2],"same"),o=vo(o,r.conv5),o=mt(o,[2,2],[1,1],"same"),o=vo(o,r.conv6),o=vo(o,r.conv7),nr(o,r.conv8,"valid",!1)},t.prototype.runMobilenet=function(n,r){var o=this.config.isFirstLayerConv2d?dm(nr(n,r.conv0,"valid",!1)):mo(n,r.conv0);return o=mt(o,[2,2],[2,2],"same"),o=mo(o,r.conv1),o=mt(o,[2,2],[2,2],"same"),o=mo(o,r.conv2),o=mt(o,[2,2],[2,2],"same"),o=mo(o,r.conv3),o=mt(o,[2,2],[2,2],"same"),o=mo(o,r.conv4),o=mt(o,[2,2],[2,2],"same"),o=mo(o,r.conv5),o=mt(o,[2,2],[1,1],"same"),o=r.conv6?mo(o,r.conv6):o,o=r.conv7?mo(o,r.conv7):o,nr(o,r.conv8,"valid",!1)},t.prototype.forwardInput=function(n,r){var o=this,i=this.params;if(!i)throw new Error("TinyYolov2 - load model before inference");return te(function(){var a=n.toBatchTensor(r,!1).toFloat();return a=o.config.meanRgb?ku(a,o.config.meanRgb):a,a=a.div(ee(256)),o.config.withSeparableConvs?o.runMobilenet(a,i):o.runTinyYolov2(a,i)})},t.prototype.forward=function(n,r){return le(this,void 0,void 0,function(){var o;return ce(this,function(i){switch(i.label){case 0:return o=this.forwardInput,[4,wt(n)];case 1:return[4,o.apply(this,[i.sent(),r])];case 2:return[2,i.sent()]}})})},t.prototype.detect=function(n,r){return r===void 0&&(r={}),le(this,void 0,void 0,function(){var o,i,a,s,u,l,c,d,f,h,v,m,g,p,y=this;return ce(this,function(x){switch(x.label){case 0:return o=new fm(r),i=o.inputSize,a=o.scoreThreshold,[4,wt(n)];case 1:return s=x.sent(),[4,this.forwardInput(s,i)];case 2:return u=x.sent(),l=te(function(){return ft(u)[0].expandDims()}),c={width:s.getInputWidth(0),height:s.getInputHeight(0)},[4,this.extractBoxes(l,s.getReshapedInputDimensions(0),a)];case 3:return d=x.sent(),u.dispose(),l.dispose(),f=d.map(function(w){return w.box}),h=d.map(function(w){return w.score}),v=d.map(function(w){return w.classScore}),m=d.map(function(w){return y.config.classes[w.label]}),g=su(f.map(function(w){return w.rescale(i)}),h,this.config.iouThreshold,!0),p=g.map(function(w){return new cC(h[w],v[w],m[w],f[w],c)}),[2,p]}})})},t.prototype.getDefaultModelName=function(){return""},t.prototype.extractParamsFromWeigthMap=function(n){return KO(n,this.config)},t.prototype.extractParams=function(n){var r=this.config.filterSizes||t.DEFAULT_FILTER_SIZES,o=r?r.length:void 0;if(o!==7&&o!==8&&o!==9)throw new Error("TinyYolov2 - expected 7 | 8 | 9 convolutional filters, but found "+o+" filterSizes in config");return GO(n,this.config,this.boxEncodingSize,r)},t.prototype.extractBoxes=function(n,r,o){return le(this,void 0,void 0,function(){var i,a,s,u,l,c,d,f,h,v,m,g,p,y,x,w,b,C,E,S,R,k,P,T,j,O,W,U,z,D=this;return ce(this,function(M){switch(M.label){case 0:return i=r.width,a=r.height,s=Math.max(i,a),u=s/i,l=s/a,c=n.shape[1],d=this.config.anchors.length,f=te(function(){var B=n.reshape([c,c,d,D.boxEncodingSize]),q=B.slice([0,0,0,0],[c,c,d,4]),K=B.slice([0,0,0,4],[c,c,d,1]),Q=D.withClassScores?no(B.slice([0,0,0,5],[c,c,d,D.config.classes.length]),3):ee(0);return[q,K,Q]}),h=f[0],v=f[1],m=f[2],g=[],[4,v.array()];case 1:return p=M.sent(),[4,h.array()];case 2:y=M.sent(),x=0,M.label=3;case 3:if(!(x<c))return[3,12];w=0,M.label=4;case 4:if(!(w<c))return[3,11];b=0,M.label=5;case 5:return b<d?(C=Tf(p[x][w][b][0]),!o||C>o?(E=(w+Tf(y[x][w][b][0]))/c*u,S=(x+Tf(y[x][w][b][1]))/c*l,R=Math.exp(y[x][w][b][2])*this.config.anchors[b].x/c*u,k=Math.exp(y[x][w][b][3])*this.config.anchors[b].y/c*l,P=E-R/2,T=S-k/2,j={row:x,col:w,anchor:b},this.withClassScores?[4,this.extractPredictedClass(m,j)]:[3,7]):[3,9]):[3,10];case 6:return z=M.sent(),[3,8];case 7:z={classScore:1,label:0},M.label=8;case 8:O=z,W=O.classScore,U=O.label,g.push(Ot({box:new xd(P,T,P+R,T+k),score:C,classScore:C*W,label:U},j)),M.label=9;case 9:return b++,[3,5];case 10:return w++,[3,4];case 11:return x++,[3,3];case 12:return h.dispose(),v.dispose(),m.dispose(),[2,g]}})})},t.prototype.extractPredictedClass=function(n,r){return le(this,void 0,void 0,function(){var o,i,a,s;return ce(this,function(u){switch(u.label){case 0:return o=r.row,i=r.col,a=r.anchor,[4,n.array()];case 1:return s=u.sent(),[2,Array(this.config.classes.length).fill(0).map(function(l,c){return s[o][i][a][c]}).map(function(l,c){return{classScore:l,label:c}}).reduce(function(l,c){return l.classScore>c.classScore?l:c})]}})})},t.DEFAULT_FILTER_SIZES=[3,16,32,64,128,256,512,1024,1024],t}(oo),XO=function(e){he(t,e);function t(n){n===void 0&&(n=!0);var r=this,o=Object.assign({},{withSeparableConvs:n,iouThreshold:BO,classes:["face"]},n?{anchors:WO,meanRgb:zO}:{anchors:jO,withClassScores:!0});return r=e.call(this,o)||this,r}return Object.defineProperty(t.prototype,"withSeparableConvs",{get:function(){return this.config.withSeparableConvs},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"anchors",{get:function(){return this.config.anchors},enumerable:!0,configurable:!0}),t.prototype.locateFaces=function(n,r){return le(this,void 0,void 0,function(){var o;return ce(this,function(i){switch(i.label){case 0:return[4,this.detect(n,r)];case 1:return o=i.sent(),[2,o.map(function(a){return new Mr(a.score,a.relativeBox,{width:a.imageWidth,height:a.imageHeight})})]}})})},t.prototype.getDefaultModelName=function(){return this.withSeparableConvs?$O:UO},t.prototype.extractParamsFromWeigthMap=function(n){return e.prototype.extractParamsFromWeigthMap.call(this,n)},t}(BC),YO=function(e){he(t,e);function t(){var n=e!==null&&e.apply(this,arguments)||this;return n._name="TinyFaceDetectorOptions",n}return t}(fm),Ru=function(){function e(){}return e.prototype.then=function(t){return le(this,void 0,void 0,function(){var n;return ce(this,function(r){switch(r.label){case 0:return n=t,[4,this.run()];case 1:return[2,n.apply(void 0,[r.sent()])]}})})},e.prototype.run=function(){return le(this,void 0,void 0,function(){return ce(this,function(t){throw new Error("ComposableTask - run is not implemented")})})},e}();function Cd(e,t,n,r,o){return o===void 0&&(o=function(i){var a=i.alignedRect;return a}),le(this,void 0,void 0,function(){var i,a,s,u,l;return ce(this,function(c){switch(c.label){case 0:return i=e.map(function(d){return rO(d)?o(d):d.detection}),s=r,s?[3,5]:t instanceof qe?[4,om(t,i)]:[3,2];case 1:return u=c.sent(),[3,4];case 2:return[4,rm(t,i)];case 3:u=c.sent(),c.label=4;case 4:s=u,c.label=5;case 5:return a=s,[4,n(a)];case 6:return l=c.sent(),a.forEach(function(d){return d instanceof qe&&d.dispose()}),[2,l]}})})}function hm(e,t,n,r,o){return le(this,void 0,void 0,function(){var i=this;return ce(this,function(a){return[2,Cd([e],t,function(s){return le(i,void 0,void 0,function(){return ce(this,function(u){return[2,n(s[0])]})})},r,o)]})})}function QO(e){return te(function(){return Cn(ft(e,3).reverse(),3)})}var fl=2,Pc=12;function JO(e,t){var n=bd(e,t),r=im(e,t);function o(l,c){var d=at(e(l));return t.push({paramPath:c}),d}function i(l,c,d){d===void 0&&(d=!1);var f=n(l[0],l[1],3,c+"/conv1"),h=o(l[1],c+"/prelu1_alpha"),v=n(l[1],l[2],3,c+"/conv2"),m=o(l[2],c+"/prelu2_alpha"),g=n(l[2],l[3],d?2:3,c+"/conv3"),p=o(l[3],c+"/prelu3_alpha");return{conv1:f,prelu1_alpha:h,conv2:v,prelu2_alpha:m,conv3:g,prelu3_alpha:p}}function a(){var l=i([3,10,16,32],"pnet"),c=n(32,2,1,"pnet/conv4_1"),d=n(32,4,1,"pnet/conv4_2");return Ot(Ot({},l),{conv4_1:c,conv4_2:d})}function s(){var l=i([3,28,48,64],"rnet",!0),c=r(576,128,"rnet/fc1"),d=o(128,"rnet/prelu4_alpha"),f=r(128,2,"rnet/fc2_1"),h=r(128,4,"rnet/fc2_2");return Ot(Ot({},l),{fc1:c,prelu4_alpha:d,fc2_1:f,fc2_2:h})}function u(){var l=i([3,32,64,64],"onet"),c=n(64,128,2,"onet/conv4"),d=o(128,"onet/prelu4_alpha"),f=r(1152,256,"onet/fc1"),h=o(256,"onet/prelu5_alpha"),v=r(256,2,"onet/fc2_1"),m=r(256,4,"onet/fc2_2"),g=r(256,10,"onet/fc2_3");return Ot(Ot({},l),{conv4:c,prelu4_alpha:d,fc1:f,prelu5_alpha:h,fc2_1:v,fc2_2:m,fc2_3:g})}return{extractPNetParams:a,extractRNetParams:s,extractONetParams:u}}function ZO(e){var t=ao(e),n=t.extractWeights,r=t.getRemainingWeights,o=[],i=JO(n,o),a=i.extractPNetParams,s=i.extractRNetParams,u=i.extractONetParams,l=a(),c=s(),d=u();if(r().length!==0)throw new Error("weights remaing after extract: "+r().length);return{params:{pnet:l,rnet:c,onet:d},paramMappings:o}}function eL(e,t){var n=ni(e,t);function r(c){var d=n(c+"/weights",4,c+"/filters"),f=n(c+"/bias",1);return{filters:d,bias:f}}function o(c){var d=n(c+"/weights",2),f=n(c+"/bias",1);return{weights:d,bias:f}}function i(c){return n(c,1)}function a(c){var d=r(c+"/conv1"),f=i(c+"/prelu1_alpha"),h=r(c+"/conv2"),v=i(c+"/prelu2_alpha"),m=r(c+"/conv3"),g=i(c+"/prelu3_alpha");return{conv1:d,prelu1_alpha:f,conv2:h,prelu2_alpha:v,conv3:m,prelu3_alpha:g}}function s(){var c=a("pnet"),d=r("pnet/conv4_1"),f=r("pnet/conv4_2");return Ot(Ot({},c),{conv4_1:d,conv4_2:f})}function u(){var c=a("rnet"),d=o("rnet/fc1"),f=i("rnet/prelu4_alpha"),h=o("rnet/fc2_1"),v=o("rnet/fc2_2");return Ot(Ot({},c),{fc1:d,prelu4_alpha:f,fc2_1:h,fc2_2:v})}function l(){var c=a("onet"),d=r("onet/conv4"),f=i("onet/prelu4_alpha"),h=o("onet/fc1"),v=i("onet/prelu5_alpha"),m=o("onet/fc2_1"),g=o("onet/fc2_2"),p=o("onet/fc2_3");return Ot(Ot({},c),{conv4:d,prelu4_alpha:f,fc1:h,prelu5_alpha:v,fc2_1:m,fc2_2:g,fc2_3:p})}return{extractPNetParams:s,extractRNetParams:u,extractONetParams:l}}function tL(e){var t=[],n=eL(e,t),r=n.extractPNetParams,o=n.extractRNetParams,i=n.extractONetParams,a=r(),s=o(),u=i();return io(e,t),{params:{pnet:a,rnet:s,onet:u},paramMappings:t}}function lp(e,t){var n=t[0],r=t[1];return{height:Math.floor(n*e),width:Math.floor(r*e)}}function nL(e,t,n){for(var r=n[0],o=n[1],i=Pc/e,a=[],s=Math.min(r,o)*i,u=0;s>=12;)a.push(i*Math.pow(t,u)),s=s*t,u+=1;return a}var pm=function(e){he(t,e);function t(n,r,o,i){return e.call(this,{left:n,top:r,right:o,bottom:i},!0)||this}return t}(Yo);function jC(e){return te(function(){return jt(pt(e,ee(127.5)),ee(.0078125))})}function ka(e,t){return te(function(){return Ee(Ke(e),jt(t,Sc(Ke(Sc(e)))))})}function vm(e,t,n){return n===void 0&&(n=!1),te(function(){var r=nr(e,t.conv1,"valid");return r=ka(r,t.prelu1_alpha),r=mt(r,n?[2,2]:[3,3],[2,2],"same"),r=nr(r,t.conv2,"valid"),r=ka(r,t.prelu2_alpha),r=n?r:mt(r,[3,3],[2,2],"valid"),r=nr(r,t.conv3,"valid"),r=ka(r,t.prelu3_alpha),r})}function rL(e,t){return te(function(){var n=vm(e,t,!0),r=nr(n,t.conv4_1,"valid"),o=Tn(vd(r,3),3),i=no(pt(r,o),3),a=nr(n,t.conv4_2,"valid");return{prob:i,regions:a}})}function oL(e,t){return te(function(){var n=lp(t,e.shape.slice(1)),r=n.height,o=n.width,i=Hv.resizeBilinear(e,[r,o]),a=jC(i);return Xo(a,[0,2,1,3])})}function iL(e,t,n,r){for(var o=[],i=e.arraySync(),a=0;a<e.shape[0];a++)for(var s=0;s<e.shape[1];s++)i[a][s]>=r&&o.push(new Te(s,a));var u=o.map(function(l){var c=new xd(Math.round((l.y*fl+1)/n),Math.round((l.x*fl+1)/n),Math.round((l.y*fl+Pc)/n),Math.round((l.x*fl+Pc)/n)),d=i[l.y][l.x],f=t.arraySync(),h=new pm(f[l.y][l.x][0],f[l.y][l.x][1],f[l.y][l.x][2],f[l.y][l.x][3]);return{cell:c,score:d,region:h}});return u}function aL(e,t,n,r,o){o.stage1=[];var i=t.map(function(f){return te(function(){var h={scale:f},v=oL(e,f),m=Date.now(),g=rL(v,r),p=g.prob,y=g.regions;h.pnet=Date.now()-m;var x=ft(ft(p,3)[1])[0],w=ft(y)[0];return{scoresTensor:x,regionsTensor:w,scale:f,statsForScale:h}})}),a=i.map(function(f){var h=f.scoresTensor,v=f.regionsTensor,m=f.scale,g=f.statsForScale,p=iL(h,v,m,n);if(h.dispose(),v.dispose(),!p.length)return o.stage1.push(g),[];var y=Date.now(),x=su(p.map(function(w){return w.cell}),p.map(function(w){return w.score}),.5);return g.nms=Date.now()-y,g.numBoxes=x.length,o.stage1.push(g),x.map(function(w){return p[w]})}),s=a.reduce(function(f,h){return f.concat(h)},[]),u=[],l=[];if(s.length>0){var c=Date.now(),d=su(s.map(function(f){return f.cell}),s.map(function(f){return f.score}),.7);o.stage1_nms=Date.now()-c,l=d.map(function(f){return s[f].score}),u=d.map(function(f){return s[f]}).map(function(f){var h=f.cell,v=f.region;return new xd(h.left+v.left*h.width,h.top+v.top*h.height,h.right+v.right*h.width,h.bottom+v.bottom*h.height).toSquare().round()})}return{boxes:u,scores:l}}function WC(e,t,n){var r=n.width,o=n.height;return le(this,void 0,void 0,function(){var i,a,s,u=this;return ce(this,function(l){switch(l.label){case 0:return i=Pi(e),[4,Promise.all(t.map(function(c){return le(u,void 0,void 0,function(){var d,f,h,v,m,g,p,y;return ce(this,function(x){return d=c.padAtBorders(e.height,e.width),f=d.y,h=d.ey,v=d.x,m=d.ex,g=v-1,p=f-1,y=i.getImageData(g,p,m-g,h-p),[2,zt.isNodejs()?nm(y):createImageBitmap(y)]})})}))];case 1:return a=l.sent(),s=[],a.forEach(function(c){var d=wd({width:r,height:o}),f=Pi(d);f.drawImage(c,0,0,r,o);for(var h=f.getImageData(0,0,r,o).data,v=[],m=0;m<h.length;m+=4)v.push(h[m+2]),v.push(h[m+1]),v.push(h[m]);s.push(v)}),[2,s.map(function(c){var d=te(function(){var f=Xo(Zt(c,[1,r,o,3]),[0,2,1,3]).toFloat();return jC(f)});return d})]}})})}function sL(e,t){return te(function(){var n=vm(e,t),r=Zn(n,[n.shape[0],t.fc1.weights.shape[0]]),o=Cr(r,t.fc1),i=ka(o,t.prelu4_alpha),a=Cr(i,t.fc2_1),s=Tn(vd(a,1),1),u=no(pt(a,s),1),l=Cr(i,t.fc2_2),c=ft(u,1)[1];return{scores:c,regions:l}})}function uL(e,t,n,r,o){return le(this,void 0,void 0,function(){var i,a,s,u,l,c,d,f,h,v,m,g,p,y;return ce(this,function(x){switch(x.label){case 0:return i=Date.now(),[4,WC(e,t,{width:24,height:24})];case 1:return a=x.sent(),o.stage2_extractImagePatches=Date.now()-i,i=Date.now(),s=a.map(function(w){var b=sL(w,r);return w.dispose(),b}),o.stage2_rnet=Date.now()-i,u=s.length>1?dt(s.map(function(w){return w.scores})):s[0].scores,d=(c=Array).from,[4,u.data()];case 2:return l=d.apply(c,[x.sent()]),u.dispose(),f=l.map(function(w,b){return{score:w,idx:b}}).filter(function(w){return w.score>n}).map(function(w){var b=w.idx;return b}),h=f.map(function(w){return t[w]}),v=f.map(function(w){return l[w]}),m=[],g=[],h.length>0&&(i=Date.now(),p=su(h,v,.7),o.stage2_nms=Date.now()-i,y=p.map(function(w){var b=s[f[w]].regions.arraySync();return new pm(b[0][0],b[0][1],b[0][2],b[0][3])}),g=p.map(function(w){return v[w]}),m=p.map(function(w,b){return h[w].calibrate(y[b])})),s.forEach(function(w){w.regions.dispose(),w.scores.dispose()}),[2,{boxes:m,scores:g}]}})})}function lL(e,t){return te(function(){var n=vm(e,t);n=mt(n,[2,2],[2,2],"same"),n=nr(n,t.conv4,"valid"),n=ka(n,t.prelu4_alpha);var r=Zn(n,[n.shape[0],t.fc1.weights.shape[0]]),o=Cr(r,t.fc1),i=ka(o,t.prelu5_alpha),a=Cr(i,t.fc2_1),s=Tn(vd(a,1),1),u=no(pt(a,s),1),l=Cr(i,t.fc2_2),c=Cr(i,t.fc2_3),d=ft(u,1)[1];return{scores:d,regions:l,points:c}})}function cL(e,t,n,r,o){return le(this,void 0,void 0,function(){var i,a,s,u,l,c,d,f,h,v,m,g,p,y,x;return ce(this,function(w){switch(w.label){case 0:return i=Date.now(),[4,WC(e,t,{width:48,height:48})];case 1:return a=w.sent(),o.stage3_extractImagePatches=Date.now()-i,i=Date.now(),s=a.map(function(b){var C=lL(b,r);return b.dispose(),C}),o.stage3_onet=Date.now()-i,u=s.length>1?dt(s.map(function(b){return b.scores})):s[0].scores,d=(c=Array).from,[4,u.data()];case 2:return l=d.apply(c,[w.sent()]),u.dispose(),f=l.map(function(b,C){return{score:b,idx:C}}).filter(function(b){return b.score>n}).map(function(b){var C=b.idx;return C}),h=f.map(function(b){var C=s[b].regions.arraySync();return new pm(C[0][0],C[0][1],C[0][2],C[0][3])}),v=f.map(function(b,C){return t[b].calibrate(h[C])}),m=f.map(function(b){return l[b]}),g=[],p=[],y=[],v.length>0&&(i=Date.now(),x=su(v,m,.7,!1),o.stage3_nms=Date.now()-i,g=x.map(function(b){return v[b]}),p=x.map(function(b){return m[b]}),y=x.map(function(b,C){return Array(5).fill(0).map(function(E,S){var R=s[b].points.arraySync();return new Te(R[0][S]*(g[C].width+1)+g[C].left,R[0][S+5]*(g[C].height+1)+g[C].top)})})),s.forEach(function(b){b.regions.dispose(),b.scores.dispose(),b.points.dispose()}),[2,{boxes:g,scores:p,points:y}]}})})}var dL=function(e){he(t,e);function t(){return e.call(this,"Mtcnn")||this}return t.prototype.load=function(n){return le(this,void 0,void 0,function(){return ce(this,function(r){return console.warn("mtcnn is deprecated and will be removed soon"),[2,e.prototype.load.call(this,n)]})})},t.prototype.loadFromDisk=function(n){return le(this,void 0,void 0,function(){return ce(this,function(r){return console.warn("mtcnn is deprecated and will be removed soon"),[2,e.prototype.loadFromDisk.call(this,n)]})})},t.prototype.forwardInput=function(n,r){return r===void 0&&(r={}),le(this,void 0,void 0,function(){var o,i,a,s,u,l,c,d,f,h,v,m,g,p,y,x,w,b,C,E,S;return ce(this,function(R){switch(R.label){case 0:if(o=this.params,!o)throw new Error("Mtcnn - load model before inference");if(i=n.canvases[0],!i)throw new Error("Mtcnn - inputCanvas is not defined, note that passing tensors into Mtcnn.forwardInput is not supported yet.");return a={},s=Date.now(),u=te(function(){return QO(Tn(Qv.fromPixels(i)).toFloat())}),l=function(k){return u.dispose(),a.total=Date.now()-s,k},c=u.shape.slice(1),d=c[0],f=c[1],h=new OC(r),v=h.minFaceSize,m=h.scaleFactor,g=h.maxNumScales,p=h.scoreThresholds,y=h.scaleSteps,x=(y||nL(v,m,[d,f])).filter(function(k){var P=lp(k,[d,f]);return Math.min(P.width,P.height)>Pc}).slice(0,g),a.scales=x,a.pyramid=x.map(function(k){return lp(k,[d,f])}),w=Date.now(),[4,aL(u,x,p[0],o.pnet,a)];case 1:return b=R.sent(),a.total_stage1=Date.now()-w,b.boxes.length?(a.stage2_numInputBoxes=b.boxes.length,w=Date.now(),[4,uL(i,b.boxes,p[1],o.rnet,a)]):[2,l({results:[],stats:a})];case 2:return C=R.sent(),a.total_stage2=Date.now()-w,C.boxes.length?(a.stage3_numInputBoxes=C.boxes.length,w=Date.now(),[4,cL(i,C.boxes,p[2],o.onet,a)]):[2,l({results:[],stats:a})];case 3:return E=R.sent(),a.total_stage3=Date.now()-w,S=E.boxes.map(function(k,P){return um(em({},new Mr(E.scores[P],new Zv(k.left/f,k.top/d,k.width/f,k.height/d),{height:d,width:f})),new WM(E.points[P].map(function(T){return T.sub(new Te(k.left,k.top)).div(new Te(k.width,k.height))}),{width:k.width,height:k.height}))}),[2,l({results:S,stats:a})]}})})},t.prototype.forward=function(n,r){return r===void 0&&(r={}),le(this,void 0,void 0,function(){var o;return ce(this,function(i){switch(i.label){case 0:return o=this.forwardInput,[4,wt(n)];case 1:return[4,o.apply(this,[i.sent(),r])];case 2:return[2,i.sent().results]}})})},t.prototype.forwardWithStats=function(n,r){return r===void 0&&(r={}),le(this,void 0,void 0,function(){var o;return ce(this,function(i){switch(i.label){case 0:return o=this.forwardInput,[4,wt(n)];case 1:return[2,o.apply(this,[i.sent(),r])]}})})},t.prototype.getDefaultModelName=function(){return"mtcnn_model"},t.prototype.extractParamsFromWeigthMap=function(n){return tL(n)},t.prototype.extractParams=function(n){return ZO(n)},t}(oo),fL=.4,hL=[new Te(1.603231,2.094468),new Te(6.041143,7.080126),new Te(2.882459,3.518061),new Te(4.266906,5.178857),new Te(9.041765,10.66308)],pL=[117.001,114.697,97.404],vL=function(e){he(t,e);function t(){var n=this,r={withSeparableConvs:!0,iouThreshold:fL,classes:["face"],anchors:hL,meanRgb:pL,isFirstLayerConv2d:!0,filterSizes:[3,16,32,64,128,256,512]};return n=e.call(this,r)||this,n}return Object.defineProperty(t.prototype,"anchors",{get:function(){return this.config.anchors},enumerable:!0,configurable:!0}),t.prototype.locateFaces=function(n,r){return le(this,void 0,void 0,function(){var o;return ce(this,function(i){switch(i.label){case 0:return[4,this.detect(n,r)];case 1:return o=i.sent(),[2,o.map(function(a){return new Mr(a.score,a.relativeBox,{width:a.imageWidth,height:a.imageHeight})})]}})})},t.prototype.getDefaultModelName=function(){return"tiny_face_detector_model"},t.prototype.extractParamsFromWeigthMap=function(n){return e.prototype.extractParamsFromWeigthMap.call(this,n)},t}(BC),Fn={ssdMobilenetv1:new LC,tinyFaceDetector:new vL,tinyYolov2:new XO,mtcnn:new dL,faceLandmark68Net:new TC,faceLandmark68TinyNet:new mO,faceRecognitionNet:new EO,faceExpressionNet:new nO,ageGenderNet:new fO},zC=function(e){he(t,e);function t(n,r,o){var i=e.call(this)||this;return i.parentTask=n,i.input=r,i.extractedFaces=o,i}return t}(Ru),mm=function(e){he(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return le(this,void 0,void 0,function(){var n,r,o=this;return ce(this,function(i){switch(i.label){case 0:return[4,this.parentTask];case 1:return n=i.sent(),[4,Cd(n,this.input,function(a){return le(o,void 0,void 0,function(){return ce(this,function(s){switch(s.label){case 0:return[4,Promise.all(a.map(function(u){return Fn.faceExpressionNet.predictExpressions(u)}))];case 1:return[2,s.sent()]}})})},this.extractedFaces)];case 2:return r=i.sent(),[2,n.map(function(a,s){return RC(a,r[s])})]}})})},t.prototype.withAgeAndGender=function(){return new wm(this,this.input)},t}(zC),gm=function(e){he(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return le(this,void 0,void 0,function(){var n,r;return ce(this,function(o){switch(o.label){case 0:return[4,this.parentTask];case 1:return n=o.sent(),n?[4,hm(n,this.input,function(i){return Fn.faceExpressionNet.predictExpressions(i)},this.extractedFaces)]:[2];case 2:return r=o.sent(),[2,RC(n,r)]}})})},t.prototype.withAgeAndGender=function(){return new bm(this,this.input)},t}(zC),ym=function(e){he(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.withAgeAndGender=function(){return new Cm(this,this.input)},t.prototype.withFaceDescriptors=function(){return new _m(this,this.input)},t}(mm),xm=function(e){he(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.withAgeAndGender=function(){return new Em(this,this.input)},t.prototype.withFaceDescriptor=function(){return new Sm(this,this.input)},t}(gm),UC=function(e){he(t,e);function t(n,r,o){var i=e.call(this)||this;return i.parentTask=n,i.input=r,i.extractedFaces=o,i}return t}(Ru),wm=function(e){he(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return le(this,void 0,void 0,function(){var n,r,o=this;return ce(this,function(i){switch(i.label){case 0:return[4,this.parentTask];case 1:return n=i.sent(),[4,Cd(n,this.input,function(a){return le(o,void 0,void 0,function(){return ce(this,function(s){switch(s.label){case 0:return[4,Promise.all(a.map(function(u){return Fn.ageGenderNet.predictAgeAndGender(u)}))];case 1:return[2,s.sent()]}})})},this.extractedFaces)];case 2:return r=i.sent(),[2,n.map(function(a,s){var u=r[s],l=u.age,c=u.gender,d=u.genderProbability;return FC(MC(a,c,d),l)})]}})})},t.prototype.withFaceExpressions=function(){return new mm(this,this.input)},t}(UC),bm=function(e){he(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return le(this,void 0,void 0,function(){var n,r,o,i,a;return ce(this,function(s){switch(s.label){case 0:return[4,this.parentTask];case 1:return n=s.sent(),n?[4,hm(n,this.input,function(u){return Fn.ageGenderNet.predictAgeAndGender(u)},this.extractedFaces)]:[2];case 2:return r=s.sent(),o=r.age,i=r.gender,a=r.genderProbability,[2,FC(MC(n,i,a),o)]}})})},t.prototype.withFaceExpressions=function(){return new gm(this,this.input)},t}(UC),Cm=function(e){he(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.withFaceExpressions=function(){return new ym(this,this.input)},t.prototype.withFaceDescriptors=function(){return new _m(this,this.input)},t}(wm),Em=function(e){he(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.withFaceExpressions=function(){return new xm(this,this.input)},t.prototype.withFaceDescriptor=function(){return new Sm(this,this.input)},t}(bm),$C=function(e){he(t,e);function t(n,r){var o=e.call(this)||this;return o.parentTask=n,o.input=r,o}return t}(Ru),_m=function(e){he(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return le(this,void 0,void 0,function(){var n,r;return ce(this,function(o){switch(o.label){case 0:return[4,this.parentTask];case 1:return n=o.sent(),[4,Cd(n,this.input,function(i){return Promise.all(i.map(function(a){return Fn.faceRecognitionNet.computeFaceDescriptor(a)}))},null,function(i){return i.landmarks.align(null,{useDlibAlignment:!0})})];case 2:return r=o.sent(),[2,r.map(function(i,a){return DC(n[a],i)})]}})})},t.prototype.withFaceExpressions=function(){return new ym(this,this.input)},t.prototype.withAgeAndGender=function(){return new Cm(this,this.input)},t}($C),Sm=function(e){he(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return le(this,void 0,void 0,function(){var n,r;return ce(this,function(o){switch(o.label){case 0:return[4,this.parentTask];case 1:return n=o.sent(),n?[4,hm(n,this.input,function(i){return Fn.faceRecognitionNet.computeFaceDescriptor(i)},null,function(i){return i.landmarks.align(null,{useDlibAlignment:!0})})]:[2];case 2:return r=o.sent(),[2,DC(n,r)]}})})},t.prototype.withFaceExpressions=function(){return new xm(this,this.input)},t.prototype.withAgeAndGender=function(){return new Em(this,this.input)},t}($C),VC=function(e){he(t,e);function t(n,r,o){var i=e.call(this)||this;return i.parentTask=n,i.input=r,i.useTinyLandmarkNet=o,i}return Object.defineProperty(t.prototype,"landmarkNet",{get:function(){return this.useTinyLandmarkNet?Fn.faceLandmark68TinyNet:Fn.faceLandmark68Net},enumerable:!0,configurable:!0}),t}(Ru),mL=function(e){he(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return le(this,void 0,void 0,function(){var n,r,o,i,a,s=this;return ce(this,function(u){switch(u.label){case 0:return[4,this.parentTask];case 1:return n=u.sent(),r=n.map(function(l){return l.detection}),this.input instanceof qe?[4,om(this.input,r)]:[3,3];case 2:return i=u.sent(),[3,5];case 3:return[4,rm(this.input,r)];case 4:i=u.sent(),u.label=5;case 5:return o=i,[4,Promise.all(o.map(function(l){return s.landmarkNet.detectLandmarks(l)}))];case 6:return a=u.sent(),o.forEach(function(l){return l instanceof qe&&l.dispose()}),[2,n.map(function(l,c){return um(l,a[c])})]}})})},t.prototype.withFaceExpressions=function(){return new ym(this,this.input)},t.prototype.withAgeAndGender=function(){return new Cm(this,this.input)},t.prototype.withFaceDescriptors=function(){return new _m(this,this.input)},t}(VC),gL=function(e){he(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return le(this,void 0,void 0,function(){var n,r,o,i,a;return ce(this,function(s){switch(s.label){case 0:return[4,this.parentTask];case 1:return n=s.sent(),n?(r=n.detection,this.input instanceof qe?[4,om(this.input,[r])]:[3,3]):[2];case 2:return i=s.sent(),[3,5];case 3:return[4,rm(this.input,[r])];case 4:i=s.sent(),s.label=5;case 5:return o=i,[4,this.landmarkNet.detectLandmarks(o[0])];case 6:return a=s.sent(),o.forEach(function(u){return u instanceof qe&&u.dispose()}),[2,um(n,a)]}})})},t.prototype.withFaceExpressions=function(){return new xm(this,this.input)},t.prototype.withAgeAndGender=function(){return new Em(this,this.input)},t.prototype.withFaceDescriptor=function(){return new Sm(this,this.input)},t}(VC),HC=function(e){he(t,e);function t(n,r){r===void 0&&(r=new cm);var o=e.call(this)||this;return o.input=n,o.options=r,o}return t}(Ru),yL=function(e){he(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return le(this,void 0,void 0,function(){var n,r,o,i;return ce(this,function(a){switch(a.label){case 0:return n=this,r=n.input,o=n.options,o instanceof OC?[4,Fn.mtcnn.forward(r,o)]:[3,2];case 1:return[2,a.sent().map(function(s){return s.detection})];case 2:if(i=o instanceof YO?function(s){return Fn.tinyFaceDetector.locateFaces(s,o)}:o instanceof cm?function(s){return Fn.ssdMobilenetv1.locateFaces(s,o)}:o instanceof fm?function(s){return Fn.tinyYolov2.locateFaces(s,o)}:null,!i)throw new Error("detectFaces - expected options to be instance of TinyFaceDetectorOptions | SsdMobilenetv1Options | MtcnnOptions | TinyYolov2Options");return[2,i(r)]}})})},t.prototype.runAndExtendWithFaceDetections=function(){var n=this;return new Promise(function(r){return le(n,void 0,void 0,function(){var o;return ce(this,function(i){switch(i.label){case 0:return[4,this.run()];case 1:return o=i.sent(),[2,r(o.map(function(a){return em({},a)}))]}})})})},t.prototype.withFaceLandmarks=function(n){return n===void 0&&(n=!1),new mL(this.runAndExtendWithFaceDetections(),this.input,n)},t.prototype.withFaceExpressions=function(){return new mm(this.runAndExtendWithFaceDetections(),this.input)},t.prototype.withAgeAndGender=function(){return new wm(this.runAndExtendWithFaceDetections(),this.input)},t}(HC);(function(e){he(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return le(this,void 0,void 0,function(){var n,r;return ce(this,function(o){switch(o.label){case 0:return[4,new yL(this.input,this.options)];case 1:return n=o.sent(),r=n[0],n.forEach(function(i){i.score>r.score&&(r=i)}),[2,r]}})})},t.prototype.runAndExtendWithFaceDetection=function(){var n=this;return new Promise(function(r){return le(n,void 0,void 0,function(){var o;return ce(this,function(i){switch(i.label){case 0:return[4,this.run()];case 1:return o=i.sent(),[2,r(o?em({},o):void 0)]}})})})},t.prototype.withFaceLandmarks=function(n){return n===void 0&&(n=!1),new gL(this.runAndExtendWithFaceDetection(),this.input,n)},t.prototype.withFaceExpressions=function(){return new gm(this.runAndExtendWithFaceDetection(),this.input)},t.prototype.withAgeAndGender=function(){return new bm(this.runAndExtendWithFaceDetection(),this.input)},t})(HC);function xL(e,t){if(e.length!==t.length)throw new Error("euclideanDistance: arr1.length !== arr2.length");var n=Array.from(e),r=Array.from(t);return Math.sqrt(n.map(function(o,i){return o-r[i]}).reduce(function(o,i){return o+Math.pow(i,2)},0))}(function(){function e(t,n){n===void 0&&(n=.6),this._distanceThreshold=n;var r=Array.isArray(t)?t:[t];if(!r.length)throw new Error("FaceRecognizer.constructor - expected atleast one input");var o=1,i=function(){return"person "+o++};this._labeledDescriptors=r.map(function(a){if(a instanceof ul)return a;if(a instanceof Float32Array)return new ul(i(),[a]);if(a.descriptor&&a.descriptor instanceof Float32Array)return new ul(i(),[a.descriptor]);throw new Error("FaceRecognizer.constructor - expected inputs to be of type LabeledFaceDescriptors | WithFaceDescriptor<any> | Float32Array | Array<LabeledFaceDescriptors | WithFaceDescriptor<any> | Float32Array>")})}return Object.defineProperty(e.prototype,"labeledDescriptors",{get:function(){return this._labeledDescriptors},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"distanceThreshold",{get:function(){return this._distanceThreshold},enumerable:!0,configurable:!0}),e.prototype.computeMeanDistance=function(t,n){return n.map(function(r){return xL(r,t)}).reduce(function(r,o){return r+o},0)/(n.length||1)},e.prototype.matchDescriptor=function(t){var n=this;return this.labeledDescriptors.map(function(r){var o=r.descriptors,i=r.label;return new g0(i,n.computeMeanDistance(t,o))}).reduce(function(r,o){return r.distance<o.distance?r:o})},e.prototype.findBestMatch=function(t){var n=this.matchDescriptor(t);return n.distance<this.distanceThreshold?n:new g0("unknown",n.distance)},e.prototype.toJSON=function(){return{distanceThreshold:this.distanceThreshold,labeledDescriptors:this.labeledDescriptors.map(function(t){return t.toJSON()})}},e.fromJSON=function(t){var n=t.labeledDescriptors.map(function(r){return ul.fromJSON(r)});return new e(n,t.distanceThreshold)},e})();const E0=document.getElementById("root");E0&&q1(E0).render(_.jsx(QT,{}))});export default wL();
